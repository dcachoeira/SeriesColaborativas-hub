/*
 
jsPDF standard_fonts_metrics plugin
Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
MIT license.
 
jsPDF split_text_to_size plugin
Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
MIT license.

jsPDF Silly SVG plugin
Copyright (c) 2012 Willow Systems Corporation, willow-systems.com
*/
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){window.OAT={};if("jap"==gx.languageCode||"jpn"==gx.languageCode||"jp"==gx.languageCode||"ja"==gx.languageCode||"jpx"==gx.languageCode||"ain"==gx.languageCode||"jpns"==gx.languageCode||"ams"==gx.languageCode||"japanese"==gx.languageCode||"JAP"==gx.languageCode||"JP"==gx.languageCode||"JA"==gx.languageCode||"JPN"==gx.languageCode||"ja-JP"==gx.languageCode||"ja_JP"==gx.languageCode||"jp"==gx.languageCode){for(var b=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/downloadify/jsPDF_japanese.js",!0),d=document.getElementsByTagName("head")[0]||document.documentElement,s=d.getElementsByTagName("script"),prevLoad=!1,i=0;s.length>i;i++)s[i].src==b&&(prevLoad=!0);if(!prevLoad){var e=document.createElement("script");e.type="text/javascript";e.src=b;e.onerror=function(){var c=document.createElement("script");c.type="text/javascript";c.src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/jsPDF_japanese.src.js",
!0);var g=document.getElementsByTagName("head")[0]||document.documentElement;g.insertBefore(c,g.lastChild)};e.onreadystatechange=function(){var c=this.readyState;if("loaded"===c||"complete"===c)e.onreadystatechange=null};d.insertBefore(e,d.lastChild)}}var featureList=["pivot","grid","statistics"];OAT.Preferences={showAjax:1,useCursors:1,windowTypeOverride:0,xsltPath:"../xslt/",imagePath:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/",!0),stylePath:gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/css/",!0),version:"19.03.2008",httpError:1,allowDefaultResize:1,allowDefaultDrag:1};OAT.$=function(c){var g="string"==typeof c?document.getElementById(c):c;if(c instanceof Array)for(var g=[],h=0;h<c.length;h++)g.push(OAT.$(c[h]));return!g?!1:g};OAT.$$=function(c,g){var h=g||document,j=h.getElementsByTagName("*"),k=[];OAT.Dom.isClass(h,c)&&k.push(h);for(h=0;h<j.length;h++)OAT.Dom.isClass(j[h],c)&&k.push(j[h]);return k};OAT.$v=function(c){c=OAT.$(c);return!c||
!("value"in c)?!1:c.value};Array.prototype.copy=function(){for(var c=[],g=0;g<this.length;g++)c.push(this[g]);return c};Array.prototype.findIndex=function(c){for(var g=0;g<this.length;g++)if(this[g]==c)return g;return-1};Array.prototype.append=function(c){var g=c;c instanceof Array||(g=[c]);for(c=0;c<g.length;c++)this.push(g[c])};String.prototype.trimpivot=function(){var c=this.match(/^ *(.*?) *$/);return c?c[1]:this};OAT.Dom={create:function(c,g,h){c=document.createElement(c);if(g)for(prop in g)c.style[prop]=
g[prop];h&&(c.className=h);return c},createNS:function(c,g){if(document.createElementNS)var h=document.createElementNS(c,g);else h=document.createElement(g),h.setAttribute("xmlns",c);return h},text:function(c){return document.createTextNode(c)},button:function(c){var g=OAT.Dom.create("input");g.type="button";g.value=c;return g},radio:function(c){if(OAT.Browser.isIE)var g=document.createElement('<input type="radio" name="'+c+'" />');else g=OAT.Dom.create("input"),g.name=c,g.type="radio";return g},
image:function(c,g,h,j){h=OAT.Dom.create("img",{width:h?h+"px":"auto",height:j?j+"px":"auto"});OAT.Dom.imageSrc(h,c,g);return h},imageSrc:function(c,g,h){c=OAT.$(c);g.toLowerCase().match(/png$/)&&OAT.Browser.isIE?(h||(h=OAT.Preferences.imagePath+"Blank.gif"),c.src=h,c.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+g+"', sizingMethod='image')"):c.src=g},option:function(c,g,h){var j=OAT.Dom.create("option");j.innerHTML=c;j.value=g;h&&OAT.$(h).appendChild(j);return j},append:function(){for(var c=
0;c<arguments.length;c++){var g=arguments[c];if(g instanceof Array&&!(2>g.length))for(var h=OAT.$(g[0]),j=1;j<g.length;j++){var k=g[j];k instanceof Array||(k=[k]);for(var m=0;m<k.length;m++)h.appendChild(OAT.$(k[m]))}}},hide:function(c){if(1<arguments.length)for(var g=0;g<arguments.length;g++)OAT.Dom.hide(arguments[g]);else if(c instanceof Array)for(g=0;g<c.length;g++)OAT.Dom.hide(c[g]);else{var h=OAT.$(c);if(h){for(var j=h.getElementsByTagName("input"),k=[],g=0;g<j.length;g++)k.push(j[g]);"input"==
h.tagName.toLowerCase()&&k.push(h);for(g=0;g<k.length;g++)if(j=k[g],("radio"==j.type||"checkbox"==j.type)&&!j.__checked)j.__checked=j.checked?"1":"0";h.style.display="none"}}},show:function(c){if(1<arguments.length)for(var g=0;g<arguments.length;g++)OAT.Dom.show(arguments[g]);else if(c instanceof Array)for(g=0;g<c.length;g++)OAT.Dom.show(c[g]);else{var h=OAT.$(c);if(h){h.style.display="";for(var j=h.getElementsByTagName("input"),k=[],g=0;g<j.length;g++)k.push(j[g]);"input"==h.tagName.toLowerCase()&&
k.push(h);for(g=0;g<k.length;g++)if(h=k[g],"radio"==h.type||"checkbox"==h.type)h.__checked&&"1"===h.__checked&&(h.checked=!0),h.__checked&&"0"===h.__checked&&(h.checked=!1),h.__checked=!1}}},clear:function(c){for(c=OAT.$(c);c.firstChild;)c.removeChild(c.firstChild)},unlink:function(c){(c=OAT.$(c))&&c.parentNode&&c.parentNode.removeChild(c)},center:function(c,g,h,j){var c=OAT.$(c),k=c.offsetParent;j&&(k=j);if(k){var m=k==document.body||"html"==k.tagName.toLowerCase()?OAT.Dom.getViewport():OAT.Dom.getWH(k),
n=OAT.Dom.getWH(c),j=Math.round(m[0]/2-n[0]/2),m=Math.round(m[1]/2-n[1]/2);0>m&&(m=30);n=OAT.Dom.getScroll();if(k==document.body||"html"==k.tagName.toLowerCase())j+=n[0],m+=n[1];g&&(c.style.left=j+"px");h&&(c.style.top=m+"px")}},isChild:function(c,g){var h=OAT.$(c),j=OAT.$(g),h=h.parentNode;do{if(!h)break;if(h==j)return!0;h=h.parentNode}while(h!=document.body&&h!=document);return!1},isKonqueror:function(){return navigator.userAgent.match(/konqueror/i)?!0:!1},isKHTML:function(){return navigator.userAgent.match(/khtml/i)?
!0:!1},isIE:function(){return document.attachEvent&&!document.addEventListener?!0:!1},isIE7:function(){return navigator.userAgent.match(/msie 7/i)?!0:!1},isIE6:function(){return OAT.Dom.isIE()&&!OAT.Dom.isIE7()},isGecko:function(){return!OAT.Dom.isKHTML()&&navigator.userAgent.match(/Gecko/i)?!0:!1},isOpera:function(){return navigator.userAgent.match(/Opera/)?!0:!1},isWebKit:function(){return navigator.userAgent.match(/AppleWebKit/)?!0:!1},isMac:function(){return navigator.platform.toString().match(/mac/i)?
!0:!1},isLinux:function(){return navigator.platform.toString().match(/linux/i)?!0:!1},isWindows:function(){return navigator.userAgent.toString().match(/windows/i)?!0:!1},color:function(c){if(c.match(/#/))return c=(4==c.length?"#"+c.charAt(1)+c.charAt(1)+c.charAt(2)+c.charAt(2)+c.charAt(3)+c.charAt(3):c).match(/#(..)(..)(..)/),[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)];c=c.match(/\(([^,]*),([^,]*),([^\)]*)/);return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]},isClass:function(c,g){var h=
OAT.$(c);return!h?!1:"*"==g?!0:""==g||!h.className?!1:-1!=h.className.split(" ").findIndex(g)},addClass:function(c,g){var h=OAT.$(c);if(h&&!OAT.Dom.isClass(h,g)){var j=h.className.split(" ");j.push(g);""==j[0]&&j.splice(0,1);h.className=j.join(" ")}},setIdPropertyValue:function(c,g){var h=OAT.$(c);h&&(h.id=g)},removeClass:function(c,g){var h=OAT.$(c);if(h&&OAT.Dom.isClass(h,g)){"*"==g&&(h.className="");var j=h.className.split(" "),k=j.findIndex(g);-1!=k&&(j.splice(k,1),h.className=j.join(" "))}},
getViewport:function(){return OAT.Browser.isWebKit?[window.innerWidth,window.innerHeight]:OAT.Browser.isOpera||"BackCompat"==document.compatMode?[document.body.clientWidth,document.body.clientHeight]:[document.documentElement.clientWidth,document.documentElement.clientHeight]},position:function(c){var c=OAT.$(c),g=c.offsetParent;if(c==document.body||c==document||!g)return OAT.Dom.getLT(c);var h=OAT.Dom.position(g),j=OAT.Dom.getLT(c),k=j[0],j=j[1];if(!OAT.Browser.isOpera||c.scrollTop!=c.offsetTop||
c.scrollLeft!=c.offsetLeft)k-=c.scrollLeft,j-=c.scrollTop;if(OAT.Browser.isWebKit&&g==document.body&&"absolute"==OAT.Dom.style(c,"position"))return[k,j];k+=h[0];j+=h[1];return[k,j]},getLT:function(c){var g=OAT.$(c),c=g.style.left&&"relative"!=g.style.position?parseInt(g.style.left):g.offsetLeft,g=g.style.top&&"relative"!=g.style.position?parseInt(g.style.top):g.offsetTop;return[c,g]},getWH:function(c){var g,h=OAT.$(c);h.style.width&&!h.style.width.match(/%/)&&"auto"!=h.style.width?c=parseInt(h.style.width):
OAT.Style.get(h,"width")&&!OAT.Browser.isIE?c=Math.round(parseFloat(OAT.Style.get(h,"width"))):(c=h.offsetWidth,"input"==h.tagName.toLowerCase()&&(c+=5));h.style.height&&!h.style.height.match(/%/)&&"auto"!=h.style.height?g=parseInt(h.style.height):OAT.Style.get(h,"height")&&!OAT.Browser.isIE?g=Math.round(parseFloat(OAT.Style.get(h,"height"))):(g=h.offsetHeight,"input"==h.tagName.toLowerCase()&&(g+=5));h==document.body&&(g=OAT.Browser.isIE?document.body.clientHeight:window.innerHeight);return[c,g]},
moveBy:function(c,g,h){c=OAT.$(c);if("absolute"==OAT.Dom.style(c,"position")&&(c.style.left||(c.style.left=c.offsetLeft+"px",c.style.right=""),!c.style.top))c.style.top=c.offsetTop+"px",c.style.bottom="";var j=OAT.Dom.getLT(c),h=j[1]+h;c.style.left=j[0]+g+"px";c.style.top=h+"px"},resizeBy:function(c,g,h){c=OAT.$(c);if("absolute"==OAT.Dom.style(c,"position")&&g&&(c.style.left||(c.style.left=c.offsetLeft+"px",c.style.right=""),!c.style.top&&h))c.style.top=c.offsetTop+"px",c.style.bottom="";var j=OAT.Dom.getWH(c),
k=j[0]+g,j=j[1]+h;g&&(c.style.width=k+"px");h&&(c.style.height=j+"px")},decodeImage:function(c){var g="image/";switch(OAT.Crypto.base64d(c).charAt(1)){case "I":g+="gif";break;case "P":g+="png";break;case "M":g+="bmp";break;default:g+="jpeg"}return"data:"+g+";base64,"+c},removeSelection:function(){var c=!1;document.getSelection&&!OAT.Browser.isGecko&&(c=document.getSelection());window.getSelection&&(c=window.getSelection());document.selection&&(c=document.selection);c&&(c.empty&&c.empty(),c.removeAllRanges&&
c.removeAllRanges())},getScroll:function(){if(OAT.Browser.isWebKit||OAT.Browser.isIE&&"BackCompat"==document.compatMode)var c=document.body.scrollLeft,g=document.body.scrollTop;else c=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),g=Math.max(document.documentElement.scrollTop,document.body.scrollTop);return[c,g]},getFreeSpace:function(c,g){var h=OAT.Dom.getScroll(),j=OAT.Dom.getViewport();return[c-h[0]>j[0]-c+h[0],g-h[1]>j[1]-g+h[1]]},toSafeXML:function(c){return"string"!=
typeof c?c:c.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},fromSafeXML:function(c){return c.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")},uriParams:function(){var c={},g=location.search;1<g.length&&(g=g.substring(1));if(!g)return c;for(var g=g.split("&"),h=0;h<g.length;h++){var j=g[h];if(j){var k=j.indexOf("=");if(-1==k)c[decodeURIComponent(j)]="";else{var m=j.substring(0,k),j=j.substring(k+1),m=decodeURIComponent(m),j=decodeURIComponent(j),k=!1;(k=m.match(/(.*)\[\]$/))?
(m=k[1],m in c?c[m].push(j):c[m]=[j]):c[m]=j}}}return c},changeHref:function(c,g){for(var h=!1,j=OAT.$(c),k=j;k.parentNode;)k=k.parentNode,k==document.body&&(h=!0);h?j.href=g:j.parentNode?(h=j.parentNode,k=j.nextSibling,document.body.appendChild(j),j.href=g,OAT.Dom.unlink(j),h.insertBefore(j,k)):(document.body.appendChild(j),j.href=g,OAT.Dom.unlink(j))},makePosition:function(c){c=OAT.$(c);"absolute"!=OAT.Dom.style(c,"position")&&(c.style.position="relative")}};OAT.Style={include:function(c,g){if(c){c=
OAT.Preferences.stylePath+c;if(!g)for(var h=document.getElementsByTagName("link"),j=location.protocol+"//"+location.host,k=0;k<h.length;k++)if(c==h[k].getAttribute("href")||j+c==h[k].getAttribute("href"))return;k=OAT.Dom.create("link");k.rel="stylesheet";k.type="text/css";k.href=c;jQuery("head").prepend(k);if(gx.util.browser.isIE()){j="Resources/English/GeneXusXEv2.css";for(k=0;k<=h.length-1;k++)"gxtheme_css_reference"===h[k].getAttribute("id")&&(j=h[k].getAttribute("href"));jQuery("head").prepend(jQuery('<link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+
j+'" />'))}}},get:function(c,g){var h=OAT.$(c);if(document.defaultView&&document.defaultView.getComputedStyle)return h=document.defaultView.getComputedStyle(h,""),!h?!0:h[g];try{var j=h.currentStyle[g]}catch(k){j=h.getExpression(g)}return j},background:function(c,g){var h=OAT.$(c);g.toLowerCase().match(/png$/)&&OAT.Browser.isIE?h.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+g+"', sizingMethod='crop')":h.style.backgroundImage="url("+g+")"},apply:function(c,g){var h=OAT.$(c);
if(h)for(var j in g)h.style[j]=g[j]},opacity:function(c,g){var h=Math.max(g,0),j=OAT.$(c);OAT.Browser.isIE?j.style.filter="alpha(opacity="+Math.round(100*h)+")":j.style.opacity=h}};OAT.Dom.style=OAT.Style.get;OAT.Dom.applyStyle=OAT.Style.apply;OAT.Browser={isIE:OAT.Dom.isIE(),isIE6:OAT.Dom.isIE6(),isIE7:OAT.Dom.isIE7(),isGecko:OAT.Dom.isGecko(),isOpera:OAT.Dom.isOpera(),isKonqueror:OAT.Dom.isKonqueror(),isKHTML:OAT.Dom.isKHTML(),isWebKit:OAT.Dom.isWebKit(),isMac:OAT.Dom.isMac(),isLinux:OAT.Dom.isLinux(),
isWindows:OAT.Dom.isWindows()};OAT.Event={attach:function(c,g,h){c=OAT.$(c);c.addEventListener?c.addEventListener(g,h,!1):c.attachEvent?c.attachEvent("on"+g,h):c["on"+g]=h},detach:function(c,g,h){c=OAT.$(c);c.removeEventListener?c.removeEventListener(g,h,!1):c.detachEvent?c.detachEvent("on"+g,h):c["on"+g]=!1},source:function(c){return c.target?c.target:c.srcElement},cancel:function(c){c.cancelBubble=!0;c.stopPropagation&&c.stopPropagation()},position:function(c){var g=OAT.Dom.getScroll();return[c.clientX+
g[0],c.clientY+g[1]]},prevent:function(c){c.preventDefault&&c.preventDefault();gx.util.browser.isIE()&&(c.returnValue=!1)}};OAT.Dom.attach=OAT.Event.attach;OAT.Dom.detach=OAT.Event.detach;OAT.Dom.source=OAT.Event.source;OAT.Dom.eventPos=OAT.Event.position;OAT.Dom.prevent=OAT.Event.prevent;OAT.Loader={toolkitPath:!1,loadOccurred:0,openAjax:!1,include:function(c){for(var g=OAT.Loader.toolkitPath||"",c="object"==typeof c?c:[c],h=0;h<c.length;h++){var j=g+c[h],k=document.createElement("script");k.src=
j;document.getElementsByTagName("head")[0].appendChild(k)}},findPath:function(){OAT.Loader.toolkitPath=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/js/",!0)},startOpenAjax:function(){OpenAjax.hub.registerLibrary("oat","http://www.openlinksw.com/oat","1.0")}};OAT.MSG={DEBUG:0,OAT_DEBUG:0,OAT_LOAD:1,ANIMATION_STOP:2,TREE_EXPAND:3,TREE_COLLAPSE:4,DS_RECORD_PREADVANCE:5,DS_RECORD_ADVANCE:6,DS_PAGE_PREADVANCE:7,DS_PAGE_ADVANCE:8,AJAX_START:9,AJAX_ERROR:10,GD_START:11,GD_ABORT:12,
GD_END:13,DOCK_DRAG:14,DOCK_REMOVE:15,SLB_OPENED:16,SLB_CLOSED:17,registry:[],attach:function(c,g,h){c&&OAT.MSG.registry.push([c,g,h])},detach:function(c,g,h){if(c){for(var j=-1,k=0;k<OAT.MSG.registry.length;k++){var m=OAT.MSG.registry[k];m[0]==c&&(m[1]==g&&m[2]==h)&&(j=k)}-1!=j&&OAT.MSG.registry.splice(j,1)}},send:function(c,g,h){for(var j=0;j<OAT.MSG.registry.length;j++){var k=OAT.MSG.registry[j];if(c==k[0]||"*"==k[0]){var m=g==k[1]||"*"==k[1];if(!m&&k[1].toString().match(/\*/)){var n=RegExp(k[1]),
l="",o;for(o in OAT.MSG)OAT.MSG[o]==g&&(l=o);l.match(n)&&(m=!0)}if(m)k[2](c,g,h)}}}};OAT.Debug={data:[],attach:function(c,g){OAT.MSG.attach(c,g,OAT.Debug.listen)},listen:function(c,g,h){var j="n/a",k;for(k in OAT.MSG){var m=OAT.MSG[k];"number"==typeof m&&m==g&&(j=k)}OAT.Debug.data.push([c,j,h])}};OAT.Loader.findPath();OAT.Loader.openAjax&&OAT.Loader.startOpenAjax();OAT.Event.attach(window,"load",function(){OAT.Loader.loadOccurred=1;OAT.Loader.callListeners()});OAT.Loader.listeners=[];OAT.Loader.addListener=
function(c){1==OAT.Loader.loadOccurred?c():OAT.Loader.listeners.push(c)};OAT.Loader.callListeners=function(){for(var c=0,g=this.listeners.length;c<g;c++)OAT.Loader.listeners[c]()}}
if((!gx.util.browser.isIE()||8<gx.util.browser.ieVersion())&&gx.util.browser.isIE()&&9==gx.util.browser.ieVersion()){(function(){Downloadify=window.Downloadify={queue:{},uid:(new Date).getTime(),getTextForSave:function(c){return(c=Downloadify.queue[c])?c.getData():""},getFileNameForSave:function(c){return(c=Downloadify.queue[c])?c.getFilename():""},getDataTypeForSave:function(c){return(c=Downloadify.queue[c])?c.getDataType():""},saveComplete:function(c){(c=Downloadify.queue[c])&&c.complete();return!0},
saveCancel:function(c){(c=Downloadify.queue[c])&&c.cancel();return!0},saveError:function(c){(c=Downloadify.queue[c])&&c.error();return!0},addToQueue:function(c){Downloadify.queue[c.queue_name]=c},getUID:function(c){""==c.id&&(c.id="downloadify_"+Downloadify.uid++);return c.id}};Downloadify.create=function(c,g){var h="string"==typeof c?document.getElementById(c):c;return new Downloadify.Container(h,g)};Downloadify.Container=function(c,g){var h=this;h.el=c;h.enabled=!0;h.dataCallback=null;h.filenameCallback=
null;h.data=null;h.filename=null;h.enable=function(){document.getElementById(h.flashContainer.id).setEnabled(!0);h.enabled=!0};h.disable=function(){document.getElementById(h.flashContainer.id).setEnabled(!1);h.enabled=!1};h.getData=function(){return!h.enabled?"":h.dataCallback?h.dataCallback():h.data?h.data:""};h.getFilename=function(){return h.filenameCallback?h.filenameCallback():h.filename?h.filename:""};h.getDataType=function(){return h.options.dataType?h.options.dataType:"string"};h.complete=
function(){if("function"===typeof h.options.onComplete)h.options.onComplete()};h.cancel=function(){if("function"===typeof h.options.onCancel)h.options.onCancel()};h.error=function(){if("function"===typeof h.options.onError)h.options.onError()};(function(){h.options=g;h.options.append||(h.el.innerHTML="");h.flashContainer=document.createElement("span");h.el.appendChild(h.flashContainer);h.queue_name=Downloadify.getUID(h.flashContainer);"function"===typeof h.options.filename?h.filenameCallback=h.options.filename:
h.options.filename&&(h.filename=h.options.filename);"function"===typeof h.options.data?h.dataCallback=h.options.data:h.options.data&&(h.data=h.options.data);var c={queue_name:h.queue_name,width:h.options.width,height:h.options.height},k={allowScriptAccess:"always"},m={id:h.flashContainer.id,name:h.flashContainer.id};!1===h.options.enabled&&(h.enabled=!1);!0===h.options.transparent&&(k.wmode="transparent");h.options.downloadImage&&(c.downloadImage=h.options.downloadImage);swfobject.embedSWF(h.options.swf,
h.flashContainer.id,h.options.width,h.options.height,"10",null,c,k,m);Downloadify.addToQueue(h)})()};Downloadify.defaultOptions={swf:"media/downloadify.swf",downloadImage:"images/download.png",width:100,height:30,transparent:!0,append:!1,dataType:"string"}})();"undefined"!=typeof jQuery&&function(c){c.fn.downloadify=function(g){return this.each(function(){g=c.extend({},Downloadify.defaultOptions,g);var h=Downloadify.create(this,g);c(this).data("Downloadify",h)})}}(jQuery);"undefined"!=typeof MooTools&&
Element.implement({downloadify:function(c){c=$merge(Downloadify.defaultOptions,c);return this.store("Downloadify",Downloadify.create(this,c))}});var swfobject=function(){function c(){if(!G){try{var f=C.getElementsByTagName("body")[0].appendChild(C.createElement("span"));f.parentNode.removeChild(f)}catch(c){return}G=!0;for(var f=W.length,g=0;g<f;g++)W[g]()}}function g(f){G?f():W[W.length]=f}function h(f){if(typeof y.addEventListener!=B)y.addEventListener("load",f,!1);else if(typeof C.addEventListener!=
B)C.addEventListener("load",f,!1);else if(typeof y.attachEvent!=B)v(y,"onload",f);else if("function"==typeof y.onload){var c=y.onload;y.onload=function(){c();f()}}else y.onload=f}function j(){var f=C.getElementsByTagName("body")[0],c=C.createElement(E);c.setAttribute("type",z);var g=f.appendChild(c);if(g){var h=0;(function(){if(typeof g.GetVariable!=B){var j=g.GetVariable("$version");j&&(j=j.split(" ")[1].split(","),P.pv=[parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10)])}else if(10>h){h++;setTimeout(arguments.callee,
10);return}f.removeChild(c);g=null;k()})()}else k()}function k(){var f=U.length;if(0<f)for(var c=0;c<f;c++){var g=U[c].id,h=U[c].callbackFn,k={success:!1,id:g};if(0<P.pv[0]){var D=w(g);if(D)if(A(U[c].swfVersion)&&!(P.wk&&312>P.wk))H(g,!0),h&&(k.success=!0,k.ref=m(g),h(k));else if(U[c].expressInstall&&n()){k={};k.data=U[c].expressInstall;k.width=D.getAttribute("width")||"0";k.height=D.getAttribute("height")||"0";D.getAttribute("class")&&(k.styleclass=D.getAttribute("class"));D.getAttribute("align")&&
(k.align=D.getAttribute("align"));for(var j={},D=D.getElementsByTagName("param"),M=D.length,R=0;R<M;R++)"movie"!=D[R].getAttribute("name").toLowerCase()&&(j[D[R].getAttribute("name")]=D[R].getAttribute("value"));l(k,j,g,h)}else o(D),h&&h(k)}else if(H(g,!0),h){if((g=m(g))&&typeof g.SetVariable!=B)k.success=!0,k.ref=g;h(k)}}}function m(f){var c=null;if((f=w(f))&&"OBJECT"==f.nodeName)typeof f.SetVariable!=B?c=f:(f=f.getElementsByTagName(E)[0])&&(c=f);return c}function n(){return!f&&A("6.0.65")&&(P.win||
P.mac)&&!(P.wk&&312>P.wk)}function l(c,g,h,k){f=!0;T=k||null;L={success:!1,id:h};var j=w(h);if(j){"OBJECT"==j.nodeName?(X=q(j),ba=null):(X=j,ba=h);c.id=x;if(typeof c.width==B||!/%$/.test(c.width)&&310>parseInt(c.width,10))c.width="310";if(typeof c.height==B||!/%$/.test(c.height)&&137>parseInt(c.height,10))c.height="137";C.title=C.title.slice(0,47)+" - Flash Player Installation";k=P.ie&&P.win?"ActiveX":"PlugIn";k="MMredirectURL="+y.location.toString().replace(/&/g,"%26")+"&MMplayerType="+k+"&MMdoctitle="+
C.title;g.flashvars=typeof g.flashvars!=B?g.flashvars+("&"+k):k;P.ie&&(P.win&&4!=j.readyState)&&(k=C.createElement("div"),h+="SWFObjectNew",k.setAttribute("id",h),j.parentNode.insertBefore(k,j),j.style.display="none",function(){j.readyState==4?j.parentNode.removeChild(j):setTimeout(arguments.callee,10)}());r(c,g,h)}}function o(f){if(P.ie&&P.win&&4!=f.readyState){var c=C.createElement("div");f.parentNode.insertBefore(c,f);c.parentNode.replaceChild(q(f),c);f.style.display="none";(function(){4==f.readyState?
f.parentNode.removeChild(f):setTimeout(arguments.callee,10)})()}else f.parentNode.replaceChild(q(f),f)}function q(f){var c=C.createElement("div");if(P.win&&P.ie)c.innerHTML=f.innerHTML;else if(f=f.getElementsByTagName(E)[0])if(f=f.childNodes)for(var g=f.length,h=0;h<g;h++)!(1==f[h].nodeType&&"PARAM"==f[h].nodeName)&&8!=f[h].nodeType&&c.appendChild(f[h].cloneNode(!0));return c}function r(f,c,g){var h,k=w(g);if(P.wk&&312>P.wk)return h;if(k)if(typeof f.id==B&&(f.id=g),P.ie&&P.win){var D="",j;for(j in f)f[j]!=
Object.prototype[j]&&("data"==j.toLowerCase()?c.movie=f[j]:"styleclass"==j.toLowerCase()?D+=' class="'+f[j]+'"':"classid"!=j.toLowerCase()&&(D+=" "+j+'="'+f[j]+'"'));j="";for(var M in c)c[M]!=Object.prototype[M]&&(j+='<param name="'+M+'" value="'+c[M]+'" />');k.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+D+">"+j+"</object>";O[O.length]=f.id;h=w(f.id)}else{M=C.createElement(E);M.setAttribute("type",z);for(var R in f)f[R]!=Object.prototype[R]&&("styleclass"==R.toLowerCase()?
M.setAttribute("class",f[R]):"classid"!=R.toLowerCase()&&M.setAttribute(R,f[R]));for(D in c)c[D]!=Object.prototype[D]&&"movie"!=D.toLowerCase()&&(f=M,j=D,R=c[D],g=C.createElement("param"),g.setAttribute("name",j),g.setAttribute("value",R),f.appendChild(g));k.parentNode.replaceChild(M,k);h=M}return h}function t(f){var c=w(f);c&&"OBJECT"==c.nodeName&&(P.ie&&P.win?(c.style.display="none",function(){if(4==c.readyState){var g=w(f);if(g){for(var h in g)"function"==typeof g[h]&&(g[h]=null);g.parentNode.removeChild(g)}}else setTimeout(arguments.callee,
10)}()):c.parentNode.removeChild(c))}function w(f){var c=null;try{c=C.getElementById(f)}catch(g){}return c}function v(f,c,g){f.attachEvent(c,g);J[J.length]=[f,c,g]}function A(f){var c=P.pv,f=f.split(".");f[0]=parseInt(f[0],10);f[1]=parseInt(f[1],10)||0;f[2]=parseInt(f[2],10)||0;return c[0]>f[0]||c[0]==f[0]&&c[1]>f[1]||c[0]==f[0]&&c[1]==f[1]&&c[2]>=f[2]?!0:!1}function F(f,c,g,h){if(!P.ie||!P.mac){var k=C.getElementsByTagName("head")[0];if(k){g=g&&"string"==typeof g?g:"screen";h&&(V=S=null);if(!S||
V!=g)h=C.createElement("style"),h.setAttribute("type","text/css"),h.setAttribute("media",g),S=k.appendChild(h),P.ie&&(P.win&&typeof C.styleSheets!=B&&0<C.styleSheets.length)&&(S=C.styleSheets[C.styleSheets.length-1]),V=g;P.ie&&P.win?S&&typeof S.addRule==E&&S.addRule(f,c):S&&typeof C.createTextNode!=B&&S.appendChild(C.createTextNode(f+" {"+c+"}"))}}}function H(f,c){if(Q){var g=c?"visible":"hidden";G&&w(f)?w(f).style.visibility=g:F("#"+f,"visibility:"+g)}}function u(f){return null!=/[\\\"<>\.;]/.exec(f)&&
typeof encodeURIComponent!=B?encodeURIComponent(f):f}var B="undefined",E="object",z="application/x-shockwave-flash",x="SWFObjectExprInst",y=window,C=document,I=navigator,K=!1,W=[function(){K?j():k()}],U=[],O=[],J=[],X,ba,T,L,G=!1,f=!1,S,V,Q=!0,P=function(){var f=typeof C.getElementById!=B&&typeof C.getElementsByTagName!=B&&typeof C.createElement!=B,c=I.userAgent.toLowerCase(),g=I.platform.toLowerCase(),h=g?/win/.test(g):/win/.test(c),g=g?/mac/.test(g):/mac/.test(c),c=/webkit/.test(c)?parseFloat(c.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,
"$1")):!1,k=!+"\v1",D=[0,0,0],j=null;if(typeof I.plugins!=B&&typeof I.plugins["Shockwave Flash"]==E){if((j=I.plugins["Shockwave Flash"].description)&&!(typeof I.mimeTypes!=B&&I.mimeTypes[z]&&!I.mimeTypes[z].enabledPlugin))K=!0,k=!1,j=j.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),D[0]=parseInt(j.replace(/^(.*)\..*$/,"$1"),10),D[1]=parseInt(j.replace(/^.*\.(.*)\s.*$/,"$1"),10),D[2]=/[a-zA-Z]/.test(j)?parseInt(j.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof y.ActiveXObject!=B)try{var M=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
if(M&&(j=M.GetVariable("$version")))k=!0,j=j.split(" ")[1].split(","),D=[parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10)]}catch(R){}return{w3:f,pv:D,wk:c,ie:k,win:h,mac:g}}();(function(){P.w3&&((typeof C.readyState!=B&&"complete"==C.readyState||typeof C.readyState==B&&(C.getElementsByTagName("body")[0]||C.body))&&c(),G||(typeof C.addEventListener!=B&&C.addEventListener("DOMContentLoaded",c,!1),P.ie&&P.win&&(C.attachEvent("onreadystatechange",function(){"complete"==C.readyState&&(C.detachEvent("onreadystatechange",
arguments.callee),c())}),y==top&&function(){if(!G){try{C.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,0);return}c()}}()),P.wk&&function(){G||(/loaded|complete/.test(C.readyState)?c():setTimeout(arguments.callee,0))}(),h(c)))})();(function(){P.ie&&P.win&&window.attachEvent("onunload",function(){for(var f=J.length,c=0;c<f;c++)J[c][0].detachEvent(J[c][1],J[c][2]);f=O.length;for(c=0;c<f;c++)t(O[c]);for(var g in P)P[g]=null;P=null;for(var h in swfobject)swfobject[h]=null;swfobject=
null})})();return{registerObject:function(f,c,g,h){if(P.w3&&f&&c){var k={};k.id=f;k.swfVersion=c;k.expressInstall=g;k.callbackFn=h;U[U.length]=k;H(f,!1)}else h&&h({success:!1,id:f})},getObjectById:function(f){if(P.w3)return m(f)},embedSWF:function(f,c,h,k,j,D,N,M,R,m){var o={success:!1,id:c};P.w3&&!(P.wk&&312>P.wk)&&f&&c&&h&&k&&j?(H(c,!1),g(function(){h+="";k+="";var g={};if(R&&typeof R===E)for(var q in R)g[q]=R[q];g.data=f;g.width=h;g.height=k;q={};if(M&&typeof M===E)for(var t in M)q[t]=M[t];if(N&&
typeof N===E)for(var u in N)q.flashvars=typeof q.flashvars!=B?q.flashvars+("&"+u+"="+N[u]):u+"="+N[u];if(A(j))t=r(g,q,c),g.id==c&&H(c,!0),o.success=!0,o.ref=t;else{if(D&&n()){g.data=D;l(g,q,c,m);return}H(c,!0)}m&&m(o)})):m&&m(o)},switchOffAutoHideShow:function(){Q=!1},ua:P,getFlashPlayerVersion:function(){return{major:P.pv[0],minor:P.pv[1],release:P.pv[2]}},hasFlashPlayerVersion:A,createSWF:function(f,c,g){if(P.w3)return r(f,c,g)},showExpressInstall:function(f,c,g,h){P.w3&&n()&&l(f,c,g,h)},removeSWF:function(f){P.w3&&
t(f)},createCSS:function(f,c,g,h){P.w3&&F(f,c,g,h)},addDomLoadEvent:g,addLoadEvent:h,getQueryParamValue:function(f){var c=C.location.search||C.location.hash;if(c){/\?/.test(c)&&(c=c.split("?")[1]);if(null==f)return u(c);for(var c=c.split("&"),g=0;g<c.length;g++)if(c[g].substring(0,c[g].indexOf("="))==f)return u(c[g].substring(c[g].indexOf("=")+1))}return""},expressInstallCallback:function(){if(f){var c=w(x);c&&X&&(c.parentNode.replaceChild(X,c),ba&&(H(ba,!0),P.ie&&P.win&&(X.style.display="block")),
T&&T(L));f=!1}}}}()}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){var jsPDF=function(){function c(j,k,m,n,l,o){j="undefined"===typeof j?"p":j.toString().toLowerCase();"undefined"===typeof k&&(k="mm");"undefined"===typeof m&&(m="a4");"undefined"===typeof n&&"undefined"===typeof zpipe&&(n=!1);var q=m.toString().toLowerCase(),r=[],t=0,w=n,n={a3:[841.89,1190.55],a4:[l,o],a5:[420.94,595.28],letter:[612,792],legal:[612,1008]},v="0 g",A=0,F=[],H=2,u=!1,B=[],E={},z={},x=16,y,C,I,K,W={title:"",subject:"",author:"",
keywords:"",creator:""},U=0,O=0,J={},X=new h(J),ba,T=function(f){return f.toFixed(2)},L=function(f){var c=f.toFixed(0);return 10>f?"0"+c:c},G=function(f){u?F[A].push(f):(r.push(f),t+=f.length+1)},f=function(){H++;B[H]=t;G(H+" 0 obj");return H},S=function(f){G("stream");G(f);G("endstream")},V,Q,P,aa=function(f,c){var g;g=f;var D=c,h,k,j,N,l,n;void 0===D&&(D={});h=D.sourceEncoding?h:"Unicode";j=D.outputEncoding;if((D.autoencode||j)&&E[y].metadata&&E[y].metadata[h]&&E[y].metadata[h].encoding)if(h=E[y].metadata[h].encoding,
!j&&E[y].encoding&&(j=E[y].encoding),!j&&h.codePages&&(j=h.codePages[0]),"string"===typeof j&&(j=h[j]),j){l=!1;N=[];h=0;for(k=g.length;h<k;h++)(n=j[g.charCodeAt(h)])?N.push(String.fromCharCode(n)):N.push(g[h]),N[h].charCodeAt(0)>>8&&(l=!0);g=N.join("")}for(h=g.length;void 0===l&&0!==h;)g.charCodeAt(h-1)>>8&&(l=!0),h--;if(l){N=D.noBOM?[]:[254,255];h=0;for(k=g.length;h<k;h++){n=g.charCodeAt(h);D=n>>8;if(D>>8)throw Error("Character at position "+h.toString(10)+" of string '"+g+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");
N.push(D);N.push(n-(D<<8))}g=String.fromCharCode.apply(void 0,N)}return g.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ca=function(){A++;u=!0;F[A]=[];G(T(0.200025*K)+" w");G("0 G");0!==U&&G(U.toString(10)+" J");0!==O&&G(O.toString(10)+" j");X.publish("addPage",{pageNumber:A})},ha=function(f,c){var g;void 0===f&&(f=E[y].fontName);void 0===c&&(c=E[y].fontStyle);try{g=z[f][c]}catch(D){g=void 0}if(!g)throw Error("Unable to look up font label for font '"+f+"', '"+c+"'. Refer to getFontList() for available fonts.");
return g},ia=function(){u=!1;r=[];B=[];G("%PDF-1.3");V=I*K;Q=C*K;var c,g,D,h,k;for(c=1;c<=A;c++){f();G("<</Type /Page");G("/Parent 1 0 R");G("/Resources 2 0 R");G("/Contents "+(H+1)+" 0 R>>");G("endobj");g=F[c].join("\n");f();if(w){D=[];for(h=0;h<g.length;++h)D[h]=g.charCodeAt(h);k=adler32cs.from(g);g=new Deflater(6);g.append(new Uint8Array(D));g=g.flush();D=[new Uint8Array([120,156]),new Uint8Array(g),new Uint8Array([k&255,k>>8&255,k>>16&255,k>>24&255])];g="";for(h in D)D.hasOwnProperty(h)&&(g+=
String.fromCharCode.apply(null,D[h]));G("<</Length "+g.length+" /Filter [/FlateDecode]>>")}else G("<</Length "+g.length+">>");S(g);G("endobj")}B[1]=t;G("1 0 obj");G("<</Type /Pages");P="/Kids [";for(h=0;h<A;h++)P+=3+2*h+" 0 R ";G(P+"]");G("/Count "+A);G("/MediaBox [0 0 "+T(V)+" "+T(Q)+"]");G(">>");G("endobj");for(var j in E)E.hasOwnProperty(j)&&(c=E[j],c.objectNumber=f(),G("<</BaseFont/"+c.PostScriptName+"/Type/Font"),"string"===typeof c.encoding&&G("/Encoding/"+c.encoding),G("/Subtype/Type1>>"),
G("endobj"));X.publish("putResources");B[2]=t;G("2 0 obj");G("<<");G("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]");G("/Font <<");for(var N in E)E.hasOwnProperty(N)&&G("/"+N+" "+E[N].objectNumber+" 0 R");G(">>");G("/XObject <<");X.publish("putXobjectDict");G(">>");G(">>");G("endobj");X.publish("postPutResources");f();G("<<");G("/Producer (jsPDF 0.9.0rc2)");W.title&&G("/Title ("+aa(W.title)+")");W.subject&&G("/Subject ("+aa(W.subject)+")");W.author&&G("/Author ("+aa(W.author)+")");W.keywords&&G("/Keywords ("+
aa(W.keywords)+")");W.creator&&G("/Creator ("+aa(W.creator)+")");j=new Date;G("/CreationDate (D:"+[j.getFullYear(),L(j.getMonth()+1),L(j.getDate()),L(j.getHours()),L(j.getMinutes()),L(j.getSeconds())].join("")+")");G(">>");G("endobj");f();G("<<");G("/Type /Catalog");G("/Pages 1 0 R");G("/OpenAction [3 0 R /FitH null]");G("/PageLayout /OneColumn");X.publish("putCatalog");G(">>");G("endobj");j=t;G("xref");G("0 "+(H+1));G("0000000000 65535 f ");for(N=1;N<=H;N++)c=B[N].toFixed(0),c=10>c.length?Array(11-
c.length).join("0")+c:c,G(c+" 00000 n ");G("trailer");G("<<");G("/Size "+(H+1));G("/Root "+H+" 0 R");G("/Info "+(H-1)+" 0 R");G(">>");G("startxref");G(j);G("%%EOF");u=!0;return r.join("\n")},fa=function(f){var c="S";if("F"===f)c="f";else if("FD"===f||"DF"===f)c="B";return c},D=function(f,c){var g,D,h,k;switch(f){case void 0:return ia();case "save":if(navigator.getUserMedia&&(void 0===window.URL||void 0===window.URL.createObjectURL))return J.output("dataurlnewwindow");g=ia();D=g.length;h=new Uint8Array(new ArrayBuffer(D));
for(k=0;k<D;k++)h[k]=g.charCodeAt(k);g=new Blob([h],{type:"application/pdf"});saveAs(g,c);break;case "datauristring":case "dataurlstring":return"data:application/pdf;base64,"+btoa(ia());case "datauri":case "dataurl":document.location.href="data:application/pdf;base64,"+btoa(ia());break;case "dataurlnewwindow":window.open("data:application/pdf;base64,"+btoa(ia()));break;default:throw Error('Output type "'+f+'" is not supported.');}};if("pt"===k)K=1;else if("mm"===k)K=72/25.4;else if("cm"===k)K=72/
2.54;else if("in"===k)K=72;else throw"Invalid unit: "+k;if(n.hasOwnProperty(q))C=n[q][1]/K,I=n[q][0]/K;else try{C=m[1],I=m[0]}catch(N){throw"Invalid format: "+m;}if("p"===j||"portrait"===j)j="p",I>C&&(j=I,I=C,C=j);else if("l"===j||"landscape"===j)j="l",C>I&&(j=I,I=C,C=j);else throw"Invalid orientation: "+j;J.internal={pdfEscape:aa,getStyle:fa,getFont:function(){return E[ha.apply(J,arguments)]},getFontSize:function(){return x},btoa:btoa,write:function(f,c,g,D){G(1===arguments.length?f:Array.prototype.join.call(arguments,
" "))},getCoordinateString:function(f){return T(f*K)},getVerticalCoordinateString:function(f){return T((C-f)*K)},collections:{},newObject:f,putStream:S,events:X,scaleFactor:K,pageSize:{width:I,height:C},output:function(f,c){return D(f,c)}};J.addPage=function(){ca();return this};J.text=function(f,c,g,D){var h,k;"number"===typeof f&&(h=f,k=c,f=g,c=h,g=k);"string"===typeof f&&f.match(/[\n\r]/)&&(f=f.split(/\r\n|\r|\n/g));if("undefined"===typeof D)D={noBOM:!0,autoencode:!0};else if(void 0===D.noBOM&&
(D.noBOM=!0),void 0===D.autoencode)D.autoencode=!0;if("string"===typeof f)D=aa(f,D);else if(f instanceof Array){f=f.concat();for(h=f.length-1;-1!==h;h--)f[h]=aa(f[h],D);D=f.join(") Tj\nT* (")}else throw Error('Type of text must be string or Array. "'+f+'" is not recognized.');G("BT\n/"+y+" "+x+" Tf\n"+x+" TL\n"+v+"\n"+T(c*K)+" "+T((C-g)*K)+" Td\n("+D+") Tj\nET");return this};J.line=function(f,c,g,D){G(T(f*K)+" "+T((C-c)*K)+" m "+T(g*K)+" "+T((C-D)*K)+" l S");return this};J.lines=function(f,c,g,D,
h){var k,j,N,l,n,m,o,q;"number"===typeof f&&(k=f,j=c,f=g,c=k,g=j);h=fa(h);D=void 0===D?[1,1]:D;G((c*K).toFixed(3)+" "+((C-g)*K).toFixed(3)+" m ");k=D[0];D=D[1];j=f.length;q=g;for(g=0;g<j;g++)N=f[g],2===N.length?(c=N[0]*k+c,q=N[1]*D+q,G((c*K).toFixed(3)+" "+((C-q)*K).toFixed(3)+" l")):(l=N[0]*k+c,n=N[1]*D+q,m=N[2]*k+c,o=N[3]*D+q,c=N[4]*k+c,q=N[5]*D+q,G((l*K).toFixed(3)+" "+((C-n)*K).toFixed(3)+" "+(m*K).toFixed(3)+" "+((C-o)*K).toFixed(3)+" "+(c*K).toFixed(3)+" "+((C-q)*K).toFixed(3)+" c"));G(h);return this};
J.rect=function(f,c,g,D,h){h=fa(h);G([T(f*K),T((C-c)*K),T(g*K),T(-D*K),"re",h].join(" "));return this};J.setProperties=function(f){for(var c in W)W.hasOwnProperty(c)&&f[c]&&(W[c]=f[c]);return this};J.setFontSize=function(f){x=f;return this};J.setFont=function(f,c){y=ha(f,c);return this};J.setFontStyle=J.setFontType=function(f){y=ha(void 0,f);return this};J.getFontList=function(){var f={},c,g,D;for(c in z)if(z.hasOwnProperty(c))for(g in f[c]=D=[],z[c])z[c].hasOwnProperty(g)&&D.push(g);return f};J.setLineWidth=
function(f){G((f*K).toFixed(2)+" w");return this};J.setDrawColor=function(f,c,g,D){f=void 0===c||void 0===D&&f===c===g?"string"===typeof f?f+" G":T(f/255)+" G":void 0===D?"string"===typeof f?[f,c,g,"RG"].join(" "):[T(f/255),T(c/255),T(g/255),"RG"].join(" "):"string"===typeof f?[f,c,g,D,"K"].join(" "):[T(f),T(c),T(g),T(D),"K"].join(" ");G(f);return this};J.setFillColor=function(f,c,g,D){f=void 0===c||void 0===D&&f===c===g?"string"===typeof f?f+" g":T(f/255)+" g":void 0===D?"string"===typeof f?[f,c,
g,"rg"].join(" "):[T(f/255),T(c/255),T(g/255),"rg"].join(" "):"string"===typeof f?[f,c,g,D,"k"].join(" "):[T(f),T(c),T(g),T(D),"k"].join(" ");G(f);return this};J.setTextColor=function(f,c,g){v=0===f&&0===c&&0===g||"undefined"===typeof c?(f/255).toFixed(3)+" g":[(f/255).toFixed(3),(c/255).toFixed(3),(g/255).toFixed(3),"rg"].join(" ");return this};J.CapJoinStyles={"0":0,butt:0,but:0,bevel:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,milter:2};J.setLineCap=function(f){var c=this.CapJoinStyles[f];
if(void 0===c)throw Error("Line cap style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");U=c;G(c.toString(10)+" J");return this};J.setLineJoin=function(f){var c=this.CapJoinStyles[f];if(void 0===c)throw Error("Line join style of '"+f+"' is not recognized. See or extend .CapJoinStyles property for valid styles");O=c;G(c.toString(10)+" j");return this};J.output=D;J.save=function(f){J.output("save",f)};for(ba in c.API)c.API.hasOwnProperty(ba)&&("events"===ba&&
c.API.events.length?function(f,c){var g,D,h;for(h=c.length-1;-1!==h;h--)g=c[h][0],D=c[h][1],f.subscribe.apply(f,[g].concat("function"===typeof D?[D]:D))}(X,c.API.events):J[ba]=c.API[ba]);(function(){var f=[["Helvetica","helvetica","normal"],["Helvetica-Bold","helvetica","bold"],["Helvetica-Oblique","helvetica","italic"],["Helvetica-BoldOblique","helvetica","bolditalic"],["Courier","courier","normal"],["Courier-Bold","courier","bold"],["Courier-Oblique","courier","italic"],["Courier-BoldOblique","courier",
"bolditalic"],["Times-Roman","times","normal"],["Times-Bold","times","bold"],["Times-Italic","times","italic"],["Times-BoldItalic","times","bolditalic"]],c,D,h,k;c=0;for(D=f.length;c<D;c++){var j=f[c][0],N=f[c][1];h=f[c][2];k="F"+(g(E)+1).toString(10);var j=E[k]={id:k,PostScriptName:j,fontName:N,fontStyle:h,encoding:"StandardEncoding",metadata:{}},l=k;void 0===z[N]&&(z[N]={});z[N][h]=l;X.publish("addFont",j);h=k;k=f[c][0].split("-");j=k[0];k=k[1]||"";void 0===z[j]&&(z[j]={});z[j][k]=h}X.publish("addFonts",
{fonts:E,dictionary:z})})();y="F1";ca();X.publish("initialized");return J}"undefined"===typeof btoa&&(window.btoa=function(c){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),h,n,l,o,q=0,r=0,t="",t=[];do h=c.charCodeAt(q++),n=c.charCodeAt(q++),l=c.charCodeAt(q++),o=h<<16|n<<8|l,h=o>>18&63,n=o>>12&63,l=o>>6&63,o&=63,t[r++]=g[h]+g[n]+g[l]+g[o];while(q<c.length);t=t.join("");c=c.length%3;return(c?t.slice(0,c-3):t)+"===".slice(c||3)});"undefined"===typeof atob&&(window.atob=
function(c){var g,h,n,l,o,q=0,r=0;l="";var t=[];if(!c)return c;c=c+"";do{g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(q++));h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(q++));l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(q++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(q++));n=g<<18|h<<12|l<<6|o;g=n>>16&255;h=n>>8&255;n=n&255;l===
64?t[r++]=String.fromCharCode(g):o===64?t[r++]=String.fromCharCode(g,h):t[r++]=String.fromCharCode(g,h,n)}while(q<c.length);return l=t.join("")});var g="function"===typeof Object.keys?function(c){return Object.keys(c).length}:function(c){var g=0,h;for(h in c)c.hasOwnProperty(h)&&g++;return g},h=function(c){this.topics={};this.context=c;this.publish=function(c,g){if(this.topics[c]){var h=this.topics[c],j=[],o,q,r,t,w=function(){},g=Array.prototype.slice.call(arguments,1);q=0;for(r=h.length;q<r;q++){t=
h[q];o=t[0];if(t[1]){t[0]=w;j.push(q)}o.apply(this.context,g)}q=0;for(r=j.length;q<r;q++)h.splice(j[q],1)}};this.subscribe=function(c,g,h){this.topics[c]?this.topics[c].push([g,h]):this.topics[c]=[[g,h]];return{topic:c,callback:g}};this.unsubscribe=function(c){if(this.topics[c.topic]){var g=this.topics[c.topic],h,j;h=0;for(j=g.length;h<j;h++)g[h][0]===c.callback&&g.splice(h,1)}}};c.API={events:[]};return c}(),Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){for(var g=
"",h,j,k,m,n,l,o=0,c=Base64._utf8_encode(c);o<c.length;)h=c.charCodeAt(o++),j=c.charCodeAt(o++),k=c.charCodeAt(o++),m=h>>2,h=(h&3)<<4|j>>4,n=(j&15)<<2|k>>6,l=k&63,isNaN(j)?n=l=64:isNaN(k)&&(l=64),g=g+this._keyStr.charAt(m)+this._keyStr.charAt(h)+this._keyStr.charAt(n)+this._keyStr.charAt(l);return g},decode:function(c){for(var g="",h,j,k,m,n,l=0,c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<c.length;)h=this._keyStr.indexOf(c.charAt(l++)),j=this._keyStr.indexOf(c.charAt(l++)),m=this._keyStr.indexOf(c.charAt(l++)),
n=this._keyStr.indexOf(c.charAt(l++)),h=h<<2|j>>4,j=(j&15)<<4|m>>2,k=(m&3)<<6|n,g+=String.fromCharCode(h),64!=m&&(g+=String.fromCharCode(j)),64!=n&&(g+=String.fromCharCode(k));return g=Base64._utf8_decode(g)},_utf8_encode:function(c){for(var c=c.replace(/\r\n/g,"\n"),g="",h=0;h<c.length;h++){var j=c.charCodeAt(h);128>j?g+=String.fromCharCode(j):(127<j&&2048>j?g+=String.fromCharCode(j>>6|192):(g+=String.fromCharCode(j>>12|224),g+=String.fromCharCode(j>>6&63|128)),g+=String.fromCharCode(j&63|128))}return g},
_utf8_decode:function(c){for(var g="",h=0,j=c1=c2=0;h<c.length;)j=c.charCodeAt(h),128>j?(g+=String.fromCharCode(j),h++):191<j&&224>j?(c2=c.charCodeAt(h+1),g+=String.fromCharCode((j&31)<<6|c2&63),h+=2):(c2=c.charCodeAt(h+1),c3=c.charCodeAt(h+2),g+=String.fromCharCode((j&15)<<12|(c2&63)<<6|c3&63),h+=3);return g}},sprintf=function(){var c=arguments,g=0,h=function(c,g,h,k){h||(h=" ");g=c.length>=g?"":Array(1+g-c.length>>>0).join(h);return k?c+g:g+c},j=function(c,g,k,j,q,r){var t=j-c.length;0<t&&(c=k||
!q?h(c,j,r,k):c.slice(0,g.length)+h("",t,"0",!0)+c.slice(g.length));return c},k=function(c,g,k,o,q,r,t){c>>>=0;k=k&&c&&{2:"0b",8:"0",16:"0x"}[g]||"";c=k+h(c.toString(g),r||0,"0",!1);return j(c,k,o,q,t)};return c[g++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,function(m,n,l,o,q,r,t){var w,v;if("%%"==m)return"%";var A=!1;v="";var F=q=!1;w=" ";for(var H=l.length,u=0;l&&u<H;u++)switch(l.charAt(u)){case " ":v=" ";break;case "+":v="+";break;case "-":A=!0;
break;case "'":w=l.charAt(u+1);break;case "0":q=!0;break;case "#":F=!0}o=o?"*"==o?+c[g++]:"*"==o.charAt(0)?+c[o.slice(1,-1)]:+o:0;0>o&&(o=-o,A=!0);if(!isFinite(o))throw Error("sprintf: (minimum-)width must be finite");r=r?"*"==r?+c[g++]:"*"==r.charAt(0)?+c[r.slice(1,-1)]:+r:-1<"fFeE".indexOf(t)?6:"d"==t?0:void 0;n=n?c[n.slice(0,-1)]:c[g++];switch(t){case "s":return t=""+n,null!=r&&(t=t.slice(0,r)),j(t,"",A,o,q,w);case "c":return t=String.fromCharCode(+n),null!=r&&(t=t.slice(0,r)),j(t,"",A,o,q,void 0);
case "b":return k(n,2,F,A,o,r,q);case "o":return k(n,8,F,A,o,r,q);case "x":return k(n,16,F,A,o,r,q);case "X":return k(n,16,F,A,o,r,q).toUpperCase();case "u":return k(n,10,F,A,o,r,q);case "i":case "d":return w=parseInt(+n),m=0>w?"-":v,n=m+h(""+Math.abs(w),r,"0",!1),j(n,m,A,o,q);case "e":case "E":case "f":case "F":case "g":case "G":return w=+n,m=0>w?"-":v,v=["toExponential","toFixed","toPrecision"]["efg".indexOf(t.toLowerCase())],t=["toString","toUpperCase"]["eEfFgG".indexOf(t)%2],n=m+Math.abs(w)[v](r),
j(n,m,A,o,q)[t]();default:return m}})};(function(c){var g=function(){var c=this.internal.collections.addImage_images,g;for(g in c){var h=c[g],n=this.internal.newObject(),l=this.internal.write,o=this.internal.putStream;h.n=n;l("<</Type /XObject");l("/Subtype /Image");l("/Width "+h.w);l("/Height "+h.h);"Indexed"===h.cs?l("/ColorSpace [/Indexed /DeviceRGB "+(h.pal.length/3-1)+" "+(n+1)+" 0 R]"):(l("/ColorSpace /"+h.cs),"DeviceCMYK"===h.cs&&l("/Decode [1 0 1 0 1 0 1 0]"));l("/BitsPerComponent "+h.bpc);
"f"in h&&l("/Filter /"+h.f);"dp"in h&&l("/DecodeParms <<"+h.dp+">>");if("trns"in h&&h.trns.constructor==Array)for(var q="",r=0;r<h.trns.length;r++)q+=h[q][r]+" "+h.trns[r]+" ",l("/Mask ["+q+"]");"smask"in h&&l("/SMask "+(n+1)+" 0 R");l("/Length "+h.data.length+">>");o(h.data);l("endobj")}},h=function(){var c=this.internal.collections.addImage_images,g=this.internal.write,h,n;for(n in c)h=c[n],g("/I"+h.i,h.n,"0","R")};c.addImage=function(c,k,m,n,l,o){if("object"===typeof c&&1===c.nodeType){k=document.createElement("canvas");
k.width=c.clientWidth;k.height=c.clientHeight;var q=k.getContext("2d");if(!q)throw"addImage requires canvas to be supported by browser.";q.drawImage(c,0,0,k.width,k.height);c=k.toDataURL("image/jpeg");k="JPEG"}if("JPEG"!==k.toUpperCase())throw Error("addImage currently only supports format 'JPEG', not '"+k+"'");var r,k=this.internal.collections.addImage_images,q=this.internal.getCoordinateString,t=this.internal.getVerticalCoordinateString;"data:image/jpeg;base64,"===c.substring(0,23)&&(c=atob(c.replace("data:image/jpeg;base64,",
"")));if(k)if(Object.keys)r=Object.keys(k).length;else{var w=k,v=0;for(r in w)w.hasOwnProperty(r)&&v++;r=v}else r=0,this.internal.collections.addImage_images=k={},this.internal.events.subscribe("putResources",g),this.internal.events.subscribe("putXobjectDict",h);a:{var w=c,A;if(255===!w.charCodeAt(0)||216===!w.charCodeAt(1)||255===!w.charCodeAt(2)||224===!w.charCodeAt(3)||74===!w.charCodeAt(6)||70===!w.charCodeAt(7)||73===!w.charCodeAt(8)||70===!w.charCodeAt(9)||0===!w.charCodeAt(10))throw Error("getJpegSize requires a binary jpeg file");
A=256*w.charCodeAt(4)+w.charCodeAt(5);for(var v=4,F=w.length;v<F;){v+=A;if(255!==w.charCodeAt(v))throw Error("getJpegSize could not find the size of the image");if(192===w.charCodeAt(v+1)){A=256*w.charCodeAt(v+5)+w.charCodeAt(v+6);w=256*w.charCodeAt(v+7)+w.charCodeAt(v+8);w=[w,A];break a}v+=2;A=256*w.charCodeAt(v)+w.charCodeAt(v+1)}w=void 0}c={w:w[0],h:w[1],cs:"DeviceRGB",bpc:8,f:"DCTDecode",i:r,data:c};k[r]=c;!l&&!o&&(o=l=-96);0>l&&(l=-72*c.w/l/this.internal.scaleFactor);0>o&&(o=-72*c.h/o/this.internal.scaleFactor);
0===l&&(l=o*c.w/c.h);0===o&&(o=l*c.h/c.w);this.internal.write("q",q(l),"0 0",q(o),q(m),t(n+o),"cm /I"+c.i,"Do Q");return this}})(jsPDF.API)}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion())(function(c){var g=function(c){for(var g={},h=0;16>h;h++)g["klmnopqrstuvwxyz"[h]]="0123456789abcdef"[h];for(var k={},j=1,r,t=k,w=[],v,A="",F="",H,u=c.length-1,h=1;h!=u;)v=c[h],h+=1,"'"==v?r?(H=r.join(""),r=void 0):r=[]:r?r.push(v):"{"==v?(w.push([t,H]),t={},H=void 0):"}"==v?(v=w.pop(),v[0][v[1]]=t,H=void 0,t=v[0]):"-"==v?j=-1:void 0===H?g.hasOwnProperty(v)?(A+=g[v],H=parseInt(A,16)*j,j=1,A=""):A+=v:g.hasOwnProperty(v)?(F+=g[v],t[H]=parseInt(F,
16)*j,j=1,H=void 0,F=""):F+=v;return k},h={codePages:["WinAnsiEncoding"],WinAnsiEncoding:g("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},j={Unicode:{Courier:h,"Courier-Bold":h,"Courier-BoldOblique":h,"Courier-Oblique":h,Helvetica:h,"Helvetica-Bold":h,"Helvetica-BoldOblique":h,"Helvetica-Oblique":h,"Times-Roman":h,"Times-Bold":h,"Times-BoldItalic":h,"Times-Italic":h}},k={Unicode:{"Courier-Oblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),
"Times-BoldItalic":g("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),
"Helvetica-Bold":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),
Courier:g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":g("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),
Helvetica:g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),
"Helvetica-BoldOblique":g("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),
"Courier-Bold":g("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":g("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),
"Times-Roman":g("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),
"Helvetica-Oblique":g("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};
c.events.push(["addFonts",function(c){var g,h,o,q;for(h in c.fonts)if(c.fonts.hasOwnProperty(h)){g=c.fonts[h];if(o=k.Unicode[g.PostScriptName])q=g.metadata.Unicode?g.metadata.Unicode:g.metadata.Unicode={},q.widths=o.widths,q.kerning=o.kerning;if(o=j.Unicode[g.PostScriptName])q=g.metadata.Unicode?g.metadata.Unicode:g.metadata.Unicode={},q.encoding=o,o.codePages&&o.codePages.length&&(g.encoding=o.codePages[0])}}])})(jsPDF.API),function(c){var g=c.getCharWidthsArray=function(c,g){g||(g={});var h=g.widths?
g.widths:this.internal.getFont().metadata.Unicode.widths,j=h.fof?h.fof:1,o=g.kerning?g.kerning:this.internal.getFont().metadata.Unicode.kerning,q=o.fof?o.fof:1,r,t,w,v=0,A=h[0]||j,F=[];r=0;for(t=c.length;r<t;r++)w=c.charCodeAt(r),F.push((h[w]||A)/j+(o[w]&&o[w][v]||0)/q),v=w;return F},h=function(c){for(var g=c.length,h=0;g;)g--,h+=c[g];return h};c.getStringUnitWidth=function(c,j){return h(g.call(this,c,j))};var j=function(c,j,n){n||(n={});var l=g(" ",n)[0],o=c.split(" "),q=[],c=[q],r=n.textIndent||
0,t=0,w=0,v,A,F,H;F=0;for(H=o.length;F<H;F++){v=o[F];A=g(v,n);w=h(A);if(r+t+w>j){if(w>j){for(var w=v,u=A,B=j,E=[],z=0,x=w.length,y=0;z!==x&&y+u[z]<j-(r+t);)y+=u[z],z++;E.push(w.slice(0,z));r=z;for(y=0;z!==x;)y+u[z]>B&&(E.push(w.slice(r,z)),y=0,r=z),y+=u[z],z++;r!==z&&E.push(w.slice(r,z));r=E;q.push(r.shift());for(q=[r.pop()];r.length;)c.push([r.shift()]);w=h(A.slice(v.length-q[0].length))}else q=[v];c.push(q);r=w}else q.push(v),r+=t+w;t=l}j=[];F=0;for(H=c.length;F<H;F++)j.push(c[F].join(" "));return j};
c.splitTextToSize=function(c,g,h){h||(h={});var l=h.fontSize||this.internal.getFontSize(),o;var q=h;o={"0":1};var r={};!q.widths||!q.kerning?(q=this.internal.getFont(q.fontName,q.fontStyle),o=q.metadata.Unicode?{widths:q.metadata.Unicode.widths||o,kerning:q.metadata.Unicode.kerning||r}:{widths:o,kerning:r}):o={widths:q.widths,kerning:q.kerning};c=c.match(/[\n\r]/)?c.split(/\r\n|\r|\n/g):[c];g=1*this.internal.scaleFactor*g/l;o.textIndent=h.textIndent?1*h.textIndent*this.internal.scaleFactor/l:0;r=
[];h=0;for(l=c.length;h<l;h++)r=r.concat(j(c[h],g,o));return r}}(jsPDF.API),function(c){c.addSVG=function(c,h,j,k,m){function n(c){for(var g=parseFloat(c[1]),h=parseFloat(c[2]),k=[],j=3,l=c.length;j<l;)"c"===c[j]?(k.push([parseFloat(c[j+1]),parseFloat(c[j+2]),parseFloat(c[j+3]),parseFloat(c[j+4]),parseFloat(c[j+5]),parseFloat(c[j+6])]),j+=7):"l"===c[j]?(k.push([parseFloat(c[j+1]),parseFloat(c[j+2])]),j+=3):j+=1;return[g,h,k]}if(void 0===h||void 0===h)throw Error("addSVG needs values for 'x' and 'y'");
var l=function(c){var g=c.createElement("iframe"),h=c.createElement("style");h.type="text/css";h.styleSheet?h.styleSheet.cssText=".jsPDF_sillysvg_iframe {display:none;position:absolute;}":h.appendChild(c.createTextNode(".jsPDF_sillysvg_iframe {display:none;position:absolute;}"));c.getElementsByTagName("head")[0].appendChild(h);g.name="childframe";g.setAttribute("width",0);g.setAttribute("height",0);g.setAttribute("frameborder","0");g.setAttribute("scrolling","no");g.setAttribute("seamless","seamless");
g.setAttribute("class","jsPDF_sillysvg_iframe");c.body.appendChild(g);return g}(document),l=function(c,g){var h=(g.contentWindow||g.contentDocument).document;h.write(c);h.close();return h.getElementsByTagName("svg")[0]}(c,l),c=[1,1],o=parseFloat(l.getAttribute("width")),q=parseFloat(l.getAttribute("height"));o&&q&&(k&&m?c=[k/o,m/q]:k?c=[k/o,k/o]:m&&(c=[m/q,m/q]));l=l.childNodes;k=0;for(m=l.length;k<m;k++)o=l[k],o.tagName&&"PATH"===o.tagName.toUpperCase()&&(o=n(o.getAttribute("d").split(" ")),o[0]=
o[0]*c[0]+h,o[1]=o[1]*c[1]+j,this.lines.call(this,o[2],o[0],o[1],c));return this}}(jsPDF.API);
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){(function(c){c.output=function(c,h){return this.internal.output(c,h)}})(jsPDF.API);var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(c){var g=c.document,h=c.URL||c.webkitURL||c,j=g.createElementNS("http://www.w3.org/1999/xhtml","a"),k="download"in j,m=function(h){var k=g.createEvent("MouseEvents");k.initMouseEvent("click",!0,!1,c,0,0,0,0,0,!1,!1,!1,!1,0,null);return h.dispatchEvent(k)},n=c.webkitRequestFileSystem,
l=c.requestFileSystem||n||c.mozRequestFileSystem,o=function(g){(c.setImmediate||c.setTimeout)(function(){throw g;},0)},q=0,r=[],t=function(c,g,h){for(var g=[].concat(g),k=g.length;k--;){var j=c["on"+g[k]];if("function"===typeof j)try{j.call(c,h||c)}catch(l){o(l)}}},w=function(g,h){var o=this,u=g.type,v=!1,w,z,x=function(){var h=(c.URL||c.webkitURL||c).createObjectURL(g);r.push(h);return h},y=function(){t(o,["writestart","progress","write","writeend"])},C=function(){if(v||!w)w=x(g);z&&(z.location.href=
w);o.readyState=o.DONE;y()},I=function(c){return function(){if(o.readyState!==o.DONE)return c.apply(this,arguments)}},K={create:!0,exclusive:!1},W;o.readyState=o.INIT;h||(h="download");if(k&&(w=x(g),j.href=w,j.download=h,m(j))){o.readyState=o.DONE;y();return}c.chrome&&(u&&"application/octet-stream"!==u)&&(W=g.slice||g.webkitSlice,g=W.call(g,0,g.size,"application/octet-stream"),v=!0);n&&"download"!==h&&(h+=".download");if("application/octet-stream"===u||n)z=c;l?(q+=g.size,l(c.TEMPORARY,q,I(function(c){c.root.getDirectory("saved",
K,I(function(c){var k=function(){c.getFile(h,K,I(function(c){c.createWriter(I(function(h){h.onwriteend=function(g){z.location.href=c.toURL();r.push(c);o.readyState=o.DONE;t(o,"writeend",g)};h.onerror=function(){var c=h.error;c.code!==c.ABORT_ERR&&C()};["writestart","progress","write","abort"].forEach(function(c){h["on"+c]=o["on"+c]});h.write(g);o.abort=function(){h.abort();o.readyState=o.DONE};o.readyState=o.WRITING}),C)}),C)};c.getFile(h,{create:false},I(function(c){c.remove();k()}),I(function(c){c.code===
c.NOT_FOUND_ERR?k():C()}))}),C)}),C)):C()},v=w.prototype;v.abort=function(){this.readyState=this.DONE;t(this,"abort")};v.readyState=v.INIT=0;v.WRITING=1;v.DONE=2;v.error=v.onwritestart=v.onprogress=v.onwrite=v.onabort=v.onerror=v.onwriteend=null;c.addEventListener("unload",function(){for(var c=r.length;c--;){var g=r[c];"string"===typeof g?h.revokeObjectURL(g):g.remove()}r.length=0},!1);return function(c,g){return new w(c,g)}}(self),MAX_BITS=15,D_CODES=30,BL_CODES=19,LENGTH_CODES=29,LITERALS=256,L_CODES=
LITERALS+1+LENGTH_CODES,HEAP_SIZE=2*L_CODES+1,END_BLOCK=256,MAX_BL_BITS=7,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,Buf_size=16,Z_DEFAULT_COMPRESSION=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_DEFAULT_STRATEGY=0,Z_NO_FLUSH=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH=4,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,_dist_code=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,
11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,
28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],Tree=function(){var c=this;c.build_tree=function(g){var h=c.dyn_tree,j=c.stat_desc.static_tree,k=c.stat_desc.elems,m,n=-1,l;g.heap_len=0;g.heap_max=HEAP_SIZE;
for(m=0;m<k;m++)0!==h[2*m]?(g.heap[++g.heap_len]=n=m,g.depth[m]=0):h[2*m+1]=0;for(;2>g.heap_len;)l=g.heap[++g.heap_len]=2>n?++n:0,h[2*l]=1,g.depth[l]=0,g.opt_len--,j&&(g.static_len-=j[2*l+1]);c.max_code=n;for(m=Math.floor(g.heap_len/2);1<=m;m--)g.pqdownheap(h,m);l=k;do m=g.heap[1],g.heap[1]=g.heap[g.heap_len--],g.pqdownheap(h,1),j=g.heap[1],g.heap[--g.heap_max]=m,g.heap[--g.heap_max]=j,h[2*l]=h[2*m]+h[2*j],g.depth[l]=Math.max(g.depth[m],g.depth[j])+1,h[2*m+1]=h[2*j+1]=l,g.heap[1]=l++,g.pqdownheap(h,
1);while(2<=g.heap_len);g.heap[--g.heap_max]=g.heap[1];m=c.dyn_tree;for(var n=c.stat_desc.static_tree,o=c.stat_desc.extra_bits,q=c.stat_desc.extra_base,r=c.stat_desc.max_length,t,w,v=0,k=0;k<=MAX_BITS;k++)g.bl_count[k]=0;m[2*g.heap[g.heap_max]+1]=0;for(l=g.heap_max+1;l<HEAP_SIZE;l++)if(j=g.heap[l],k=m[2*m[2*j+1]+1]+1,k>r&&(k=r,v++),m[2*j+1]=k,!(j>c.max_code))g.bl_count[k]++,t=0,j>=q&&(t=o[j-q]),w=m[2*j],g.opt_len+=w*(k+t),n&&(g.static_len+=w*(n[2*j+1]+t));if(0!==v){do{for(k=r-1;0===g.bl_count[k];)k--;
g.bl_count[k]--;g.bl_count[k+1]+=2;g.bl_count[r]--;v-=2}while(0<v);for(k=r;0!==k;k--)for(j=g.bl_count[k];0!==j;)n=g.heap[--l],n>c.max_code||(m[2*n+1]!=k&&(g.opt_len+=(k-m[2*n+1])*m[2*n],m[2*n+1]=k),j--)}m=c.max_code;l=g.bl_count;g=[];j=0;for(k=1;k<=MAX_BITS;k++)g[k]=j=j+l[k-1]<<1;for(l=0;l<=m;l++)if(o=h[2*l+1],0!==o){j=h;k=2*l;n=g[o]++;q=0;do q|=n&1,n>>>=1,q<<=1;while(0<--o);j[k]=q>>>1}}};Tree._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,
16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,
26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28];Tree.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0];Tree.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576];Tree.d_code=function(c){return 256>c?_dist_code[c]:_dist_code[256+(c>>>7)]};Tree.extra_lbits=[0,0,0,0,0,0,
0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];Tree.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];Tree.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];Tree.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var StaticTree=function(c,g,h,j,k){this.static_tree=c;this.extra_bits=g;this.extra_base=h;this.elems=j;this.max_length=k};StaticTree.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,
66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,
57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,
9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,
8,99,8,227,8];StaticTree.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5];StaticTree.static_l_desc=new StaticTree(StaticTree.static_ltree,Tree.extra_lbits,LITERALS+1,L_CODES,MAX_BITS);StaticTree.static_d_desc=new StaticTree(StaticTree.static_dtree,Tree.extra_dbits,0,D_CODES,MAX_BITS);StaticTree.static_bl_desc=new StaticTree(null,Tree.extra_blbits,0,BL_CODES,MAX_BL_BITS);var MAX_MEM_LEVEL=9,DEF_MEM_LEVEL=
8,Config=function(c,g,h,j,k){this.good_length=c;this.max_lazy=g;this.nice_length=h;this.max_chain=j;this.func=k},STORED=0,FAST=1,SLOW=2,config_table=[new Config(0,0,0,0,STORED),new Config(4,4,8,4,FAST),new Config(4,5,16,8,FAST),new Config(4,6,32,32,FAST),new Config(4,4,16,16,SLOW),new Config(8,16,32,32,SLOW),new Config(8,16,128,128,SLOW),new Config(8,32,128,256,SLOW),new Config(32,128,258,1024,SLOW),new Config(32,258,258,4096,SLOW)],z_errmsg="need dictionary;stream end;;;stream error;data error;;buffer error;;".split(";"),
NeedMore=0,BlockDone=1,FinishStarted=2,FinishDone=3,PRESET_DICT=32,INIT_STATE=42,BUSY_STATE=113,FINISH_STATE=666,Z_DEFLATED=8,STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,smaller=function(c,g,h,j){var k=c[2*g],c=c[2*h];return k<c||k==c&&j[g]<=j[h]},Deflate=function(){function c(){var f;for(f=0;f<L_CODES;f++)R[2*f]=0;for(f=0;f<D_CODES;f++)Y[2*f]=0;for(f=0;f<BL_CODES;f++)da[2*f]=0;R[2*END_BLOCK]=1;ka=la=u.opt_len=u.static_len=0}function g(f,
c){var g,D=-1,h,k=f[1],j=0,M=7,N=4;0===k&&(M=138,N=3);f[2*(c+1)+1]=65535;for(g=0;g<=c;g++)if(h=k,k=f[2*(g+1)+1],!(++j<M&&h==k))(j<N?da[2*h]+=j:0!==h?(h!=D&&da[2*h]++,da[2*REP_3_6]++):10>=j?da[2*REPZ_3_10]++:da[2*REPZ_11_138]++,j=0,D=h,0===k)?(M=138,N=3):h==k?(M=6,N=3):(M=7,N=4)}function h(f){u.pending_buf[u.pending++]=f}function j(f){h(f&255);h(f>>>8&255)}function k(f,c){ga>Buf_size-c?(ja|=f<<ga&65535,j(ja),ja=f>>>Buf_size-ga,ga+=c-Buf_size):(ja|=f<<ga&65535,ga+=c)}function m(f,c){var g=2*f;k(c[g]&
65535,c[g+1]&65535)}function n(f,c){var g,D=-1,h,j=f[1],M=0,N=7,l=4;0===j&&(N=138,l=3);for(g=0;g<=c;g++)if(h=j,j=f[2*(g+1)+1],!(++M<N&&h==j)){if(M<l){do m(h,da);while(0!==--M)}else 0!==h?(h!=D&&(m(h,da),M--),m(REP_3_6,da),k(M-3,2)):10>=M?(m(REPZ_3_10,da),k(M-3,3)):(m(REPZ_11_138,da),k(M-11,7));M=0;D=h;0===j?(N=138,l=3):h==j?(N=6,l=3):(N=7,l=4)}}function l(){16==ga?(j(ja),ga=ja=0):8<=ga&&(h(ja&255),ja>>>=8,ga-=8)}function o(f,c){var g,D,h;u.pending_buf[ra+2*ka]=f>>>8&255;u.pending_buf[ra+2*ka+1]=f&
255;u.pending_buf[ta+ka]=c&255;ka++;0===f?R[2*c]++:(la++,f--,R[2*(Tree._length_code[c]+LITERALS+1)]++,Y[2*Tree.d_code(f)]++);if(0===(ka&8191)&&2<fa){g=8*ka;D=Q-G;for(h=0;h<D_CODES;h++)g+=Y[2*h]*(5+Tree.extra_dbits[h]);if(la<Math.floor(ka/2)&&g>>>3<Math.floor(D/2))return!0}return ka==qa-1}function q(f,c){var g,D,h=0,j,M;if(0!==ka){do if(g=u.pending_buf[ra+2*h]<<8&65280|u.pending_buf[ra+2*h+1]&255,D=u.pending_buf[ta+h]&255,h++,0===g)m(D,f);else if(j=Tree._length_code[D],m(j+LITERALS+1,f),M=Tree.extra_lbits[j],
0!==M&&(D-=Tree.base_length[j],k(D,M)),g--,j=Tree.d_code(g),m(j,c),M=Tree.extra_dbits[j],0!==M)g-=Tree.base_dist[j],k(g,M);while(h<ka)}m(END_BLOCK,f);ua=f[2*END_BLOCK+1]}function r(){8<ga?j(ja):0<ga&&h(ja&255);ga=ja=0}function t(f,c,g){r();ua=8;g&&(j(c),j(~c));u.pending_buf.set(K.subarray(f,f+c),u.pending);u.pending+=c}function w(f){var D=0<=G?G:-1,h=Q-G,j,M,N=0;if(0<fa){oa.build_tree(u);ea.build_tree(u);g(R,oa.max_code);g(Y,ea.max_code);na.build_tree(u);for(N=BL_CODES-1;3<=N&&0===da[2*Tree.bl_order[N]+
1];N--);u.opt_len+=3*(N+1)+14;j=u.opt_len+3+7>>>3;M=u.static_len+3+7>>>3;M<=j&&(j=M)}else j=M=h+5;if(h+4<=j&&-1!=D)k((STORED_BLOCK<<1)+(f?1:0),3),t(D,h,!0);else if(M==j)k((STATIC_TREES<<1)+(f?1:0),3),q(StaticTree.static_ltree,StaticTree.static_dtree);else{k((DYN_TREES<<1)+(f?1:0),3);D=oa.max_code+1;h=ea.max_code+1;N+=1;k(D-257,5);k(h-1,5);k(N-4,4);for(j=0;j<N;j++)k(da[2*Tree.bl_order[j]+1],3);n(R,D-1);n(Y,h-1);q(R,Y)}c();f&&r();G=Q;B.flush_pending()}function v(){var f,c,g,D;do{D=W-aa-Q;if(0===D&&
0===Q&&0===aa)D=y;else if(-1==D)D--;else if(Q>=y+y-MIN_LOOKAHEAD){K.set(K.subarray(y,y+y),0);P-=y;Q-=y;G-=y;g=f=X;do c=O[--g]&65535,O[g]=c>=y?c-y:0;while(0!==--f);g=f=y;do c=U[--g]&65535,U[g]=c>=y?c-y:0;while(0!==--f);D+=y}if(0===B.avail_in)break;f=B.read_buf(K,Q+aa,D);aa+=f;aa>=MIN_MATCH&&(J=K[Q]&255,J=(J<<L^K[Q+1]&255)&T)}while(aa<MIN_LOOKAHEAD&&0!==B.avail_in)}function A(f){var c=65535,g;for(c>z-5&&(c=z-5);;){if(1>=aa){v();if(0===aa&&f==Z_NO_FLUSH)return NeedMore;if(0===aa)break}Q+=aa;aa=0;g=G+
c;if(0===Q||Q>=g)if(aa=Q-g,Q=g,w(!1),0===B.avail_out)return NeedMore;if(Q-G>=y-MIN_LOOKAHEAD&&(w(!1),0===B.avail_out))return NeedMore}w(f==Z_FINISH);return 0===B.avail_out?f==Z_FINISH?FinishStarted:NeedMore:f==Z_FINISH?FinishDone:BlockDone}function F(f){var c=ha,g=Q,D,h=ca,k=Q>y-MIN_LOOKAHEAD?Q-(y-MIN_LOOKAHEAD):0,j=M,l=I,R=Q+MAX_MATCH,n=K[g+h-1],m=K[g+h];ca>=N&&(c>>=2);j>aa&&(j=aa);do if(D=f,!(K[D+h]!=m||K[D+h-1]!=n||K[D]!=K[g]||K[++D]!=K[g+1])){g+=2;D++;do;while(K[++g]==K[++D]&&K[++g]==K[++D]&&
K[++g]==K[++D]&&K[++g]==K[++D]&&K[++g]==K[++D]&&K[++g]==K[++D]&&K[++g]==K[++D]&&K[++g]==K[++D]&&g<R);D=MAX_MATCH-(R-g);g=R-MAX_MATCH;if(D>h){P=f;h=D;if(D>=j)break;n=K[g+h-1];m=K[g+h]}}while((f=U[f&l]&65535)>k&&0!==--c);return h<=aa?h:aa}function H(c){for(var g=0,h,k;;){if(aa<MIN_LOOKAHEAD){v();if(aa<MIN_LOOKAHEAD&&c==Z_NO_FLUSH)return NeedMore;if(0===aa)break}aa>=MIN_MATCH&&(J=(J<<L^K[Q+(MIN_MATCH-1)]&255)&T,g=O[J]&65535,U[Q&I]=O[J],O[J]=Q);ca=f;S=P;f=MIN_MATCH-1;if(0!==g&&(ca<ia&&(Q-g&65535)<=y-
MIN_LOOKAHEAD)&&(D!=Z_HUFFMAN_ONLY&&(f=F(g)),5>=f&&(D==Z_FILTERED||f==MIN_MATCH&&4096<Q-P)))f=MIN_MATCH-1;if(ca>=MIN_MATCH&&f<=ca){k=Q+aa-MIN_MATCH;h=o(Q-1-S,ca-MIN_MATCH);aa-=ca-1;ca-=2;do++Q<=k&&(J=(J<<L^K[Q+(MIN_MATCH-1)]&255)&T,g=O[J]&65535,U[Q&I]=O[J],O[J]=Q);while(0!==--ca);V=0;f=MIN_MATCH-1;Q++;if(h&&(w(!1),0===B.avail_out))return NeedMore}else if(0!==V){if((h=o(0,K[Q-1]&255))&&w(!1),Q++,aa--,0===B.avail_out)return NeedMore}else V=1,Q++,aa--}0!==V&&(o(0,K[Q-1]&255),V=0);w(c==Z_FINISH);return 0===
B.avail_out?c==Z_FINISH?FinishStarted:NeedMore:c==Z_FINISH?FinishDone:BlockDone}var u=this,B,E,z,x,y,C,I,K,W,U,O,J,X,ba,T,L,G,f,S,V,Q,P,aa,ca,ha,ia,fa,D,N,M,R,Y,da,oa=new Tree,ea=new Tree,na=new Tree;u.depth=[];var ta,qa,ka,ra,la,ua,ja,ga;u.bl_count=[];u.heap=[];R=[];Y=[];da=[];u.pqdownheap=function(f,c){for(var g=u.heap,D=g[c],h=c<<1;h<=u.heap_len;){h<u.heap_len&&smaller(f,g[h+1],g[h],u.depth)&&h++;if(smaller(f,D,g[h],u.depth))break;g[c]=g[h];c=h;h<<=1}g[c]=D};u.deflateInit=function(g,h,k,j,l,n){j||
(j=Z_DEFLATED);l||(l=DEF_MEM_LEVEL);n||(n=Z_DEFAULT_STRATEGY);g.msg=null;h==Z_DEFAULT_COMPRESSION&&(h=6);if(1>l||l>MAX_MEM_LEVEL||j!=Z_DEFLATED||9>k||15<k||0>h||9<h||0>n||n>Z_HUFFMAN_ONLY)return Z_STREAM_ERROR;g.dstate=u;C=k;y=1<<C;I=y-1;ba=l+7;X=1<<ba;T=X-1;L=Math.floor((ba+MIN_MATCH-1)/MIN_MATCH);K=new Uint8Array(2*y);U=[];O=[];qa=1<<l+6;u.pending_buf=new Uint8Array(4*qa);z=4*qa;ra=Math.floor(qa/2);ta=3*qa;fa=h;D=n;g.total_in=g.total_out=0;g.msg=null;u.pending=0;u.pending_out=0;E=BUSY_STATE;x=Z_NO_FLUSH;
oa.dyn_tree=R;oa.stat_desc=StaticTree.static_l_desc;ea.dyn_tree=Y;ea.stat_desc=StaticTree.static_d_desc;na.dyn_tree=da;na.stat_desc=StaticTree.static_bl_desc;ga=ja=0;ua=8;c();W=2*y;for(g=O[X-1]=0;g<X-1;g++)O[g]=0;ia=config_table[fa].max_lazy;N=config_table[fa].good_length;M=config_table[fa].nice_length;ha=config_table[fa].max_chain;aa=G=Q=0;f=ca=MIN_MATCH-1;J=V=0;return Z_OK};u.deflateEnd=function(){if(E!=INIT_STATE&&E!=BUSY_STATE&&E!=FINISH_STATE)return Z_STREAM_ERROR;K=U=O=u.pending_buf=null;u.dstate=
null;return E==BUSY_STATE?Z_DATA_ERROR:Z_OK};u.deflateParams=function(f,c,g){var h=Z_OK;c==Z_DEFAULT_COMPRESSION&&(c=6);if(0>c||9<c||0>g||g>Z_HUFFMAN_ONLY)return Z_STREAM_ERROR;config_table[fa].func!=config_table[c].func&&0!==f.total_in&&(h=f.deflate(Z_PARTIAL_FLUSH));fa!=c&&(fa=c,ia=config_table[fa].max_lazy,N=config_table[fa].good_length,M=config_table[fa].nice_length,ha=config_table[fa].max_chain);D=g;return h};u.deflateSetDictionary=function(f,c,g){var f=g,D=0;if(!c||E!=INIT_STATE)return Z_STREAM_ERROR;
if(f<MIN_MATCH)return Z_OK;f>y-MIN_LOOKAHEAD&&(f=y-MIN_LOOKAHEAD,D=g-f);K.set(c.subarray(D,D+f),0);G=Q=f;J=K[0]&255;J=(J<<L^K[1]&255)&T;for(c=0;c<=f-MIN_MATCH;c++)J=(J<<L^K[c+(MIN_MATCH-1)]&255)&T,U[c&I]=O[J],O[J]=c;return Z_OK};u.deflate=function(c,g){var j,M,N;if(g>Z_FINISH||0>g)return Z_STREAM_ERROR;if(!c.next_out||!c.next_in&&0!==c.avail_in||E==FINISH_STATE&&g!=Z_FINISH)return c.msg=z_errmsg[Z_NEED_DICT-Z_STREAM_ERROR],Z_STREAM_ERROR;if(0===c.avail_out)return c.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],
Z_BUF_ERROR;B=c;j=x;x=g;E==INIT_STATE&&(M=Z_DEFLATED+(C-8<<4)<<8,N=(fa-1&255)>>1,3<N&&(N=3),M|=N<<6,0!==Q&&(M|=PRESET_DICT),E=BUSY_STATE,M+=31-M%31,h(M>>8&255),h(M&255));if(0!==u.pending){if(B.flush_pending(),0===B.avail_out)return x=-1,Z_OK}else if(0===B.avail_in&&g<=j&&g!=Z_FINISH)return B.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(E==FINISH_STATE&&0!==B.avail_in)return c.msg=z_errmsg[Z_NEED_DICT-Z_BUF_ERROR],Z_BUF_ERROR;if(0!==B.avail_in||0!==aa||g!=Z_NO_FLUSH&&E!=FINISH_STATE){j=-1;
switch(config_table[fa].func){case STORED:j=A(g);break;case FAST:a:{for(j=0;;){if(aa<MIN_LOOKAHEAD){v();if(aa<MIN_LOOKAHEAD&&g==Z_NO_FLUSH){j=NeedMore;break a}if(0===aa)break}aa>=MIN_MATCH&&(J=(J<<L^K[Q+(MIN_MATCH-1)]&255)&T,j=O[J]&65535,U[Q&I]=O[J],O[J]=Q);0!==j&&(Q-j&65535)<=y-MIN_LOOKAHEAD&&D!=Z_HUFFMAN_ONLY&&(f=F(j));if(f>=MIN_MATCH)if(M=o(Q-P,f-MIN_MATCH),aa-=f,f<=ia&&aa>=MIN_MATCH){f--;do Q++,J=(J<<L^K[Q+(MIN_MATCH-1)]&255)&T,j=O[J]&65535,U[Q&I]=O[J],O[J]=Q;while(0!==--f);Q++}else Q+=f,f=0,
J=K[Q]&255,J=(J<<L^K[Q+1]&255)&T;else M=o(0,K[Q]&255),aa--,Q++;if(M&&(w(!1),0===B.avail_out)){j=NeedMore;break a}}w(g==Z_FINISH);j=0===B.avail_out?g==Z_FINISH?FinishStarted:NeedMore:g==Z_FINISH?FinishDone:BlockDone}break;case SLOW:j=H(g)}if(j==FinishStarted||j==FinishDone)E=FINISH_STATE;if(j==NeedMore||j==FinishStarted)return 0===B.avail_out&&(x=-1),Z_OK;if(j==BlockDone){if(g==Z_PARTIAL_FLUSH)k(STATIC_TREES<<1,3),m(END_BLOCK,StaticTree.static_ltree),l(),9>1+ua+10-ga&&(k(STATIC_TREES<<1,3),m(END_BLOCK,
StaticTree.static_ltree),l()),ua=7;else if(k((STORED_BLOCK<<1)+0,3),t(0,0,!0),g==Z_FULL_FLUSH)for(j=0;j<X;j++)O[j]=0;B.flush_pending();if(0===B.avail_out)return x=-1,Z_OK}}return g!=Z_FINISH?Z_OK:Z_STREAM_END}},ZStream=function(){this.total_out=this.avail_out=this.total_in=this.avail_in=this.next_out_index=this.next_in_index=0};ZStream.prototype={deflateInit:function(c,g){this.dstate=new Deflate;g||(g=MAX_BITS);return this.dstate.deflateInit(this,c,g)},deflate:function(c){return!this.dstate?Z_STREAM_ERROR:
this.dstate.deflate(this,c)},deflateEnd:function(){if(!this.dstate)return Z_STREAM_ERROR;var c=this.dstate.deflateEnd();this.dstate=null;return c},deflateParams:function(c,g){return!this.dstate?Z_STREAM_ERROR:this.dstate.deflateParams(this,c,g)},deflateSetDictionary:function(c,g){return!this.dstate?Z_STREAM_ERROR:this.dstate.deflateSetDictionary(this,c,g)},read_buf:function(c,g,h){var j=this.avail_in;j>h&&(j=h);if(0===j)return 0;this.avail_in-=j;c.set(this.next_in.subarray(this.next_in_index,this.next_in_index+
j),g);this.next_in_index+=j;this.total_in+=j;return j},flush_pending:function(){var c=this.dstate.pending;c>this.avail_out&&(c=this.avail_out);0!==c&&(this.next_out.set(this.dstate.pending_buf.subarray(this.dstate.pending_out,this.dstate.pending_out+c),this.next_out_index),this.next_out_index+=c,this.dstate.pending_out+=c,this.total_out+=c,this.avail_out-=c,this.dstate.pending-=c,0===this.dstate.pending&&(this.dstate.pending_out=0))}};var Deflater=function(c){var g=new ZStream,h=Z_NO_FLUSH,j=new Uint8Array(512);
"undefined"==typeof c&&(c=Z_DEFAULT_COMPRESSION);g.deflateInit(c);g.next_out=j;this.append=function(c,m){var n,l=[],o=0,q=0,r=0,t;if(c.length){g.next_in_index=0;g.next_in=c;g.avail_in=c.length;do{g.next_out_index=0;g.avail_out=512;n=g.deflate(h);if(n!=Z_OK)throw"deflating: "+g.msg;g.next_out_index&&(512==g.next_out_index?l.push(new Uint8Array(j)):l.push(new Uint8Array(j.subarray(0,g.next_out_index))));r+=g.next_out_index;m&&(0<g.next_in_index&&g.next_in_index!=o)&&(m(g.next_in_index),o=g.next_in_index)}while(0<
g.avail_in||0===g.avail_out);t=new Uint8Array(r);l.forEach(function(c){t.set(c,q);q+=c.length});return t}};this.flush=function(){var c,h=[],n=0,l=0,o;do{g.next_out_index=0;g.avail_out=512;c=g.deflate(Z_FINISH);if(c!=Z_STREAM_END&&c!=Z_OK)throw"deflating: "+g.msg;0<512-g.avail_out&&h.push(new Uint8Array(j.subarray(0,g.next_out_index)));l+=g.next_out_index}while(0<g.avail_in||0===g.avail_out);g.deflateEnd();o=new Uint8Array(l);h.forEach(function(c){o.set(c,n);n+=c.length});return o}},fVoid=function(c,
g){"object"===typeof module?module.exports=g():"function"===typeof define?define(g):c.adler32cs=g()}(this,function(){var c="function"===typeof ArrayBuffer&&"function"===typeof Uint8Array,g=null,h=function(){if(!c)return function(){return!1};try{var h=require("buffer");"function"===typeof h.Buffer&&(g=h.Buffer)}catch(k){}return function(c){return c instanceof ArrayBuffer||null!==g&&c instanceof g}}(),j=function(){return null!==g?function(c){return(new g(c,"utf8")).toString("binary")}:function(c){return unescape(encodeURIComponent(c))}}(),
k=function(c,g){for(var h=c&65535,k=c>>>16,j=0,l=g.length;j<l;j++)h=(h+(g.charCodeAt(j)&255))%65521,k=(k+h)%65521;return(k<<16|h)>>>0},m=function(c,g){for(var h=c&65535,k=c>>>16,j=0,l=g.length;j<l;j++)h=(h+g[j])%65521,k=(k+h)%65521;return(k<<16|h)>>>0},n={},l=n.Adler32=function(){var g=function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(!isFinite(c=null==c?1:+c))throw Error("First arguments needs to be a finite number.");this.checksum=c>>>0},n=
g.prototype={};n.constructor=g;g.from=function(c){c.prototype=n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(null==c)throw Error("First argument needs to be a string.");this.checksum=k(1,c.toString())});g.fromUtf8=function(c){c.prototype=n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(null==c)throw Error("First argument needs to be a string.");c=j(c.toString());
this.checksum=k(1,c)});c&&(g.fromBuffer=function(c){c.prototype=n;return c}(function(c){if(!(this instanceof g))throw new TypeError("Constructor cannot called be as a function.");if(!h(c))throw Error("First argument needs to be ArrayBuffer.");c=new Uint8Array(c);return this.checksum=m(1,c)}));n.update=function(c){if(c==null)throw Error("First argument needs to be a string.");c=c.toString();return this.checksum=k(this.checksum,c)};n.updateUtf8=function(c){if(c==null)throw Error("First argument needs to be a string.");
c=j(c.toString());return this.checksum=k(this.checksum,c)};c&&(n.updateBuffer=function(c){if(!h(c))throw Error("First argument needs to be ArrayBuffer.");c=new Uint8Array(c);return this.checksum=m(this.checksum,c)});n.clone=function(){return new l(this.checksum)};return g}();n.from=function(c){if(null==c)throw Error("First argument needs to be a string.");return k(1,c.toString())};n.fromUtf8=function(c){if(null==c)throw Error("First argument needs to be a string.");c=j(c.toString());return k(1,c)};
c&&(n.fromBuffer=function(c){if(!h(c))throw Error("First argument need to be ArrayBuffer.");c=new Uint8Array(c);return m(1,c)});return n}),JSZip=function(c,g){this.files={};this.root="";c&&this.load(c,g)};JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK"};JSZip.defaults={base64:!1,binary:!1,dir:!1,date:null};JSZip.prototype=function(){var c=function(c,g,
h){this.name=c;this.data=g;this.options=h};c.prototype={asText:function(){return this.options.binary?JSZip.prototype.utf8decode(this.data):this.data},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)}};var g=function(c,g){var h="",k;for(k=0;k<g;k++)h+=String.fromCharCode(c&255),c>>>=8;return h},h=function(){var c={},g,h;for(g=0;g<arguments.length;g++)for(h in arguments[g])"undefined"===typeof c[h]&&(c[h]=arguments[g][h]);return c},j=function(c,g,j){var q=
k(c);q&&m.call(this,q);j=j||{};!0===j.base64&&null==j.binary&&(j.binary=!0);j=h(j,JSZip.defaults);j.date=j.date||new Date;return this.files[c]={name:c,data:g,options:j}},k=function(c){"/"==c.slice(-1)&&(c=c.substring(0,c.length-1));var g=c.lastIndexOf("/");return 0<g?c.substring(0,g):""},m=function(c){"/"!=c.slice(-1)&&(c+="/");if(!this.files[c]){var g=k(c);g&&m.call(this,g);j.call(this,c,"",{dir:!0})}return this.files[c]};return{load:function(){throw Error("Load method is not defined. Is the file jszip-load.js included ?");
},filter:function(g){var k=[],j,m,r;for(j in this.files)m=this.files[j],r=new c(m.name,m.data,h(m.options)),m=j.slice(this.root.length,j.length),j.slice(0,this.root.length)===this.root&&g(m,r)&&k.push(r);return k},file:function(c,g,h){if(1===arguments.length){if(c instanceof RegExp){var k=c;return this.filter(function(c,g){return!g.options.dir&&k.test(c)})}return this.filter(function(g,h){return!h.options.dir&&g===c})[0]||null}c=this.root+c;j.call(this,c,g,h);return this},folder:function(c){if(!c)throw Error("folder : wrong argument");
if(c instanceof RegExp)return this.filter(function(g,h){return h.options.dir&&c.test(g)});var g=m.call(this,this.root+c),h=this.clone();h.root=g.name;return h},remove:function(c){var c=this.root+c,g=this.files[c];g||("/"!=c.slice(-1)&&(c+="/"),g=this.files[c]);if(g)if(g.options.dir)for(var g=this.filter(function(g,h){return h.name.slice(0,c.length)===c}),h=0;h<g.length;h++)delete this.files[g[h].name];else delete this.files[c];return this},generate:function(c){var k,j,c=h(c||{},{base64:!0,compression:"STORE"}),
m=c.compression.toUpperCase(),r=[],t=[],w=0;if(!JSZip.compressions[m])throw m+" is not a valid compression method !";for(var v in this.files)if(this.files.hasOwnProperty(v)){var A=this.files[v],F=this.utf8encode(A.name);k=j="";k=F;var H=m;j=k!==A.name;var u=A.data,B=A.options,E=A=void 0,A=B.date.getHours(),A=A<<6,A=A|B.date.getMinutes(),A=A<<5,A=A|B.date.getSeconds()/2,E=B.date.getFullYear()-1980,E=E<<4,E=E|B.date.getMonth()+1,E=E<<5,E=E|B.date.getDate();!0===B.base64&&(u=JSZipBase64.decode(u));!1===
B.binary&&(u=this.utf8encode(u));var B=JSZip.compressions[H],H=B.compress(u),z="",z=z+"\n\x00",z=z+(j?"\x00":"\x00\x00"),z=z+B.magic,z=z+g(A,2),z=z+g(E,2),z=z+g(this.crc32(u),4),z=z+g(H.length,4),z=z+g(u.length,4),z=z+g(k.length,2);k=z+="\x00\x00";j=H;j=JSZip.signature.LOCAL_FILE_HEADER+k+F+j;k=JSZip.signature.CENTRAL_FILE_HEADER+"\x00"+k+"\x00\x00\x00\x00\x00\x00"+(!0===this.files[v].dir?"\x00\x00\x00":"\x00\x00\x00\x00")+g(w,4)+F;w+=j.length;t.push(j);r.push(k)}m=t.join("");r=r.join("");w="";
w=JSZip.signature.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+g(t.length,2)+g(t.length,2)+g(r.length,4)+g(m.length,4)+"\x00\x00";t=m+r+w;return c.base64?JSZipBase64.encode(t):t},crc32:function(c,g){if(""===c||"undefined"===typeof c)return 0;"undefined"==typeof g&&(g=0);for(var h=0,h=0,g=g^-1,k=0,j=c.length;k<j;k++)h=(g^c.charCodeAt(k))&255,h="0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*
h,8),g=g>>>8^h;return g^-1},clone:function(){var c=new JSZip,g;for(g in this)"function"!==typeof this[g]&&(c[g]=this[g]);return c},utf8encode:function(c){for(var c=c.replace(/\r\n/g,"\n"),g="",h=0;h<c.length;h++){var k=c.charCodeAt(h);128>k?g+=String.fromCharCode(k):(127<k&&2048>k?g+=String.fromCharCode(k>>6|192):(g+=String.fromCharCode(k>>12|224),g+=String.fromCharCode(k>>6&63|128)),g+=String.fromCharCode(k&63|128))}return g},utf8decode:function(c){for(var g="",h=0,k=0,j=0,m=0;h<c.length;)k=c.charCodeAt(h),
128>k?(g+=String.fromCharCode(k),h++):191<k&&224>k?(j=c.charCodeAt(h+1),g+=String.fromCharCode((k&31)<<6|j&63),h+=2):(j=c.charCodeAt(h+1),m=c.charCodeAt(h+2),g+=String.fromCharCode((k&15)<<12|(j&63)<<6|m&63),h+=3);return g}}}();JSZip.compressions={STORE:{magic:"\x00\x00",compress:function(c){return c},uncompress:function(c){return c}}};var JSZipBase64=function(){return{encode:function(c){for(var g="",h,j,k,m,n,l,o=0;o<c.length;)h=c.charCodeAt(o++),j=c.charCodeAt(o++),k=c.charCodeAt(o++),m=h>>2,h=
(h&3)<<4|j>>4,n=(j&15)<<2|k>>6,l=k&63,isNaN(j)?n=l=64:isNaN(k)&&(l=64),g=g+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l);return g},decode:function(c){for(var g="",h,j,k,m,n,l=0,c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<c.length;)h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),
j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),h=h<<2|j>>4,j=(j&15)<<4|m>>2,k=(m&3)<<6|n,g+=String.fromCharCode(h),64!=m&&(g+=String.fromCharCode(j)),64!=n&&(g+=String.fromCharCode(k));return g}}}();if(!JSZip)throw"JSZip not defined";(function(){var c,g,h,j,k=null,m,n,
l,o,q,r,t,w,v,A,F,H,u,B,E,z,x,y,C,I,K,W,U,O,J,X,ba,T,L,G,f,S,V,Q,P,aa,ca,ha,ia,fa,D,N,M,R,Y,da,oa,ea,na,ta,qa,ka=function(){this.dl=this.fc=0},ra=function(){this.extra_bits=this.static_tree=this.dyn_tree=null;this.max_code=this.max_length=this.elems=this.extra_base=0},la=function(f,c,g,D){this.good_length=f;this.max_lazy=c;this.nice_length=g;this.max_chain=D},ua=function(){this.next=null;this.len=0;this.ptr=Array(8192);this.off=0},ja=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ga=
[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Oa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Da=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],za=[new la(0,0,0,0),new la(4,4,8,4),new la(4,5,16,8),new la(4,6,32,32),new la(4,4,16,16),new la(8,16,32,32),new la(8,16,128,128),new la(8,32,128,256),new la(32,128,258,1024),new la(32,258,258,4096)],va=function(f){k[n+m++]=f;if(8192==n+m&&0!=m){var D;null!=c?(f=c,c=c.next):f=new ua;f.next=null;f.len=f.off=0;null==g?g=h=f:h=h.next=f;f.len=
m-n;for(D=0;D<f.len;D++)f.ptr[D]=k[n+D];m=n=0}},wa=function(f){f&=65535;8190>n+m?(k[n+m++]=f&255,k[n+m++]=f>>>8):(va(f&255),va(f>>>8))},xa=function(){F=(F<<5^o[x+3-1]&255)&8191;H=t[32768+F];t[x&32767]=H;t[32768+F]=x},sa=function(f,c){ma(c[f].fc,c[f].dl)},Ea=function(f,c,g){return f[c].fc<f[g].fc||f[c].fc==f[g].fc&&ca[c]<=ca[g]},Fa=function(f,c,g){var D;for(D=0;D<g&&qa<ta.length;D++)f[c+D]=ta.charCodeAt(qa++)&255;return D},Ga=function(f){var c=K,g=x,D,h=z,k=32506<x?x-32506:0,j=x+258,M=o[g+h-1],N=o[g+
h];z>=O&&(c>>=2);do if(D=f,!(o[D+h]!=N||o[D+h-1]!=M||o[D]!=o[g]||o[++D]!=o[g+1])){g+=2;D++;do;while(o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&o[++g]==o[++D]&&g<j);D=258-(j-g);g=j-258;if(D>h){y=f;h=D;if(258<=D)break;M=o[g+h-1];N=o[g+h]}}while((f=t[f&32767])>k&&0!=--c);return h},Aa=function(){var f,c,g=65536-I-x;if(-1==g)g--;else if(65274<=x){for(f=0;32768>f;f++)o[f]=o[f+32768];y-=32768;x-=32768;A-=32768;for(f=0;8192>f;f++)c=t[32768+
f],t[32768+f]=32768<=c?c-32768:0;for(f=0;32768>f;f++)c=t[f],t[f]=32768<=c?c-32768:0;g+=32768}C||(f=Fa(o,x+I,g),0>=f?C=!0:I+=f)},Pa=function(c,h,k){var M;if(!j){if(!C){v=w=0;var N,R;if(0==T[0].dl){G.dyn_tree=J;G.static_tree=ba;G.extra_bits=ja;G.extra_base=257;G.elems=286;G.max_length=15;G.max_code=0;f.dyn_tree=X;f.static_tree=T;f.extra_bits=ga;f.extra_base=0;f.elems=30;f.max_length=15;f.max_code=0;S.dyn_tree=L;S.static_tree=null;S.extra_bits=Oa;S.extra_base=0;S.elems=19;S.max_length=7;for(R=N=S.max_code=
0;28>R;R++){fa[R]=N;for(M=0;M<1<<ja[R];M++)ha[N++]=R}ha[N-1]=R;for(R=N=0;16>R;R++){D[R]=N;for(M=0;M<1<<ga[R];M++)ia[N++]=R}for(N>>=7;30>R;R++){D[R]=N<<7;for(M=0;M<1<<ga[R]-7;M++)ia[256+N++]=R}for(M=0;15>=M;M++)V[M]=0;for(M=0;143>=M;)ba[M++].dl=8,V[8]++;for(;255>=M;)ba[M++].dl=9,V[9]++;for(;279>=M;)ba[M++].dl=7,V[7]++;for(;287>=M;)ba[M++].dl=8,V[8]++;Ha(ba,287);for(M=0;30>M;M++)T[M].dl=5,T[M].fc=pa(M,5);Ia()}for(M=0;8192>M;M++)t[32768+M]=0;W=za[U].max_lazy;O=za[U].good_length;K=za[U].max_chain;A=x=
0;I=Fa(o,0,65536);if(0>=I)C=!0,I=0;else{for(C=!1;262>I&&!C;)Aa();for(M=F=0;2>M;M++)F=(F<<5^o[M]&255)&8191}g=null;n=m=0;3>=U?(z=2,E=0):(E=2,B=0);l=!1}j=!0;if(0==I)return l=!0,0}if((M=Ja(c,h,k))==k)return k;if(l)return M;if(3>=U)for(;0!=I&&null==g;){xa();0!=H&&32506>=x-H&&(E=Ga(H),E>I&&(E=I));if(3<=E)if(R=Z(x-y,E-3),I-=E,E<=W){E--;do x++,xa();while(0!=--E);x++}else x+=E,E=0,F=o[x]&255,F=(F<<5^o[x+1]&255)&8191;else R=Z(0,o[x]&255),I--,x++;R&&(ya(0),A=x);for(;262>I&&!C;)Aa()}else for(;0!=I&&null==g;){xa();
z=E;u=y;E=2;0!=H&&(z<W&&32506>=x-H)&&(E=Ga(H),E>I&&(E=I),3==E&&4096<x-y&&E--);if(3<=z&&E<=z){R=Z(x-1-u,z-3);I-=z-1;z-=2;do x++,xa();while(0!=--z);B=0;E=2;x++;R&&(ya(0),A=x)}else 0!=B?Z(0,o[x-1]&255)&&(ya(0),A=x):B=1,x++,I--;for(;262>I&&!C;)Aa()}0==I&&(0!=B&&Z(0,o[x-1]&255),ya(1),l=!0);return M+Ja(c,M+h,k-M)},Ja=function(f,D,h){var j,M,N;for(j=0;null!=g&&j<h;){M=h-j;M>g.len&&(M=g.len);for(N=0;N<M;N++)f[D+j+N]=g.ptr[g.off+N];g.off+=M;g.len-=M;j+=M;0==g.len&&(M=g,g=g.next,M.next=c,c=M)}if(j==h)return j;
if(n<m){M=h-j;M>m-n&&(M=m-n);for(N=0;N<M;N++)f[D+j+N]=k[n+N];n+=M;j+=M;m==n&&(m=n=0)}return j},Ia=function(){var f;for(f=0;286>f;f++)J[f].fc=0;for(f=0;30>f;f++)X[f].fc=0;for(f=0;19>f;f++)L[f].fc=0;J[256].fc=1;da=M=R=Y=ea=na=0;oa=1},Ba=function(f,c){for(var g=Q[c],D=c<<1;D<=P;){D<P&&Ea(f,Q[D+1],Q[D])&&D++;if(Ea(f,g,Q[D]))break;Q[c]=Q[D];c=D;D<<=1}Q[c]=g},Ha=function(f,c){var g=Array(16),D=0,h;for(h=1;15>=h;h++)D=D+V[h-1]<<1,g[h]=D;for(D=0;D<=c;D++)h=f[D].dl,0!=h&&(f[D].fc=pa(g[h]++,h))},Ca=function(f){var c=
f.dyn_tree,g=f.static_tree,D=f.elems,h,k=-1,j=D;P=0;aa=573;for(h=0;h<D;h++)0!=c[h].fc?(Q[++P]=k=h,ca[h]=0):c[h].dl=0;for(;2>P;)h=Q[++P]=2>k?++k:0,c[h].fc=1,ca[h]=0,ea--,null!=g&&(na-=g[h].dl);f.max_code=k;for(h=P>>1;1<=h;h--)Ba(c,h);do h=Q[1],Q[1]=Q[P--],Ba(c,1),g=Q[1],Q[--aa]=h,Q[--aa]=g,c[j].fc=c[h].fc+c[g].fc,ca[j]=ca[h]>ca[g]+1?ca[h]:ca[g]+1,c[h].dl=c[g].dl=j,Q[1]=j++,Ba(c,1);while(2<=P);Q[--aa]=Q[1];j=f.dyn_tree;h=f.extra_bits;var D=f.extra_base,g=f.max_code,M=f.max_length,N=f.static_tree,R,
l,m,n,Y=0;for(l=0;15>=l;l++)V[l]=0;j[Q[aa]].dl=0;for(f=aa+1;573>f;f++)if(R=Q[f],l=j[j[R].dl].dl+1,l>M&&(l=M,Y++),j[R].dl=l,!(R>g))V[l]++,m=0,R>=D&&(m=h[R-D]),n=j[R].fc,ea+=n*(l+m),null!=N&&(na+=n*(N[R].dl+m));if(0!=Y){do{for(l=M-1;0==V[l];)l--;V[l]--;V[l+1]+=2;V[M]--;Y-=2}while(0<Y);for(l=M;0!=l;l--)for(R=V[l];0!=R;)h=Q[--f],h>g||(j[h].dl!=l&&(ea+=(l-j[h].dl)*j[h].fc,j[h].fc=l),R--)}Ha(c,k)},Ka=function(f,c){var g,D=-1,h,k=f[0].dl,j=0,M=7,N=4;0==k&&(M=138,N=3);f[c+1].dl=65535;for(g=0;g<=c;g++)if(h=
k,k=f[g+1].dl,!(++j<M&&h==k))(j<N?L[h].fc+=j:0!=h?(h!=D&&L[h].fc++,L[16].fc++):10>=j?L[17].fc++:L[18].fc++,j=0,D=h,0==k)?(M=138,N=3):h==k?(M=6,N=3):(M=7,N=4)},La=function(f,c){var g,D=-1,h,k=f[0].dl,j=0,M=7,N=4;0==k&&(M=138,N=3);for(g=0;g<=c;g++)if(h=k,k=f[g+1].dl,!(++j<M&&h==k)){if(j<N){do sa(h,L);while(0!=--j)}else 0!=h?(h!=D&&(sa(h,L),j--),sa(16,L),ma(j-3,2)):10>=j?(sa(17,L),ma(j-3,3)):(sa(18,L),ma(j-11,7));j=0;D=h;0==k?(M=138,N=3):h==k?(M=6,N=3):(M=7,N=4)}},ya=function(c){var g,D,h,k;k=x-A;N[Y]=
da;Ca(G);Ca(f);Ka(J,G.max_code);Ka(X,f.max_code);Ca(S);for(h=18;3<=h&&0==L[Da[h]].dl;h--);ea+=3*(h+1)+14;g=ea+3+7>>3;D=na+3+7>>3;D<=g&&(g=D);if(k+4<=g&&0<=A){ma(0+c,3);Ma();wa(k);wa(~k);for(h=0;h<k;h++)va(o[A+h])}else if(D==g)ma(2+c,3),Na(ba,T);else{ma(4+c,3);k=G.max_code+1;g=f.max_code+1;h+=1;ma(k-257,5);ma(g-1,5);ma(h-4,4);for(D=0;D<h;D++)ma(L[Da[D]].dl,3);La(J,k-1);La(X,g-1);Na(J,X)}Ia();0!=c&&Ma()},Z=function(f,c){r[M++]=c;0==f?J[c].fc++:(f--,J[ha[c]+256+1].fc++,X[(256>f?ia[f]:ia[256+(f>>7)])&
255].fc++,q[R++]=f,da|=oa);oa<<=1;0==(M&7)&&(N[Y++]=da,da=0,oa=1);if(2<U&&0==(M&4095)){var g=8*M,D=x-A,h;for(h=0;30>h;h++)g+=X[h].fc*(5+ga[h]);g>>=3;if(R<parseInt(M/2)&&g<parseInt(D/2))return!0}return 8191==M||8192==R},Na=function(f,c){var g,h=0,k=0,j=0,R=0,l,m;if(0!=M){do{0==(h&7)&&(R=N[j++]);g=r[h++]&255;if(0==(R&1))sa(g,f);else if(l=ha[g],sa(l+256+1,f),m=ja[l],0!=m&&(g-=fa[l],ma(g,m)),g=q[k++],l=(256>g?ia[g]:ia[256+(g>>7)])&255,sa(l,c),m=ga[l],0!=m)g-=D[l],ma(g,m);R>>=1}while(h<M)}sa(256,f)},ma=
function(f,c){v>16-c?(w|=f<<v,wa(w),w=f>>16-v,v+=c-16):(w|=f<<v,v+=c)},pa=function(f,c){var g=0;do g|=f&1,f>>=1,g<<=1;while(0<--c);return g>>1},Ma=function(){8<v?wa(w):0<v&&va(w);v=w=0},la=function(M,R){var l,m;ta=M;qa=0;"undefined"==typeof R&&(R=6);(l=R)?1>l?l=1:9<l&&(l=9):l=6;U=l;C=j=!1;if(null==k){c=g=h=null;k=Array(8192);o=Array(65536);q=Array(8192);r=Array(32832);t=Array(65536);J=Array(573);for(l=0;573>l;l++)J[l]=new ka;X=Array(61);for(l=0;61>l;l++)X[l]=new ka;ba=Array(288);for(l=0;288>l;l++)ba[l]=
new ka;T=Array(30);for(l=0;30>l;l++)T[l]=new ka;L=Array(39);for(l=0;39>l;l++)L[l]=new ka;G=new ra;f=new ra;S=new ra;V=Array(16);Q=Array(573);ca=Array(573);ha=Array(256);ia=Array(512);fa=Array(29);D=Array(30);N=Array(1024)}for(var n=Array(1024),Y=[];0<(l=Pa(n,0,n.length));){var da=Array(l);for(m=0;m<l;m++)da[m]=String.fromCharCode(n[m]);Y[Y.length]=da.join("")}ta=null;return Y.join("")};JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.compress=la:JSZip.compressions.DEFLATE={magic:"\x00",compress:la}})();
if(!JSZip)throw"JSZip not defined";(function(){function c(){this.list=this.next=null}function g(){this.n=this.b=this.e=0;this.t=null}function h(f,h,k,j,l,m){this.BMAX=16;this.N_MAX=288;this.status=0;this.root=null;this.m=0;var n=Array(this.BMAX+1),D,N,M,R,Y,o,q,ea=Array(this.BMAX+1),t,u,r,x=new g,v=Array(this.BMAX);R=Array(this.N_MAX);var w,E=Array(this.BMAX+1),y,A,C;C=this.root=null;for(Y=0;Y<n.length;Y++)n[Y]=0;for(Y=0;Y<ea.length;Y++)ea[Y]=0;for(Y=0;Y<v.length;Y++)v[Y]=null;for(Y=0;Y<R.length;Y++)R[Y]=
0;for(Y=0;Y<E.length;Y++)E[Y]=0;D=256<h?f[256]:this.BMAX;t=f;u=0;Y=h;do n[t[u]]++,u++;while(0<--Y);if(n[0]==h)this.root=null,this.status=this.m=0;else{for(o=1;o<=this.BMAX&&0==n[o];o++);q=o;m<o&&(m=o);for(Y=this.BMAX;0!=Y&&0==n[Y];Y--);M=Y;m>Y&&(m=Y);for(y=1<<o;o<Y;o++,y<<=1)if(0>(y-=n[o])){this.status=2;this.m=m;return}if(0>(y-=n[Y]))this.status=2,this.m=m;else{n[Y]+=y;E[1]=o=0;t=n;u=1;for(r=2;0<--Y;)E[r++]=o+=t[u++];t=f;Y=u=0;do if(0!=(o=t[u++]))R[E[o]++]=Y;while(++Y<h);h=E[M];E[0]=Y=0;t=R;u=0;
R=-1;w=ea[0]=0;r=null;for(A=0;q<=M;q++)for(f=n[q];0<f--;){for(;q>w+ea[1+R];){w+=ea[1+R];R++;A=(A=M-w)>m?m:A;if((N=1<<(o=q-w))>f+1){N-=f+1;for(r=q;++o<A&&!((N<<=1)<=n[++r]);)N-=n[r]}w+o>D&&w<D&&(o=D-w);A=1<<o;ea[1+R]=o;r=Array(A);for(N=0;N<A;N++)r[N]=new g;C=null==C?this.root=new c:C.next=new c;C.next=null;C.list=r;v[R]=r;0<R&&(E[R]=Y,x.b=ea[R],x.e=16+o,x.t=r,o=(Y&(1<<w)-1)>>w-ea[R],v[R-1][o].e=x.e,v[R-1][o].b=x.b,v[R-1][o].n=x.n,v[R-1][o].t=x.t)}x.b=q-w;u>=h?x.e=99:t[u]<k?(x.e=256>t[u]?16:15,x.n=
t[u++]):(x.e=l[t[u]-k],x.n=j[t[u++]-k]);N=1<<q-w;for(o=Y>>w;o<A;o+=N)r[o].e=x.e,r[o].b=x.b,r[o].n=x.n,r[o].t=x.t;for(o=1<<q-1;0!=(Y&o);o>>=1)Y^=o;for(Y^=o;(Y&(1<<w)-1)!=E[R];)w-=ea[R],R--}this.m=ea[1];this.status=0!=y&&1!=M?1:0}}}function j(f){for(;x<f;){var c=z,g;g=X.length==ba?-1:X.charCodeAt(ba++)&255;z=c|g<<x;x+=8}}function k(f){return z&T[f]}function m(f){z>>=f;x-=f}function n(f,c,g){var h,l,n;if(0==g)return 0;for(n=0;;){j(O);l=W.list[k(O)];for(h=l.e;16<h;){if(99==h)return-1;m(l.b);h-=16;j(h);
l=l.t[k(h)];h=l.e}m(l.b);if(16==h)H&=t-1,f[c+n++]=F[H++]=l.n;else{if(15==h)break;j(h);I=l.n+k(h);m(h);j(J);l=U.list[k(J)];for(h=l.e;16<h;){if(99==h)return-1;m(l.b);h-=16;j(h);l=l.t[k(h)];h=l.e}m(l.b);j(h);K=H-l.n-k(h);for(m(h);0<I&&n<g;)I--,K&=t-1,H&=t-1,f[c+n++]=F[H++]=F[K++]}if(n==g)return g}y=-1;return n}function l(c,g,l){var o,q,t,r,D,N,M,R=Array(316);for(o=0;o<R.length;o++)R[o]=0;j(5);N=257+k(5);m(5);j(5);M=1+k(5);m(5);j(4);o=4+k(4);m(4);if(286<N||30<M)return-1;for(q=0;q<o;q++)j(3),R[V[q]]=k(3),
m(3);for(;19>q;q++)R[V[q]]=0;O=7;q=new h(R,19,19,null,null,O);if(0!=q.status)return-1;W=q.root;O=q.m;r=N+M;for(o=t=0;o<r;)if(j(O),D=W.list[k(O)],q=D.b,m(q),q=D.n,16>q)R[o++]=t=q;else if(16==q){j(2);q=3+k(2);m(2);if(o+q>r)return-1;for(;0<q--;)R[o++]=t}else{17==q?(j(3),q=3+k(3),m(3)):(j(7),q=11+k(7),m(7));if(o+q>r)return-1;for(;0<q--;)R[o++]=0;t=0}O=v;q=new h(R,N,257,L,G,O);0==O&&(q.status=1);if(0!=q.status)return-1;W=q.root;O=q.m;for(o=0;o<M;o++)R[o]=R[o+N];J=A;q=new h(R,M,0,f,S,J);U=q.root;J=q.m;
return 0==J&&257<N||0!=q.status?-1:n(c,g,l)}function o(c,g,o){var q,v;for(q=0;q<o&&!(C&&-1==y);){if(0<I){if(y!=w)for(;0<I&&q<o;)I--,K&=t-1,H&=t-1,c[g+q++]=F[H++]=F[K++];else{for(;0<I&&q<o;)I--,H&=t-1,j(8),c[g+q++]=F[H++]=k(8),m(8);0==I&&(y=-1)}if(q==o)break}if(-1==y){if(C)break;j(1);0!=k(1)&&(C=!0);m(1);j(2);y=k(2);m(2);W=null;I=0}switch(y){case 0:v=c;var A=g+q,T=o-q,D=void 0,D=x&7;m(D);j(16);D=k(16);m(16);j(16);if(D!=(~z&65535))v=-1;else{m(16);I=D;for(D=0;0<I&&D<T;)I--,H&=t-1,j(8),v[A+D++]=F[H++]=
k(8),m(8);0==I&&(y=-1);v=D}break;case 1:if(null!=W)v=n(c,g+q,o-q);else a:{v=c;A=g+q;T=o-q;if(null==u){for(var N=void 0,D=Array(288),N=void 0,N=0;144>N;N++)D[N]=8;for(;256>N;N++)D[N]=9;for(;280>N;N++)D[N]=7;for(;288>N;N++)D[N]=8;E=7;N=new h(D,288,257,L,G,E);if(0!=N.status){alert("HufBuild error: "+N.status);v=-1;break a}u=N.root;E=N.m;for(N=0;30>N;N++)D[N]=5;r=5;N=new h(D,30,0,f,S,r);if(1<N.status){u=null;alert("HufBuild error: "+N.status);v=-1;break a}B=N.root;r=N.m}W=u;U=B;O=E;J=r;v=n(v,A,T)}break;
case 2:v=null!=W?n(c,g+q,o-q):l(c,g+q,o-q);break;default:v=-1}if(-1==v)return C?0:-1;q+=v}return q}function q(f){var c,g,h;null==F&&(F=Array(2*t));x=z=H=0;y=-1;C=!1;I=K=0;W=null;X=f;ba=0;c=Array(1024);for(f="";0<(g=o(c,0,c.length));)for(h=0;h<g;h++)f+=String.fromCharCode(c[h]);X=null;return f}var r,t=32768,w=0,v=9,A=6,F,H,u=null,B,E,z,x,y,C,I,K,W,U,O,J,X,ba,T=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],L=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,
163,195,227,258,0,0],G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];JSZip.compressions.DEFLATE?JSZip.compressions.DEFLATE.uncompress=q:JSZip.compressions.DEFLATE={magic:"\x00",uncompress:q}})();(function(){function c(c){this.stream=c;this.index=
0}function g(c,g){this.options=c;this.loadOptions=g}function h(c,g){this.files=[];this.loadOptions=g;c&&this.load(c)}var j=function(c){var g="",h,j;for(j=0;j<c.length;j++)h=c.charCodeAt(j),g+="\\x"+(10>h?"0":"")+h.toString(16);return g};c.prototype={checkOffset:function(c){this.checkIndex(this.index+c)},checkIndex:function(c){if(this.stream.length<c||0>c)throw Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+c+"). Corrupted zip ?");},setIndex:function(c){this.checkIndex(c);
this.index=c},eof:function(){return this.index>=this.stream.length},byteAt:function(c){return this.stream.charCodeAt(c)&255},readByte:function(){this.checkOffset(1);return this.byteAt(1+this.index++)},readInt:function(c){var g=0,h;this.checkOffset(c);for(h=c-1;0<=h;h--)g=(g<<8)+this.byteAt(this.index+h);this.index+=c;return g},readString:function(c){var g="",h,j;this.checkOffset(c);for(h=0;h<c;h++)j=this.byteAt(this.index+h),g+=String.fromCharCode(j);this.index+=c;return g},readDate:function(){var c=
this.readInt(4);return new Date((c>>25&127)+1980,(c>>21&15)-1,c>>16&31,c>>11&31,c>>5&63,(c&31)<<1)}};g.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},hasDataDescriptor:function(){return 8===(this.bitFlag&8)},useUTF8:function(){return 2048===(this.bitFlag&2048)},isZIP64:function(){return this.options.zip64},readLocalPartHeader:function(c){this.versionNeeded=c.readInt(2);this.bitFlag=c.readInt(2);this.compressionMethod=c.readString(2);this.date=c.readDate();this.crc32=c.readInt(4);this.compressedSize=
c.readInt(4);this.uncompressedSize=c.readInt(4);this.fileNameLength=c.readInt(2);this.extraFieldsLength=c.readInt(2);if(this.isEncrypted())throw Error("Encrypted zip are not supported");},readLocalPart:function(c){this.readLocalPartHeader(c);this.fileName=c.readString(this.fileNameLength);this.readExtraFields(c);if(this.hasDataDescriptor()){if(this.compressedFileData=this.findDataUntilDataDescriptor(c),this.crc32=c.readInt(4),this.compressedSize=c.readInt(this.isZIP64()?8:4),this.uncompressedSize=
c.readInt(this.isZIP64()?8:4),this.compressedFileData.length!==this.compressedSize)throw Error("Bug : data descriptor incorrectly read (size mismatch)");}else this.compressedFileData=c.readString(this.compressedSize);this.uncompressedFileData=null;a:{for(var g in JSZip.compressions)if(JSZip.compressions[g].magic===this.compressionMethod){c=JSZip.compressions[g];break a}c=null}if(null===c)throw Error("Corrupted zip : compression "+j(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");
this.uncompressedFileData=c.uncompress(this.compressedFileData);if(this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32)throw Error("Corrupted zip : CRC32 mismatch");this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName))},findDataUntilDataDescriptor:function(c){for(var g="",h=c.readString(4),j;h!==JSZip.signature.DATA_DESCRIPTOR;)j=c.readString(1),g+=h.slice(0,1),h=(h+j).slice(-4);return g},readCentralPart:function(c){this.versionMadeBy=c.readString(2);
this.readLocalPartHeader(c);this.fileCommentLength=c.readInt(2);this.diskNumberStart=c.readInt(2);this.internalFileAttributes=c.readInt(2);this.externalFileAttributes=c.readInt(4);this.localHeaderOffset=c.readInt(4);this.fileName=c.readString(this.fileNameLength);this.readExtraFields(c);this.fileComment=c.readString(this.fileCommentLength);this.useUTF8()&&(this.fileName=JSZip.prototype.utf8decode(this.fileName),this.fileComment=JSZip.prototype.utf8decode(this.fileComment));this.dir=this.externalFileAttributes&
16?!0:!1},parseZIP64ExtraField:function(){var g=new c(this.extraFields[1].value);-1===this.uncompressedSize&&(this.uncompressedSize=g.readInt(8));-1===this.compressedSize&&(this.compressedSize=g.readInt(8));-1===this.localHeaderOffset&&(this.localHeaderOffset=g.readInt(8));-1===this.diskNumberStart&&(this.diskNumberStart=g.readInt(4))},readExtraFields:function(c){var g=c.index,h,j,o;for(this.extraFields=this.extraFields||{};c.index<g+this.extraFieldsLength;)h=c.readInt(2),j=c.readInt(2),o=c.readString(j),
this.extraFields[h]={id:h,length:j,value:o};this.isZIP64()&&this.extraFields[1]&&this.parseZIP64ExtraField(c)}};h.prototype={checkSignature:function(c){var g=this.reader.readString(4);if(g!==c)throw Error("Corrupted zip or bug : unexpected signature ("+j(g)+", expected "+j(c)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);
this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);
this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var c=this.zip64EndOfCentralSize-44,g,h,j;0<c;)g=this.reader.readInt(2),h=this.reader.readInt(4),j=this.reader.readString(h),this.zip64ExtensibleData[g]={id:g,length:h,value:j}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);
this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var c,g;for(c=0;c<this.files.length;c++)g=this.files[c],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER),g.readLocalPart(this.reader)},readCentralDir:function(){var c;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER;)c=new g({zip64:this.zip64},this.loadOptions),
c.readCentralPart(this.reader),this.files.push(c)},readEndOfCentral:function(){var c=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===c){this.zip64=!1;c=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END);if(-1===c)throw Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(c);this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral()}else this.zip64=!0,this.reader.setIndex(c),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR),
this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()},load:function(g){this.reader=new c(g);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};JSZip.prototype.load=function(c,g){var j,l,o,g=g||{};g.base64&&(c=JSZipBase64.decode(c));j=(new h(c,g)).files;for(l in j)o=j[l],this.file(o.fileName,o.uncompressedFileData,{binary:!0,date:o.date,
dir:o.dir});return this}})();var xlsx=function(c){function g(f){var c=Math.floor(f/26)-1;return(-1<c?g(c):"")+S.charAt(f%26)}function h(f){return"object"===typeof f?(f-new Date(1900,0,0))/864E5+1:new Date(+new Date(1900,0,0)+864E5*(f-1))}function j(f){return{}.toString.call(f).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function k(f){return(f||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}var m=new JSZip,n,l,o,q,r,t,w,v,A,F,H,u,B,E,z,
x,y,C,I,K,W=[[],[]],U=[],O=[],J=[],X,ba,T,L,G,f=["General","0","0.00","#,##0","#,##0.00",,,,,"0%","0.00%","0.00E+00","# ?/?","# ??/??","mm-dd-yy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","h:mm","h:mm:ss","m/d/yy h:mm",,,,,,,,,,,,,,,"#,##0 ;(#,##0)","#,##0 ;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)",,,,,"mm:ss","[h]:mm:ss","mmss.0","##0.0E+0","@"],S="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(c.pivot){n=Date.now();m.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/></Relationships>');
y=m.folder("docProps");y.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>gonzalo</dc:creator><dcterms:created xsi:type="dcterms:W3CDTF">2010-12-23T01:32:21Z</dcterms:created><cp:lastModifiedBy>xperTools</cp:lastModifiedBy><dcterms:modified xsi:type="dcterms:W3CDTF">2010-02-23T01:32:21Z</dcterms:modified></cp:coreProperties>');
y.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Hojas de clculo</vt:lpstr></vt:variant><vt:variant><vt:i4>2</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="2" baseType="lpstr"><vt:lpstr>PivotTable</vt:lpstr><vt:lpstr>SourceData</vt:lpstr></vt:vector></TitlesOfParts><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>');
m.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml"/><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet2.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/pivotTables/pivotTable1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml"/><Override PartName="/xl/pivotCache/pivotCacheDefinition1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml"/><Override PartName="/xl/pivotCache/pivotCacheRecords1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml"/></Types>');
C=m.folder("xl");C.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet2.xml"/><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="pivotCache/pivotCacheDefinition1.xml"/><Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId5" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId6" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/></Relationships>');
I=C.folder("pivotCache").file("pivotCacheRecords1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotCacheRecords xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"></pivotCacheRecords>');I.file("pivotCacheDefinition1.xml",c.pivotCacheDefinition);I.folder("_rels").file("pivotCacheDefinition1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords" Target="pivotCacheRecords1.xml"/></Relationships>');
C.folder("pivotTables").file("pivotTable1.xml",c.pivotTable1).folder("_rels").file("pivotTable1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition" Target="../pivotCache/pivotCacheDefinition1.xml"/></Relationships>');C.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme name="Tema de Office" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main"/>');
I=C.folder("worksheets");I.file("sheet1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheetData/></worksheet>');F=Array(1);z=Array(1);x=Array(1);var V="",Q=1;for(v=c.worksheets.length;v--;){X=v+1;K=c.worksheets[v];u=K.data;l="";ba=[];G=[];o=-1;for(t=u.length;++o<t;){q=-1;r=u[o].length;for(l+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';++q<
r;){A=!1;L=u[o][q];B=L.hasOwnProperty("value")?L.value:L;w="";E={borders:L.borders,hAlign:L.hAlign,vAlign:L.vAlign,bold:L.bold,italic:L.italic,fontColor:L.fontColor,fontName:L.fontName,fontSize:L.fontSize,fill:L.fill,formatCode:L.formatCode||"General"};T=0;L.isString||B&&"string"===typeof B&&!isFinite(B)?(B=k(B),w="inlineStr",A=!0):"boolean"===typeof B?(B=B?1:0,w="b",T=1):"date"===j(B)?(B=h(B),E.formatCode=L.formatCode||"mm-dd-yy",T=B.length):"object"===typeof B?B=null:T=(""+B).length;E=JSON.stringify(E);
H=F.indexOf(E);E=0>H?F.push(E)-1:H;null==ba[q]&&(ba[q]={autoWidth:!1,max:0});L.autoWidth&&(ba[q].autoWidth=!0);T>ba[q].max&&(ba[q].max=T);if(1<L.colSpan){G.push([g(q)+(o+1),g(q+L.colSpan-1)+(o+1)]);H=[q,0];for(T=0;T<L.colSpan-1;T++)H.push(L);u[o].splice.apply(u[o],H);r+=L.colSpan-1}else if(1<L.rowSpan){for(T=1;T<L.rowSpan;T++)if(u[o+T])u[o+T].splice(q,0,L);else{L.rowSpan=T;break}G.push([g(q)+(o+1),g(q)+(o+L.rowSpan)])}if(1<L.rowSpan||1<L.colSpan)delete L.value,delete L.rowSpan,delete L.colSpan;l+=
'<c r="'+g(q)+(o+1)+'"'+(E?' s="'+E+'"':"")+(w?' t="'+w+'"':"");l=null!=B?A?l+(">"+(L.formula?"<f>"+L.formula+"</f>":"")+"<is><t>"+B+"</t></is></c>"):l+(">"+(L.formula?"<f>"+L.formula+"</f>":"")+"<v>"+B+"</v></c>"):l+"/>"}l+="</row>"}w=[];for(o=0;o<ba.length;o++)ba[o].autoWidth&&w.push('<col min="',o+1,'" max="',o+1,'" width="',ba[o].max,'" bestFit="1"/>');0<w.length&&(w=["<cols>"].concat(w,["</cols>"]).join(""));l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1:'+
g(u[0].length-1)+u.length+'"/><sheetViews><sheetView '+(v===c.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+w+"<sheetData>"+l+"</sheetData>";if(0<G.length){l+='<mergeCells count="'+G.length+'">';for(o=0;o<G.length;o++)l+='<mergeCell ref="'+G[o].join(":")+'"/>';l+="</mergeCells>"}l+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';K.table&&(l+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>');
I.file("sheet2.xml",l+"</worksheet>")}o=F.length;w=[];for(u=0;--o;){E=JSON.parse(F[o]);"General"!==E.formatCode?(H=f.indexOf(E.formatCode),0>H&&(H=164+w.length,w.push('<numFmt formatCode="'+E.formatCode+'" numFmtId="'+H+'"/>')),E.formatCode=H):E.formatCode=0;l=0;if(E.borders){v=["<border>"];for(var P in{left:0,right:0,top:0,bottom:0,diagonal:0})E.borders[P]?(l=E.borders[P],6===l.length&&(l="FF"+l),v.push("<",P,' style="thin">','<color rgb="',E.borders[P],'"/></',P,">")):v.push("<",P,"/>");v.push("</border>");
v=v.join("");l=z.indexOf(v);0>l&&(l=z.push(v)-1)}v=0;if(E.bold||E.italic||E.fontSize||E.fontName||E.fontColor)u=["<font>"],E.bold&&u.push("<b/>"),E.italic&&u.push("<i/>"),u.push('<sz val="',E.fontSize||11,'"/>'),u.push('<color rgb="FF',E.fontColor||"000000",'"/>'),u.push('<name val="',E.fontName||"Calibri",'"/>'),u.push('<family val="2"/>',"</font>"),u=u.join(""),v=x.indexOf(u),0>v&&(v=x.push(u)-1);u=0;E.fill&&(V=V+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+E.fill+'"/><bgColor indexed="64"/></patternFill></fill>',
Q++,u=Q);F[o]=['<xf xfId="0" borderId="',l,'" fontId="',v,'" numFmtId="',E.formatCode,'" fillId="',u,'" ',E.hAlign||E.vAlign?'applyAlignment="1" ':" ",0<E.formatCode?'applyNumberFormat="1" ':" ",0<l?'applyBorder="1" ':" ",0<v?'applyFont="1" ':" ",0<u?'applyFill="1" ':" ",">"];if(E.hAlign||E.vAlign)F[o].push("<alignment"),E.hAlign&&F[o].push(' horizontal="',E.hAlign,'"'),E.vAlign&&F[o].push(' vertical="',E.vAlign,'"'),F[o].push("/>");F[o].push("</xf>");F[o]=F[o].join("")}w=w.length?'<numFmts count="'+
w.length+'">'+w.join("")+"</numFmts>":"";""!=c.style&&(w=c.style);f='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+w+'<fonts count="'+x.length+'" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>'+
x.join("")+'</fonts><fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+V+'</fills><borders count="'+z.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+z.join("")+'</borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+F.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+F.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>';
f=void 0!=c.dfx?f+"<dxfs>"+c.dfx+"</dxfs>":f+'<dxfs count="0"/>';C.file("styles.xml",f+'<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');I.folder("_rels").file("sheet1.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable" Target="../pivotTables/pivotTable1.xml"/></Relationships>');
C.file("sharedStrings.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"></sst>');C.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="4" lowestEdited="4" rupBuild="4506"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView xWindow="360" yWindow="555" windowWidth="21015" windowHeight="9405"/></bookViews><sheets><sheet name="PivotTable" sheetId="1" r:id="rId1"/><sheet name="SourceData" sheetId="2" r:id="rId2"/></sheets><calcPr calcId="125725"/><pivotCaches><pivotCache cacheId="5" r:id="rId3"/></pivotCaches><fileRecoveryPr repairLoad="1"/></workbook>')}else{n=
Date.now();A=[[],0];m.folder("_rels").file(".rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties" Target="docProps/app.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties" Target="docProps/core.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>');
y=m.folder("docProps");C=m.folder("xl");C.folder("theme").file("theme1.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="MS P????"/><a:font script="Hang" typeface="?? ??"/><a:font script="Hans" typeface="??"/><a:font script="Hant" typeface="????"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>');
I=C.folder("worksheets");y.file("core.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>'+(c.creator||"XLSX.js")+"</dc:creator><cp:lastModifiedBy>"+(c.lastModifiedBy||"XLSX.js")+'</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">'+
(c.created||new Date).toISOString()+'</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">'+(c.modified||new Date).toISOString()+"</dcterms:modified></cp:coreProperties>");F=Array(1);z=Array(1);x=Array(1);V="";Q=1;for(v=c.worksheets.length;v--;){X=v+1;K=c.worksheets[v];u=K.data;l="";ba=[];G=[];o=-1;for(t=u.length;++o<t;){q=-1;r=u[o].length;for(l+='<row r="'+(o+1)+'" x14ac:dyDescent="0.25">';++q<r;){L=u[o][q];B=L.hasOwnProperty("value")?L.value:L;w="";E={borders:L.borders,hAlign:L.hAlign,
vAlign:L.vAlign,bold:L.bold,italic:L.italic,fontColor:L.fontColor,fontName:L.fontName,fontSize:L.fontSize,fill:L.fill,formatCode:L.formatCode||"General"};T=0;B&&"string"===typeof B&&!isFinite(B)?(B=k(B),A[1]++,H=A[0].indexOf(B),T=B.length,0>H&&(H=A[0].push(B)-1),B=H,w="s"):"boolean"===typeof B?(B=B?1:0,w="b",T=1):"date"===j(B)?(B=h(B),E.formatCode=L.formatCode||"mm-dd-yy",T=B.length):"object"===typeof B?B=null:T=(""+B).length;E=JSON.stringify(E);H=F.indexOf(E);E=0>H?F.push(E)-1:H;null==ba[q]&&(ba[q]=
{autoWidth:!1,max:0});L.autoWidth&&(ba[q].autoWidth=!0);T>ba[q].max&&(ba[q].max=T);if(1<L.colSpan){G.push([g(q)+(o+1),g(q+L.colSpan-1)+(o+1)]);H=[q,0];for(T=0;T<L.colSpan-1;T++)H.push(L);u[o].splice.apply(u[o],H);r+=L.colSpan-1}else if(1<L.rowSpan){for(T=1;T<L.rowSpan;T++)if(u[o+T])u[o+T].splice(q,0,L);else{L.rowSpan=T;break}G.push([g(q)+(o+1),g(q)+(o+L.rowSpan)])}if(1<L.rowSpan||1<L.colSpan)delete L.value,delete L.rowSpan,delete L.colSpan;l+='<c r="'+g(q)+(o+1)+'"'+(E?' s="'+E+'"':"")+(w?' t="'+
w+'"':"");l=null!=B?l+(">"+(L.formula?"<f>"+L.formula+"</f>":"")+"<v>"+B+"</v></c>"):l+"/>"}l+="</row>"}w=[];for(o=0;o<ba.length;o++)ba[o].autoWidth&&w.push('<col min="',o+1,'" max="',o+1,'" width="',ba[o].max,'" bestFit="1"/>');0<w.length&&(w=["<cols>"].concat(w,["</cols>"]).join(""));l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><dimension ref="A1:'+
g(u[0].length-1)+u.length+'"/><sheetViews><sheetView '+(v===c.activeWorksheet?'tabSelected="1" ':"")+' workbookViewId="0"/></sheetViews><sheetFormatPr defaultRowHeight="15" x14ac:dyDescent="0.25"/>'+w+"<sheetData>"+l+"</sheetData>";if(0<G.length){l+='<mergeCells count="'+G.length+'">';for(o=0;o<G.length;o++)l+='<mergeCell ref="'+G[o].join(":")+'"/>';l+="</mergeCells>"}l+='<pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3"/>';K.table&&(l+='<tableParts count="1"><tablePart r:id="rId1"/></tableParts>');
I.file("sheet"+X+".xml",l+"</worksheet>");if(K.table){o=-1;t=u[0].length;w=g(u[0].length-1)+u.length;for(l='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><table xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" id="'+X+'" name="Table'+X+'" displayName="Table'+X+'" ref="A1:'+w+'" totalsRowShown="0"><autoFilter ref="A1:'+w+'"/><tableColumns count="'+u[0].length+'">';++o<t;)l+='<tableColumn id="'+(o+1)+'" name="'+(u[0][o].hasOwnProperty("value")?u[0][o].value:u[0][o])+'"/>';
l+='</tableColumns><tableStyleInfo name="TableStyleMedium2" showFirstColumn="0" showLastColumn="0" showRowStripes="1" showColumnStripes="0"/></table>';C.folder("tables").file("table"+X+".xml",l);I.folder("_rels").file("sheet"+X+".xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table" Target="../tables/table'+
X+'.xml"/></Relationships>');W[1].unshift('<Override PartName="/xl/tables/table'+X+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"/>')}W[0].unshift('<Override PartName="/xl/worksheets/sheet'+X+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');U.unshift(k(K.name)||"Sheet"+X);O.unshift('<Relationship Id="rId'+X+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+
X+'.xml"/>');J.unshift('<sheet name="'+(k(K.name)||"Sheet"+X)+'" sheetId="'+X+'" r:id="rId'+X+'"/>')}o=F.length;w=[];for(u=0;--o;){E=JSON.parse(F[o]);"General"!==E.formatCode?(H=f.indexOf(E.formatCode),0>H&&(H=164+w.length,w.push('<numFmt formatCode="'+E.formatCode+'" numFmtId="'+H+'"/>')),E.formatCode=H):E.formatCode=0;l=0;if(E.borders){v=["<border>"];for(P in{left:0,right:0,top:0,bottom:0,diagonal:0})E.borders[P]?(l=E.borders[P],6===l.length&&(l="FF"+l),v.push("<",P,' style="thin">','<color rgb="',
E.borders[P],'"/></',P,">")):v.push("<",P,"/>");v.push("</border>");v=v.join("");l=z.indexOf(v);0>l&&(l=z.push(v)-1)}v=0;if(E.bold||E.italic||E.fontSize||E.fontName||E.fontColor)u=["<font>"],E.bold&&u.push("<b/>"),E.italic&&u.push("<i/>"),u.push('<sz val="',E.fontSize||11,'"/>'),u.push('<color rgb="FF',E.fontColor||"000000",'"/>'),u.push('<name val="',E.fontName||"Calibri",'"/>'),u.push('<family val="2"/>',"</font>"),u=u.join(""),v=x.indexOf(u),0>v&&(v=x.push(u)-1);u=0;E.fill&&(V=V+'<fill><patternFill patternType="solid"><fgColor rgb="FF'+
E.fill+'"/><bgColor indexed="64"/></patternFill></fill>',Q++,u=Q);F[o]=['<xf xfId="0" borderId="',l,'" fontId="',v,'" numFmtId="',E.formatCode,'" fillId="',u,'" ',E.hAlign||E.vAlign?'applyAlignment="1" ':" ",0<E.formatCode?'applyNumberFormat="1" ':" ",0<l?'applyBorder="1" ':" ",0<v?'applyFont="1" ':" ",0<u?'applyFill="1" ':" ",">"];if(E.hAlign||E.vAlign)F[o].push("<alignment"),E.hAlign&&F[o].push(' horizontal="',E.hAlign,'"'),E.vAlign&&F[o].push(' vertical="',E.vAlign,'"'),F[o].push("/>");F[o].push("</xf>");
F[o]=F[o].join("")}w=w.length?'<numFmts count="'+w.length+'">'+w.join("")+"</numFmts>":"";C.file("styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac">'+w+'<fonts count="'+x.length+'" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>'+
x.join("")+'</fonts><fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>'+V+'</fills><borders count="'+z.length+'"><border><left/><right/><top/><bottom/><diagonal/></border>'+z.join("")+'</borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="'+F.length+'"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/>'+F.join("")+'</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles><dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext></extLst></styleSheet>');
m.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>'+W[0].join("")+'<Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/>'+
W[1].join("")+'<Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>');y.file("app.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>XLSX.js</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>'+
c.worksheets.length+'</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="'+U.length+'" baseType="lpstr"><vt:lpstr>'+U.join("</vt:lpstr><vt:lpstr>")+"</vt:lpstr></vt:vector></TitlesOfParts><Manager></Manager><Company>Microsoft Corporation</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>1.0</AppVersion></Properties>");C.folder("_rels").file("workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'+
O.join("")+'<Relationship Id="rId'+(O.length+1)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/><Relationship Id="rId'+(O.length+2)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId'+(O.length+3)+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/></Relationships>');C.file("sharedStrings.xml",
'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="'+A[1]+'" uniqueCount="'+A[0].length+'"><si><t>'+A[0].join("</t></si><si><t>")+"</t></si></sst>");C.file("workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="9303"/><workbookPr defaultThemeVersion="124226"/><bookViews><workbookView '+
(c.activeWorksheet?'activeTab="'+c.activeWorksheet+'" ':"")+'xWindow="480" yWindow="60" windowWidth="18195" windowHeight="8505"/></bookViews><sheets>'+J.join("")+'</sheets><calcPr calcId="145621"/></workbook>')}n=Date.now()-n;c=Date.now();return{base64:m.generate({compression:"DEFLATE"}),zipTime:Date.now()-c,processTime:n,href:function(){return"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+this.base64}}};"object"===typeof exports&&"object"===typeof module&&(module.exports=
xlsx);OAT.GeneratePDFOutput=function(c,g){var h=-1,j=-1,k=jQuery("#"+c.controlName+"_"+c.query+" tr").length*30+18;k<841&&(k=841);for(var m=0,k=true,n=0;k&&n<jQuery("#"+c.controlName+"_"+c.query+" tr").length;)jQuery("#"+c.controlName+"_"+c.query+" tr")[n].getAttribute("title_row")!="true"?k=false:n++;var l=jQuery("#"+c.controlName+"_"+c.query+" tr")[n];l==void 0&&(l=jQuery("#"+c.controlName+"_"+c.query+" tr")[0]);for(var o=0;o<l.children.length;o++)m=l.children[o].getAttribute("colspan")!=null?m+
parseInt(l.children[o].getAttribute("colspan")):m+1;m=m*73+15;m<595&&(m=595);k=[];for(n=0;n<jQuery("#"+c.controlName+"_"+c.query+" tr").length;n++){for(var q=-1,h=-1,r=0,l=0;l<n;l++){o=jQuery("#"+c.controlName+"_"+c.query+" tr")[l];for(q=0;q<o.children.length;q++){var t=o.children[q].getAttribute("rowspan");if(t!=null&&parseInt(t)>n-l){t=o.children[q].getAttribute("colspan");r=t===null?1+r:parseInt(t)+r}}}q=r-1;l=jQuery("#"+c.controlName+"_"+c.query+" tr")[n];for(o=0;o<l.children.length;o++){q++;
var h=l.children[o].textContent.replace(/^\s+|\s+$/g,""),w=l.children[o].getAttribute("hidden");if(w===null){var v=l.children[o].getAttribute("rowspan"),w=l.children[o].getAttribute("colspan"),A=q;k[A]==void 0&&(k[A]=25);v===null&&w===null||o===l.children.length-1&&w==="3"?w!=null&&h===""&&(q=parseInt(w)+q-1):w!==null&&(q=parseInt(w)+q-1);for(var F=0,H=F=0;H<h.length&&h.charCodeAt(H)<1E3;){F++;H++}F=h.length-F;if(F==0){if(h.length>14&&(w==null||n==0||parseInt(w)<2))h.length*1.68>k[A]&&(k[A]=h.length*
1.68)}else{F=F*3.1+(h.length-F)*2;if(F>k[A]&&(w==null||n==0||parseInt(w)<2))k[A]=F}}h=q}}for(F=n=0;F<k.length;F++)n=n+k[F]*2.5+48;n=10+n+5;n>m&&(m=n);F=function(c,g){if(c>g.length)c=g.length;for(var h=0,k=0;k<c;k++)h=h+g[k];return h};m=m<=595?new jsPDF("portrait","mm","a4",false,m,792):m>595&&m<792?new jsPDF("landscape","mm","a4",false,793,792):new jsPDF("landscape","mm","a4",false,m,792);m.setFontSize(8);H=[];if(jQuery("#"+c.controlName+"_"+c.query+" tr")[1+c.colConditions.length]!=void 0)for(n=
0;n<jQuery("#"+c.controlName+"_"+c.query+" tr")[1+c.colConditions.length].children.length;n++)H[n]=0;else for(n=0;n<jQuery("#"+c.controlName+"_"+c.query+" tr")[c.colConditions.length].children.length;n++)H[n]=0;for(n=0;n<jQuery("#"+c.controlName+"_"+c.query+" tr").length;n++){h=q=-1;j++;for(l=r=0;l<n;l++){o=jQuery("#"+c.controlName+"_"+c.query+" tr")[l];for(q=0;q<o.children.length;q++){t=o.children[q].getAttribute("rowspan");if(t!=null&&parseInt(t)>n-l){t=o.children[q].getAttribute("colspan");r=t===
null?1+r:parseInt(t)+r}}}q=r-1;l=jQuery("#"+c.controlName+"_"+c.query+" tr")[n];t=-1;for(o=0;o<l.children.length;o++){var h=l.children[o].textContent.replace(/^\s+|\s+$/g,""),w=l.children[o].getAttribute("hidden"),A=l.children[o].getAttribute("pivotcorrect"),u=false;m.setDrawColor(0,0,0);m.setTextColor(0,0,0);m.setFontStyle("normal");var B=!isNaN(parseFloat(h))||h=="-"&&(l.children[o].getAttribute("style")==void 0||l.children[o].getAttribute("style").indexOf("text-align: left")==-1),E=0,E=m.getStringUnitWidth(h);
if(l.children[o].getAttribute("style")!=void 0&&l.children[o].getAttribute("style")!=null)for(var z=l.children[o].getAttribute("style").split(";"),x=0;x<z.length;x++){var y=z[x].split(":");if(y[0].replace(/^\s+|\s+$/g,"")==="color"){y=y[1].replace(/^\s+|\s+$/g,"");y=y.substring(4,y.length);y=y.substring(0,y.length-1);m.setTextColor(parseInt(y.split(",")[0]),parseInt(y.split(",")[1]),parseInt(y.split(",")[2]))}else if(y[0].replace(/^\s+|\s+$/g,"")==="text-align")B=y[1].replace(/^\s+|\s+$/g,"")=="right";
else if(y[0].replace(/^\s+|\s+$/g,"")==="font-style")m.setFontStyle("italic");else if(y[0].replace(/^\s+|\s+$/g,"")==="font-weight")y[1].replace(/^\s+|\s+$/g,"")==="bold"&&m.setFontStyle("bold");else if(y[0].replace(/^\s+|\s+$/g,"")==="background-color"){y=y[1].replace(/^\s+|\s+$/g,"");y=y.substring(4,y.length);y=y.substring(0,y.length-1);m.setFillColor(parseInt(y.split(",")[0]),parseInt(y.split(",")[1]),parseInt(y.split(",")[2]));u=true}else if(y[0].replace(/^\s+|\s+$/g,"")==="border-color"){y=y[1].replace(/^\s+|\s+$/g,
"");y=y.substring(4,y.length);y=y.substring(0,y.length-1);m.setDrawColor(parseInt(y.split(",")[0]),parseInt(y.split(",")[1]),parseInt(y.split(",")[2]))}}z=[];x="";y=-1;v=0;if(h.charCodeAt(0)>1E3)for(var C=0;C<h.length;C++){if((v==58||v==65306)&&h.charCodeAt(C)==32)z[C]="ToDelete";else{z[C]=OAT.getCharacterImg(h.charCodeAt(C));v=h.charCodeAt(C)}if(h.charCodeAt(C)<1E3){x=x+h[C];y==-1&&(y=C)}else{x="";y=-1}}else{for(var I=-1,C=1;C<h.length;C++)if(h.charCodeAt(C)>1E3){I=C;break}if(I>0){for(var K=h.substring(0,
I),W=0,C=I;C<h.length;C++){if(h.charCodeAt(C)<1E3){x=x+h[C];y==-1&&(y=C-I)}else{x="";y=-1}if((v==58||v==65306)&&h.charCodeAt(C)==32)z[W]="ToDelete";else{z[W]=OAT.getCharacterImg(h.charCodeAt(C));v=h.charCodeAt(C)}W++}h=K}}try{y!=-1&&!B&&(z=z.slice(0,y))}catch(U){}for(;z.length>0&&z.indexOf("ToDelete")!=-1;){C=z.indexOf("ToDelete");z.splice(C,1)}if(w===null&&!A){q++;v=l.children[o].getAttribute("rowspan");w=l.children[o].getAttribute("colspan");t=t+1;if(v&&j+parseInt(v)>26){A=j+parseInt(v)-26;v=parseInt(v)-
A;H[t+r]=A}A=1;w!=null&&(A=parseInt(w));o===l.children.length-1&&(A===3&&c.colConditions.length==0)&&(A=1);A=q;if(v===null&&w===null||o===l.children.length-1&&w==="3"&&c.colConditions.length==0){if(u){u=q;w!=null&&h===""&&(u=parseInt(w)+q-1);m.rect(8+F(A,k),13+j*10-7,F(u+1,k)-F(A,k),10,"F")}u=0;if(h.charCodeAt(0)<1E3){u=h.length*1.4+2;B?m.text(10+F(q+1,k)-E*3-4,13+j*10,h):m.text(10+F(q,k),13+j*10,h)}if(z.length>0)for(C=0;C<z.length;C++)m.addImage(z[C],"JPEG",10+F(q,k)+u+C*2.5,13+j*10-2.3,2.5,2.5);
y!=-1&&!B&&m.text(10+F(q,k)+u+z.length*2.5,13+j*10,x);w!=null&&h===""&&(q=parseInt(w)+q-1);m.line(8+F(A,k),13+j*10-7,8+F(q+1,k),13+j*10-7);m.line(8+F(A,k),13+j*10-7,8+F(A,k),j*10+16)}else if(w===null){u&&(v===null?m.rect(8+F(q,k),13+j*10-7,25,10,"F"):m.rect(8+F(q,k),13+j*10-7,25,10+(parseInt(v)-1)*10,"F"));u=0;if(h.charCodeAt(0)<1E3){u=h.length*1.4+2;m.text(10+F(q,k),13+j*10,h)}if(z.length>0)for(C=0;C<z.length;C++)m.addImage(z[C],"JPEG",10+F(q,k)+u+C*2.5,13+j*10-2.3,2.5,2.5);y!=-1&&!B&&m.text(10+
F(q,k)+u+z.length*2.5,13+j*10,x);m.line(8+F(q,k),13+j*10-7,8+F(q+1,k),13+j*10-7);v===null?m.line(8+F(q,k),13+j*10-7,8+F(q,k),j*10+16):m.line(8+F(A,k),13+j*10-7,8+F(A,k),(j+parseInt(v)-1)*10+16)}else if(v===null){if(u){E=parseInt(w)+q-1;m.rect(8+F(A,k),13+j*10-7,F(E+1,k)-F(A,k),10,"F")}u=0;if(h.charCodeAt(0)<1E3){u=h.length*1.4+2;m.text(10+F(q,k),13+j*10,h)}if(z.length>0)for(C=0;C<z.length;C++)m.addImage(z[C],"JPEG",10+F(q,k)+u+C*2.5,13+j*10-2.3,2.5,2.5);y!=-1&&!B&&m.text(10+F(q,k)+u+z.length*2.5,
13+j*10,x);q=parseInt(w)+q-1;m.line(8+F(A,k),13+j*10-7,8+F(q+1,k),13+j*10-7);m.line(8+F(A,k),13+j*10-7,8+F(A,k),j*10+16)}else{if(u){E=parseInt(w)+q-1;v===null?m.rect(8+F(A,k),13+j*10-7,F(E+1,k)-F(A,k),10,"F"):m.rect(8+F(A,k),13+j*10-7,F(E+1,k)-F(A,k),(parseInt(v)-1)*10,"F")}u=0;if(h.charCodeAt(0)<1E3){u=h.length*1.4+2;m.text(10+F(q,k),13+j*10,h)}if(z.length>0)for(C=0;C<z.length;C++)m.addImage(z[C],"JPEG",10+F(q,k)+u+C*2.5,13+j*10-2.3,2.5,2.5);y!=-1&&!B&&m.text(10+F(q,k)+u+z.length*2.5,13+j*10,x);
q=parseInt(w)+q-1;m.line(8+F(A,k),13+j*10-7,8+F(q+1,k),13+j*10-7);v===null?m.line(8+F(A,k),13+j*10-7,8+F(A,k),j*10+16):m.line(8+F(A,k),13+j*10-7,8+F(A,k),(j+parseInt(v)-1)*10+16)}}m.setFontSize(8);h=q;o===l.children.length-1&&m.line(8+F(q+1,k),13+j*10-7,8+F(q+1,k),j*10+16)}if(j>=25){m.setDrawColor(0,0,0);m.line(8,13+(j+1)*10-7,8+F(h+1,k),13+(j+1)*10-7);j=0;m.addPage();for(r=0;r<H.length;r++)if(!isNaN(H[r]))if(H[r]>=25){H[r]=H[r]-25;m.line(8+F(r,k),16,8+F(r+1,k),16);m.line(8+F(r,k),16,8+F(r,k),266)}else{m.line(8+
F(r,k),16,8+F(r+1,k),16);m.line(8+F(r,k),16,8+F(r,k),(1+H[r]-1)*10+16);H[r]=0}}}m.setDrawColor(0,0,0);m.line(8,13+(j+1)*10-7,8+F(h+1,k),13+(j+1)*10-7);if(gx.util.browser.webkit&&!gx.util.browser.chrome)m.output("dataurlnewwindow");else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())m.save(g+".pdf");else return m.output()};removeComas=function(c,g){var h="";actPos=0;for(var j=g.defaultPicture.getAttribute("decimalSeparator"),k=0;k<c.length;k++)if(c[k]=="0"||c[k]=="1"||c[k]=="2"||c[k]=="3"||
c[k]=="4"||c[k]=="5"||c[k]=="6"||c[k]=="7"||c[k]=="8"||c[k]=="9"||c[k]==j||c[k]=="-")h=h+c[k];if(j!="."){for(var m="",k=0;k<h.length;k++)m=h[k]==j?m+".":m+h[k];h=m}return h};cleanDistinctValue=function(c,g,h){return c=="#NuN#"?" ":c.indexOf("%")>-1?c.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\%/g,"%"+h).trimpivot():c.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").trimpivot()};createExcelROWITEMS=function(c,g,h,j,k){if(g===0){c=h[j].indexOf(c.value);g="";g=k===0?"<i>":'<i r="'+k+'">';return c>
0?g+'<x v="'+c+'"/></i>':g+"<x/></i>"}g--;for(var m="",n=0;n<c.items.length;n++)m=m+createExcelROWITEMS(c.items[n],g,h,j,k);return m};createExcelCOLITEMS=function(c,g,h,j,k){if(g===0){c=h[j].indexOf(c.value.trimpivot());g="";for(h=0;h<measures.length;h++){g=k===0?"<i>":'<i r="'+k+'">';g=g+'<x v="'+c+'"/>';measures.length>1&&(g=g+"<x/>");g=g+"</i>"}return g}g--;for(var m="",n=0;n<c.items.length;n++)m=m+createExcelROWITEMS(c.items[n],g,h,j,k);return m};OAT.GenerateExcelOutput=function(c,g,h){function j(c){c=
c.toString(16);return c.length==1?"0"+c:c}function k(c,g,h){return j(c)+j(g)+j(h)}function m(c){for(var g={},h=0;h<c.length;h++){var j=c[h].split(":");if(j[0].replace(/^\s+|\s+$/g,"")==="color"){j=j[1].replace(/^\s+|\s+$/g,"");j=j.substring(4,j.length);j=j.substring(0,j.length-1);j=k(parseInt(j.split(",")[0]),parseInt(j.split(",")[1]),parseInt(j.split(",")[2]));g.fontColor=j}else if(j[0].replace(/^\s+|\s+$/g,"")==="text-align"){j=j[1].replace(/^\s+|\s+$/g,"");g.vAlign=j}else if(j[0].replace(/^\s+|\s+$/g,
"")==="font-style"){if(j[1].replace(/^\s+|\s+$/g,"")==="italic")g.italic=1}else if(j[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(j[1].replace(/^\s+|\s+$/g,"")==="bold")g.bold=1}else if(j[0].replace(/^\s+|\s+$/g,"")==="background-color"){j=j[1].replace(/^\s+|\s+$/g,"");j=j.substring(4,j.length);j=j.substring(0,j.length-1);j=k(parseInt(j.split(",")[0]),parseInt(j.split(",")[1]),parseInt(j.split(",")[2]));g.fill=j}}return g}var n=function(c,g){for(var h in c.formulaInfo.itemPosition)if(c.formulaInfo.itemPosition[h]==
g)return h};dataTable=[];dataRow=[];for(var l=0;l<g.columns.length;l++){var o={value:cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name")),isString:1};dataRow.push(o)}for(l=0;l<h.length;l++)if(!g.formulaInfo.measureFormula[l].hasFormula){o={value:cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))};dataRow.push(o)}var q=[];if(g.formulaInfo.cantFormulaMeasures>0){for(var r=0;r<g.formulaInfo.measureFormula.length;r++)if(g.formulaInfo.measureFormula[r].hasFormula)for(var t=
0;t<g.formulaInfo.measureFormula[r].relatedMeasures.length;t++){l=g.formulaInfo.measureFormula[r].relatedMeasures[t];q.indexOf(l)==-1&&q.push(l)}q.sort();for(l=0;l<q.length;l++){o={value:n(g,q[l])};dataRow.push(o)}}dataTable.push(dataRow);r=g.GeneralDataRows;if(g.autoPaging)r=g.RowsWhenMoveToFilter;if(g.formulaInfo.cantFormulaMeasures>0)r=g.recordForFormula;for(var w=0;w<r.length;w++){dataRow=[];for(l=0;l<g.columns.length;l++){var v=g.conditions[l].dataRowPosition,A=r[w][v];A=="#NuN#"&&(A=" ");o=
{value:A,isString:1};t=OAT.Dom.create("th",{},"");t=g.applyFormatValues(t,r[w][v],v);if(t.getAttribute("style")!=void 0)for(var t=t.getAttribute("style").split(";"),F=0;F<t.length;F++){v=t[F].split(":");if(v[0].replace(/^\s+|\s+$/g,"")==="color"){v=v[1].replace(/^\s+|\s+$/g,"");v=v.substring(4,v.length);v=v.substring(0,v.length-1);v=k(parseInt(v.split(",")[0]),parseInt(v.split(",")[1]),parseInt(v.split(",")[2]));o.fontColor=v}else if(v[0].replace(/^\s+|\s+$/g,"")==="text-align"){v=v[1].replace(/^\s+|\s+$/g,
"");o.vAlign=v}else if(v[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(v[1].replace(/^\s+|\s+$/g,"")==="italic")o.italic=1}else if(v[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(v[1].replace(/^\s+|\s+$/g,"")==="bold")o.bold=1}else if(v[0].replace(/^\s+|\s+$/g,"")==="background-color"){v=v[1].replace(/^\s+|\s+$/g,"");v=v.substring(4,v.length);v=v.substring(0,v.length-1);v=k(parseInt(v.split(",")[0]),parseInt(v.split(",")[1]),parseInt(v.split(",")[2]));o.fill=v}}dataRow.push(o)}for(l=0;l<h.length;l++)if(!g.formulaInfo.measureFormula[l].hasFormula){v=
g.columns.length+l;A=r[w][v];A=g.defaultPictureValue(A,l==h.length-1,l);A=removeComas(A,g);o={value:A};t=OAT.Dom.create("td",{},"");t=g.applyConditionalFormats(t,r[w][v],l===h.length-1?true:false,l);if(t.getAttribute("style")!=void 0){t=t.getAttribute("style").split(";");for(F=0;F<t.length;F++){v=t[F].split(":");if(v[0].replace(/^\s+|\s+$/g,"")==="color"){v=v[1].replace(/^\s+|\s+$/g,"");v=v.substring(4,v.length);v=v.substring(0,v.length-1);v=k(parseInt(v.split(",")[0]),parseInt(v.split(",")[1]),parseInt(v.split(",")[2]));
o.fontColor=v}else if(v[0].replace(/^\s+|\s+$/g,"")==="text-align"){v=v[1].replace(/^\s+|\s+$/g,"");o.vAlign=v}else if(v[0].replace(/^\s+|\s+$/g,"")==="font-style"){if(v[1].replace(/^\s+|\s+$/g,"")==="italic")o.italic=1}else if(v[0].replace(/^\s+|\s+$/g,"")==="font-weight"){if(v[1].replace(/^\s+|\s+$/g,"")==="bold")o.bold=1}else if(v[0].replace(/^\s+|\s+$/g,"")==="background-color"){v=v[1].replace(/^\s+|\s+$/g,"");v=v.substring(4,v.length);v=v.substring(0,v.length-1);v=k(parseInt(v.split(",")[0]),
parseInt(v.split(",")[1]),parseInt(v.split(",")[2]));o.fill=v}}}dataRow.push(o)}for(t=0;t<q.length;t++)dataRow.push({value:r[w][q[t]]});dataTable.push(dataRow)}w=[];A=[];o=1;for(l=0;l<g.columns.length;l++){A[l]=0;t=OAT.Dom.create("th",{},"");v=g.conditions[l].dataRowPosition;t=g.applyFormatValues(t,r[0][v],v);if(t.getAttribute("style")!=void 0){t=t.getAttribute("style").split(";");t=m(t);if(t.fontColor!=void 0||t.italic!=void 0||t.bold!=void 0){A[l]=o;o++;w.push(t)}}}for(var H=[],l=0;l<h.length;l++){H[l]=
0;t=OAT.Dom.create("td",{},"");v=g.columns.length+l;t=g.applyConditionalFormats(t,r[0][v],l===h.length-1?true:false,l);if(t.getAttribute("style")!=void 0){t=t.getAttribute("style").split(";");t=m(t);if(t.fontColor!=void 0||t.italic!=void 0||t.bold!=void 0){H[l]=o;o++;w.push(t)}}}for(var u=w.length>0,o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD"],F=o[h.length+g.columns.length-1]+(r.length+1+2),t=g.colConditions.length+
2,l=g.colConditions.length>0?g.colConditions.length:1,r=0;r<g.formulaInfo.measureFormula.length;r++);r=g.GeneralDataRows;if(g.autoPaging)r=g.RowsWhenMoveToFilter;if(g.columns.length<0){for(var t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+gx.getMessage("GXPL_QViewerJSValue")+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" rowHeaderCaption="Make"  xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><location ref="A1:'+
F+'" firstHeaderRow="1" firstDataRow="'+t+'" firstDataCol="'+l+'"/><pivotFields>',B=[],F=[],E=-1,z=0,x=-1,y=0,l=0;l<g.columns.length;l++){v="axisRow";if(g.rowConditions.findIndex(l)!=-1){v="axisRow";E++;z=l}else if(g.colConditions.findIndex(l)!=-1){v="axisCol";x++;y=l}else{v="axisRow";E++;z=l}var C="",I='<item t="default"/>',t=t+'<pivotField axis="'+v+'" showAll="0" '+C+"><items>",K,W;if(g.conditions[l].distinctValues!=void 0){K=[];W=[];for(C=0;C<g.conditions[l].distinctValues.length;C++){K.push(cleanDistinctValue(g.conditions[l].distinctValues[C],
g));var U="";if(g.conditions[l].blackList.findIndex(g.conditions[l].distinctValues[C])!=-1){U=' h="1"';W.push(cleanDistinctValue(g.conditions[l].distinctValues[C],g))}t=t+'<item x="'+C+'" '+U+" />"}t=t+I+"</items></pivotField>"}F[l]=K;B.push(l)}for(l=0;l<h.length;l++){t=t+'<pivotField dataField="1" showAll="0"/>';B.push(cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name")))}t=t+"</pivotFields><rowFields>";for(l=0;l<g.columns.length;l++)if(g.rowConditions.findIndex(l)!=-1||
g.filterIndexes.findIndex(l)!=-1)t=t+'<field x="0"/>';for(var t=t+"</rowFields><rowItems>",O=0;O<g.rowStructure.items.length;O++)t=t+createExcelROWITEMS(g.rowStructure.items[O],E,F,z,E);t=t+'<i t="grand"><x/></i></rowItems>';if(x>-1||h.length>1){t=t+"<colFields>";for(l=0;l<g.columns.length;l++)if(g.colConditions.findIndex(l)!=-1){v=B.indexOf(l);t=t+'<field x="'+v+'"/>'}h.length>1&&(t=t+'<field x="-2"/>');t=t+"</colFields>"}t=t+"<colItems>";if(g.colStructure.items)for(O=0;O<g.colStructure.items.length;O++)t=
t+createExcelCOLITEMS(g.colStructure.items[O],x,F,y,x);else for(l=0;l<h.length;l++)t=t+"<i/>";t=t+"</colItems><dataFields>";for(l=0;l<h.length;l++)t=t+'<dataField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" fld="'+(l+g.columns.length)+'"/>';t=t+"</dataFields>";if(u){t=t+"<formats>";for(l=0;l<g.columns.length;l++)if(A[l]>0){t=t+'<format dxfId="'+A[l]+'"><pivotArea dataOnly="0" labelOnly="1" fieldPosition="0"><references ><reference field="0">';if(g.conditions[l].distinctValues!=
void 0)for(C=0;C<g.conditions[l].distinctValues.length;C++)t=t+'<x v="'+C+'"/>';t=t+"</reference></references></pivotArea></format>"}for(O=0;O<h.length;O++)if(H[O]>0){t=t+'<format dxfId="'+H[O]+'">';t=t+'<pivotArea  fieldPosition="0">';t=t+"<references>";t=t+'<reference field="4294967294" selected="0">';t=t+'<x v="'+O+'"/></reference>';t=t+'<reference field="0">';for(n=0;n<g.rowStructure.items.length;n++)t=t+'<x v="'+n+'"/>';t=t+"</reference>";t=t+"</references></pivotArea>";t=t+"</format>"}t=t+"</formats>"}t=
t+'<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/></pivotTableDefinition>';n='<dxf><font><color rgb="FFCCCCCC" /></font></dxf>';if(u)for(O=0;O<w.length;O++){n=n+"<dxf><font>";w[O].bold!=void 0&&(n=n+"<b/>");w[O].italic!=void 0&&(n=n+"<i/>");w[O].fontColor!=void 0&&(n=n+'<color rgb="FF'+w[O].fontColor+'"/>');n=n+"</font></dxf>"}O=n;for(w=0;w<r.length;w++){for(l=0;l<g.columns.length;l++)F[l].indexOf(r[w][l]);
for(l=0;l<h.length;l++){v=g.columns.length+l;A=g.defaultPictureValue(r[w][v],l==h.length-1,l);A=removeComas(A,g);A=cleanDistinctValue(A,g)}}var J;J='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><pivotCacheDefinition r:id="rId1" refreshOnLoad="1" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><cacheSource type="worksheet"><worksheetSource ref="A1:'+o[g.columns.length+h.length-1]+(r.length+1)+
'" sheet="SourceData"/>';J=J+'</cacheSource><cacheFields count="'+(g.columns.length+h.length)+'">';for(l=0;l<g.columns.length;l++){J=J+'<cacheField name="'+cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name"))+'" numFmtId="0">';J=J+'<sharedItems count="'+g.conditions[l].distinctValues.length+'">';for(C=0;C<g.conditions[l].distinctValues.length;C++)J=J+'<s v="'+cleanDistinctValue(g.conditions[l].distinctValues[C],g)+'"/>';J=J+"</sharedItems>";J=J+"</cacheField>"}for(l=
0;l<h.length;l++){J=J+'<cacheField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" numFmtId="0">';J=J+"<sharedItems/>";J=J+"</cacheField>"}J=J+"</cacheFields></pivotCacheDefinition>";q='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><dimension ref="A1:'+o[g.columns.length+h.length-1]+(r.length+
1)+'"/><sheetViews><sheetView workbookViewId="0"/></sheetViews><sheetData>';K=1;F=0;q=q+'<row r="'+K+'" span="1:3">';for(l=0;l<g.columns.length;l++){q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name"))+"</t></is>";q=q+"</c>";F++}for(l=0;l<h.length;l++){q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+"</t></is>";q=q+"</c>";
F++}q=q+"</row>";for(w=0;w<r.length;w++){F=0;K++;q=q+'<row r="'+K+'" span="1:3">';for(l=0;l<g.columns.length;l++){v=g.conditions[l].dataRowPosition;A=cleanDistinctValue(r[w][v],g);q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+A+"</t></is>";q=q+"</c>";F++}for(l=0;l<h.length;l++){v=g.columns.length+l;A=g.defaultPictureValue(r[w][v],l==h.length-1,l);A=removeComas(A,g);A=cleanDistinctValue(A);if(h[l].getAttribute("dataType")==="real"||h[l].getAttribute("dataType")==="integer"){q=q+'<c r="'+o[F]+
K+'">';q=q+"<v>"+A+"</v>"}else{q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+A+"</t></is>"}q=q+"</c>";F++}q=q+"</row>"}h=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:J,pivotTable1:t,Sheet2:q+"</sheetData></worksheet>",style:n,dfx:O,worksheets:[{data:dataTable,name:"Sheet 1"}]});if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.location=h.href();else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){g=atob(h.base64);r=function(c){return c.charCodeAt(0)};
g=Array.prototype.map.call(g,r);g=new Uint8Array(g);g=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(g,c+".xlsx")}else return h.base64}else{t=g.colConditions.length+1;l=g.colConditions.length>0?g.colConditions.length:1;g.filterIndexes.length>0&&g.rowConditions.length+1==h.length&&(l=0);if(g.rowConditions.length+g.filterIndexes.length==0)l=t=1;o="1";F="";if(g.filterIndexes.length>0){t=t+g.filterIndexes.length;F=' rowPageCount="'+g.filterIndexes.length+
'\'" colPageCount="1" ';o=t+1}w="";if(g.rowConditions.length>0){v=g.rowConditions[0];g.columns.length>v&&(w=' rowHeaderCaption="'+cleanDistinctValue(g.columns[v].getAttribute("displayName"),g,g.columns[v].getAttribute("name"))+'" ')}if(g.colConditions.length>0){v=g.colConditions[0];g.columns.length>v&&(w=w+' colHeaderCaption="'+cleanDistinctValue(g.columns[v].getAttribute("displayName"),g,g.columns[v].getAttribute("name"))+'" ')}t='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<pivotTableDefinition name="Tabla dinamica1" cacheId="5" dataCaption="'+
gx.getMessage("GXPL_QViewerJSValue")+'" createdVersion="3" updatedVersion="3" minRefreshableVersion="3" applyNumberFormats="0" applyBorderFormats="0" applyFontFormats="0" applyPatternFormats="0" applyAlignmentFormats="0" applyWidthHeightFormats="1" showCalcMbrs="0" useAutoFormatting="1" itemPrintTitles="1" indent="0" outline="1" outlineData="1" multipleFieldFilters="0" '+w+'   xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">\n<location ref="A'+o+'" firstHeaderRow="1" firstDataRow="'+
t+'" firstDataCol="'+l+'" '+F+"/>\n<pivotFields>\n";B=[];F=[];if(g.formulaInfo.cantFormulaMeasures==0)for(l=0;l<h.length;l++){O=163;h[l].getAttribute("picture")!=""&&(O=164+l);t=t+'<pivotField dataField="1" showAll="0"  numFmtId="'+O+'"/>\n';B.push(cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name")))}E=-1;z=0;x=-1;for(w=y=0;w<g.filterIndexes.length;w++){l=g.filterIndexes[w];v="axisPage";C='numFmtId="163"';I='<item t="default"/>\n';t=t+'<pivotField axis="'+v+'" showAll="0" '+
C+" >\n<items>\n";if(g.conditions[l].distinctValues!=void 0){K=[];W=[];o=g.conditions[l].distinctValues;for(C=v=0;C<o.length;C++)if(!(o[C]==""&&o.findIndex("#NuN#")!=-1)){K.push(cleanDistinctValue(o[C],g));U="";if(g.conditions[l].blackList.findIndex(o[C])!=-1){U=' h="1"';W.push(cleanDistinctValue(o[C],g))}t=t+'<item x="'+v+'" '+U+" />\n";v=v+1}t=t+I+"</items>\n</pivotField>\n"}F[l]=K;B.push(l)}for(l=0;l<g.columns.length;l++)if(g.filterIndexes.indexOf(l)==-1){v="axisRow";if(g.rowConditions.findIndex(l)!=
-1||g.rowConditions.length+g.filterIndexes.length==0){v="axisRow";E++;z=l}else if(g.colConditions.findIndex(l)!=-1){v="axisCol";x++;y=l}else v="axisPage";C='numFmtId="163"';I='<item t="default"/>\n';t=t+'<pivotField axis="'+v+'" showAll="0" '+C+" >\n<items>\n";if(g.conditions[l].distinctValues!=void 0){K=[];W=[];o=g.conditions[l].distinctValues;for(C=v=0;C<o.length;C++)if(!(o[C]==""&&o.findIndex("#NuN#")!=-1)){K.push(cleanDistinctValue(o[C],g));U="";if(g.conditions[l].blackList.findIndex(o[C])!=-1){U=
' h="1"';W.push(cleanDistinctValue(o[C],g))}t=t+'<item x="'+v+'" '+U+" />";v=v+1}t=t+I+"</items>\n</pivotField>\n"}F[l]=K;B.push(l)}if(g.formulaInfo.cantFormulaMeasures>0){for(l=0;l<h.length;l++){O=163;h[l].getAttribute("picture")!=""&&(O=164+l);if(!g.formulaInfo.measureFormula[l].hasFormula){t=t+'<pivotField dataField="1" showAll="0"  numFmtId="'+O+'"/>\n';B.push(cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name")))}}for(l=0;l<q.length;l++)t=t+'<pivotField showAll="0" defaultSubtotal="0"/>\n';
for(l=0;l<h.length;l++)g.formulaInfo.measureFormula[l].hasFormula&&(t=t+'<pivotField dataField="1" dragToRow="0" dragToCol="0" dragToPage="0" showAll="0" defaultSubtotal="0" numFmtId="'+O+'"/>\n')}t=t+"</pivotFields>\n";if(g.rowConditions.length+1!=h.length){t=t+"<rowFields>\n";for(l=0;l<g.columns.length;l++)if(g.rowConditions.findIndex(l)!=-1||g.rowConditions.length+g.filterIndexes.length==0){v=B.indexOf(l);t=t+'<field x="'+v+'"/>\n'}t=t+"</rowFields>\n"}t=t+"<rowItems>\n";for(O=0;O<g.rowStructure.items.length;O++)t=
t+createExcelROWITEMS(g.rowStructure.items[O],E,F,z,E);t=t+'<i t="grand"><x/></i>\n</rowItems>\n';if(x>-1||h.length>1){t=t+"<colFields>\n";for(l=0;l<g.columns.length;l++)if(g.colConditions.findIndex(l)!=-1&&g.rowConditions.length+g.filterIndexes.length!=0){v=B.indexOf(l);t=t+'<field x="'+v+'"/>\n'}h.length>1&&(t=t+'<field x="-2"/>\n');t=t+"</colFields>\n"}t=t+"<colItems>\n";if(g.colStructure.items&&g.rowConditions.length+g.filterIndexes.length!=0)for(O=0;O<g.colStructure.items.length;O++)t=t+createExcelCOLITEMS(g.colStructure.items[O],
x,F,y,x);else for(l=0;l<h.length;l++)t=t+"<i/>\n";t=t+"</colItems>\n";if(g.filterIndexes.length>0){t=t+"<pageFields>\n";for(O=0;O<g.filterIndexes.length;O++)t=t+'<pageField fld="'+(h.length+O)+'" hier="-1"/>\n';t=t+"</pageFields>\n"}t=t+"<dataFields>\n";for(l=o=K=0;l<h.length;l++){O=163;h[l].getAttribute("picture")!=""&&(O=164+l);if(g.formulaInfo.measureFormula[l].hasFormula){K++;O=163;h[l].getAttribute("picture")!=""&&(O=164+l);if(g.formulaInfo.measureFormula[l].hasFormula)if(h[l].getAttribute("displayName").indexOf("%")>
-1){for(w=0;w<l;w++)J=J+" ";t=t+'<dataField name="'+h[l].getAttribute("displayName")+J+' " fld="'+(l+g.columns.length+q.length)+'" numFmtId="'+O+'" baseField="0" baseItem="0"/>\n'}else{for(w=A=v=0;w<g.formulaInfo.measureFormula.length;w++)g.formulaInfo.measureFormula[w].hasFormula?v=v+g.formulaInfo.measureFormula[w].relatedMeasures.length:A++;w=v+A+g.columns.length+o;t=t+'<dataField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+' " fld="'+w+'" numFmtId="'+
O+'" baseField="0" baseItem="0"/>\n';o++}}else{v=0;g.formulaInfo.cantFormulaMeasures>0&&(v=g.columns.length-K);J="";if(h[l].getAttribute("displayName").indexOf("%")>-1){for(w=0;w<l;w++)J=J+" ";t=t+'<dataField name="'+h[l].getAttribute("displayName")+J+'" fld="'+(l+v)+'" subtotal="'+h[l].getAttribute("aggregation")+'" numFmtId="'+O+'"/>\n'}else t=t+'<dataField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" fld="'+(l+v)+'" subtotal="'+h[l].getAttribute("aggregation")+
'" numFmtId="'+O+'"/>\n'}}t=t+'</dataFields>\n<pivotTableStyleInfo name="PivotStyleLight16" showRowHeaders="1" showColHeaders="1" showRowStripes="0" showColStripes="0" showLastColumn="1"/>\n</pivotTableDefinition>\n';for(w=0;w<r.length;w++){for(l=0;l<g.columns.length;l++)F[l].indexOf(cleanDistinctValue(r[w][l],g));for(l=0;l<h.length;l++){v=g.columns.length+l;A=g.defaultPictureValue(r[w][v],l==h.length-1,l);A=removeComas(A,g);A=cleanDistinctValue(A,g)}}o=["A","B","C","D","E","F","G","H","I","J","K",
"L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD"];J='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<pivotCacheDefinition r:id="rId1" refreshOnLoad="1" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">\n<cacheSource type="worksheet">\n<worksheetSource ref="A1:'+o[g.columns.length+h.length-1-g.formulaInfo.cantFormulaMeasures+q.length]+(r.length+1)+'" sheet="SourceData"/>\n';
J=J+'</cacheSource>\n<cacheFields count="'+(g.columns.length+h.length+q.length)+'">\n';if(g.formulaInfo.cantFormulaMeasures==0)for(l=0;l<h.length;l++){J=J+'<cacheField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" numFmtId="0">\n';J=J+"<sharedItems/>\n";J=J+"</cacheField>\n"}for(w=0;w<g.filterIndexes.length;w++){l=g.filterIndexes[w];O="";for(C=0;C<g.GeneralDistinctValues[l].length;C++)if(!isNaN(g.GeneralDistinctValues[l][C])){O=' containsMixedTypes="1" containsString="1" containsNumber="1" containsInteger="1" ';
break}if(O!=""){K=true;for(C=0;C<g.GeneralDistinctValues[l].length;C++)if(isNaN(g.GeneralDistinctValues[l][C])){K=false;break}K&&(O=' containsSemiMixedTypes="0" containsString="0" containsNumber="1" containsInteger="1" ')}J=J+'<cacheField name="'+cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name"))+'" numFmtId="0">\n';J=J+"<sharedItems "+O+' count="'+g.GeneralDistinctValues[l].length+'">\n';for(C=0;C<g.GeneralDistinctValues[l].length;C++)J=isNaN(g.GeneralDistinctValues[l][C])?
J+'<s v="'+cleanDistinctValue(g.GeneralDistinctValues[l][C],g)+'"/>\n':J+'<n v="'+cleanDistinctValue(g.GeneralDistinctValues[l][C],g)+'"/>\n';J=J+"</sharedItems>\n";J=J+"</cacheField>\n"}for(l=0;l<g.columns.length;l++)if(g.filterIndexes.indexOf(l)==-1){J=J+'<cacheField name="'+cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name"))+'" numFmtId="0">\n';J=J+'<sharedItems count="'+g.conditions[l].distinctValues.length+'">\n';for(C=0;C<g.conditions[l].distinctValues.length;C++)J=
J+'<s v="'+cleanDistinctValue(g.conditions[l].distinctValues[C],g)+'"/>\n';J=J+"</sharedItems>\n";J=J+"</cacheField>\n"}if(g.formulaInfo.cantFormulaMeasures>0){for(l=0;l<h.length;l++)if(!g.formulaInfo.measureFormula[l].hasFormula){J=J+'<cacheField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" numFmtId="165">\n';J=J+"<sharedItems/>\n";J=J+"</cacheField>\n"}for(l=0;l<q.length;l++)J=J+'<cacheField name="'+n(g,q[l])+'" numFmtId="0">\n</cacheField>\n';for(l=
0;l<h.length;l++)g.formulaInfo.measureFormula[l].hasFormula&&(J=J+'<cacheField name="'+cleanDistinctValue(h[l].getAttribute("displayName"),g,h[l].getAttribute("name"))+'" numFmtId="165" formula="'+g.formulaInfo.measureFormula[l].textFormula+'" databaseField="0"/>\n')}J=J+"</cacheFields>\n</pivotCacheDefinition>\n";q='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><dimension ref="A1:'+
o[g.columns.length+h.length-1]+(r.length+1)+'"/><sheetViews><sheetView workbookViewId="0"/></sheetViews><sheetData>';K=1;F=0;q=q+'<row r="'+K+'" span="1:3">';for(l=0;l<g.columns.length;l++){q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+cleanDistinctValue(g.columns[l].getAttribute("displayName"),g,g.columns[l].getAttribute("name")).trimpivot()+"</t></is>";q=q+"</c>";F++}for(l=0;l<h.length;l++){q=q+'<c t="inlineStr" r="'+o[F]+K+'">';q=q+"<is><t>"+cleanDistinctValue(h[l].getAttribute("displayName"),
g,h[l].getAttribute("name")).trimpivot()+"</t></is>";q=q+"</c>";F++}q=q+"</row></sheetData></worksheet>";n="<numFmts>";r=false;for(g=0;g<h.length;g++)if(h[g].getAttribute("picture")!=""){r=h[g].getAttribute("picture");O=164+g;q="";for(K=0;K<r.length;K++)q=r[K]=="Z"?q+"#":r[K]=="9"?q+"0":r[K]=="."||r[K]==","?q+r[K]:q+"\\"+r[K];n=n+'<numFmt formatCode="'+q+'" numFmtId="'+O+'"/>';r=true}h=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:true,pivotCacheDefinition:J,pivotTable1:t,Sheet2:"",style:r?
n+"</numFmts>":"",worksheets:[{data:dataTable,name:"Sheet 1"}]})}if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.location=h.href();else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){g=atob(h.base64);r=function(c){return c.charCodeAt(0)};g=Array.prototype.map.call(g,r);g=new Uint8Array(g);g=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});saveAs(g,c+".xlsx")}else return h.base64}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Dialog=function(c,g,h){var j=this,k={width:0,height:0,modal:0,onshow:function(){},onhide:function(){},zIndex:1E3,buttons:1,resize:1,close:1,autoEnter:1,imagePath:OAT.Preferences.imagePath};if(h)for(var m in h)k[m]=h[m];var n=new OAT.Window({close:k.close,max:0,min:0,width:k.width,height:k.height,x:0,y:0,title:c,resize:k.resize,imagePath:k.imagePath});OAT.Dom.hide(n.div);try{OAT.$(g).style.margin="10px"}catch(l){}c=OAT.Dom.create("table",
{marginTop:"1em",width:"90%",textAlign:"center"});h=OAT.Dom.create("tbody");m=OAT.Dom.create("tr");var o=OAT.Dom.create("td",{border:"none"}),q=OAT.Dom.create("input");q.setAttribute("type","button");q.value=" OK ";o.appendChild(q);var r=OAT.Dom.create("input",{marginLeft:"2em"});r.setAttribute("type","button");r.value="Cancel";o.appendChild(r);m.appendChild(o);h.appendChild(m);c.appendChild(h);k.buttons&&OAT.$(g).appendChild(c);document.body.appendChild(n.div);n.content.appendChild(OAT.$(g));n.div.style.zIndex=
k.zIndex;k.modal?(this.show=function(){OAT.Dimmer.show(n.div,{});n.accomodate();OAT.Dom.center(n.div,1,1);k.onshow()},this.hide=function(){OAT.Dimmer.hide();k.onhide()}):(this.show=function(){OAT.Dom.show(n.div);n.accomodate();OAT.Dom.center(n.div,1,1);k.onshow()},this.hide=function(){OAT.Dom.hide(n.div);k.onhide()});n.onclose=this.hide;this.accomodate=n.accomodate;this.ok=function(){};this.cancel=function(){};this.okBtn=q;this.cancelBtn=r;OAT.Dom.attach(q,"click",function(){j.ok()});OAT.Dom.attach(r,
"click",function(){j.cancel()});g=function(c){"disabled"!=j.okBtn.getAttribute("disabled")&&(13==c.keyCode&&j.ok(),27==c.keyCode&&j.cancel())};k.autoEnter&&OAT.Dom.attach(n.div,"keypress",g)};try{OAT.Loader.featureLoaded("dialog")}catch(ERROR){}OAT.Drag={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,elm:!1,mouse_x:0,mouse_y:0,move:function(c){function g(c,g){return Math.abs(c-g)<=r}if(OAT.Drag.elm){OAT.Dom.removeSelection();var h=OAT.Dom.getViewport(),j=OAT.Dom.position(OAT.Drag.elm);OAT.Dom.eventPos(c);OAT.Dom.getWH(OAT.Drag.elm);
if(!(c.clientX>h[0]||0>c.clientX||c.clientY>h[1]||0>c.clientY)){for(var h=c.clientX-OAT.Drag.mouse_x,k=c.clientY-OAT.Drag.mouse_y,m=!0,n=OAT.Drag.elm._Drag_movers,l=0;l<n.length;l++){var j=n[l][0],o=n[l][1],j=OAT.Dom.getLT(j);o.restrictionFunction(j[0]+h,j[1]+k)&&(m=!1)}for(var q=!0,r=10,l=0;l<n.length;l++){for(var j=n[l][0],o=n[l][1],t=OAT.Dom.getWH(j),w=OAT.Dom.position(j),v=w[0]+h,w=w[1]+k,A=0;A<o.magnetsH.length;A++){var F=OAT.$(o.magnetsH[A]),H=OAT.Dom.position(F),F=OAT.Dom.getWH(F);if(g(v,H[0])){j.style.left=
H[0]+"px";q=!1;break}if(g(v+t[0],H[0])){j.style.left=H[0]-t[0]+"px";q=!1;break}if(g(v,H[0]+F[0])){j.style.left=H[0]+F[0]+"px";q=!1;break}if(g(v+t[0],H[0]+F[0])){j.style.left=H[0]+F[0]-t[0]+"px";q=!1;break}}for(A=0;A<o.magnetsV.length;A++){F=OAT.$(o.magnetsV[A]);H=OAT.Dom.position(F);F=OAT.Dom.getWH(F);if(g(w,H[1])){j.style.top=H[1]+"px";q=!1;break}if(g(w+t[1],H[1])){j.style.top=H[1]-t[1]+"px";q=!1;break}if(g(w,H[1]+F[1])){j.style.top=H[1]+F[1]+"px";q=!1;break}if(g(w+t[1],H[1]+F[1])){j.style.top=H[1]+
F[1]-t[1]+"px";q=!1;break}}}if(m&&q){for(l=0;l<n.length;l++)if(j=n[l][0],o=n[l][1],o.moveFunction)o.moveFunction(h,k);else switch(o.type){case OAT.Drag.TYPE_X:OAT.Dom.moveBy(j,h,0);break;case OAT.Drag.TYPE_Y:OAT.Dom.moveBy(j,0,k);break;case OAT.Drag.TYPE_XY:OAT.Dom.moveBy(j,h,k)}OAT.Drag.mouse_x=c.clientX;OAT.Drag.mouse_y=c.clientY}}}},up:function(){if(OAT.Drag.elm){for(var c=OAT.Drag.elm._Drag_movers,g=0;g<c.length;g++)c[g][1].endFunction(c[g][0]);OAT.Drag.elm=!1}},create:function(c,g,h){var j={type:OAT.Drag.TYPE_XY,
restrictionFunction:function(){return!1},endFunction:function(){},moveFunction:!1,magnetsH:[],magnetsV:[],cursor:!0};if(h)for(p in h)j[p]=h[p];var k=OAT.$(c),c=OAT.$(g),g=function(c){OAT.Drag.initiate(c,k)};k._Drag_movers||(OAT.Dom.attach(k,"mousedown",g),k._Drag_movers=[],k._Drag_cursor=k.style.cursor);j.cursor&&(k.style.cursor="move");k._Drag_movers.push([c,j])},initiate:function(c,g){OAT.Drag.elm=g;OAT.Drag.mouse_x=c.clientX;OAT.Drag.mouse_y=c.clientY},remove:function(c,g){var h=OAT.$(c);OAT.$(g);
if(h._Drag_movers){for(var j=-1,k=0;k<h._Drag_movers.length;k++)h._Drag_movers[k][0]==g&&(j=k);-1!=j&&h._Drag_movers.splice(j,1)}},removeAll:function(c){c=OAT.$(c);c._Drag_movers&&(c._Drag_movers=[],c.style.cursor=c._Drag_cursor)},createDefault:function(c,g){if(OAT.Preferences.allowDefaultDrag){var h=OAT.$(c),j=OAT.Dom.create("div",{position:"absolute",width:"21px",height:"21px",backgroundImage:"url("+OAT.Preferences.imagePath+"drag.png)"}),k=OAT.Dom.getLT(h);j.style.left=k[0]-21+"px";j.style.top=
k[1]-21+"px";if(g){h.parentNode.appendChild(j);k=function(c,g){var j=OAT.Dom.getWH(h),k=OAT.Dom.getWH(h.parentNode),m=c+j[0],j=g+j[1];return 20>c||20>g||m>k[0]||j>k[1]};OAT.Drag.create(j,j);OAT.Drag.create(j,h,{restrictionFunction:k});OAT.Dom.hide(j);var m=function(){j._Drag_pending&&OAT.Dom.hide(j)};OAT.Dom.attach(h,"mouseover",function(){OAT.Dom.show(j);j._Drag_pending=0});OAT.Dom.attach(h,"mouseout",function(){j._Drag_pending=1;setTimeout(m,3E3)})}else k=function(c,g){var j=OAT.Dom.getWH(h),k=
OAT.Dom.getWH(h.parentNode),m=c+j[0],j=g+j[1];return 0>c||0>g||m>k[0]||j>k[1]},OAT.Drag.create(h,h,{restrictionFunction:k})}}};OAT.Dom.attach(document,"mousemove",OAT.Drag.move);OAT.Dom.attach(document,"mouseup",OAT.Drag.up);try{OAT.Loader.featureLoaded("drag")}catch(ERROR$$1){}OAT.GhostDragData={lock:!1,up:function(c){if(OAT.GhostDragData.lock){var g=OAT.GhostDragData.lock,h=g.object;if(h.pending)h.pending=0,OAT.GhostDragData.lock=!1;else{OAT.GhostDragData.lock=!1;for(var j=OAT.Dom.eventPos(c),c=
j[0],j=j[1],k=0,m=0;m<h.targets.length;m++){var n=h.targets[m],l=n[1]?n[1](c,j):OAT.GhostDragData.pos(n[0],c,j);!k&&l&&(k=1,h.callback(n[0],c,j))}k?(OAT.Dom.unlink(g),OAT.MSG.send(h,OAT.MSG.GD_END,g)):(OAT.MSG.send(h,OAT.MSG.GD_ABORT,g),h.onFail(),h=OAT.Dom.position(h.originalElement),c=h[0],j=h[1],h=new OAT.AnimationPosition(g,{speed:10,delay:10,left:c,top:j}),OAT.MSG.attach(h.animation,OAT.MSG.ANIMATION_STOP,function(){OAT.Dom.unlink(g)}),h.start())}}},move:function(c){if(OAT.GhostDragData.lock){var g=
OAT.GhostDragData.lock,h=g.object;h.pending&&(document.body.appendChild(g),g.style.zIndex=2E3,h.process&&h.process(g),h.pending=0,OAT.MSG.send(h,OAT.MSG.GD_START,g));OAT.Dom.removeSelection();var j=c.clientX-g.mouse_x,h=c.clientY-g.mouse_y,j=parseInt(OAT.Dom.style(g,"left"))+j,h=parseInt(OAT.Dom.style(g,"top"))+h;g.style.left=j+"px";g.style.top=h+"px";g.mouse_x=c.clientX;g.mouse_y=c.clientY}},pos:function(c,g,h){if(!c||"none"==c.style.display.toLowerCase())return 0;var j=OAT.Dom.position(c),k=j[0]-
2,j=j[1]-2,m=parseInt(c.offsetWidth)+2,c=parseInt(c.offsetHeight)+2;return g>=k&&g<=k+m&&h>=j&&h<=j+c}};OAT.GhostDrag=function(){var c=this;this.onFail=function(){};this.sources=[];this.processes=[];this.callbacks=[];this.targets=[];this.pending=0;this.addSource=function(g,h,j){var k=OAT.$(g);c.sources.push(k);c.processes.push(h);c.callbacks.push(j);OAT.Dom.attach(k,"mousedown",function(g){OAT.Dom.prevent(g);var h=c.sources.findIndex(k);-1!=h&&c.startDrag(c.sources[h],c.processes[h],c.callbacks[h],
g.clientX,g.clientY)})};this.delSource=function(g){g=$(g);g=c.sources.findIndex(g);-1!=g&&(c.sources.splice(g,1),c.processes.splice(g,1),c.callbacks.splice(g,1))};this.clearSources=function(){c.sources=[];c.processes=[];c.callbacks=[]};this.addTarget=function(g,h,j){g=[OAT.$(g),h,j];c.targets.length&&c.targets[c.targets.length-1][2]?c.targets.splice(c.targets.length-1,0,g):c.targets.push(g)};this.delTarget=function(g){for(var g=OAT.$(g),h=-1,j=0;j<c.targets.length;j++)c.targets[j][0]==g&&(h=j);-1!=
h&&c.targets.splice(h,1)};this.clearTargets=function(){c.targets=[]};this.startDrag=function(g,h,j,k,m){OAT.GhostDragData.lock||(c.pending=1,c.originalElement=g,c.callback=j,j=OAT.Dom.create("div",{position:"absolute"}),c.process=h,h=OAT.Dom.position(g),j.style.left=h[0]+"px",j.style.top=h[1]+"px",OAT.Style.opacity(j,0.5),j.appendChild(g.cloneNode(!0)),j.mouse_x=k,j.mouse_y=m,j.object=c,OAT.GhostDragData.lock=j)}};OAT.Dom.attach(document,"mousemove",OAT.GhostDragData.move);OAT.Dom.attach(document,
"mouseup",OAT.GhostDragData.up);try{OAT.Loader.featureLoaded("ghostdrag")}catch(ERROR$$2){}OAT.Instant=function(c,g){var h=this;this.options={showCallback:!1,hideCallback:!1};for(var j in g)h.options[j]=g[j];this.state=1;this.elm=OAT.$(c);this.handles=[];this.hide=function(){h.state=0;OAT.Dom.hide(h.elm)};this.show=function(){h.options.showCallback&&h.options.showCallback();OAT.Dom.show(h.elm);h.state=1};this.check=function(c){h.state&&(c=OAT.Event.source(c),c==h.elm||OAT.Dom.isChild(c,h.elm)||(h.options.hideCallback&&
h.options.hideCallback(),h.hide()))};this.createHandle=function(c){var g=OAT.$(c);h.handles.push(g);OAT.Event.attach(g,"mousedown",function(c){-1!=h.handles.findIndex(g)&&!h.state&&(OAT.Event.cancel(c),h.show())})};this.removeHandle=function(c){c=OAT.$(c);c=h.handles.findIndex(c);-1!=c&&h.handles.splice(c,1)};h.elm._Instant_show=h.show;h.elm._Instant_hide=h.hide;h.hide();OAT.Dom.attach(document,"mousedown",h.check)};OAT.Instant.assign=function(c,g){new OAT.Instant(c,{hideCallback:g})};try{OAT.Loader.featureLoaded("instant")}catch(ERROR$$3){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.GridData={dragging:!1,resizing:!1,index:0,x:0,w:0,forbidSort:0,LIMIT:15,ALIGN_CENTER:1,ALIGN_LEFT:2,ALIGN_RIGHT:3,SORT_NONE:1,SORT_ASC:2,SORT_DESC:3,TYPE_STRING:1,TYPE_NUMERIC:2,TYPE_AUTO:3,up:function(){if(OAT.GridData.resizing){var c=OAT.GridData.resizing;OAT.GridData.resizing=!1;c.header.cells[OAT.GridData.index].changeWidth(OAT.GridData.w);for(var g=0;g<c.rows.length;g++)c.rows[g].cells[OAT.GridData.index].changeWidth(OAT.GridData.w);
OAT.Dom.unlink(c.tmp_resize);OAT.Dom.unlink(c.tmp_resize_start);OAT.GridData.forbidSort=1;setTimeout(function(){OAT.GridData.forbidSort=0},100)}if(OAT.GridData.dragging&&(c=OAT.GridData.dragging,OAT.GridData.dragging=!1,c.tmp_drag)){for(var h=-1,g=0;g<c.header.cells.length;g++)c.header.cells[g].signal&&(h=g,c.header.cells[g].signalEnd());if(-1!=h){var j=OAT.GridData.index;c.header.cells[j].html.parentNode.insertBefore(c.header.cells[j].html,c.header.cells[h].html);var k=c.header.cells[j];c.header.cells.splice(j,
1);var m=j<h?h-1:h;c.header.cells.splice(m,0,k);j=c.columnsDataType.length-1-j;h=c.columnsDataType.length-1-h;m=c.columnsDataType.length-1-m;for(g=0;g<c.rows.length;g++)c.rows[g].cells[j].html.parentNode.insertBefore(c.rows[g].cells[j].html,c.rows[g].cells[h].html),k=c.rows[g].cells[j],c.rows[g].cells.splice(j,1),c.rows[g].cells.splice(m,0,k);for(g=0;g<c.header.cells.length;g++)c.header.cells[g].number=g;OAT.Dom.unlink(c.tmp_drag);OAT.GridData.forbidSort=1;c.options.reorderNotifier&&j!=h&&c.options.reorderNotifier(j,
h);setTimeout(function(){OAT.GridData.forbidSort=0},100)}}},move:function(c){if(OAT.GridData.resizing){OAT.Dom.removeSelection();var g=OAT.GridData.resizing,g=g.tmp_resize,h=OAT.Event.position(c),j=h[0]-OAT.GridData.mouseX,k=OAT.GridData.w+j;k>=OAT.GridData.LIMIT&&(OAT.GridData.w=k,OAT.GridData.x+=j,OAT.GridData.mouseX=h[0],g.style.left=OAT.GridData.x+"px")}if(OAT.GridData.dragging){OAT.Dom.removeSelection();g=OAT.GridData.dragging;g.tmp_drag||(h=g.header.cells[OAT.GridData.index].container,g.tmp_drag=
OAT.Dom.create("div",{position:"absolute",left:"0px",top:"0px",backgroundColor:"#888"}),OAT.Style.opacity(g.tmp_drag,0.5),g.tmp_drag.appendChild(h.cloneNode(!0)),j=OAT.Dom.getWH(g.header.cells[OAT.GridData.index].html),g.tmp_drag.firstChild.style.width=j[0]+"px",h.appendChild(g.tmp_drag),OAT.GridData.w=0);h=OAT.Event.position(c);j=h[0]-OAT.GridData.x;k=OAT.GridData.w+j;g.tmp_drag.style.left=k+"px";OAT.GridData.x=h[0];OAT.GridData.w=k;for(c=0;c<g.header.cells.length;c++){var k=g.header.cells[c],m=
OAT.Dom.position(k.container),j=OAT.Dom.getWH(k.container),m=m[0];OAT.Browser.isIE7&&(m-=OAT.Dom.position(k.container.offsetParent)[0]);if(h[0]>=m&&h[0]<=m+j[0]){if(k.signal)break;for(c=0;c<g.header.cells.length;c++)g.header.cells[c].signal&&g.header.cells[c].signalEnd();k.signalStart()}}}}};OAT.Grid=function(c,g,h,j,k,m,n,l,o,q,r,t,w,v,A,F,H){var u=this;u.controlName=j;u.columnsDataType=m;u.query=k;u.rowsPerPage="";u.columns=n;u.QueryViewerCollection=l;u.InitPageSize=o;u.disableColumnSort=q;u.UcId=
r;u.IdForQueryViewerCollection=t;u.rememberLayout=w;u.serverPaging=v;u.HideDataFilds=A;u.OrderFildsHidden=F;u.TableDataFilds=H;u.conditions=Array(m.length);for(iC=0;iC<m.length;iC++)u.conditions[iC]={blackList:[],sort:1};this.options={autoNumber:!1,allowHiding:!1,rowOffset:0,sortFunc:!1,imagePath:OAT.Preferences.imagePath,reorderNotifier:!1};if("object"==typeof g)for(var B in g)u.options[B]=g[B];else u.options.autoNumber=g;h&&(u.options.allowHiding=!0);c=OAT.$(c);g=document.createElement("div");g.setAttribute("class",
"divIeContainer");c.appendChild(g);this.div=g;this.init=function(){var c=OAT.Dom.create("div");c.setAttribute("class","oatgrid_top_div");c.setAttribute("id",u.controlName+"_grid_top_div");var g=OAT.Dom.create("a");g.href="#";g.innerHTML=gx.getMessage("GXPL_QViewerJSVisibleColumns");g.id="oatGridAnchor";u.div.appendChild(c);u.propPage=OAT.Dom.create("div",{padding:"5px"});var h=function(){},g=function(){};OAT.Dom.makePosition(u.div);u.html=OAT.Dom.create("table");OAT.Dom.addClass(u.html,"oatgrid");
OAT.Dom.setIdPropertyValue(u.html,u.controlName);u.header=new OAT.GridHeader(u);u.rows=[];u.rowBlock=OAT.Dom.create("tbody");OAT.Dom.append([u.div,u.html],[u.html,u.header.html,u.rowBlock]);var j=OAT.Dom.create("div");j.href="#";j.setAttribute("class","exportOptionsAnchor");u.exportPage=OAT.Dom.create("div",{padding:"0px"});OAT.Dom.attach(document,"mousedown",function(c){source=OAT.Event.source(c);for(var g=c=false,h=0;h<jQuery(".oat_winrect_container").length;h++){var j=jQuery(".oat_winrect_container")[h];
if(source!=j&&!OAT.Dom.isChild(source,j))c=true;else{c=false;break}}for(h=0;h<jQuery(".oat_winrect_container").length;h++)jQuery(".oat_winrect_container")[h].style.display!="none"&&(g=true);u.serverPaging&&((source.getAttribute("class")=="oat_winrect_close_b"||!OAT.Dom.isChild(source,j))&&g)&&u.oat_component.resetAllScrollValue(u.UcId);c&&jQuery(".oat_winrect_container").css({display:"none"})});OAT.Anchor.assign(j,{title:" ",content:u.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,
width:"auto",containerQuery:qv.util.GetContainerControlClass(u.QueryViewerCollection[t])+" ExportPopup "});h=function(c){var g=u.header.cells[c].html.style.display!="none",h=OAT.Dom.create("div");h.setAttribute("class",g?"check_item_img":"uncheck_item_img");g=OAT.Dom.create("span");g.innerHTML=" "+u.header.cells[c].value.innerHTML;h.appendChild(g);OAT.Event.attach(h,"click",function(){this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");var g=
u.header.cells[c].html.style.display=="none"?"":"none";u.header.cells[c].html.style.display=g;for(var h=u.columnsDataType.length-1-c,h=c,j=0;j<u.rows.length;j++)u.rows[j].cells[h].html.style.display=g;OAT.saveState({grid:u},false);u.serverPaging&&OAT_JS.grid.setColumnVisibleValue(u.UcId,h,g=="")});return h};g=function(c){c=OAT.Event.position(c);u.exportPage.style.left=c[0]+"px";u.exportPage.style.top=c[1]+"px";u.exportPage.id="exportOptionsContainer";if(gx.util.browser.isIE())u.exportPage.id="exportOptionsContainerGrid";
OAT.Dom.clear(u.exportPage);var c=false,g=document.createElement("div");g.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();c=u.appendExportToXmlOption(g,c);c=u.appendExportToHtmlOption(g,c);c=u.appendExportToPdfOption(g,c);c=u.appendExportToExcelOption(g,c);c=u.appendExportToExcel2010Option(g,c);u.exportPage.appendChild(g);if(u.options.allowHiding){if(c){c=OAT.Dom.create("hr",
{});u.exportPage.appendChild(c)}c=document.createElement("div");c.setAttribute("class","down_container");u.exportPage.appendChild(c);g=document.createElement("span");g.textContent=gx.getMessage("GXPL_QViewerJSVisibleColumns");var j=document.createElement("div");j.setAttribute("class","div_label_win");j.appendChild(g);c.appendChild(j);for(g=u.autoNumber?1:0;g<u.header.cells.length;g++){j=h(g);c.appendChild(j)}}(gx.util.browser.isIPad()||gx.util.browser.isIPhone())&&jQuery(".oat_winrect_close_b").css({backgroundSize:"30px 30px",
height:"30px",width:"30px",right:"-14px",top:"-14px"})};OAT.Event.attach(j,"click",g);c.appendChild(j)};this.appendExportToXmlOption=function(c,g){var h,j=this.query;if(j=="")try{j=u.controlName.substr(4).split("_")[0]}catch(k){}if(u.QueryViewerCollection[u.IdForQueryViewerCollection].ExportToXML){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var l=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",
marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});l.setAttribute("id","divtoxml");h.appendChild(l);l.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");var m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXml");m.htmlFor="pivot_checkbox_restoreview";h.appendChild(m);OAT.Dom.attach(l,"click",function(){u.serverPaging?OAT_JS.grid.getAllDataRowsForExport(u.UcId,{grid:u},j,"xml"):str=OAT.ExportToXML({grid:u},j)})}else{h=document.createElement("div");
h.style.marginBottom="10px";exportXMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXMLButtonSub.setAttribute("id","divtoxml");setTimeout(function(){jQuery("#divtoxml").downloadify({filename:function(){return j+".xml"},data:function(){return OAT.ExportToXML({grid:u})},onComplete:function(){},onCancel:function(){},onError:function(){},swf:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXMLButtonSub);m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXml");m.style.paddingLeft="9px";m.htmlFor="pivot_checkbox_restoreview";h.appendChild(m)}c.appendChild(h);g||(g=true)}return g};this.appendExportToHtmlOption=function(c,g){var h,j=this.query;if(j=="")try{j=u.controlName.substr(4).split("_")[0]}catch(k){}if(u.QueryViewerCollection[u.IdForQueryViewerCollection].ExportToHTML){if(!gx.util.browser.isIE()||
9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var l=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});l.setAttribute("id","divtoxml");h.appendChild(l);l.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");var m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportHtml");m.htmlFor="pivot_checkbox_restoreview";
h.appendChild(m);OAT.Dom.attach(l,"click",function(){u.serverPaging?OAT_JS.grid.getAllDataRowsForExport(u.UcId,u,j,"html"):u.ExportToHtml(u,j)})}else{h=document.createElement("div");h.style.marginBottom="10px";exportHTMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportHTMLButtonSub.setAttribute("id","divtohtml");setTimeout(function(){jQuery("#divtohtml").downloadify({filename:function(){return j+".html"},data:function(){var c=location.href.substr(0,location.href.indexOf(location.pathname))+
gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/css/grid.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" /></STYLE></HEAD>'+jQuery("#"+u.controlName)[0].outerHTML.replace(/display: none;/g,"").replace(/Grid_asc.gif/g,"").replace(/Grid_desc.gif/g,"");return c+"</BODY></HTML>"},onComplete:function(){},onCancel:function(){},onError:function(){},
swf:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportHTMLButtonSub);m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportHtml");m.style.paddingLeft="9px";m.htmlFor="pivot_checkbox_restoreview";h.appendChild(m)}c.appendChild(h);
g||(g=true)}return g};this.ExportToHtml=function(c,g){var h=location.href.substr(0,location.href.indexOf(location.pathname))+gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/css/grid.css"),h='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+h+'" /></STYLE></HEAD>'+jQuery("#"+c.controlName)[0].outerHTML.replace(/visibility: collapse;/g,"").replace(/visibility:collapse;/g,
"").replace(/Grid_asc.gif/g,"").replace(/Grid_desc.gif/g,""),h=h+"</BODY></HTML>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:text/html,"+h);else{h=new Blob([h],{type:"text/html"});saveAs(h,g+".html")}};this.appendExportToPdfOption=function(c,g){var h=this.query;if(h=="")try{h=u.controlName.substr(4).split("_")[0]}catch(j){}var k;if(u.QueryViewerCollection[u.IdForQueryViewerCollection].ExportToPDF){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){k=document.createElement("div");
k.style.marginBottom="10px";exportPDFButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportPDFButtonSub.setAttribute("id","divtoexport");setTimeout(function(){jQuery("#divtoexport").downloadify({filename:function(){return h+".pdf"},data:function(){return btoa(OAT.ExportToPdf({grid:u}))},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),
downloadImage:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:true,append:false})},100);k.appendChild(exportPDFButtonSub);var l=OAT.Dom.create("label");l.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportPdf");l.style.paddingLeft="9px";l.htmlFor="pivot_checkbox_restoreview";k.appendChild(l)}else{k=OAT.Dom.create("div");var m=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",
height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});m.setAttribute("id","divtoxml");k.appendChild(m);m.setAttribute("class","download_file_img");k.setAttribute("class","export_item_div");l=OAT.Dom.create("label");l.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportPdf");l.htmlFor="pivot_checkbox_restoreview";k.appendChild(l);u.serverPaging?OAT.Dom.attach(m,"click",function(){OAT_JS.grid.getAllDataRowsForExport(u.UcId,{grid:u},h,"pdf")}):OAT.Dom.attach(m,
"click",function(){OAT.ExportToPdf({grid:u},h)})}c.appendChild(k);g||(g=true)}return g};this.appendExportToExcelOption=function(c,g){var h=this.query;if(h=="")try{h=u.controlName.substr(4).split("_")[0]}catch(j){}var k;if(u.QueryViewerCollection[u.IdForQueryViewerCollection].ExportToXLS){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){k=OAT.Dom.create("div");var l=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",
cursor:"pointer",boxSizing:"content-box"});l.setAttribute("id","divtoxml");k.appendChild(l);l.setAttribute("class","download_file_img");k.setAttribute("class","export_item_div");var m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXls2003");m.htmlFor="pivot_checkbox_restoreview";k.appendChild(m);OAT.Dom.attach(l,"click",function(){u.serverPaging?OAT_JS.grid.getAllDataRowsForExport(u.UcId,{grid:u},h,"xls"):OAT.ExportToExcel({grid:u},h)})}else{k=document.createElement("div");
k.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id","divtoxls");setTimeout(function(){jQuery("#divtoxls").downloadify({filename:function(){return h+".xls"},data:function(){return OAT.ExportToExcel({grid:u})},onComplete:function(){},onCancel:function(){},onError:function(){},swf:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:true,append:false})},100);k.appendChild(exportXLSButtonSub);m=OAT.Dom.create("label");m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXls2003");m.style.paddingLeft="9px";m.htmlFor="pivot_checkbox_restoreview";k.appendChild(m)}c.appendChild(k);g||(g=true)}return g};this.appendExportToExcel2010Option=function(c,g){var h=this.query;if(h=="")try{h=u.controlName.substr(4).split("_")[0]}catch(j){}var k;
if(u.QueryViewerCollection[u.IdForQueryViewerCollection].ExportToXLSX){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){k=OAT.Dom.create("div");var l=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});l.setAttribute("id","divtoxml");k.appendChild(l);l.setAttribute("class","download_file_img");k.setAttribute("class","export_item_div");var m=OAT.Dom.create("label");
m.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXlsx");m.htmlFor="pivot_checkbox_restoreview";k.appendChild(m);OAT.Dom.attach(l,"click",function(){u.serverPaging?OAT_JS.grid.getAllDataRowsForExport(u.UcId,{grid:u},h,"xlsx"):OAT.ExportToExcel2010({grid:u},h)})}else{k=document.createElement("div");k.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id","divtoxlsx");setTimeout(function(){jQuery("#divtoxlsx").downloadify({filename:function(){return h+
".xlsx"},data:function(){return OAT.ExportToExcel2010({grid:u})},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf"),downloadImage:gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png"),width:21,height:21,transparent:true,append:false})},100);k.appendChild(exportXLSButtonSub);m=OAT.Dom.create("label");m.innerHTML=
gx.getMessage("GXPL_QViewerContextMenuExportXlsx");m.style.paddingLeft="9px";m.htmlFor="pivot_checkbox_restoreview";k.appendChild(m)}c.appendChild(k);g||(g=true)}return g};this.clearData=function(){u.rows=[];OAT.Dom.clear(u.rowBlock)};this.appendHeader=function(c,g,h){h=!h?u.header.cells.length:h;c=u.header.addCell(c,"character",h,g);for(h=0;h<u.header.cells.length;h++)u.header.cells[h].number=h;return c};this.ieFix=function(){for(var c=0;c<u.header.cells.length;c++){var g=u.header.cells[c].html;
OAT.Dom.addClass(g,"hover");OAT.Dom.removeClass(g,"hover");OAT.Dom.getWH(u.header.cells[c].value)}};this.createHeader=function(c,g){u.header.clear();if(u.options.autoNumber){var h=u.header.addCell({value:"&nbsp;#&nbsp;",align:OAT.GridData.ALIGN_CENTER,type:OAT.GridData.TYPE_NUMERIC,draggable:0,sortable:0},"character");OAT.Event.attach(h.html,"click",function(){for(var c=0;c<u.rows.length;c++)u.rows[c].select()})}for(h=0;h<c.length;h++)u.appendHeader(c[h],g[h]);OAT.Browser.isIE&&u.ieFix()};this.createRow=
function(c,g,h,j,k,l,m,n,o,q){var n=!o?u.rows.length:o,t=new OAT.GridRow(u,n);o==n||n==u.rows.length?u.rowBlock.appendChild(t.html):u.rowBlock.insertBefore(t.html,u.rowBlock.childNodes[n]);if(u.options.autoNumber){t.addCell({value:u.options.rowOffset+n+1,align:OAT.GridData.ALIGN_CENTER},g[r]);OAT.Dom.addClass(t.cells[0].html,"index")}OAT.underRecursionStyle=false;for(var r=0;r<c.length;r++)t.addCell(c[r],g[r],h,j[r],k,l,m,r,o,q[r]);u.rows.splice(n,0,t);return t.html};this.loadDifferentValues=function(c,
g){u.conditions[c].differentValue=[];for(var h=0;h<g.length;h++)u.conditions[c].differentValue.push(g[h])};this.removeAllRows=function(){for(var c=u.rows.length,g=0;g<c;g++)u.removeRow(0)};this.removeAllHiddenRows=function(){for(var c=u.rows.length-1;c>0&&u.rows[c].html.style.display=="none";){u.removeRow(c);c--}};this.removeAllCollapseRows=function(){for(var c=u.rows.length-1;c>0&&u.rows[c].html.style.visibility=="collapse";){u.removeRow(c);c--}};this.removeRow=function(c){jQuery(u.rows[c].html).remove();
u.rows.splice(c,1)};this.removeColumn=function(c){u.header.removeColumn(c);for(var g=0;g<u.rows.length;g++)u.rows[g].removeColumn(c)};this.hideColumnHeader=function(c){u.header.cells[c].html.style.display="none"};this.showColumnHeader=function(c){u.header.cells[u.columnsDataType.length-1-c].html.style.display=""};this.sort=function(c,g,h){if(!OAT.GridData.forbidSort)if(u.options.sortFunc)u.options.sortFunc(h,g);else{for(var j=0;j<u.header.cells.length;j++){u.conditions[j].sort=1;u.header.cells[j].changeSort(OAT.GridData.SORT_NONE)}u.conditions[c].sort=
g;u.header.cells[h].changeSort(g);var j=u.header.cells[h].options.type,k,l;switch(g){case OAT.GridData.SORT_ASC:k=1;l=-1;break;case OAT.GridData.SORT_DESC:k=-1;l=1}var g=OAT_JS.grid.gridData[u.UcId].customOrderValues&&OAT_JS.grid.gridData[u.UcId].customOrderValues[c]!=false&&OAT_JS.grid.gridData[u.UcId].customOrderValues[c].length>0,h=function(g,h){var j=g.cells[c].options.value,m=h.cells[c].options.value;return j==m?0:parseFloat(j)>parseFloat(m)?k:l},m=function(g,h){var j=g.cells[c].options.value,
m=h.cells[c].options.value;return j==m?0:j>m?k:l},n=function(g,h){var j=h.cells[c].options.value,m=OAT_JS.grid.gridData[u.UcId].customOrderValues[c].indexOf(g.cells[c].options.value),j=OAT_JS.grid.gridData[u.UcId].customOrderValues[c].indexOf(j);return m==j?0:m>j?k:l},o;if(u.rows.length&&!u.serverPaging){var q=u.rows[0].cells[c].options.value;switch(j){case OAT.GridData.TYPE_STRING:o=m;break;case OAT.GridData.TYPE_NUMERIC:o=h;break;case OAT.GridData.TYPE_AUTO:o=q==parseFloat(q)?h:m}g&&(o=n);u.rows.sort(o);
for(j=0;j<u.rows.length;j++){u.rowBlock.appendChild(u.rows[j].html);o=u.rows[j].html;OAT.Dom.removeClass(o,"WorkWithEven");OAT.Dom.removeClass(o,"WorkWithOdd");OAT.Dom.addClass(u.rows[j].html,j%2?"WorkWithEven":"WorkWithOdd")}}}};this.applySaveState=function(c){if(u.rememberLayout&&u.rememberLayout!="false"){u=this;if(OAT.getState(u,c)){OAT.filterRows(u);for(c=0;c<u.columnsDataType.length;c++)u.conditions[c].sort!=1&&u.sort(c,u.conditions[c].sort,c)}}};this.applySortOrderType=function(c,g){u.sort(c,
g,c)};this.applyCustomSort=function(c,g,h){for(var j=[],k=0;k<g.childNodes.length;k++)if(g.childNodes[k]!=void 0&&g.childNodes[k].localName!=void 0&&g.childNodes[k].localName==="customOrder")for(var l=0;l<g.childNodes[k].childNodes.length;l++)g.childNodes[k].childNodes[l].localName=="Value"&&j.push(g.childNodes[k].childNodes[l].textContent.trimpivot());for(g=0;g<h.length;g++)j.indexOf(h[g][c].trimpivot())==-1&&j.push(h[g][c]);g=h;h=[];for(k=0;k<j.length;k++)for(l=0;l<g.length;l++)g[l][c].trimpivot()===
j[k].trimpivot()&&h.push(g[l]);return[h,j]};this.applyCustomFilter=function(c,g){try{for(var h=[],j=false,k=0;k<g.childNodes.length;k++)if(g.childNodes[k]!=void 0&&g.childNodes[k].localName!=void 0&&g.childNodes[k].localName==="include")for(var j=true,l=0;l<g.childNodes[k].childNodes.length;l++)g.childNodes[k].childNodes[l].localName!=null&&g.childNodes[k].childNodes[l].localName.toLowerCase()==="value"&&h.push(g.childNodes[k].childNodes[l].textContent);if(j){u.conditions[c].blackList=[];var m=OAT_JS.grid.gridData[u.UcId].columnDataField[c];
OAT_JS.grid.gridData[u.UcId].blackLists[m].state="";OAT_JS.grid.gridData[u.UcId].blackLists[m].defaultAction="Exclude";OAT_JS.grid.gridData[u.UcId].blackLists[m].hiddens=[];for(j=0;j<h.length;j++)h[j]!="TOTAL"&&OAT_JS.grid.gridData[u.UcId].blackLists[m].visibles.push(h[j]);for(j=0;j<u.rows.length;j++){m=c;if(h.findIndex(u.rows[j].cells[m].options.value)===-1&&h.findIndex(u.rows[j].cells[m].options.value.trimpivot())===-1&&u.conditions[m].blackList.findIndex(u.rows[j].cells[m].options.value)===-1){u.conditions[m].blackList.push(u.rows[j].cells[m].options.value);
OAT.HideGridRow({grid:u},c,u.rows[j].cells[c].options.value);OAT.actualizeBlackList("push",u,c,u.rows[j].cells[c].options.value,false)}}}}catch(n){}};this.moveToNextPage=function(){u.oat_component.moveToNextPage(u.UcId)};this.moveToFirstPage=function(){u.oat_component.moveToFirstPage(u.UcId)};this.moveToLastPage=function(){u.oat_component.moveToLastPage(u.UcId)};this.moveToPreviousPage=function(){u.oat_component.moveToPreviousPage(u.UcId)};this.refreshPivot=function(c,g){if(c!=""&&g!=""){var h=(new DOMParser).parseFromString(c,
"text/xml"),j=h.getElementsByTagName("OLAPDimension");u.serverPaging||OAT.RestoreGridRow({grid:u});for(var k="",l="",m=[],n=0;n<j.length;n++){for(var o=j[n].getElementsByTagName("name")[0].childNodes[0].nodeValue,q=-1,t=-1,r=0;r<u.columns.length;r++)if(u.columns[r].attributes.getNamedItem("name").nodeValue===o)for(var v=u.columns[r].attributes.getNamedItem("displayName").nodeValue,w=0;w<u.header.cells.length;w++)if(u.header.cells[w].options.value===v){q=u.header.cells.length-1-w;t=w}if(q!=-1){r=j[n].getElementsByTagName("condition")[0].childNodes[0].nodeValue===
"none"?"none":"";u.header.cells[t].html.style.display=r;for(o=0;o<u.rows.length;o++)u.rows[o].cells[q].html.style.display=r;u.serverPaging&&OAT_JS.grid.setColumnVisibleValue(u.UcId,t,r=="");try{if(u.serverPaging){var A=OAT_JS.grid.gridData[u.UcId].columnDataField[t];m[parseInt(j[n].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=A}}catch(B){}if(u.serverPaging){A=OAT_JS.grid.gridData[u.UcId].columnDataField[t];OAT_JS.grid.updateFilterInfo(u.UcId,A,{op:"all",values:[]})}o=j[n].getElementsByTagName("order")[0].childNodes[0].nodeValue;
if(o=="ascending"&&u.conditions[q].sort==3){u.sort(q,OAT.GridData.SORT_ASC,t);l="Ascending";k=j[n].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}else if(o=="descending"&&u.conditions[q].sort!=3){u.sort(q,OAT.GridData.SORT_DESC,t);l="Descending";k=j[n].getElementsByTagName("dataField")[0].childNodes[0].nodeValue}r=j[n].getElementsByTagName("hide")[0].childNodes;for(v=0;v<r.length;v++)if(r[v].tagName==="value")if(u.serverPaging){A=OAT_JS.grid.gridData[u.UcId].columnDataField[t];w=OAT_JS.grid.gridData[u.UcId].differentValues[A];
for(o=0;o<w.length;o++)w[o].trimpivot()==r[v].textContent&&OAT_JS.grid.updateFilterInfo(u.UcId,A,{op:"push",values:w[o]})}else if(u.conditions[q].blackList.findIndex(r[v].textContent)===-1)for(o=0;o<u.rows.length;o++)if(u.rows[o].cells[q].options.value.toString().trimpivot()==r[v].textContent){u.conditions[n].blackList.append(u.rows[o].cells[q].options.value);break}}}if(u.serverPaging){m.length!=OAT_JS.grid.gridData[u.UcId].columnDataField.length&&(m=[]);h.getElementsByTagName("OLAPDimension");OAT_JS.grid.refreshPivotWhenServerPagination(u.UcId,
k,l,m)}else{OAT.filterRows(u);OAT.saveState({grid:u},true,-1)}}};this.getDataXML=function(){if(u.serverPaging){spl=u.IdForQueryViewerCollection;c=u.QueryViewerCollection[spl].getPivottableDataSync().split("<Recordset")[1];c="<Recordset"+c}else{for(var c='<OLAPData format="adonet">\n <Table>\n',g=0;g<u.rows.length;g++){for(var c=c+"  <Record>\n",h=0;h<u.columns.length;h++){c=c+"   <"+u.columns[h].getAttribute("dataField")+">";c=c+u.rows[g].cells[h].options.value;c=c+"</"+u.columns[h].getAttribute("dataField")+
">\n"}c=c+"  </Record>\n"}c=c+" </Table>\n</OLAPData>"}return c};this.getFilteredDataXML=function(){if(u.serverPaging)return OAT_JS.grid.getTableWhenServerPagination(u.UcId);for(var c="<Table>\n",g=0;g<u.rows.length;g++)if(u.rows[g].html.style.display!="none"||u.rows[g].html.getAttribute("visibq")==void 0||u.rows[g].html.getAttribute("visibq")=="tt"){for(var c=c+"  <Record>\n",h=0;h<u.columns.length;h++){c=c+"   <"+u.columns[h].getAttribute("dataField")+">";c=c+u.rows[g].cells[h].options.value;c=
c+"</"+u.columns[h].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}return c+"</Table>\n"};this.getMetadataXML=function(){for(var c='<OLAPCube format="compact" thousandsSeparator="," decimalSeparator="." dateFormat="MDY">',g=0;g<u.columns.length;g++){c=c+"<OLAPDimension> ";c=c+"<name>"+u.columns[g].getAttribute("name")+"</name> ";c=c+"<displayName>"+u.columns[g].getAttribute("displayName")+"</displayName> ";c=c+"<description>"+u.columns[g].getAttribute("description")+"</description> ";c=c+"<dataField>"+
u.columns[g].getAttribute("dataField")+"</dataField> ";c=c+"<dataType>"+u.columns[g].getAttribute("dataType")+"</dataType> ";c=c+"<defaultPosition>"+u.columns[g].getAttribute("defaultPosition")+"</defaultPosition> ";c=c+"<validPositions>"+u.columns[g].getAttribute("validPositions")+"</validPositions> ";c=c+"<summarize>"+u.columns[g].getAttribute("summarize")+"</summarize> ";c=c+"<align>"+u.columns[g].getAttribute("align")+"</align> ";u.header.cells[g].html.style.display=="none"&&(c=c+"<hidden>true</hidden>");
for(var c=u.columns[g].getAttribute("picture")===""?c+"<picture/> ":c+"<picture>"+u.columns[g].getAttribute("picture")+"</picture> ",c=u.columns[g].getAttribute("format")===""?c+"<format/> ":c+"<format>"+u.columns[g].getAttribute("format")+"</format> ",c=u.conditions[g].sort===2?c+"<order>ascending</order> ":u.conditions[g].sort===1?c+"<order>none</order> ":c+"<order>descending</order> ",c=c+"<popupDisabled>"+u.columns[g].getAttribute("popupDisabled")+"</popupDisabled> ",c=c+"<customOrder/> ",c=c+
"<include> ",h=[],j=0;j<u.rows.length;j++)if(u.rows[j].cells[g]!=void 0&&h.findIndex(u.rows[j].cells[g].options.value)===-1&&u.conditions[g].blackList.findIndex(u.rows[j].cells[g].options.value)===-1){c=c+"<value>"+u.rows[j].cells[g].options.value+"</value> ";h.push(u.rows[j].cells[g].options.value)}c=c+"<value>TOTAL</value> </include> <collapse/> null null null ";c=c+" </OLAPDimension>"}return c+"</OLAPCube>"};u.init();setInterval(function(){if(jQuery("#"+u.controlName).length>0&&jQuery("#"+u.controlName)[0].getAttribute("class")===
"oatgrid"){var c=0;if(jQuery("#"+u.controlName+"tablePagination_rowsPerPage").length>0){c=parseInt(jQuery("#"+u.controlName+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c))if(u.rowsPerPage!=c){var g=u.rowsPerPage!="";u.rowsPerPage=c;c={grid:u};g&&OAT.saveState(c,false)}else u.rowsPerPage=c;g=jQuery("#"+u.controlName)[0].offsetWidth-1;c=g-3;try{if($("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){c=g+1;gx.util.browser.isIE()&&jQuery(u.div).css({width:c+"px"})}}catch(h){}try{var j=jQuery("#"+
u.controlName+"_tablePagination").css("border-right-width");j!=void 0&&j[0]!="0"&&(g=g-1)}catch(k){}jQuery("#"+u.controlName+"_tablePagination").css({width:g+"px"});jQuery("#"+u.controlName+"_grid_top_div").css({width:c+"px"})}else{j=jQuery("#"+u.controlName)[0].offsetWidth-4;try{if($("#MAINFORM")[0].className.indexOf("form-horizontal")>-1){j=j+4;gx.util.browser.isIE()&&jQuery(u.div).css({width:j+"px"})}}catch(l){}jQuery("#"+u.controlName+"_grid_top_div").css({width:j+"px"});jQuery(".oatgrid").css({marginBottom:"0px"})}if(jQuery("#"+
u.controlName+" tr").length<500)for(g=j=1;g<jQuery("#"+u.controlName+" tr").length;g++)if(jQuery("#"+u.controlName+" tr")[g].style.display!="none"){j%2===1?jQuery("#"+u.controlName+" tr")[g].className="odd":jQuery("#"+u.controlName+" tr")[g].className="even";j++}jQuery("#"+u.controlName+"tablePagination_rowsPerPage").length>0&&u.QueryViewerCollection.length===0&&jQuery(".pivot_pag_div").css({marginBottom:"0px"})}},250)};OAT.GridHeader=function(c){var g=this;this.cells=[];this.grid=c;this.html=OAT.Dom.create("thead");
this.container=OAT.Dom.create("tr");this.html.appendChild(g.container);this.clear=function(){OAT.Dom.clear(g.container);g.cells=[]};this.addCell=function(c,j,k,m){c=new OAT.GridHeaderCell(g.grid,c,k,m);j=g.container.childNodes;j.length&&k<j.length?g.container.insertBefore(c.html,j[k]):g.container.appendChild(c.html);g.cells.splice(k,0,c);return c};g.removeColumn=function(c){OAT.Dom.unlink(g.cells[c].html);g.cells.splice(c,1);for(c=0;c<g.cells.length;c++)g.cells[c].number=c}};OAT.GridHeaderCell=function(c,
g,h,j){var k=this;this.options={value:"",sortable:1,draggable:1,resizable:1,align:OAT.GridData.ALIGN_LEFT,sort:OAT.GridData.SORT_NONE,type:OAT.GridData.TYPE_AUTO};var g="object"==typeof g?g:{value:g},m;for(m in g)k.options[m]=g[m];this.signalStart=function(){k.signal=1;var c=OAT.Dom.getWH(k.container);k.signalElm=OAT.Dom.create("div",{position:"absolute",width:"2px",height:c[1]+2+"px",left:"-2px",top:"-1px",backgroundColor:"#f00"});k.container.appendChild(k.signalElm)};this.signalEnd=function(){k.signal=
0;OAT.Dom.unlink(k.signalElm)};this.changeWidth=function(c){if(c){if(!k.value.style.width||"auto"==k.value.style.width)c-=parseInt(OAT.Style.get(k.value,"paddingLeft")),c-=parseInt(OAT.Style.get(k.value,"paddingRight"));k.value.style.width=c+"px"}else k.value.style.width=""};this.changeSort=function(c){k.options.sort=c;k.updateSortImage()};this.updateSortImage=function(){if(k.sorter){var c="none";switch(k.options.sort){case OAT.GridData.SORT_NONE:c="none";break;case OAT.GridData.SORT_ASC:c="asc";
break;case OAT.GridData.SORT_DESC:c="desc"}k.sorter.style.backgroundImage="url("+k.grid.options.imagePath+"Grid_"+c+".gif)"}};this.signal=0;this.number=h;this.grid=c;this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div",{position:"relative"});this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(k.value,"header_value");OAT.Dom.append([k.html,k.container],[k.container,k.value]);this.value.innerHTML=g.value.replace(/ /g,"&nbsp;");this.value.setAttribute("title_v",g.value);
this.value.setAttribute("dataField",j);this.html.setAttribute("title_v",g.value);this.html.setAttribute("dataField",j);if(k.options.sortable){k.html.style.cursor="pointer";k.sorter=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});k.container.appendChild(k.sorter);k.updateSortImage();var n;n=gx.util.browser.isIE()?OAT.Dom.create("div","","oatfilterwindowGrid"):OAT.Dom.create("div","","oatfilterwindow");OAT.Anchor.assign(k.container,{title:" ",content:n,
result_control:!1,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(k.grid.QueryViewerCollection[IdForQueryViewerCollection])+" FilterPopup "});c=function(c){var g=OAT.GridData.SORT_NONE;switch(k.options.sort){case OAT.GridData.SORT_NONE:g=OAT.GridData.SORT_ASC;break;case OAT.GridData.SORT_ASC:g=OAT.GridData.SORT_DESC;break;case OAT.GridData.SORT_DESC:g=OAT.GridData.SORT_ASC}OAT.showPopup(c,k,g,n)};OAT.Event.attach(k.container,"click",c)}k.options.resizable&&
(h=OAT.Dom.create("div",{width:"7px",height:"100%",position:"absolute",right:"-5px",top:"0px",cursor:"e-resize"}),h.style.backgroundImage="url("+k.grid.options.imagePath+"Grid_none.gif)",k.container.appendChild(h),c=function(c){var g=OAT.Dom.eventPos(c),c=OAT.Dom.getWH(k.grid.html),h=OAT.Dom.getWH(k.container),j=OAT.Dom.getWH(k.value);OAT.GridData.resizing=k.grid;OAT.GridData.index=k.number;OAT.GridData.mouseX=g[0];OAT.GridData.w=j[0];g=-2;h=h[0];OAT.Browser.isIE6&&!k.value.style.width&&(g-=2,h-=
4);OAT.GridData.x=h;k.grid.tmp_resize_start=OAT.Dom.create("div",{position:"absolute",left:g+"px",top:"-1px",backgroundColor:"#f00",width:"2px",height:c[1]+"px"});k.grid.tmp_resize=OAT.Dom.create("div",{position:"absolute",left:h+"px",top:"-1px",backgroundColor:"#f00",width:"2px",height:c[1]+"px"});k.container.appendChild(k.grid.tmp_resize);k.container.appendChild(k.grid.tmp_resize_start)},OAT.Event.attach(h,"mousedown",c),OAT.Event.attach(h,"dblclick",function(){k.changeWidth(!1);for(var c=0;c<k.grid.rows.length;c++)k.grid.rows[c].cells[k.number].changeWidth(!1)}));
k.options.draggable&&(c=function(c){if(!OAT.GridData.resizing){OAT.GridData.dragging=false;OAT.GridData.index=k.number;c=OAT.Event.position(c);OAT.GridData.x=c[0];k.grid.tmp_drag=false}},OAT.Event.attach(k.container,"mousedown",c));switch(k.options.align){case OAT.GridData.ALIGN_LEFT:k.html.style.textAlign="left";break;case OAT.GridData.ALIGN_CENTER:k.html.style.textAlign="center";break;case OAT.GridData.ALIGN_RIGHT:k.html.style.textAlign="right"}OAT.Event.attach(k.html,"mouseover",function(){OAT.Dom.addClass(k.html,
"hover")});OAT.Event.attach(k.html,"mouseout",function(){OAT.Dom.removeClass(k.html,"hover")})};OAT.GridRow=function(c,g){var h=this;this.clear=function(){OAT.Dom.clear(h.html);h.cells=[]};this.removeColumn=function(c){OAT.Dom.unlink(h.cells[c].html);h.cells.splice(c,1)};this.isDecimal=function(c){return c.match(/^[0-9]+(\.[0-9]+)+$/)?!0:!1};this.addCell=function(c,g,m,n,l,o,q,r,t,w){t=!t?h.cells.length:t;void 0==c&&(c="");g=new OAT.GridRowCell(c,t,g,m,n,l,o,q,r,w);m=h.html.childNodes;m.length&&t!=
m.length?(h.html.insertBefore(g.html,m[t]),w||(m[t].style.display="none")):(h.html.appendChild(g.html),w||(g.html.style.display="none"));OAT.setClickEventHandlers(h,m[m.length-1],c,"DIMENSION",r,h.grid.rows.length);h.cells.splice(t,0,g);return g.value};this.select=function(){h.selected=1};this.deselect=function(){h.selected=0;OAT.Dom.removeClass(h.html,"selected")};this.grid=c;this.cells=[];this.html=OAT.Dom.create("tr");this.selected=0;OAT.Dom.addClass(h.html,g%2?"even":"odd");OAT.Event.attach(h.html,
"mouseover",function(){OAT.Dom.addClass(h.html,"hover")});OAT.Event.attach(h.html,"mouseout",function(){OAT.Dom.removeClass(h.html,"hover")});OAT.Event.attach(h.html,"click",function(c){if(!c.shiftKey&&!c.ctrlKey)for(var g=0;g<h.grid.rows.length;g++){var m=h.grid.rows[g];m!=h&&m.deselect()}if(c.shiftKey){for(var n=c=-1,l=0,g=0;g<h.grid.rows.length;g++)m=h.grid.rows[g],m!=h?(!l&&m.selected&&(c=g),!l&&-1!=c&&m.select(),l&&m.selected&&(n=g)):l=1;if(-1==c&&-1!=n)for(g=l=0;g<h.grid.rows.length;g++)m=h.grid.rows[g],
m==h&&(l=1),l&&(m!=h&&g<n)&&m.select()}h.selected?h.deselect():h.select()})};OAT.GridRowCell=function(c,g,h,j,k,m,n,l,o){var q=this;this.options={value:"",align:OAT.GridData.ALIGN_LEFT};c="object"==typeof c?c:{value:c};for(p in c)q.options[p]=c[p];this.html=OAT.Dom.create("td");this.container=OAT.Dom.create("div");this.value=OAT.Dom.create("div",{overflow:"hidden"});OAT.Dom.addClass(q.value,"row_value");this.value.innerHTML=OAT.defaultPictureValue(q.options.value,h,j,k).replace(/ /g,"&nbsp;");this.html=
OAT.applyFormatValues(this.html,q.options.value,h,o,n,m,l);this.html.setAttribute("title",OAT.defaultPictureValue(q.options.value,h,j,k));OAT.Dom.append([q.html,q.container],[q.container,q.value]);if("character"!=h&&(isNaN(q.options.value)||(q.options.align=3),q.options.value))q.options.align=3;"date"===h&&(q.options.align=OAT.GridData.ALIGN_RIGHT);switch(q.options.align){case OAT.GridData.ALIGN_LEFT:q.html.style.textAlign="left";break;case OAT.GridData.ALIGN_CENTER:q.html.style.textAlign="center";
break;case OAT.GridData.ALIGN_RIGHT:q.html.style.textAlign="right"}this.changeWidth=function(c){if(c){if(!q.value.style.width||q.value.style.width=="auto"){c=c-parseInt(OAT.Style.get(q.value,"paddingLeft"));c=c-parseInt(OAT.Style.get(q.value,"paddingRight"))}q.value.style.width=c+"px"}else q.value.style.width=""}};OAT.underRecursionStyle=!1;OAT.applyFormatValues=function(c,g,h,j,k,m,n){n=n[j];null!=n&&""!=n&&(c=OAT.setStyleValues(c,n));if(OAT.underRecursionStyle)for(var l=0;l<k.length;l++)c=OAT.setStyleValues(c,
k[l].format);for(l=0;l<k.length;l++)k[l].columnNumber==j&&k[l].value===g.trimpivot()&&(c=OAT.setStyleValues(c,k[l].format),void 0!=self.formatValues[l].recursive&&"yes"==self.formatValues[l].recursive&&(OAT.underRecursionStyle=!0));for(var k=[],n=[],o=[],q=[],r=[],t=[],q=[],w=[],l=0;l<m.length;l++)if(m[l].columnNumber==j&&("equal"==m[l].operation1&&(k[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,k[1]=m[l].format),"notequal"==m[l].operation1&&(n[0]="real"===h||"integer"===h?parseFloat(m[l].value1):
m[l].value1,n[1]=m[l].format),"less"==m[l].operation1&&(r[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,r[1]=m[l].format),"lessequal"==m[l].operation1&&(t[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,r[1]=m[l].format),"greater"==m[l].operation1&&(o[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,o[1]=m[l].format),"greaterequal"==m[l].operation1&&(q[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,o[1]=m[l].format),m[l].operation2&&
"greaterequal"==m[l].operation1))q=[],w[0]="real"===h||"integer"===h?parseFloat(m[l].value1):m[l].value1,m[l].operation2&&"lessequal"==m[l].operation2&&(w[1]="real"===h||"integer"===h?parseFloat(m[l].value2):m[l].value2,w[2]=m[l].format);j=Array(3);"real"===h&&(g=parseFloat(g),void 0!=o[0]&&""!=o[0]&&(j[0]=parseFloat(o[0])),void 0!=r[0]&&""!=r[0]&&(j[1]=parseFloat(r[0])),void 0!=w[0]&&""!=w[0]&&(j[2]=parseFloat(w[0])));"integer"===h&&(g=parseInt(g),void 0!=o[0]&&""!=o[0]&&(j[0]=parseInt(o[0])),void 0!=
r[0]&&""!=r[0]&&(j[1]=parseInt(r[0])),void 0!=w[0]&&""!=w[0]&&(j[2]=parseInt(w[0])));if("date"===h){j=g.split("-");m=Array(3);m[0]=parseInt(j[0]);m[1]=parseInt(j[1]);m[2]=parseInt(j[2]);try{if(void 0!=k[0]||void 0!=q[0]||void 0!=t[0]){var v;void 0!=k[0]?v=k[0].split("-"):void 0!=q[0]?v=q[0].split("-"):void 0!=q[0]&&(v=t[0].split("-"));var A=Array(3);A[1]=parseInt(v[1]);A[2]=parseInt(v[2]);A[0]=parseInt(v[0]);if(A[0]==m[0]||A[0]==m[0]&&A[1]==m[1])void 0!=k[1]?c=OAT.setStyleValues(c,k[1]):void 0!=o[1]?
c=OAT.setStyleValues(c,o[1]):void 0!=r[1]&&(c=OAT.setStyleValues(c,r[1]))}if(void 0!=n[0]&&(v=n[0].split("-"),A=Array(3),A[1]=parseInt(v[1]),A[2]=parseInt(v[2]),A[0]=parseInt(v[0]),A[0]!=m[0]||A[0]!=m[0]&&A[1]!=m[1]))c=OAT.setStyleValues(c,n[1]);if(void 0!=o[0]||void 0!=q[0])if(v=void 0!=o[0].split("-")?o[0].split("-"):q[0].split("-"),A[1]=parseInt(v[1]),A[2]=parseInt(v[2]),A[0]=parseInt(v[0]),A[0]<m[0]||A[0]<=m[0]&&A[1]<m[1]||A[0]<=m[0]&&A[1]<=m[1]&&A[2]<m[2])c=OAT.setStyleValues(c,o[1]);if(void 0!=
r[0]||void 0!=t[0])if(v=void 0!=r[0].split("-")?r[0].split("-"):t[0].split("-"),A=Array(3),A[1]=parseInt(v[1]),A[2]=parseInt(v[2]),A[0]=parseInt(v[0]),A[0]>m[0]||A[0]>=m[0]&&A[1]>m[1]||A[0]>=m[0]&&A[1]>=m[1]&&A[2]>m[2])c=OAT.setStyleValues(c,r[1]);if(void 0!=w[0]&&void 0!=w[1]){v=w[0].split("-");var F=w[1].split("-"),A=Array(3);cmparElements2=Array(3);A[1]=parseInt(v[1]);A[2]=parseInt(v[2]);A[0]=parseInt(v[0]);cmparElements2[1]=parseInt(F[1]);cmparElements2[2]=parseInt(F[2]);cmparElements2[0]=parseInt(F[0]);
if((A[0]<=m[0]||A[0]<=m[0]&&A[1]<m[1]||A[0]<=m[0]&&A[1]<=m[1]&&A[2]<m[2])&&(cmparElements2[0]>m[0]||cmparElements2[0]>=m[0]&&cmparElements2[1]>m[1]||cmparElements2[0]>=m[0]&&cmparElements2[1]>=m[1]&&cmparElements2[2]>m[2]))c=OAT.setStyleValues(c,w[2])}}catch(H){}}if("date"!=h){void 0!=k[0]&&g==k[0]&&(c=OAT.setStyleValues(c,k[1]));void 0!=n[0]&&g!=n[0]&&(c=OAT.setStyleValues(c,n[1]));if(void 0!=o[0]&&g>o[0]||void 0!=q[0]&&g>=q[0])c=OAT.setStyleValues(c,o[1]);if(void 0!=r[0]&&g<r[0]||void 0!=t[0]&&
g<=t[0])c=OAT.setStyleValues(c,r[1]);void 0!=w[0]&&void 0!=w[1]&&(g>=w[0]&&g<=w[1])&&(c=OAT.setStyleValues(c,w[2]))}return c};OAT.setStyleValues=function(c,g){function h(c){c=c.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,g,h,j){return g+g+h+h+j+j});return(c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c))?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}if(void 0==g)return c;for(var j=g.split(";"),k=0;k<j.length;k++){var m=j[k].split(":");switch(m[0]){case "color":c.style.color=
void 0!=m[1][0]&&"#"===m[1][0]?"rgb("+h(m[1]).r+","+h(m[1]).g+","+h(m[1]).b+")":m[1];break;case "fontStyle":c.style.fontStyle=m[1];break;case "backgroundColor":c.style.backgroundColor=m[1];break;case "textDecoration":c.style.textDecoration=m[1];break;case "fontWeight":c.style.fontWeight=m[1];break;case "fontFamily":c.style.fontFamily=m[1];break;case "fontVariant":c.style.fontVariant=m[1];break;case "fontSize":c.style.fontSize=m[1].replace("px","")+"px";break;case "textAlign":c.style.textAlign=m[1];
break;case "lineHeight":c.style.lineHeight=m[1];break;case "textIndent":c.style.textIndent=m[1];break;case "verticalAlign":c.style.verticalAlign=m[1];break;case "wordSpacing":c.style.wordSpacing=m[1];break;case "display":c.style.display=m[1];break;case "borderThickness":c.style.borderThickness=m[1];c.style.borderWidth=m[1]+"px";break;case "borderColor":c.style.borderColor=m[1];break;case "borderWith":c.style.borderWith=m[1];break;case "borderStyle":c.style.borderStyle=m[1];break;case "padding":c.style.padding=
m[1];break;case "paddingBottom":c.style.paddingBottom=m[1];break;case "paddingLeft":c.style.paddingLeft=m[1];break;case "paddingRight":c.style.paddingRight=m[1];break;case "paddingTop":c.style.paddingTop=m[1]}}return c};OAT.defaultPictureValue=function(c,g,h,j){if("#NuN#"==c)return j=h.getAttribute("textForNullValues"),""==j?"&nbsp;":void 0!=j?j:"&nbsp;";var k=void 0!=h.getAttribute("decimalSeparator")&&null!=h.getAttribute("decimalSeparator")?h.getAttribute("decimalSeparator"):".",m=void 0!=h.getAttribute("decimalPlaces")&&
null!=h.getAttribute("decimalPlaces")?h.getAttribute("decimalPlaces"):2,n=h.getAttribute("thousandsSeparator"),l=h.getAttribute("dateFormat"),o=c,h=!1,q="";if("integer"==g||"real"==g)if(void 0!=j||null!=j)if("Z"!=j[0]||"9"!=j[0]||","!=j[0]||"."!=j[0]){for(var h=!0,r=0;j.length>r&&"Z"!=j[r]&&"9"!=j[r]&&","!=j[r]&&"."!=j[r];)r++;q=j.substring(0,r);j=j.substring(r)}var t=!1,w="";if("integer"==g||"real"==g)if(void 0!=j||null!=j)if("Z"!=j[j.length-1]||"9"!=j[j.length-1]||","!=j[j.length-1]||"."!=j[j.length-
1]){t=!0;for(r=j.length-1;-1<r&&"Z"!=j[r]&&"9"!=j[r]&&","!=j[r]&&"."!=j[r];)r--;w=j.substring(r+1);j=j.substring(0,r+1)}switch(g){case "integer":case "real":r=c.split(".");l=!0;""==j&&"integer"==g&&(l=!1);if(void 0!=j&&""!=j){var l=-1!=j.indexOf("."),v=j.split(".");void 0!=v[1]?m=v[1].length:(m=0,l=!1);"real"==g&&(o=parseFloat(o).toFixed(m));r=o.split(".");o="";for(g=0;g<v[0].length;g++)","!=v[0][g]&&(o+=v[0][g]);if(-1!=o.indexOf("9")&&(o=o.length-o.indexOf("9"),r[0].length<o)){for(var g=r[0],A=0;A<
o-r[0].length;A++)g="0"+g;r[0]=g}o=r;g=r[0];v=v[0];if(void 0!=n&&null!=n&&3<g.length)for(A=v.length-1;0<=A&&!(v.length-1-A>g.length);A--)if(","===v[A])var F=g.length-(v.length-A-1),H=g.substring(0,F),g=g.substring(F),g=0<H.length?H+n+g:g;o[0]=g}else"real"==g&&(o=parseFloat(o).toFixed(2),r=o.split("."));o=r[0];n=-1;void 0!=j&&""!=j&&(v=j.split("."),1<v.length&&(n=v[1].indexOf("Z")));if(null==r[1]){if(l&&(-1!=n&&(m=n),0<m)){o+=k;for(n=0;n<m;n++)o+="0"}}else if(l)if(-1===n)if(r[1].length<m){o=o+k+r[1];
for(n=0;n<m-r[1].length;n++)o+="0"}else if(r[1].length>m){l="";for(n=0;n<m;n++)l+=r[1].charAt(n);o=o+k+l}else o=o+k+r[1];else if(l=n,r[1].length<m){if(0<r[1].length||0<l){o=o+k+r[1];for(n=0;n<l-r[1].length;n++)o+="0"}}else if(r[1].length>m){l="";for(n=0;n<m;n++)l+=r[1].charAt(n);o=o+k+l}else o=o+k+r[1];-1===j.indexOf("9")&&0===parseFloat(c)&&(o="");break;case "date":if(""==c)return"";if(""===j)if(c=c.split("-"),void 0!=l&&null!=l){pict=l.split("");o="";for(n=0;2>=n;n++)"M"===pict[n]&&(o+=c[1]),"D"===
pict[n]&&(o+=c[2]),"Y"===pict[n]&&(o+=c[0]),2!=n&&(o+="/")}else o=c[1]+"/"+c[2]+"/"+c[0];else if(r=c.split("-"),"99/99/9999"==j)if(4==r[0].length)o=void 0==l||null==l||"MDY"==l?r[1]+"/"+r[2]+"/"+r[0]:void 0!=l&&"YMD"==l?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0];else for(o=c;-1!=o.indexOf("-");)o.replace("-","/");else"99/99/99"==j?4==r[0].length&&(r[0]=r[0].substr(r[0].length-2,2)):"9999/99/99"!=j&&4==r[0].length&&(r[0]=r[0].substr(r[0].length-2,2)),o=void 0==l||null==l||"MDY"==l?r[1]+"/"+r[2]+
"/"+r[0]:void 0!=l&&"YMD"==l?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0];break;case "datetime":if(""==c)return"";k=c.split("T");-1===c.indexOf("T")&&(k=c.split(" "));if(""===j)if(c=k[0].split("-"),void 0!=l&&null!=l){pict=l.split("");o="";for(n=0;2>=n;n++)"M"===pict[n]&&(o+=c[1]),"D"===pict[n]&&(o+=c[2]),"Y"===pict[n]&&(o+=c[0]),2!=n&&(o+="/")}else o=c[1]+"/"+c[2]+"/"+c[0];else if(m=j.split(" "),r=k[0].split("-"),"99/99/9999"==m[0])if(4==r[0].length)o=void 0==l||null==l||"MDY"==l?r[1]+"/"+r[2]+
"/"+r[0]:r[2]+"/"+r[1]+"/"+r[0];else for(o=c;-1!=o.indexOf("-");)o.replace("-","/");else"99/99/99"==m[0]?(4==r[0].length&&(r[0]=r[0].substr(r[0].length-2,2)),o=void 0==l||null==l||"MDY"==l?r[1]+"/"+r[2]+"/"+r[0]:void 0!=l&&"YMD"==l?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0]):o="9999/99/99"==m[0]?void 0==l||null==l||"MDY"==l?r[1]+"/"+r[2]+"/"+r[0]:void 0!=l&&"YMD"==l?r[0]+"/"+r[1]+"/"+r[2]:r[2]+"/"+r[1]+"/"+r[0]:"";if(""===j)1<k.length&&(o=o+" "+k[1]);else if(m=j.split(" "),2>j.split(" ").length&&
("99/99/9999"!=m[0]&&"9999/99/99"!=m[0]&&"99/99/99"!=m[0])&&m.append(j),1<m.length)switch(1<k.length?(j=k[1].split(":"),2>j.length&&(j[1]="00",j[2]="00"),3>j.length&&(j[2]="00")):(j=Array(3),j[0]="00",j[1]="00",j[2]="00"),m[1]){case "99":o=o+" "+j[0];break;case "99:99":o=o+" "+j[0]+":"+j[1];break;case "99:99:99":o=o+" "+j[0]+":"+j[1]+":"+j[2];break;default:o=o+" "+j[0]+":"+j[1]+":"+j[2]}break;case "character":"@!"==j&&(o=c.toUpperCase())}h&&(o=q+o);t&&(o+=w);return o};OAT.GenerateFormatDateForGrid=
function(c,g){g.split(" ");var h=c[0].split("-"),j="";switch(g){case "99/99/9999":j=h[1]+"/"+h[2]+"/"+h[0];break;case "99/99/99":4==h[0].length&&(h[0]=h[0].substr(h[0].length-2,2));j=h[1]+"/"+h[2]+"/"+h[0];break;default:j=h[2]+"/"+h[1]+"/"+h[0]}return j};OAT.HideGridRow=function(c,g,h){for(var j=0;j<c.grid.rows.length;j++)c.grid.rows[j].cells[g].options.value.toString().trimpivot()===h.toString().trimpivot()&&(c.grid.rows[j].html.style.display="none",c.grid.rows[j].html.setAttribute("visibQ","tf"))};
OAT.ShowGridRow=function(c,g,h){for(var j=0;j<c.grid.rows.length;j++)c.grid.rows[j].cells[g].options.value.toString().trimpivot()===h.toString().trimpivot()&&(c.grid.rows[j].html.style.display="",c.grid.rows[j].html.setAttribute("visibQ","tt"))};OAT.RestoreGridRow=function(c){for(var g=0;g<c.grid.rows.length;g++)c.grid.rows[g].html.style.display="",c.grid.rows[g].html.setAttribute("visibQ","tt");for(g=0;g<c.grid.columnsDataType.length;g++)c.grid.conditions[g].blackList=[]};OAT.RestoreGridOrder=function(c){c.grid.sort(0,
2,c.grid.columnsDataType.length-1-0);c.grid.sort(0,1,c.grid.columnsDataType.length-1-0)};OAT.RestoreGridColumns=function(c){for(var g=0;g<c.grid.columnsDataType.length;g++){c.grid.header.cells[g].html.style.display="";for(var h=0,j=c.grid.columnsDataType.length-1-g,h=0;h<c.grid.rows.length;h++)c.grid.rows[h].cells[j].html.style.display=""}};OAT.filterRows=function(c){for(var g={grid:c},h=0;h<c.columnsDataType.length;h++)for(var j=0;j<c.conditions[h].blackList.length;j++)OAT.HideGridRow(g,h,c.conditions[h].blackList[j]),
OAT.actualizeBlackList("push",c,h,c.conditions[h].blackList[j],!1)};OAT.actualizeBlackList=function(c,g,h,j,k){if(!k)for(k=0;k<g.rows.length;k++)if(g.rows[k].cells[h].options.value===j)for(var m=0;m<g.rows[0].cells.length;m++)if(m!=h){for(var n=g.rows[k].cells[m].options.value,l=0,o=0;o<g.rows.length;o++)if(g.rows[o].cells[m].options.value===n&&("none"!=g.rows[o].html.style.display||"tf"!=g.rows[o].html.getAttribute("visibQ")))l+=1;o=g.conditions[m].blackList.findIndex(n);0===l?"push"===c&&-1===o&&
g.conditions[m].blackList.push(n):"pop"===c&&-1!=o&&g.conditions[m].blackList.splice(o,1)}"push"===c?-1===g.conditions[h].blackList.findIndex(j)&&g.conditions[h].blackList.push(j):(o=g.conditions[h].blackList.findIndex(j),-1!=o&&g.conditions[h].blackList.splice(o,1))};OAT.showPopup=function(c,g,h,j){var c=[],k=function(){jQuery(".oat_winrect_container").css({display:"none"})},m=g.number;OAT.Dom.clear(j);c.append(j);if(!g.grid.disableColumnSort){j=document.createElement("div");j.setAttribute("class",
"first_popup_subdiv");h=OAT.Dom.radio("order");h.id="pivot_order_asc";h.checked=2===g.grid.conditions[m].sort;OAT.Dom.attach(h,"change",function(){});OAT.Dom.attach(h,"click",function(){g.grid.sort(m,OAT.GridData.SORT_ASC,g.number);OAT.saveState(g,!0);try{var c='<DATA event="OrderChanged" name="'+g.grid.columns[g.number].getAttribute("name")+'" displayName="'+g.grid.columns[g.number].getAttribute("displayName")+'"  order="ascending">',c=c+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,
c)}catch(h){}g.grid.serverPaging&&self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,!1,OAT_JS.grid.gridData[g.grid.UcId].columnDataField[g.number],"Ascending","","")});j.appendChild(h);h=OAT.Dom.create("label");h.htmlFor="pivot_order_asc";h.innerHTML=gx.getMessage("GXPL_QViewerJSAscending");j.appendChild(h);j.appendChild(OAT.Dom.create("br"));h=OAT.Dom.radio("order");h.id="pivot_order_desc";h.checked=3===g.grid.conditions[m].sort;OAT.Dom.attach(h,"change",function(){});OAT.Dom.attach(h,"click",
function(){g.grid.sort(m,OAT.GridData.SORT_DESC,g.number);OAT.saveState(g,!0);try{var c='<DATA event="OrderChanged" name="'+g.grid.columns[g.number].getAttribute("name")+'" displayName="'+g.grid.columns[g.number].getAttribute("displayName")+'"  order="ascending">',c=c+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(self.QueryViewerCollection[self.IdForQueryViewerCollection].ControlName,c)}catch(h){}g.grid.serverPaging&&self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,!1,OAT_JS.grid.gridData[g.grid.UcId].columnDataField[g.number],
"Descending","","")});var n=OAT.Dom.create("label");n.htmlFor="pivot_order_desc";n.innerHTML=gx.getMessage("GXPL_QViewerJSDescending");j.appendChild(h);j.appendChild(n);c.append(j);1<self.header.length&&(j=OAT.Dom.create("hr",{}),c.append(j))}h=OAT.Dom.create("hr",{});j=OAT.Dom.create("hr",{});n=OAT.Dom.create("div");g.grid.disableColumnSort&&n.setAttribute("class","first_popup_subdiv");if(0<g.container.parentNode.cellIndex){var l=document.createElement("div");l.setAttribute("class","move_item_img");
OAT.Dom.attach(l,"click",function(){for(var c=g.container.parentNode.cellIndex,h=c-1,j=0,l=0,m=g.container.parentNode.parentNode.children[h].getAttribute("title_v"),n=0;n<g.grid.header.cells.length;n++)g.container.children[0].getAttribute("title_v")===g.grid.header.cells[n].value.innerHTML.replace(/\&nbsp;/g," ")&&(j=n),m===g.grid.header.cells[n].value.innerHTML.replace(/\&nbsp;/g," ")&&(l=n);g.grid.header.cells[j].html.parentNode.insertBefore(g.grid.header.cells[j].html,g.grid.header.cells[l].html);
if(g.grid.serverPaging)for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[j].html,g.grid.rows[n].cells[l].html);else{m=jQuery("#"+g.grid.controlName+" tr")[1];for(n=0;n<g.grid.rows[0].cells.length;n++){if(m.children[c].getAttribute("title")===g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")||!isNaN(parseInt(m.children[c].getAttribute("title")))&&parseInt(m.children[c].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g,
" ")))j=n;if(m.children[h].getAttribute("title")===g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")||!isNaN(parseInt(m.children[h].getAttribute("title")))&&parseInt(m.children[h].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")))l=n}c=g.grid.columnsDataType.length-1-(j<l?l-1:l);for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[j].html,g.grid.rows[n].cells[l].html),h=g.grid.rows[n].cells[j],
g.grid.rows[n].cells.splice(j,1),g.grid.rows[n].cells.splice(c,0,h)}j=[];for(l=0;l<jQuery("#"+g.grid.controlName).find("thead td").length;l++)j.push(jQuery("#"+g.grid.controlName).find("thead td")[l].getAttribute("dataField"));OAT_JS.grid.setDataFieldPosition(g.grid.UcId,j);k()});var o=OAT.Dom.create("label");o.innerHTML=gx.getMessage("GXPL_QViewerJSMoveColumnToLeft");o.htmlFor="move_column_to_left";l.appendChild(o);OAT.Dom.append([n,l]);g.container.parentNode.cellIndex>=g.grid.header.cells.length-
2&&c.append(n)}g.container.parentNode.cellIndex<g.grid.header.cells.length-1&&(l=document.createElement("div"),l.setAttribute("class","move_item_img"),OAT.Dom.attach(l,"click",function(){for(var c=g.container.parentNode.cellIndex,h=c+1,j=0,l=0,m=g.container.parentNode.parentNode.children[h].getAttribute("title_v"),n=0;n<g.grid.header.cells.length;n++)g.container.children[0].getAttribute("title_v")===g.grid.header.cells[n].value.innerHTML.replace(/\&nbsp;/g," ")&&(j=n),m===g.grid.header.cells[n].value.innerHTML.replace(/\&nbsp;/g,
" ")&&(l=n);g.grid.header.cells[j].html.parentNode.insertBefore(g.grid.header.cells[l].html,g.grid.header.cells[j].html);if(g.grid.serverPaging)for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[l].html,g.grid.rows[n].cells[j].html);else{m=jQuery("#"+g.grid.controlName+" tr")[1];for(n=0;n<g.grid.rows[0].cells.length;n++){if(m.children[c].getAttribute("title")===g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")||!isNaN(parseInt(m.children[c].getAttribute("title")))&&
parseInt(m.children[c].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")))j=n;if(m.children[h].getAttribute("title")===g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")||!isNaN(parseInt(m.children[h].getAttribute("title")))&&parseInt(m.children[h].getAttribute("title"))===parseInt(g.grid.rows[0].cells[n].value.innerHTML.replace(/\&nbsp;/g," ")))l=n}c=g.grid.columnsDataType.length-1-(j<l?l-1:l);for(n=0;n<g.grid.rows.length;n++)g.grid.rows[n].cells[j].html.parentNode.insertBefore(g.grid.rows[n].cells[l].html,
g.grid.rows[n].cells[j].html),h=g.grid.rows[n].cells[j],g.grid.rows[n].cells.splice(j,1),g.grid.rows[n].cells.splice(c,0,h)}j=[];for(l=0;l<jQuery("#"+g.grid.controlName).find("thead td").length;l++)j.push(jQuery("#"+g.grid.controlName).find("thead td")[l].getAttribute("dataField"));OAT_JS.grid.setDataFieldPosition(g.grid.UcId,j);k()}),o=OAT.Dom.create("label"),o.innerHTML=gx.getMessage("GXPL_QViewerJSMoveColumnToRight"),o.htmlFor="move_column_to_right",l.appendChild(o),OAT.Dom.append([n,l]),c.append(n));
OAT.gridStateChanged(g)&&(c.append(h),h=OAT.Dom.create("div"),n=document.createElement("div"),n.setAttribute("class","uncheck_item_img"),OAT.Dom.attach(n,"click",function(){if(g.grid.serverPaging)self.getDataForTable(g.grid.UcId,1,g.grid.rowsPerPage,true,"","","","",true);else{OAT.RestoreGridRow(g);OAT.RestoreGridOrder(g);OAT.RestoreGridColumns(g);OAT.saveState(g,"1")}k()}),l=OAT.Dom.create("label"),l.innerHTML=gx.getMessage("GXPL_QViewerJSRestoreDefaultView"),l.htmlFor="pivot_checkbox_restoreview",
n.appendChild(l),OAT.Dom.append([h,n]),c.append(h));h=OAT.Dom.create("div");h.setAttribute("class","last_div_popup");OAT.distinctDivs(g,h);c.append(j);c.append(h);OAT.Dom.append(c);(gx.util.browser.isIPad()||gx.util.browser.isIPhone())&&jQuery(".oat_winrect_close_b").css({backgroundSize:"30px 30px",height:"30px",width:"30px",right:"-14px",top:"-14px"})};OAT.distinctDivs=function(c,g){var h=c.grid.columns.length-1-c.number,j=c.container.parentNode.cellIndex;c.grid.serverPaging&&(h=j);if(!c.grid.serverPaging)try{for(var k=
jQuery("#"+c.grid.controlName+" tr")[1],m=0;m<c.grid.columns.length;m++){var n=k.children[j].getAttribute("title"),l=c.grid.rows[0].cells[m].value.innerHTML.replace(/\&nbsp;/g," ");n===l&&(h=m)}}catch(o){}var j=function(c,g){var h=OAT.Dom.create("div"),j=OAT.Dom.create("input"),k=OAT.Dom.create("label");k.innerHTML=c;k.htmlFor=g;h.appendChild(k);return[h,j]},q=function(g,j){var k="pop";g?(c.grid.serverPaging||OAT.ShowGridRow(c,h,j),OAT.actualizeBlackList("pop",c.grid,h,j,c.grid.serverPaging)):(c.grid.serverPaging||
OAT.HideGridRow(c,h,j),k="push",OAT.actualizeBlackList("push",c.grid,h,j,c.grid.serverPaging));c.grid.serverPaging&&self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:k,values:j});OAT.onFilteredChangedEventHandle(c,h);OAT.saveState(c,!0,h)},m=function(){self.getValuesForColumn(c.grid.UcId,h,this.value)};OAT.Dom.clear(g);k=OAT.Dom.create("div");k.setAttribute("class","div_buttons_popup");n=document.createElement("button");n.textContent=
gx.getMessage("GXPL_QViewerJSAll");n.setAttribute("class","btn");jQuery(n).click(function(){c.grid.serverPaging?self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"all",values:[]}):(c.grid.conditions[h].blackList=[],OAT.RestoreGridRow(c),OAT.saveState(c,!0,h));OAT.onFilteredChangedEventHandle(c,h);OAT.distinctDivs(c,g)});l=document.createElement("button");l.textContent=gx.getMessage("GXPL_QViewerJSNone");l.setAttribute("class","btn");
jQuery(l).click(function(){if(c.grid.serverPaging)self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"none",values:[]});else{c.grid.conditions[h].blackList=[];for(var j=0;j<c.grid.rows.length;j++){for(var k=0;k<c.grid.columns.length;k++)-1===c.grid.conditions[k].blackList.findIndex(c.grid.rows[j].cells[k].options.value)&&c.grid.conditions[k].blackList.push(c.grid.rows[j].cells[k].options.value);OAT.HideGridRow(c,h,c.grid.rows[j].cells[h].options.value)}}OAT.saveState(c,
!0,h);OAT.onFilteredChangedEventHandle(c,h);OAT.distinctDivs(c,g)});var r=document.createElement("button");r.textContent=gx.getMessage("GXPL_QViewerJSReverse");r.setAttribute("class","btn");jQuery(r).click(function(){if(c.grid.serverPaging)self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h],{op:"reverse",values:[]});else{for(var j=[],k=0;k<c.grid.rows.length;k++){var l=c.grid.rows[k].cells[h].options.value;-1==c.grid.conditions[h].blackList.findIndex(l)&&
j.push(l)}for(k=0;k<c.grid.columns.length;k++)c.grid.conditions[k].blackList=[];c.grid.conditions[h].blackList=j;for(k=0;k<c.grid.rows.length;k++)c.grid.rows[k].html.style.display="",c.grid.rows[k].html.setAttribute("visibQ","tt");OAT.filterRows(c.grid)}OAT.saveState(c,!0,h);OAT.distinctDivs(c,g);OAT.onFilteredChangedEventHandle(c,h)});OAT.Dom.append([k,n,l,r],[g,k]);k=OAT.Dom.create("div");k.setAttribute("class","div_filter_input");c.grid.serverPaging&&(n=document.createElement("input"),n.textContent=
"none",n.setAttribute("class","search_input"),n.setAttribute("type","text"),n.setAttribute("label","Search filter..."),n.setAttribute("title","Search filter..."),n.setAttribute("placeholder","Search filter..."),n.setAttribute("id",c.grid.UcId+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h]),jQuery(n).keyup(m),OAT.Dom.append([k,n],[g,k]));k=OAT.Dom.create("div");if(c.grid.serverPaging){n=OAT_JS.grid.getCantDifferentValues(c.grid.UcId,h);for(m=0;m<n;m++){var t=OAT_JS.grid.getDifferentValues(c.grid.UcId,
h,m);if(t){l=t.value;r=t.pict_value;if("#NuN#"==t.value||""==r.trimpivot())r+="&nbsp;";r=r.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");33<r.length&&(w=0<r.substring(32,r.length).trimpivot().length?"...":"",r=r.substring(0,32)+w);r=r.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";r=j(r,"pivot_distinct_"+m);r[0].setAttribute("value",l);k.appendChild(r[0]);l=(l=t.checked)?"check_item_img":"uncheck_item_img";r[0].setAttribute("class",l);OAT.Dom.attach(r[0],"click",function(){var c=this.getAttribute("class")!==
"check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");q(c,this.getAttribute("value"))})}}9>=OAT_JS.grid.getCantDifferentValues(c.grid.UcId,h)?k.setAttribute("class","pivot_popup_auto"):k.setAttribute("class","pivot_popup_fix");k.setAttribute("ucid",c.grid.UcId);k.setAttribute("columnnumber",h);k.setAttribute("id","values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[h])}else{n=[];for(m=0;m<c.grid.rows.length;m++)if(-1===
n.findIndex(c.grid.rows[m].cells[h].options.value)){l=c.grid.rows[m].cells[h].options.value;r=c.grid.rows[m].cells[h].value.innerHTML;r=r.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(33<r.length)var w=0<r.substring(32,r.length).trimpivot().length?"...":"",r=r.substring(0,32)+w;r=r.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";r=j(r,"pivot_distinct_"+m);r[0].setAttribute("value",l);k.appendChild(r[0]);l=(l=-1==c.grid.conditions[h].blackList.findIndex(l))?"check_item_img":"uncheck_item_img";
r[0].setAttribute("class",l);OAT.Dom.attach(r[0],"click",function(){var c=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");q(c,this.getAttribute("value"))});n.push(c.grid.rows[m].cells[h].options.value)}9>=n.length?k.setAttribute("class","pivot_popup_auto"):k.setAttribute("class","pivot_popup_fix")}g.appendChild(k)};OAT.appendNewPairToPopUp=function(c,g,h,j,k,m){"#NuN#"==g&&(k="&nbsp;");k=k.replace(/\&amp;/g,
"&").replace(/\&nbsp;/g," ");if(33<k.length)var n=0<k.substring(32,k.length).trimpivot().length?"...":"",k=k.substring(0,32)+n;k=k.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";k=function(c,g){var h=OAT.Dom.create("div"),j=OAT.Dom.create("input"),k=OAT.Dom.create("label");k.innerHTML=c;k.htmlFor=g;h.appendChild(k);return[h,j]}(k,"pivot_distinct_"+i);k[0].setAttribute("value",g);jQuery("#values_"+c.grid.UcId+"_"+m)[0].appendChild(k[0]);k[0].setAttribute("class",j?"check_item_img":"uncheck_item_img");
OAT.Dom.attach(k[0],"click",function(){var g="check_item_img"!==this.getAttribute("class");this.setAttribute("class","check_item_img"===this.getAttribute("class")?"uncheck_item_img":"check_item_img");var j=this.getAttribute("value"),k="pop";g||(k="push");self.getDataForTable(c.grid.UcId,1,c.grid.rowsPerPage,!0,"","",m,{op:k,values:j});OAT.onFilteredChangedEventHandle(c,h);OAT.saveState(c,!0,h)})};OAT.removeAllPairsFromPopUp=function(c,g,h){jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).find(".check_item_img").remove();
jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).find(".uncheck_item_img").remove();jQuery(".last_div_popup .check_item_img").remove();jQuery(".last_div_popup .uncheck_item_img").remove();h?(jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).removeClass("pivot_popup_auto"),jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).addClass("pivot_popup_fix")):(jQuery("#values_"+c.grid.UcId+"_"+
OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).removeClass("pivot_popup_fix"),jQuery("#values_"+c.grid.UcId+"_"+OAT_JS.grid.gridData[c.grid.UcId].columnDataField[g]).addClass("pivot_popup_auto"))};OAT.onFilteredChangedEventHandle=function(c,g){if(c.grid.serverPaging)return OAT_JS.grid.setFilterChangedWhenServerPagination(c.grid.UcId,c.grid.columns[g]);for(var h='<DATA event="FilterChanged" name="'+c.grid.columns[g].getAttribute("name")+'" displayName="'+c.grid.columns[g].getAttribute("displayName")+
'">',j=[],k=0;k<c.grid.rows.length;k++)-1===j.findIndex(c.grid.rows[k].cells[g].options.value)&&-1===c.grid.conditions[g].blackList.findIndex(c.grid.rows[k].cells[g].options.value)&&(h=h+"<VALUE>"+c.grid.rows[k].cells[g].options.value+"</VALUE>",j.push(c.grid.rows[k].cells[g].options.value));h+="</DATA>";j=c.grid.IdForQueryViewerCollection;qv.util.isGeneXusPreview()&&window.external.SendText(c.QueryViewerCollection[c.IdForQueryViewerCollection].ControlName,h);if(c.grid.QueryViewerCollection[j].FilterChanged){k=
qv.util.dom.xmlDocument(h);h=qv.util.dom.selectXPathNode(k,"/DATA");c.grid.QueryViewerCollection[j].FilterChangedData={};c.grid.QueryViewerCollection[j].FilterChangedData.Name=h.getAttribute("name");c.grid.QueryViewerCollection[j].FilterChangedData.SelectedValues=[];for(var m=-1,k=0;k<h.childNodes.length;k++)"VALUE"==h.childNodes[k].nodeName&&(m++,c.grid.QueryViewerCollection[j].FilterChangedData.SelectedValues[m]=h.childNodes[k].firstChild.nodeValue);c.grid.QueryViewerCollection[j].FilterChanged()}};
OAT.setClickEventHandlers=function(c,g,h,j,k,m){jQuery(g).data("itemValue",h);jQuery(g).data("typeMorD",j);jQuery(g).data("numberMorD",k);jQuery(g).data("itemInfo",m);g.onclick=function(){OAT.onClickEventHandle(c,this)};c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection].ItemClick&&(g.style.cursor="pointer")};var alreadyclicked=!1,alreadyclickedTimeout;OAT.onClickEventHandle=function(c,g){if(alreadyclicked){alreadyclicked=!1;clearTimeout(alreadyclickedTimeout);var h=OAT.ClickHandle(c,
g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],h,!0)}else h=300,void 0==c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection].ItemDoubleClick&&(h=0),alreadyclicked=!0,alreadyclickedTimeout=setTimeout(function(){alreadyclicked=!1;var h=OAT.ClickHandle(c,g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],h,!1)},h)};OAT.onDblClickEventHandle=function(c,g){var h=OAT.ClickHandle(c,g);qv.pivot.onItemClickEvent(c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],
h,!0)};OAT.ClickHandle=function(c,g){if(c.grid.HideDataFilds.length){var h=c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection].getPivottableDataSync();c.grid.allRowsPivot=[];c.grid.allFullRowsPivot=[];for(var h=h.split("<Record>"),j=1;j<h.length;j++){for(var k=[],m=[],n=0;n<c.grid.TableDataFilds.length;n++){k[n]="#NuN#";var l=h[j].split("<"+c.grid.TableDataFilds[n]+">");1<l.length?(l=l[1].split("</"+c.grid.TableDataFilds[n]+">"),k[n]=l[0],m[n]=k[n]):0<=h[j].indexOf("<"+c.grid.TableDataFilds[n]+
"/>")&&(k[n]="",m[n]="")}c.grid.allRowsPivot.push(k);for(n=0;n<c.grid.HideDataFilds.length;n++)l=h[j].split("<"+c.grid.HideDataFilds[n]+">"),1<l.length&&(l=l[1].split("</"+c.grid.HideDataFilds[n]+">"),m[m.length+n]=l[0]);c.grid.allFullRowsPivot.push(m)}}h=[];j=jQuery(g).data("itemValue");m=jQuery(g).data("typeMorD");n=jQuery(g).data("numberMorD");k=jQuery(g).data("itemInfo");m='<DATA><ITEM type="'+m+'" name="'+c.grid.columns[n].getAttribute("name")+'" ';m=m+'displayName="'+c.grid.columns[n].getAttribute("displayName")+
'" ';m=m+'location="rows">'+j+"</ITEM><CONTEXT><RELATED>";for(j=0;j<c.grid.rows[k].cells.length;j++)m=m+'<ITEM name="'+c.grid.columns[j].getAttribute("name")+'">',m+="<VALUES>",m=m+"<VALUE>"+c.grid.rows[k].cells[j].options.value+"</VALUE>",h.push(c.grid.rows[k].cells[j].options.value),m+="</VALUES>",m+="</ITEM>";if(c.grid.HideDataFilds.length)for(j=0;j<c.grid.allFullRowsPivot.length;j++){a:{for(n=0;n<h.length;n++)if(void 0!=h[n]&&h[n]!=c.grid.allFullRowsPivot[j][n]){n=!1;break a}n=!0}if(n)for(n=0;n<
c.grid.HideDataFilds.length;n++)m=m+'<ITEM name="'+c.grid.OrderFildsHidden[n]+'">',m+="<VALUES>",m=m+"<VALUE>"+c.grid.allFullRowsPivot[j][n+c.grid.rows[k].cells.length]+"</VALUE>",m+="</VALUES>",m+="</ITEM>"}return m+"</RELATED><FILTERS></FILTERS></CONTEXT></DATA>"};OAT.gridStateChanged=function(c){if(c.grid.serverPaging)return OAT_JS.grid.getStateChange(c.grid.UcId);for(var g=!1,h=0;h<c.grid.columnsDataType.length;h++)void 0!=c.grid.header.cells[h]&&""!=c.grid.header.cells[h].html.style.display&&
(g=!0);for(h=0;h<c.grid.conditions.length;h++)1!=c.grid.conditions[h].sort&&(g=!0),0<c.grid.conditions[h].blackList.length&&(g=!0);return void 0!=c.grid.InitPageSize&&c.grid.rowsPerPage!=c.grid.InitPageSize?!0:g};OAT.createXMLMetadata=function(c,g,h){for(var g='<OLAPCube format="compact" thousandsSeparator="," decimalSeparator="." dateFormat="MDY">',j=0;j<=c.grid.columns.length-1;j++){var k=j,g=g+"<OLAPDimension> ",g=g+"<name>"+c.grid.columns[k].getAttribute("name")+"</name> ",g=g+"<displayName>"+
c.grid.columns[k].getAttribute("displayName")+"</displayName> ",g=g+"<description>"+c.grid.columns[k].getAttribute("description")+"</description> ",g=g+"<dataField>"+c.grid.columns[k].getAttribute("dataField")+"</dataField> ",g=g+"<dataType>"+c.grid.columns[k].getAttribute("dataType")+"</dataType> ",g="none"!=c.grid.header.cells[k].html.style.display?g+"<defaultPosition>"+c.grid.columns[k].getAttribute("defaultPosition")+"</defaultPosition> ":g+"<defaultPosition>hidden</defaultPosition> ",g=g+"<validPositions>"+
c.grid.columns[k].getAttribute("validPositions")+"</validPositions> ",g=g+"<summarize>"+c.grid.columns[k].getAttribute("summarize")+"</summarize> ",g=g+"<align>"+c.grid.columns[k].getAttribute("align")+"</align> ";"none"==c.grid.header.cells[k].html.style.display&&(g+="<hidden>true</hidden>");g=""===c.grid.columns[k].getAttribute("picture")?g+"<picture/> ":g+"<picture>"+c.grid.columns[k].getAttribute("picture")+"</picture> ";g=""===c.grid.columns[k].getAttribute("picture")?g+"<format/> ":g+"<format>"+
c.grid.columns[k].getAttribute("format")+"</format> ";g=2===c.grid.conditions[k].sort?g+"<order>ascending</order> ":1===c.grid.conditions[k].sort?g+"<order>none</order> ":g+"<order>descending</order> ";g=g+"<popupDisabled>"+c.grid.columns[k].getAttribute("popupDisabled")+"</popupDisabled> ";g+="<customOrder/> ";g+="<include> ";if(h){var m=c.grid.columns[k].getAttribute("dataField");if("none"!=c.blackLists[m].state&&"all"!=c.blackLists[m].state)for(n=0;n<c.blackLists[m].visibles.length;n++)g=g+"<value>"+
c.blackLists[m].visibles[n].trimpivot()+"</value> ";else if("none"!=c.blackLists[m].state)for(n=0;n<c.differentValues[m].length;n++)g=g+"<value>"+c.differentValues[m][n].trimpivot()+"</value> "}else for(var m=[],n=0;n<c.grid.rows.length;n++)void 0!=c.grid.rows[n].cells[k]&&(-1===m.findIndex(c.grid.rows[n].cells[k].options.value)&&-1===c.grid.conditions[k].blackList.findIndex(c.grid.rows[n].cells[k].options.value))&&(g=g+"<value>"+c.grid.rows[n].cells[k].options.value.toString().trimpivot()+"</value> ",
m.push(c.grid.rows[n].cells[k].options.value));g+="<value>TOTAL</value> </include> <collapse/> null null null ";g+="<hide> ";if(h)if(m=c.grid.columns[k].getAttribute("dataField"),"none"!=c.blackLists[m].state&&"all"!=c.blackLists[m].state)for(n=0;n<c.blackLists[m].hiddens.length;n++)g=g+"<value>"+c.blackLists[m].hiddens[n].trimpivot()+"</value> ";else{if("all"!=c.blackLists[m].state)for(n=0;n<c.differentValues[m].length;n++)g=g+"<value>"+c.differentValues[m][n].trimpivot()+"</value> "}else for(n=
0;n<c.grid.conditions[k].blackList.length;n++){for(var m=0===k,l=0;l<c.grid.rows.length;l++)if(c.grid.rows[l].cells[k].options.value===c.grid.conditions[k].blackList[n])for(var o=0;o<k;o++)-1===c.grid.conditions[o].blackList.findIndex(c.grid.rows[l].cells[o].options.value)&&(m=!0);!0===m&&(g=g+"<value>"+c.grid.conditions[k].blackList[n].toString().trimpivot()+"</value> ")}g+="</hide> ";n=c.grid.columnsDataType.length-1-k;try{void 0!=c.grid.header.cells[n]&&(""===c.grid.header.cells[n].html.style.display?
(g+="<condition>table</condition> ",g+="<filterbar>no</filterbar> "):(g+="<condition>none</condition> ",g+="<filterbar>yes</filterbar> "),g=g+"<position>"+c.columnDataField.indexOf(c.grid.columns[k].getAttribute("dataField"))+"</position>")}catch(q){}try{var r=c.columnDataField.indexOf(c.grid.columns[k].getAttribute("dataField"))+1,g=g+"<axisOrder>"+r+"</axisOrder>"}catch(t){}g+="<restoreview>no</restoreview> ";g+=" </OLAPDimension>"}return g+"</OLAPCube>"};OAT.ExportToPdf=function(c,g){for(var h=
[],j=0;1>j;j++)for(var k=jQuery("#"+c.grid.controlName+" tr")[j],m=0;m<k.children.length;m++)"none"==k.children[m].style.display&&h.push(m);var n=30*jQuery("#"+c.grid.controlName+" tr").length+25;841>n&&(n=841);var l=0,k=jQuery("#"+c.grid.controlName+" tr")[0].children.length-h.length,l=95*k+25;595>l&&(l=595);for(var o=[],j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++)for(var k=jQuery("#"+c.grid.controlName+" tr")[j],q=0,m=0;m<k.children.length;m++){var r=k.children[m].textContent,t=k.children[m].getAttribute("hidden");
if("none"!=k.children[m].style.display&&null===t){void 0==o[q]&&(o[q]=30);for(var w=0,v=0;v<r.length;v++)1E3<r.charCodeAt(v)&&w++;0===w?14<r.length&&1.68*r.length>o[q]&&(o[q]=1.68*r.length):(r=2.8*w+1.68*(r.length-w),r>o[q]&&(o[q]=r));q+=1}}for(j=k=0;j<o.length;j++)k=k+2.5*o[j]+65;k=20+k+5;k>l&&(l=k);w=function(c,g){for(var h=0,j=0;j<c;j++)h+=g[j];return h};n=l<=n?new jsPDF("portrait","mm","a4",!1,l,792):new jsPDF("landscape","mm","a4",!1,l,792);n.setFontSize(8);n.line(18,13,20+w(jQuery("#"+c.grid.controlName+
" tr")[0].children.length-h.length,o),13);for(var l=-1,A=1,F=Math.min(jQuery("#"+c.grid.controlName+" tr").length-26*(A-1),26),j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){l++;k=jQuery("#"+c.grid.controlName+" tr")[j];for(m=q=0;m<k.children.length;m++)if("none"!=k.children[m].style.display){n.line(18+w(q,o),13,18+w(q,o),23+10*(F-1));var r=k.children[m].textContent,t=k.children[m].getAttribute("hidden"),H=[];if(1E3<r.charCodeAt(0))for(v=0;v<r.length;v++)H[v]=OAT.getCharacterImg(r.charCodeAt(v));
else{for(var u=-1,v=1;v<r.length;v++)if(1E3<r.charCodeAt(v)){u=v;break}if(0<u){for(var B=r.substring(0,u),E=0,v=u;v<r.length;v++)H[E]=OAT.getCharacterImg(r.charCodeAt(v)),E++;r=B}}B=!1;n.setTextColor(0,0,0);n.setFontStyle("normal");v=!isNaN(parseFloat(r));u=n.getStringUnitWidth(r);if(void 0!=k.children[m].getAttribute("style")&&null!=k.children[m].getAttribute("style"))for(var E=k.children[m].getAttribute("style").split(";"),z=0;z<E.length;z++){var x=E[z].split(":");"color"===x[0].replace(/^\s+|\s+$/g,
"")?(x=x[1].replace(/^\s+|\s+$/g,""),x=x.substring(4,x.length),x=x.substring(0,x.length-1),n.setTextColor(parseInt(x.split(",")[0]),parseInt(x.split(",")[1]),parseInt(x.split(",")[2]))):"text-align"===x[0].replace(/^\s+|\s+$/g,"")?v="right"==x[1].replace(/^\s+|\s+$/g,""):"font-style"===x[0].replace(/^\s+|\s+$/g,"")?n.setFontStyle("italic"):"font-weight"===x[0].replace(/^\s+|\s+$/g,"")?"bold"===x[1].replace(/^\s+|\s+$/g,"")&&n.setFontStyle("bold"):"background-color"===x[0].replace(/^\s+|\s+$/g,"")?
(x=x[1].replace(/^\s+|\s+$/g,""),x=x.substring(4,x.length),x=x.substring(0,x.length-1),n.setFillColor(parseInt(x.split(",")[0]),parseInt(x.split(",")[1]),parseInt(x.split(",")[2])),B=!0):"border-color"===x[0].replace(/^\s+|\s+$/g,"")&&(x=x[1].replace(/^\s+|\s+$/g,""),x=x.substring(4,x.length),x=x.substring(0,x.length-1),n.setDrawColor(parseInt(x.split(",")[0]),parseInt(x.split(",")[1]),parseInt(x.split(",")[2])))}B&&m==k.children.length-1?n.rect(18+w(q,o),23+10*(l-1),32,10,"FD"):B&&n.rect(18+w(q,
o),23+10*(l-1),30,10,"FD");n.setDrawColor(0,0,0);n.setFontSize(8);if(null===t&&(t=0,1E3>r.charCodeAt(0)&&(t=r.length+2,v?n.text(20+w(q+1,o)-3*u-4,20+10*l,r):n.text(20+w(q,o),20+10*l,r)),0<H.length))for(v=0;v<H.length;v++)n.addImage(H[v],"JPEG",20+w(q,o)+t+2.5*v,20+10*l-2.5,2.5,2.5);q+=1}n.line(20+w(k.children.length-h.length,o),13,20+w(k.children.length-h.length,o),23+10*(F-1));n.line(18,23+10*l,20+w(k.children.length-h.length,o),23+10*l);25<=l&&(n.setDrawColor(0,0,0),A++,F=Math.min(jQuery("#"+c.grid.controlName+
" tr").length-1-26*(A-1)+1,26),l=-1,n.addPage(),n.line(18,13,20+w(jQuery("#"+c.grid.controlName+" tr")[0].children.length-h.length,o),13))}if(gx.util.browser.webkit&&!gx.util.browser.chrome)n.output("dataurlnewwindow");else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())n.save(g+".pdf");else return n.output()};OAT.ExportToExcel=function(c,g){for(var h="<table><tbody>",j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){for(var h=h+"<tr>",k=jQuery("#"+c.grid.controlName+" tr")[j],m=0;m<
k.children.length;m++){var n;0===j?n=k.children[m].getAttribute("title_v"):(k.children[m].getAttribute("title"),n=k.children[m].textContent);void 0===n&&(n=k.children[m].textContent);var l=k.children[m].getAttribute("hidden");if("none"!=k.children[m].style.display&&null===l){var l=k.children[m].getAttribute("rowspan"),o=k.children[m].getAttribute("colspan"),q="";void 0!=k.children[m].getAttribute("style")&&null!=k.children[m].getAttribute("style")&&(q=' style="'+k.children[m].getAttribute("style")+
'" ');h=null===l&&null===o?h+"<td "+q+">"+n+"</td>":null===o?h+"<td "+q+' rowspan="'+l+'">'+n+"</td>":null===l?h+"<td "+q+' colspan="'+o+'">'+n+"</td>":h+"<td "+q+' colspan="'+o+'" rowspan="'+l+'">'+n+"</td>"}}h+="</tr>"}h+="</tbody></table>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:application/vnd.ms-excel,"+encodeURIComponent(h));else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())h=new Blob([h],{type:"application/vnd.ms-excel"}),saveAs(h,g+".xls");else return h};
OAT.ExportToExcel2010=function(c,g,h,j,k){function m(c){c=c.toString(16);return 1==c.length?"0"+c:c}function n(c,g,h){return m(c)+m(g)+m(h)}dataTable=[];var l=jQuery("#"+c.grid.controlName+" tr").length;void 0!=h&&h&&(l=1);for(var o=[],q=0;q<l;q++){dataRow=[];for(var r=jQuery("#"+c.grid.controlName+" tr")[q],t=0;t<r.children.length;t++){var w=r.children[t].textContent,v=r.children[t].getAttribute("hidden");if("none"!=r.children[t].style.display){if(null===v){var v=r.children[t].getAttribute("rowspan"),
A=r.children[t].getAttribute("colspan"),w={value:w};if(void 0!=r.children[t].getAttribute("style")&&null!=r.children[t].getAttribute("style"))for(var F=r.children[t].getAttribute("style").split(";"),H=0;H<F.length;H++){var u=F[H].split(":");"color"===u[0].replace(/^\s+|\s+$/g,"")?(u=u[1].replace(/^\s+|\s+$/g,""),u=u.substring(4,u.length),u=u.substring(0,u.length-1),u=n(parseInt(u.split(",")[0]),parseInt(u.split(",")[1]),parseInt(u.split(",")[2])),w.fontColor=u):"text-align"===u[0].replace(/^\s+|\s+$/g,
"")?(u=u[1].replace(/^\s+|\s+$/g,""),w.vAlign=u):"font-style"===u[0].replace(/^\s+|\s+$/g,"")?"italic"===u[1].replace(/^\s+|\s+$/g,"")&&(w.italic=1):"font-weight"===u[0].replace(/^\s+|\s+$/g,"")?"bold"===u[1].replace(/^\s+|\s+$/g,"")&&(w.bold=1):"background-color"===u[0].replace(/^\s+|\s+$/g,"")&&(u=u[1].replace(/^\s+|\s+$/g,""),u=u.substring(4,u.length),u=u.substring(0,u.length-1),u=n(parseInt(u.split(",")[0]),parseInt(u.split(",")[1]),parseInt(u.split(",")[2])),w.fill=u)}null===v&&null===A||(null===
A?w.rowSpan=parseInt(v):null===v?w.colSpan=parseInt(A):(w.colSpan=parseInt(A),w.rowSpan=parseInt(v)));dataRow.push(w)}}else o.push(t)}dataTable.push(dataRow)}if(void 0!=h&&h)for(q=0;q<j.length;q++){dataRow=[];for(t=0;t<j[q].length;t++)if(-1==o.indexOf(t)){w=OAT.defaultPictureValue(j[q][t],c.grid.columnsDataType,OAT_JS.grid.gridData[k].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomPicture[t]);h=OAT.Dom.create("td");h.setAttribute("title",w);h=OAT.applyFormatValues(h,
j[q][t],c.grid.columnsDataType,t,OAT_JS.grid.gridData[k].rowsMetadata.formatValues,OAT_JS.grid.gridData[k].rowsMetadata.conditionalFormatsColumns,OAT_JS.grid.gridData[k].rowsMetadata.forPivotCustomFormat);if("character"!=c.grid.columnsDataType[t]||"date"===c.grid.columnsDataType)h.style.textAlign="right";w={value:w};if(void 0!=h.getAttribute("style")&&null!=h.getAttribute("style")){F=h.getAttribute("style").split(";");for(H=0;H<F.length;H++)u=F[H].split(":"),"color"===u[0].replace(/^\s+|\s+$/g,"")?
(u=u[1].replace(/^\s+|\s+$/g,""),u=u.substring(4,u.length),u=u.substring(0,u.length-1),u=n(parseInt(u.split(",")[0]),parseInt(u.split(",")[1]),parseInt(u.split(",")[2])),w.fontColor=u):"text-align"===u[0].replace(/^\s+|\s+$/g,"")?(u=u[1].replace(/^\s+|\s+$/g,""),w.vAlign=u):"font-style"===u[0].replace(/^\s+|\s+$/g,"")?"italic"===u[1].replace(/^\s+|\s+$/g,"")&&(w.italic=1):"font-weight"===u[0].replace(/^\s+|\s+$/g,"")?"bold"===u[1].replace(/^\s+|\s+$/g,"")&&(w.bold=1):"background-color"===u[0].replace(/^\s+|\s+$/g,
"")&&(u=u[1].replace(/^\s+|\s+$/g,""),u=u.substring(4,u.length),u=u.substring(0,u.length-1),u=n(parseInt(u.split(",")[0]),parseInt(u.split(",")[1]),parseInt(u.split(",")[2])),w.fill=u)}dataRow.push(w)}dataTable.push(dataRow)}c=xlsx({creator:"Genexus",lastModifiedBy:"Genexus",pivot:!1,worksheets:[{data:dataTable,name:"Sheet 1"}]});if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.location=c.href();else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())c=atob(c.base64),c=Array.prototype.map.call(c,
function(c){return c.charCodeAt(0)}),c=new Uint8Array(c),c=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),saveAs(c,g+".xlsx");else return c.base64};OAT.ExportToXML=function(c,g){for(var h=[],j=0;1>j;j++)for(var k=jQuery("#"+c.grid.controlName+" tr")[j],m=0;m<k.children.length;m++)"none"==k.children[m].style.display&&h.push(m);var n;n='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><EXPORT format="XML" type="flat"><METADATA>';for(k=0;k<c.grid.columns.length;k++)if(-1==
h.indexOf(k)){n+="<OLAPDimension ";n=n+'name="'+c.grid.columns[k].getAttribute("dataField")+'" ';n=n+'label="'+c.grid.columns[k].getAttribute("displayName")+'" ';n=n+'picture="'+c.grid.columns[k].getAttribute("picture")+'" ';n=n+'datatype="'+c.grid.columns[k].getAttribute("dataType")+'" ';n+='showAll="false" ';n+='position="row">';m=[];for(j=0;j<c.grid.rows.length;j++)if(-1===m.findIndex(c.grid.rows[j].cells[k].options.value)){n+="<VALUE CHECKED=";-1===c.grid.conditions[k].blackList.findIndex(c.grid.rows[j].cells[k].options.value)?
(m.push(c.grid.rows[j].cells[k].options.value),n+='"true"'):n+='"false"';n+=' COLLAPSED="false">';var l=c.grid.rows[j].cells[k].options.value;if(!isNaN(parseFloat(c.grid.rows[j].cells[k].options.value))&&(parseFloat(c.grid.rows[j].cells[k].options.value),void 0!=data))for(var o=0;o<data.length;o++)if(void 0!=data[o])for(var q=0;q<data[o].length;q++)void 0!=parseFloat(data[o][q])&&!isNaN(data[o][q])&&parseFloat(data[o][q])===parseFloat(c.grid.rows[j].cells[k].options.value)&&(l=data[o][q]);n=n+l+"</VALUE>"}n+=
"</OLAPDimension>"}for(k=0;k<measures.length;k++)n+="<OLAPMeasure ",n=n+'name="'+measures[k].getAttribute("dataField")+'" ',n=n+'label="'+measures[k].getAttribute("displayName")+'" ',n=n+'picture="'+measures[k].getAttribute("picture")+'" ',n=n+'datatype="'+measures[k].getAttribute("dataType")+'" ',n+='showAll="true" ',n+='aggregator="sum"/>';n+="</METADATA><FLATDATA>";if(void 0!=data)for(j=0;j<data.length;j++){n+="<ROW ";for(k=0;k<data[0].length;k++)-1==h.indexOf(k)&&(l=data[j][k],n=n+c.grid.columns[k].getAttribute("dataField")+
'="'+l+'" ');n+="/>"}else for(j=0;j<c.grid.rows.length;j++){n+="<ROW ";for(k=0;k<c.grid.rows[0].cells.length;k++){l=c.grid.rows[j].cells[k].options.value;if(!isNaN(parseFloat(c.grid.rows[j].cells[k].options.value))&&(parseFloat(c.grid.rows[j].cells[k].options.value),void 0!=data))for(o=0;o<data.length;o++)if(void 0!=data[o])for(q=0;q<data[o].length;q++)void 0!=parseFloat(data[o][q])&&!isNaN(data[o][q])&&parseFloat(data[o][q])===parseFloat(c.grid.rows[j].cells[k].options.value)&&(l=data[o][q]);n=n+
c.grid.columns[k].getAttribute("dataField")+'="'+l+'" '}n+="/>"}n+='</FLATDATA><HTML><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><STYLE>.odd {background-color: #FEFEFE; font-family: Verdana; font-size: 10pt;}\n.event {background-color: #EBEBEB; font-family: Verdana; font-size: 10pt;}\n.even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\ntr {border-left: 1px solid #BBBBBB; border-right: 1px solid #BBBBBB; line-height: 22px;}\ntable {border-collapse: collapse;}\n</STYLE></HEAD><BODY>';
for(j=0;j<jQuery("#"+c.grid.controlName+" tr").length;j++){n+="<TR>";k=jQuery("#"+c.grid.controlName+" tr")[j];for(m=0;m<k.children.length;m++)if(h=k.children[m].textContent,l=k.children[m].getAttribute("hidden"),"none"!=k.children[m].style.display&&null===l){l=k.children[m].getAttribute("rowspan");o=k.children[m].getAttribute("colspan");q="";void 0!=k.children[m].getAttribute("style")&&null!=k.children[m].getAttribute("style")&&(q=' style="'+k.children[m].getAttribute("style")+'" ');var r="";void 0!=
k.getAttribute("class")&&null!=k.getAttribute("class")&&(r=' class="'+k.getAttribute("class")+'" ');n=null===l&&null===o?n+"<TD "+r+" "+q+" >"+h+"</TD>":null===o?n+"<TD "+r+" "+q+' rowspan="'+l+'">'+h+"</TD>":null===l?n+"<TD "+r+" "+q+' colspan="'+o+'">'+h+"</TD>":n+"<TD "+r+" "+q+' colspan="'+o+'" rowspan="'+l+'">'+h+"</TD>"}n+="</TR>"}n+="</BODY></HTML></EXPORT>";if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion())n=n.replace(/\&/g,"&amp;"),gx.util.browser.webkit&&!gx.util.browser.chrome?
window.open("data:text/xml,"+encodeURIComponent(n)):(j=new Blob([n],{type:"text/xml"}),saveAs(j,g+".xml"));else return n.replace(/\&/g,"&amp;")};OAT.SaveStateWhenServerPaging=function(c,g,h,j,k,m,n,l){g={pageSize:h,dataFieldOrder:j,orderType:k,filters:m,blackLists:n,columnVisible:l};h=Array(c.columnsDataType);for(j=0;j<c.columnsDataType.length;j++)void 0!=c.header.cells[j]&&(h[j]=c.header.cells[j].html.style.display);localStorage.setItem(OAT.getURL()+c.controlName+c.query,JSON.stringify(g))};OAT.saveState=
function(c,g,h){if(!c.grid.serverPaging){"function"!==typeof JSON.decycle&&(JSON.decycle=function(c){var g=[],h=[];return function q(c,j){var k,m,A;switch(typeof c){case "object":if(!c)return null;for(k=0;k<g.length;k+=1)if(g[k]===c)return{$ref:h[k]};g.push(c);h.push(j);if("[object Array]"===Object.prototype.toString.apply(c)){A=[];for(k=0;k<c.length;k+=1)A[k]=q(c[k],j+"["+k+"]")}else for(m in A={},c)Object.prototype.hasOwnProperty.call(c,m)&&(A[m]=q(c[m],j+"["+JSON.stringify(m)+"]"));return A;case "number":case "string":case "boolean":return c}}(c,
"$")});for(var j=Array(c.grid.columnsDataType),k=0;k<c.grid.columnsDataType.length;k++)void 0!=c.grid.header.cells[k]&&(j[k]=c.grid.header.cells[k].html.style.display);"1"===g&&(c.grid.rowsPerPage=c.grid.InitPageSize);j={conditions:c.grid.conditions,columnDisplay:j,rowsPerPage:c.grid.rowsPerPage};localStorage.setItem(OAT.getURL()+c.grid.controlName+c.grid.query,JSON.stringify(JSON.decycle(j)));j=!isNaN(c.grid.rowsPerPage)&&""!=c.grid.rowsPerPage?c.grid.rowsPerPage:c.grid.InitPageSize;"1"===g&&(j=
c.grid.InitPageSize);j={currPage:1,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+c.grid.controlName)),optionsForRows:[10,15,20],rowsPerPage:"undefined"!=j?j:50,firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",!0),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?
(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",!0),lastArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",
!0),nextArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/nextBlue.png",!0),jstype:"table",topNav:!1,controlName:c.grid.controlName};c.grid.InitPageSize&&g&&(jQuery("#"+c.grid.controlName).tablePagination(j),setTimeout(function(){var g=jQuery("#"+c.grid.controlName)[0].offsetWidth-
1;jQuery("#"+c.grid.controlName+"_tablePagination").css({width:g+"px"});jQuery("#"+c.grid.controlName).css("margin-bottom","0px")},500));void 0!=h&&-1<h&&(g=OAT.createXMLMetadata(c,h),h=c.grid.QueryViewerCollection[c.grid.IdForQueryViewerCollection],""!=h&&(null!=h&&void 0!=h)&&qv.util.autorefresh.UpdateLayoutSameGroup(h,g))}};OAT.getStateWhenServingPaging=function(c,g){var h=localStorage.getItem(OAT.getURL()+c+g);return JSON.parse(h)};OAT.getState=function(c,g){"function"!==typeof JSON.retrocycle&&
(JSON.retrocycle=function(c){var g=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function q(c){var h,j,k;if(c&&"object"===typeof c)if("[object Array]"===Object.prototype.toString.apply(c))for(h=0;h<c.length;h+=1){if((j=c[h])&&"object"===typeof j)k=j.$ref,"string"===typeof k&&g.test(k)?c[h]=eval(k):q(j)}else for(h in c)if("object"===typeof c[h]&&(j=c[h]))k=j.$ref,"string"===typeof k&&g.test(k)?c[h]=eval(k):q(j)})(c);return c});var h=localStorage.getItem(OAT.getURL()+
c.controlName+c.query),h=JSON.retrocycle(JSON.parse(h));if(null!=h&&h.rowsPerPage+" "==g+" "){for(var j=0;j<c.columnsDataType.length;j++){c.header.cells[j].html.style.display=h.columnDisplay[j];for(var k=c.columnsDataType.length-1-j,m=0,m=0;m<c.rows.length;m++)c.rows[m].cells[k].html.style.display=h.columnDisplay[j]}c.conditions=h.conditions;c.rowsPerPage=h.rowsPerPage;return!0}return!1};OAT.SaveMetadata=function(c,g){try{window.localStorage&&(localStorage.removeItem(OAT.getURL()+g),localStorage.setItem(OAT.getURL()+
g,c))}catch(h){}};OAT.GetSavedMetadata=function(c){try{if(null!=localStorage.getItem(OAT.getURL()+c)){var g=localStorage.getItem(OAT.getURL()+c);if(void 0!=g&&null!=g)return g}}catch(h){}return""};gx.util.browser.webkit||(OAT.Event.attach(document,"mouseup",OAT.GridData.up),OAT.Event.attach(document,"mousemove",OAT.GridData.move));try{OAT.Loader.featureLoaded("grid")}catch(ERROR$$9){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){this.contains=function(c,g){for(var h=0;h<c.length;h++)if(c[h]===g)return h;return-1};renderJSPivot=function(c,g,h){"Table"!=c.RealType&&(c.ServerPaging=!1);"Table"==c.RealType&&(c.ServerPagingPivot=!1,""==qv.collection[c.UcId].AutoRefreshGroup&&jQuery(".oat_winrect_container").remove());if(c.RememberLayout&&c.ServerPaging&&"PivotTable"!=c.RealType){var j=OAT.getStateWhenServingPaging(c.UcId+"_"+c.ObjectName,c.ObjectName);if(j){var k=1;""==
j.pageSize&&(j.pageSize=void 0,k=0);g[c.UcId].getPageDataForTable(function(k){c.data=k;c.previousDataFieldOrder=j.dataFieldOrder;c.orderType=j.orderType;renderJSPivotInter(c,g,j,h)}.closure(this),[k,j.pageSize,!0,j.dataFieldOrder,j.orderType,j.filters])}else renderJSPivotInter(c,g,null,h)}else if("Table"!=c.RealType)renderJSPivotInter(c,g,null,h);else{c.customFilterInfo="";for(var k=jQuery.parseXML(c.metadata).getElementsByTagName("OLAPDimension"),m=!1,n="",l="",o=0;o<k.length;o++){k[o].getAttribute("dataField");
for(var q=[],r=!1,t=0;t<k[o].childNodes.length;t++)if(void 0!=k[o].childNodes[t]&&void 0!=k[o].childNodes[t].localName&&"include"===k[o].childNodes[t].localName)for(var r=!0,w=0;w<k[o].childNodes[t].childNodes.length;w++)null!=k[o].childNodes[t].childNodes[w].localName&&"value"===k[o].childNodes[t].childNodes[w].localName.toLowerCase()&&q.push(k[o].childNodes[t].childNodes[w].textContent);!m&&(void 0!=k[o].getAttribute("order")&&""!=k[o].getAttribute("order"))&&(n=k[o].getAttribute("dataField"),l=
"descending"==k[o].getAttribute("order")?"Descending":"Ascending",m=!0);if(r){for(var t=g[c.UcId].getAttributeValuesSync([k[o].getAttribute("dataField"),1,0,""]),t=JSON.parse(t),r=t.NotNullValues,w=[],v=0;v<q.length;v++)for(t=0;t<r.length;t++)if(r[t].trimpivot()==q[v].trimpivot()){w.push(r[t]);break}""==c.customFilterInfo&&(c.customFilterInfo=[]);q={DataField:k[o].getAttribute("dataField"),NotNullValues:{DefaultAction:"Exclude",Excluded:"",Included:w},NullIncluded:!0};c.customFilterInfo.push(q)}}""!=
c.customFilterInfo||""!=n?g[c.UcId].getPageDataForTable(function(j){c.data=j;renderJSPivotInter(c,g,null,h)}.closure(this),[1,c.PageSize,!0,n,l,c.customFilterInfo]):renderJSPivotInter(c,g,null,h)}};renderJSPivotInter=function(c,g,h,j){var k=c.RealType,m=c.container,n=c.page,l=c.content,o=c.chart,q=c.metadata;this.dataString=c.data;var r=c.ObjectName,t=c.ControlName,w=c.PageSize,v=c.ShrinkToFit,A=c.DisableColumnSort,F=c.UcId,H=c.RememberLayout;this.serverPaging=c.ServerPaging;this.previousDataFieldOrder=
c.previousDataFieldOrder;this.previousOrderType=c.orderType;this.previousFilters=h?h.filters:void 0;this.previousColumnVisible=h?h.columnVisible:void 0;this.initialColumnVisible=[];this.previousState=h;this.customFilterInfo=c.customFilterInfo;this.gridCacheSize=c.ServerPagingCacheSize;h="Rows"==c.ShowDataLabelsIn;if(void 0==H||"false"==H)H=!1;try{if(H){var u=OAT.GetSavedMetadata(m.id+r+F+t+k+"metadata");if(""===u)OAT.SaveMetadata(q,m.id+r+F+t+k+"metadata");else{var B=u.split("OLAPDimension").length===
q.split("OLAPDimension").length,E=u.split("OLAPMeasure").length===q.split("OLAPMeasure").length,z=u.split("name").length===q.split("name").length,x=!0;if(B&&E&&z)for(var y=1;y<u.split("name").length;y++){var C=u.split("name")[y].substring(2,u.split("name")[y].length).split('"')[0],I=q.split("name")[y].substring(2,q.split("name")[y].length).split('"')[0];C!=I&&(x=!1)}if(!B||!E||!z||!x)if(gx.util.browser.isIE())try{window.localStorage&&(localStorage.removeItem(OAT.getURL()+m.id+r+F+t+k+"metadata"),
localStorage.removeItem(OAT.getURL()+r+F))}catch(K){}else H=!1}}}catch(W){}u=jQuery.parseXML(q);this.InitMetadata={};this.InitMetadata.Metadata=q;this.InitMetadata.DataString=dataString;this.InitMetadata.Dimensions=[];this.InitMetadata.Conditions=[];this.InitMetadata.DataFields=[];B=u.getElementsByTagName("OLAPDimension");for(y=0;y<B.length;y++)E={},E.name=B[y].getAttribute("name"),E.displayName=B[y].getAttribute("displayName"),E.description=B[y].getAttribute("description"),E.dataField=B[y].getAttribute("dataField"),
E.defaultPosition=B[y].getAttribute("defaultPosition"),E.validPosition=B[y].getAttribute("validPositions"),E.Visible="hidden"!=E.defaultPosition,this.InitMetadata.Dimensions.push(E),this.InitMetadata.Conditions.push(""),this.InitMetadata.DataFields.push(E.dataField);this.InitMetadata.Measures=[];u=u.getElementsByTagName("OLAPMeasure");for(y=0;y<u.length;y++)B={},B.name=u[y].attributes.getNamedItem("name").nodeValue,B.displayName=u[y].attributes.getNamedItem("displayName").nodeValue,B.dataField=u[y].attributes.getNamedItem("dataField").nodeValue,
B.dataType=u[y].attributes.getNamedItem("dataType").nodeValue,B.defaultPosition=u[y].attributes.getNamedItem("defaultPosition")?u[y].attributes.getNamedItem("defaultPosition"):"data",B.validPosition=u[y].attributes.getNamedItem("validPositions")?u[y].attributes.getNamedItem("validPositions"):"data;hidden",B.Visible="hidden"!=B.defaultPosition,this.InitMetadata.Measures.push(B);this.InitMetadata.DimensionPosition=[];this.HideDataFilds=[];u=OATgetState(r,F.replace(/,/g,"").replace(/\./g,""));if(H&&
void 0!=u){B=[];for(y=0;y<u.Dimensions.length;y++)u.Dimensions[y].Visible||B.push(u.Dimensions[y].dataField);E=[];for(y=0;y<u.Measures.length;y++)u.Measures[y].Visible||E.push(u.Measures[y].dataField);this.InitMetadata.Measures=u.Measures;this.InitMetadata.Dimensions=u.Dimensions;this.InitMetadata.DataFields=u.DataFields;this.InitMetadata.DimensionPosition=u.DimensionPosition;c.ServerPagingPivot&&(this.InitMetadata.Conditions=u.Conditions);y=OATParseMetadata(q,B,E,c.ServerPagingPivot)}else{B=[];for(y=
0;y<this.InitMetadata.Dimensions.length;y++)this.InitMetadata.Dimensions[y].Visible||B.push(this.InitMetadata.Dimensions[y].dataField);E=[];for(y=0;y<this.InitMetadata.Measures.length;y++)this.InitMetadata.Measures[y].Visible||E.push(this.InitMetadata.Measures[y].dataField);y="Table"==c.RealType?OATParseMetadata(q,[],E,c.ServerPagingPivot):OATParseMetadata(q,B,E,c.ServerPagingPivot)}q=y[0];E=y[1];z=y[3];this.HideDataFilds=y[2];y=jQuery.parseXML(q);q=y.childNodes[0];this.IdForQueryViewerCollection=
F;this.UcId=F=F.replace(/,/g,"").replace(/\./g,"");this.pivotDiv=m.id;this.query=r;this.control=t;this.pageSize=w;this.shrinkToFit=v;this.disableColumnSort=A;this.header=[];this.data=[];this.columnNumbers=[];this.rowNumbers=[];this.filterNumbers=[];this.cols=0;this.conditionalFormats=[];this.conditionalFormatsColumns=[];this.formatValues=[];this.formatValuesMeasures=[];this.forPivotFormatValues=[];this.forPivotFormats=[];this.forPivotCustomPicture=[];this.forPivotCustomFormat=[];m=y.getElementsByTagName("OLAPDimension");
t=[];v=[];A=[];this.measures=y.getElementsByTagName("OLAPMeasure");var F=[],U=[],I=x=0,B=[],u={measureFormula:[],itemPosition:[]},O=[],J=[],X=[],ba=[],T=[];if("Table"==c.RealType)for(y=0;y<m.length;y++)this.initialColumnVisible[y]=!0,"hidden"==m[y].attributes.getNamedItem("defaultPosition").nodeValue&&(this.initialColumnVisible[y]=!1);for(y=0;y<m.length;y++){if("rows"==m[y].attributes.getNamedItem("defaultPosition").nodeValue||"Table"==c.RealType)t[x]=m[y].attributes.getNamedItem("displayName").nodeValue,
B[y]=t[x],x++;"columns"==m[y].attributes.getNamedItem("defaultPosition").nodeValue&&(v[I]=m[y].attributes.getNamedItem("displayName").nodeValue,B[y]=v[I],I++);"filters"==m[y].attributes.getNamedItem("defaultPosition").nodeValue&&(A[I]=m[y].attributes.getNamedItem("displayName").nodeValue,B[y]=A[I],I++);if(c.ServerPagingPivot&&"hidden"==m[y].attributes.getNamedItem("defaultPosition").nodeValue)for(C=0;C<this.InitMetadata.Dimensions.length;C++)this.InitMetadata.Dimensions[C].dataField==m[y].attributes.getNamedItem("dataField").nodeValue&&
this.InitMetadata.Dimensions[C].Visible&&(t[x]=m[y].attributes.getNamedItem("displayName").nodeValue,x++,B[y]=m[y].attributes.getNamedItem("displayName").nodeValue);F[y]=m[y].attributes.getNamedItem("dataType").nodeValue;if(0<m[y].childNodes.length&&null!=m[y].childNodes)for(var L=0;L<m[y].childNodes.length;L++)if("formatValues"==m[y].childNodes[L].localName)for(C=0;C<m[y].childNodes[L].childNodes.length;C++)if("value"==m[y].childNodes[L].childNodes[C].localName){var G={};G.format=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("format").nodeValue;
G.recursive=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("recursive").nodeValue;var f=m[y].childNodes[L].childNodes[C].textContent;G.value=f.replace(/^\s+|\s+$/g,"");G.columnNumber=y;this.formatValues.push(G)}if(0<m[y].childNodes.length&&null!=m[y].childNodes)for(L=0;L<m[y].childNodes.length;L++)if("conditionalFormats"==m[y].childNodes[L].localName)for(C=0;C<m[y].childNodes[L].childNodes.length;C++)"rule"==m[y].childNodes[L].childNodes[C].localName&&(G={},G.format=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("format").nodeValue,
G.operation1=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("op1").nodeValue,G.value1=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("value1").nodeValue,null!=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("op2")&&(G.operation2=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("op2").nodeValue,G.value2=m[y].childNodes[L].childNodes[C].attributes.getNamedItem("value2").nodeValue),G.columnNumber=y,this.conditionalFormatsColumns.push(G));if(""!=m[y].attributes.getNamedItem("picture").nodeValue&&
("date"==m[y].attributes.getNamedItem("dataType").nodeValue&&(J.push(m[y].attributes.getNamedItem("picture").nodeValue),ba.push(m[y].attributes.getNamedItem("dataField").nodeValue)),"integer"==m[y].attributes.getNamedItem("dataType").nodeValue))X.push(m[y].attributes.getNamedItem("picture").nodeValue),T.push(m[y].attributes.getNamedItem("dataField").nodeValue);this.forPivotCustomPicture.push(m[y].attributes.getNamedItem("picture").nodeValue);this.forPivotCustomFormat.push(m[y].attributes.getNamedItem("format").nodeValue);
O.push(m[y].attributes.getNamedItem("dataField").nodeValue)}for(y=0;y<this.measures.length;y++){U[y]=this.measures[y].attributes.getNamedItem("displayName").nodeValue;if(0<measures[y].childNodes.length&&null!=measures[y].childNodes)for(L=0;L<measures[y].childNodes.length;L++)if("formatValues"==measures[y].childNodes[L].localName)for(C=0;C<measures[y].childNodes[L].childNodes.length;C++)"value"==measures[y].childNodes[L].childNodes[C].localName&&(G={},G.format=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("format").nodeValue,
G.recursive=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("recursive").nodeValue,f=measures[y].childNodes[L].childNodes[C].textContent,G.value=f.replace(/^\s+|\s+$/g,""),G.columnNumber=y,this.formatValuesMeasures.push(G));if(0<measures[y].childNodes.length&&null!=measures[y].childNodes)for(L=0;L<measures[y].childNodes.length;L++)if("conditionalFormats"==measures[y].childNodes[L].localName)for(C=0;C<measures[y].childNodes[L].childNodes.length;C++)"rule"==measures[y].childNodes[L].childNodes[C].localName&&
(G={},G.format=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("format").nodeValue,G.operation1=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("op1").nodeValue,G.value1=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("value1").nodeValue,null!=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("op2")&&(G.operation2=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("op2").nodeValue,G.value2=measures[y].childNodes[L].childNodes[C].attributes.getNamedItem("value2").nodeValue),
G.columnNumber=y,this.conditionalFormats.push(G));if(""!=measures[y].attributes.getNamedItem("picture").nodeValue&&("date"==measures[y].attributes.getNamedItem("dataType").nodeValue&&(J.push(measures[y].attributes.getNamedItem("picture").nodeValue),ba.push(measures[y].attributes.getNamedItem("dataField").nodeValue)),"integer"==measures[y].attributes.getNamedItem("dataType").nodeValue||"real"==measures[y].attributes.getNamedItem("dataType").nodeValue))X.push(measures[y].attributes.getNamedItem("picture").nodeValue),
T.push(measures[y].attributes.getNamedItem("dataField").nodeValue);void 0!=measures[y].attributes.getNamedItem("formula")&&""!=measures[y].attributes.getNamedItem("formula").nodeValue?u.measureFormula.push({hasFormula:!0,textFormula:measures[y].attributes.getNamedItem("formula").nodeValue}):u.measureFormula.push({hasFormula:!1});this.forPivotCustomPicture.push(measures[y].attributes.getNamedItem("picture").nodeValue);O.push(measures[y].attributes.getNamedItem("dataField").nodeValue)}this.header=B.concat(U);
this.getDataFromXML=function(f){f=f.split("<Record>");this.serverPaging&&(this.ServerRecordCount=parseToIntRegisterValue(f[0],"RecordCount"),this.ServerPageCount=parseToIntRegisterValue(f[0],"PageCount"),this.ServerPageNumber=parseToIntRegisterValue(f[0],"PageNumber"));var c=O;void 0!=this.TableOrderFilds&&(c=this.TableOrderFilds);for(var g=1;g<f.length;g++){for(var h=[],j=[],k=0;k<c.length;k++){h[k]="#NuN#";var D=f[g].split("<"+c[k]+">");1<D.length?(D=D[1].split("</"+c[k]+">"),h[k]=D[0],j[k]=h[k]):
0<=f[g].indexOf("<"+c[k]+"/>")&&(h[k]="",j[k]="")}this.data.push(h);h=c.length;for(k=0;k<this.HideDataFilds.length;k++)j[h+k]=void 0,D=f[g].split("<"+this.HideDataFilds[k]+">"),1<D.length&&(D=D[1].split("</"+this.HideDataFilds[k]+">"),j[h+k]=D[0]);this.fullRecord.push(j);j.length>this.maxLengthRecord&&(this.maxLengthRecord=j.length)}};this.maxLengthRecord=0;this.data=[];this.fullRecord=[];this.orderFildsHidden=E;c.ServerPagingPivot?(h=h&&1<measures.length,this.pagingData={},this.pagingData.dataFields=
O):(this.TableOrderFilds=O,this.getDataFromXML(this.dataString));y={};for(x=0;x<E.length;x++)y[E[x]]=O.length+x;this.orderFildsHidden=z;u.itemPosition=y;u.recordDataLength=this.maxLengthRecord;for(C=u.cantFormulaMeasures=0;C<u.measureFormula.length;C++)if(u.measureFormula[C].hasFormula){u.cantFormulaMeasures++;z=u.measureFormula[C].textFormula;E="*-+/()".split("");for(x=0;x<E.length;x++)if(I=z.split(E[x]),1<I.length){z="";for(y=0;y<I.length-1;y++)z=z+I[y]+" "+E[x]+" ";z+=I[I.length-1]}y=InfixToPostfix(z);
u.measureFormula[C].polishNotationText=y;for(z=y.split(" ");-1!=z.indexOf("");)z.splice(z.indexOf(""),1);x=[];for(I=0;I<z.length;I++)-1==E.indexOf(z[I])&&isNaN(parseInt(z[I]))&&(L=u.itemPosition[z[I]],-1==x.indexOf(L)&&x.push(L));u.measureFormula[C].relatedMeasures=x;for(y=y.split(" ");-1!=y.indexOf("");)y.splice(y.indexOf(""),1);u.measureFormula[C].PolishNotation=y}for(y=z=L=E=0;y<B.length;y++)if(-1!=this.contains(t,B[y])&&(this.columnNumbers[E]=y,E++),-1!=this.contains(v,B[y])&&(this.rowNumbers[L]=
y,L++),-1!=this.contains(A,B[y]))this.filterNumbers[z]=y,z++;y=[];for(C=0;C<m.length;C++)y[C]=m[C];var S;this.query=r=r.replace(/\./g,"");if("PivotTable"==k){if(OAT.Style.include("pivot.css"),S=OAT_JS.pivot.cb(this.pivotDiv,n,l,o,q,g,y,this.formatValues,this.conditionalFormatsColumns,this.formatValuesMeasures,this.shrinkToFit,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,H,h,u,this.fullRecord,c.ServerPagingPivot,this.pagingData,this.HideDataFilds,this.orderFildsHidden,this.InitMetadata),
"error"==S)return}else"Table"==k&&(OAT.Style.include("grid.css"),S=OAT_JS.grid.cb(this.pivotDiv,this.UcId+"_"+r,F,q,this.forPivotCustomPicture,this.conditionalFormatsColumns,this.formatValues,this.forPivotCustomFormat,y,m,g,this.pageSize,this.disableColumnSort,this.UcId,this.IdForQueryViewerCollection,H,this));if("Table"==k){var V=this.pageSize=this.previousState?this.previousState.pageSize:w;void 0!=S.rowsPerPage&&""!=S.rowsPerPage&&(V=S.rowsPerPage);this.pageSize&&(self.serverPaging?(k={currPage:this.ServerPageNumber,
ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+this.UcId+"_"+this.query)),optionsForRows:[10,15,20],rowsPerPage:"undefined"!=V?V:10,jstype:"table",topNav:!1,controlName:this.UcId+"_"+this.query,cantPages:this.ServerPageCount,controlUcId:this.UcId,control:this},self.serverPaging?jQuery("#"+this.UcId+"_"+this.query).partialTablePagination(k):jQuery("#"+this.UcId+"_"+this.query).tablePagination(k),k=jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth-1,jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({width:k+
"px"}),"none"===jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css("display")?jQuery("#"+this.UcId+"_"+this.query).css({marginBottom:"0px"}):jQuery("#"+this.UcId+"_"+this.query).css("margin-bottom","0px"),0<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater").length&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.UcId+
"_"+this.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}),k=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4,jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:k+"px"}),this.serverPaging&&10==this.pageSize&&1>=this.ServerPageCount&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({visibility:"hidden",height:"0px"})):setTimeout(function(){var f={currPage:this.ServerPageNumber,ignoreRows:jQuery("tbody tr[visibQ=tf]",jQuery("#"+this.UcId+"_"+this.query)),
optionsForRows:[10,15,20],rowsPerPage:V!="undefined"?V:10,jstype:"table",topNav:false,controlName:this.UcId+"_"+this.query,cantPages:this.ServerPageCount,controlUcId:this.UcId,control:this};self.serverPaging?jQuery("#"+this.UcId+"_"+this.query).partialTablePagination(f):jQuery("#"+this.UcId+"_"+this.query).tablePagination(f);f=jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth-1;jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({width:f+"px"});jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css("display")===
"none"?jQuery("#"+this.UcId+"_"+this.query).css({marginBottom:"0px"}):jQuery("#"+this.UcId+"_"+this.query).css("margin-bottom","0px");jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.UcId+"_"+this.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({height:"65px",marginBottom:"0px"});f=jQuery("#"+
this.UcId+"_"+this.query)[0].offsetWidth-4;jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:f+"px"});this.serverPaging&&this.pageSize==10&&this.ServerPageCount<=1&&jQuery("#"+this.UcId+"_"+this.query+"_tablePagination").css({visibility:"hidden",height:"0px"})},50));k=jQuery("#"+this.UcId+"_"+this.query)[0].offsetWidth-4;try{-1<$("#MAINFORM")[0].className.indexOf("form-horizontal")&&(k+=4)}catch(Q){}jQuery("#"+this.UcId+"_"+this.query+"_grid_top_div").css({width:k+"px"});self.serverPaging&&
setInterval(function(){for(var f=0;f<jQuery(".oat_winrect_container .pivot_popup_fix").length;f++)if((!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[f].style.display||jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[f].style.display!="none")&&jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var c=jQuery(".oat_winrect_container .pivot_popup_fix")[f];if(c.scrollHeight-c.clientHeight-c.scrollTop<25){var g=c.getAttribute("ucid"),
c=parseInt(c.getAttribute("columnNumber"));OAT_JS.grid.readScrollValue(g,c)}}},250)}c.ServerPagingPivot||(380>jQuery("#"+this.UcId+"_"+this.query)[0].clientWidth&&(!this.shrinkToFit&&400<=jQuery("#"+g[c.UcId].ContainerName)[0].clientWidth)&&jQuery("#"+this.UcId+"_"+this.query).css({width:"400px"}),this.shrinkToFit&&jQuery("#"+this.UcId+"_"+this.query).css({minWidth:"10px"}),!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()&&(jQuery(".h2title").css({height:"25px"}),jQuery(".h2titlewhite").css({height:"25px"}),
jQuery(".header_value").css({height:"25px"}),jQuery(".header_value").css({lineHeight:"25px"})));this.getDataForTable=function(f,c,g,h,j,k,D,N,M,l){(h||j!=""||D!="")&&OAT_JS.grid.cleanCache(this,f);if(j!="")OAT_JS.grid.gridData[f].dataFieldOrder=j;if(k!="")OAT_JS.grid.gridData[f].orderType=k;D!=""&&OAT_JS.grid.updateFilterInfo(f,D,N);if(M){OAT_JS.grid.restoreDefaultView(f);g=OAT_JS.grid.gridData[f].rowsPerPage}(h||j!=""||D!="")&&OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[f].grid,f,g,OAT_JS.grid.gridData[f].dataFieldOrder,
OAT_JS.grid.gridData[f].orderType,OAT_JS.grid.gridData[f].filterInfo,OAT_JS.grid.gridData[f].blackLists,OAT_JS.grid.gridData[f].columnVisible);OAT_JS.grid.gridData[f].rowsPerPage=g;if(g==""){g=void 0;c=0}OAT_JS.grid.pageInCache(f,c)?OAT_JS.grid.redraw(this,f,OAT_JS.grid.pageInCache(f,c),false,false,c,true):qv.collection[OAT_JS.grid.gridData[f].IdForQueryViewerCollection].getPageDataForTable(function(g){if(c==0){c=1;h=false}OAT_JS.grid.redraw(this,f,g,h,j!="",c,l)}.closure(this),[c,g,h,OAT_JS.grid.gridData[f].dataFieldOrder,
OAT_JS.grid.gridData[f].orderType,OAT_JS.grid.gridData[f].filterInfo])};this.getValuesForColumn=function(f,c,g){var h=OAT_JS.grid.gridData[f].columnDataField[c];g!=""?qv.collection[OAT_JS.grid.gridData[f].IdForQueryViewerCollection].getAttributeValues(function(j){j=JSON.parse(j);OAT_JS.grid.changeValues(f,h,c,j,g)}.closure(this),[h,1,10,g]):OAT_JS.grid.resetScrollValue(f,h,c)};j.oat_element=S};var OAT_JS={grid:{panel:1,tab:4,div:"",needs:["grid"],gridData:[],cb:function(c,g,h,j,k,m,n,l,o,q,r,t,w,
v,A,F,H){this.gridData[v]={};this.gridData[v].div=c;this.gridData[v].controlName=g;this.gridData[v].actualPageNumber=1;this.gridData[v].rowsPerPage=H.previousState?H.previousState.pageSize:t;this.gridData[v].actualCantPages=H.ServerPageCount;this.gridData[v].grid=new OAT.Grid(c,0,1,g,query,h,o,r,this.gridData[v].rowsPerPage,w,v,A,F,H.serverPaging,H.HideDataFilds,H.orderFildsHidden,H.TableOrderFilds);this.gridData[v].grid.oat_component=this;this.gridData[v].columnDataField=[];for(c=0;c<q.length;c++)this.gridData[v].columnDataField[c]=
q[c].getAttribute("dataField");this.gridData[v].grid.createHeader(header,this.gridData[v].columnDataField);this.gridData[v].defaultValues={};this.gridData[v].defaultValues.rowsPerPage=t;this.gridData[v].defaultValues.dataFieldOrder="";this.gridData[v].defaultValues.orderType="";this.gridData[v].defaultValues.filterInfo=[];this.gridData[v].IdForQueryViewerCollection=A;this.gridData[v].cacheSize=0==H.gridCacheSize?H.ServerPageCount*(0<this.gridData[v].rowsPerPage?this.gridData[v].rowsPerPage:1):H.gridCacheSize;
this.gridData[v].gridCache=[];this.gridData[v].gridCache[0]={page:1,pageData:H.dataString};this.gridData[v].nextCachePos=1;this.gridData[v].columnVisible=[];for(c=0;c<q.length;c++)this.gridData[v].columnVisible[c]=!0,H.previousColumnVisible?(this.gridData[v].columnVisible[c]=H.previousColumnVisible[c],this.gridData[v].columnVisible[c]||this.gridData[v].grid.hideColumnHeader(c)):H.initialColumnVisible&&(this.gridData[v].columnVisible[c]=H.initialColumnVisible[c],this.gridData[v].columnVisible[c]||
this.gridData[v].grid.hideColumnHeader(c));this.gridData[v].columnDataField=[];this.gridData[v].originalColumnDataField=[];for(c=0;c<q.length;c++)this.gridData[v].columnDataField[c]=q[c].getAttribute("dataField"),this.gridData[v].originalColumnDataField[c]=q[c].getAttribute("dataField");this.gridData[v].filterInfo=[];this.gridData[v].differentValues=[];this.gridData[v].blackLists=[];this.gridData[v].differentValuesPaginationInfo=[];this.gridData[v].filteredValuesPaginationInfo=[];for(c=0;c<q.length;c++)this.gridData[v].differentValues[q[c].getAttribute("dataField")]=
[],this.gridData[v].blackLists[q[c].getAttribute("dataField")]={state:"all",visibles:[],hiddens:[],defaultAction:"Include",hasNull:!0},this.gridData[v].differentValuesPaginationInfo[q[c].getAttribute("dataField")]={blocked:!1,previousPage:0,totalPages:!0,filtered:!1},this.gridData[v].filteredValuesPaginationInfo[q[c].getAttribute("dataField")]={previousPage:0,totalPages:0,filteredText:"",values:[]};this.gridData[v].defaultNullText=j.getAttribute("textForNullValues");if(void 0!=H.previousFilters){this.gridData[v].filterInfo=
H.previousFilters;for(A=0;A<this.gridData[v].filterInfo.length;A++){for(t=0;t<this.gridData[v].filterInfo[A].NotNullValues.Included.length;t++)c=this.gridData[v].filterInfo[A].NotNullValues.Included[t],-1==this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].visibles.indexOf(c)&&this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].visibles.push(c);for(t=0;t<this.gridData[v].filterInfo[A].NotNullValues.Excluded.length;t++)c=this.gridData[v].filterInfo[A].NotNullValues.Excluded[t],
-1==this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].hiddens.indexOf(c)&&this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].hiddens.push(c);this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].state=0<this.gridData[v].filterInfo[A].NotNullValues.Included.length?"":"none";this.gridData[v].blackLists[this.gridData[v].filterInfo[A].DataField].defaultAction=this.gridData[v].filterInfo[A].NotNullValues.DefaultAction}}else void 0!=H.customFilterInfo&
""!=H.customFilterInfo&&(this.gridData[v].filterInfo=H.customFilterInfo);this.gridData[v].dataFieldOrder=void 0!=H.previousDataFieldOrder?H.previousDataFieldOrder:"";this.gridData[v].orderType=void 0!=H.previousOrderType?H.previousOrderType:"";this.gridData[v].customOrderValues=[];for(t=0;t<q.length;t++)void 0!=q[t].getAttribute("order")&&"custom"===q[t].getAttribute("order")?(result=this.gridData[v].grid.applyCustomSort(t,q[t],data),data=result[0],this.gridData[v].customOrderValues[t]=result[1]):
this.gridData[v].customOrderValues[t]=!1;this.gridData[v].rowsMetadata={columnsDataType:h,defaultPicture:j,forPivotCustomPicture:k,conditionalFormatsColumns:m,formatValues:n,forPivotCustomFormat:forPivotCustomFormat,columns:q};for(t=0;t<data.length;t++)this.gridData[v].grid.createRow(data[t],h,j,k,m,n,forPivotCustomFormat,q,null,this.gridData[v].columnVisible);if(H.serverPaging){h=!1;for(t=0;t<q.length;t++)if(void 0!=q[t].getAttribute("order")&&""!=q[t].getAttribute("order")){this.gridData[v].dataFieldOrder=
q[t].getAttribute("dataField");this.gridData[v].orderType="descending"==q[t].getAttribute("order")?"Descending":"Ascending";h="custom"==q[t].getAttribute("order");break}if(""!=this.gridData[v].dataFieldOrder&&!h){for(t=h=0;t<this.gridData[v].grid.columns.length;t++)if(this.gridData[v].dataFieldOrder==this.gridData[v].columnDataField[t]){h=t;break}this.gridData[v].grid.applySortOrderType(h,"ascending"==this.gridData[v].orderType.toLowerCase()?2:3)}}else for(t=0;t<q.length&&!(void 0!=q[t].getAttribute("order")&&
"ascending"===q[t].getAttribute("order")&&this.gridData[v].grid.applySortOrderType(t,2),void 0!=q[t].getAttribute("order")&&"descending"===q[t].getAttribute("order")&&this.gridData[v].grid.applySortOrderType(t,3),void 0!=q[t].getAttribute("order"));t++);for(t=0;t<q.length;t++)this.gridData[v].grid.applyCustomFilter(t,q[t]);H.serverPaging&&(OAT_JS.grid.initValueRead(v,0),qv.collection[this.gridData[v].IdForQueryViewerCollection].CurrentPage=1,"function"==typeof qv.collection[this.gridData[v].IdForQueryViewerCollection].OnFirstPage&&
qv.collection[this.gridData[v].IdForQueryViewerCollection].OnFirstPage());H.serverPaging||this.gridData[v].grid.applySaveState(this.gridData[v].rowsPerPage);return this.gridData[v].grid},redraw:function(c,g,h,j,k,m,n){if(this.pageInCache(g,m)){for(var k=-1,l=0;l<this.gridData[g].gridCache.length;l++)this.gridData[g].gridCache[l].page==m&&(k=l);this.gridData[g].gridCache.splice(k,1);this.gridData[g].gridCache.push({page:m,pageData:h})}else this.gridData[g].gridCache.push({page:m,pageData:h}),this.gridData[g].gridCache.length>
this.gridData[g].cacheSize&&this.gridData[g].gridCache.splice(0,1);c.data=[];c.getDataFromXML(h);0<=c.ServerPageCount&&(this.gridData[g].actualCantPages=c.ServerPageCount);this.gridData[g].grid.removeAllRows();j&&0<jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_totalPages").length&&(jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_totalPages")[0].innerHTML=" "+c.ServerPageCount,1>=c.ServerPageCount&&10==this.gridData[g].rowsPerPage?jQuery("#"+
this.gridData[g].controlName+"_tablePagination ").css({visibility:"hidden",height:"0px"}):(jQuery("#"+this.gridData[g].controlName+"_tablePagination ").css({visibility:"visible",height:"36px"}),1==c.ServerPageCount?$("#"+this.gridData[g].controlName+"_tablePagination_paginater").css("display","none"):$("#"+this.gridData[g].controlName+"_tablePagination_paginater").css("display","")));OAT_JS.grid.gridData[g].actualPageNumber!=m&&(qv.collection[this.gridData[g].IdForQueryViewerCollection].CurrentPage=
m,1==m?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnFirstPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnFirstPage():m==this.gridData[g].actualCantPages?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnLastPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnLastPage():m<OAT_JS.grid.gridData[g].actualPageNumber?"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnPreviousPage&&
qv.collection[this.gridData[g].IdForQueryViewerCollection].OnPreviousPage():"function"==typeof qv.collection[this.gridData[g].IdForQueryViewerCollection].OnNextPage&&qv.collection[this.gridData[g].IdForQueryViewerCollection].OnNextPage());!n&&""!=qv.collection[OAT_JS.grid.gridData[g].IdForQueryViewerCollection].AutoRefreshGroup&&(h=OAT.createXMLMetadata(OAT_JS.grid.gridData[g],null,!0),j=qv.collection[OAT_JS.grid.gridData[g].IdForQueryViewerCollection],""!=j&&(null!=j&&void 0!=j)&&qv.util.autorefresh.UpdateLayoutSameGroup(j,
h));OAT_JS.grid.gridData[g].actualPageNumber=m;currPageNumber[this.gridData[g].controlName]=m;jQuery("#"+this.gridData[g].controlName+"_tablePagination #tablePagination_currPage").val(m);for(m=0;m<c.data.length;m++){for(var h=[],j=[],n=[],k=[],l=[],o=0;o<this.gridData[g].columnDataField.length;o++){var q=this.gridData[g].originalColumnDataField.indexOf(this.gridData[g].columnDataField[o]);h[o]=c.data[m][q];j[o]=this.gridData[g].rowsMetadata.columnsDataType[q];n[o]=this.gridData[g].rowsMetadata.forPivotCustomPicture[q];
k[o]=this.gridData[g].rowsMetadata.forPivotCustomFormat[q];l[o]=this.gridData[g].columnVisible[q]}this.gridData[g].grid.createRow(h,j,this.gridData[g].rowsMetadata.defaultPicture,n,this.gridData[g].rowsMetadata.conditionalFormatsColumns,this.gridData[g].rowsMetadata.formatValues,k,this.gridData[g].rowsMetadata.columns,null,l)}},getDifferentValues:function(c,g,h){var j=this.gridData[c].columnDataField[g],h=this.gridData[c].differentValues[j][h],g=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]),
g=OAT.defaultPictureValue(h.trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[g],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[g]).replace(/ /g,"&nbsp;");if(this.gridData[c].blackLists[j].hasNull&&h.trimpivot()==this.gridData[c].defaultNullText)return!1;var k=!0;"all"!=this.gridData[c].blackLists[j].state&&0>this.gridData[c].blackLists[j].visibles.findIndex(h)&&(k=!1);return{value:h,checked:k,pict_value:g}},getCantDifferentValues:function(c,
g){return this.gridData[c].differentValues[this.gridData[c].columnDataField[g]].length},cleanCache:function(c,g){for(var h=0;h<this.gridData[g].gridCache.length;h++)this.gridData[g].gridCache[h]={page:-1,pageData:""};this.gridData[g].nextCachePos=0},pageInCache:function(c,g){for(var h=0;h<this.gridData[c].gridCache.length;h++)if(this.gridData[c].gridCache[h].page==g)return this.gridData[c].gridCache[h].pageData;return!1},updateFilterInfo:function(c,g,h){if("all"==h.op){for(var j=-1,h=0;h<this.gridData[c].filterInfo.length;h++)if(g==
this.gridData[c].filterInfo[h].DataField){j=h;break}-1<j&&this.gridData[c].filterInfo.splice(j,1);this.gridData[c].blackLists[g].state="all";this.gridData[c].blackLists[g].visibles=[];this.gridData[c].blackLists[g].hiddens=[];this.gridData[c].blackLists[g].defaultAction="Include"}else{if("none"==this.gridData[c].blackLists[g].state){this.gridData[c].blackLists[g].visibles=[];for(var k=0;k<this.gridData[c].differentValues[g].length;k++)-1==this.gridData[c].blackLists[g].hiddens.indexOf(this.gridData[c].differentValues[g][k])&&
this.gridData[c].blackLists[g].hiddens.push(this.gridData[c].differentValues[g][k])}else if("all"==this.gridData[c].blackLists[g].state){this.gridData[c].blackLists[g].hiddens=[];for(k=0;k<this.gridData[c].differentValues[g].length;k++)-1==this.gridData[c].blackLists[g].visibles.indexOf(this.gridData[c].differentValues[g][k])&&this.gridData[c].blackLists[g].visibles.push(this.gridData[c].differentValues[g][k])}if("none"==h.op)this.gridData[c].blackLists[g].state="none",this.gridData[c].blackLists[g].visibles=
[],this.gridData[c].blackLists[g].hiddens=[],this.gridData[c].blackLists[g].defaultAction="Exclude";else if("push"==h.op)this.gridData[c].blackLists[g].state="",j=this.gridData[c].blackLists[g].visibles.indexOf(h.values),-1<j&&this.gridData[c].blackLists[g].visibles.splice(j,1),-1==this.gridData[c].blackLists[g].hiddens.indexOf(h.values)&&this.gridData[c].blackLists[g].hiddens.push(h.values);else if("pop"==h.op)this.gridData[c].blackLists[g].state="",-1==this.gridData[c].blackLists[g].visibles.indexOf(h.values)&&
this.gridData[c].blackLists[g].visibles.push(h.values),j=this.gridData[c].blackLists[g].hiddens.indexOf(h.values),-1<j&&this.gridData[c].blackLists[g].hiddens.splice(j,1);else if("reverse"==h.op){this.gridData[c].blackLists[g].defaultAction="Include"==this.gridData[c].blackLists[g].defaultAction?"Exclude":"Include";if("none"==this.gridData[c].blackLists[g].state){j=-1;for(h=0;h<this.gridData[c].filterInfo.length;h++)if(g==this.gridData[c].filterInfo[h].DataField){j=h;break}-1<j&&this.gridData[c].filterInfo.splice(j,
1);this.gridData[c].blackLists[g].state="all";this.gridData[c].blackLists[g].visibles=[];this.gridData[c].blackLists[g].hiddens=[];return}if("all"==this.gridData[c].blackLists[g].state)this.gridData[c].blackLists[g].state="none",this.gridData[c].blackLists[g].visibles=[],this.gridData[c].blackLists[g].hiddens=[];else{for(var m=[],n=0;n<this.gridData[c].blackLists[g].visibles.length;n++)m.push(this.gridData[c].blackLists[g].visibles[n]);for(var l=[],n=0;n<this.gridData[c].blackLists[g].hiddens.length;n++)l.push(this.gridData[c].blackLists[g].hiddens[n]);
this.gridData[c].blackLists[g].visibles=[];this.gridData[c].blackLists[g].hiddens=[];for(k=0;k<this.gridData[c].differentValues[g].length;k++)j=this.gridData[c].differentValues[g][k],-1==m.indexOf(j)?this.gridData[c].blackLists[g].visibles.push(j):this.gridData[c].blackLists[g].hiddens.push(j);for(k=0;k<l.length;k++)-1==this.gridData[c].blackLists[g].visibles.indexOf(l[k])&&this.gridData[c].blackLists[g].visibles.push(l[k]);for(k=0;k<m.length;k++)-1==this.gridData[c].blackLists[g].hiddens.indexOf(m[k])&&
this.gridData[c].blackLists[g].hiddens.push(m[k])}}m=!1;l=!0;n=[];for(k=0;k<this.gridData[c].blackLists[g].visibles.length;k++)"#NuN#"!=this.gridData[c].blackLists[g].visibles[k]&&n.push(this.gridData[c].blackLists[g].visibles[k]);var o=[];if("none"!=this.gridData[c].blackLists[g].state){for(k=0;k<this.gridData[c].differentValues[g].length;k++)j=this.gridData[c].differentValues[g][k],"#NuN#"!=j&&-1==n.indexOf(j)&&o.push(j);for(k=0;k<this.gridData[c].blackLists[g].hiddens.length;k++)"#NuN#"!=this.gridData[c].blackLists[g].hiddens[k]&&
-1==o.indexOf(this.gridData[c].blackLists[g].hiddens[k])&&o.push(this.gridData[c].blackLists[g].hiddens[k]);0==n.length&&"Exclude"==this.gridData[c].blackLists[g].defaultAction&&(o=[])}"none"==h.op?(l=!1,n=[],o=[]):-1<this.gridData[c].differentValues[g].indexOf("#NuN#")||-1!=o.indexOf(this.gridData[c].blackLists[g].hiddens[k])?-1==this.gridData[c].blackLists[g].visibles.indexOf("#NuN#")&&(l=!1):"Exclude"==this.gridData[c].blackLists[g].defaultAction&&(l=!1);if(this.gridData[c].blackLists[g].hasNull&&
"none"!=h.op){for(var j=this.gridData[c].defaultNullText,q=!1,r=0,k=0;k<this.gridData[c].differentValues[g].length;k++)r=this.gridData[c].differentValues[g][k].length;for(k=0;k<this.gridData[c].differentValues[g].length;k++)if(this.gridData[c].differentValues[g][k].trimpivot()==this.gridData[c].defaultNullText){j=this.gridData[c].differentValues[g][k];q=!0;break}if(!q)for(k=0;k<r-this.gridData[c].defaultNullText.length;k++)j+=" ";if(l){if(-1==n.indexOf(j)&&(-1!=o.indexOf(j)?(o.splice(o.indexOf(j),
1),n.push(j)):"Exclude"==this.gridData[c].blackLists[g].defaultAction&&n.push(j),-1!=this.gridData[c].blackLists[g].hiddens.indexOf(j)))this.gridData[c].blackLists[g].hiddens.splice(this.gridData[c].blackLists[g].hiddens.indexOf(j),1),-1==this.gridData[c].blackLists[g].visibles.indexOf(j)&&this.gridData[c].blackLists[g].visibles.push(j)}else-1==o.indexOf(j)&&(o.push(j),-1==this.gridData[c].blackLists[g].hiddens.indexOf(j)&&this.gridData[c].blackLists[g].hiddens.push(j)),-1!=n.indexOf(j)&&n.splice(n.indexOf(j),
1),-1!=this.gridData[c].blackLists[g].visibles.indexOf(j)&&this.gridData[c].blackLists[g].visibles.splice(this.gridData[c].blackLists[g].visibles.indexOf(j),1)}k=!1;null!=this.gridData[c].differentValuesPaginationInfo[g]&&(k=this.gridData[c].differentValuesPaginationInfo[g].previousPage==this.gridData[c].differentValuesPaginationInfo[g].totalPages);h=(l||!this.gridData[c].blackLists[g].hasNull)&&0==o.length&&"none"!=h.op&&"push"!=h.op&&("Include"==this.gridData[c].blackLists[g].defaultAction||k)&&
"reverse"!=h.op;for(k=j=0;k<this.gridData[c].filterInfo.length;k++)this.gridData[c].filterInfo[k].DataField==g&&(m=!0,this.gridData[c].filterInfo[k].NullIncluded=l,this.gridData[c].filterInfo[k].NotNullValues.Included=n,this.gridData[c].filterInfo[k].NotNullValues.Excluded=o,this.gridData[c].filterInfo[k].NotNullValues.DefaultAction=this.gridData[c].blackLists[g].defaultAction,j=k);h&&this.gridData[c].filterInfo.splice(j,1);!m&&!h&&(filter={DataField:g,NullIncluded:l,NotNullValues:{Included:n,Excluded:o,
DefaultAction:this.gridData[c].blackLists[g].defaultAction}},this.gridData[c].filterInfo.push(filter))}},readScrollValue:function(c,g){var h=this.gridData[c].columnDataField[g],j=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]);if(!this.gridData[c].differentValuesPaginationInfo[h].blocked)if(this.gridData[c].differentValuesPaginationInfo[h].blocked=!0,this.gridData[c].differentValuesPaginationInfo[h].filtered){m=this.gridData[c].filteredValuesPaginationInfo[h];
n=m.previousPage+1;this.gridData[c].lastRequestValue=h;var k=m.filteredText;qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);OAT_JS.grid.appendNewFilteredValueData(c,g,j,k)}.closure(this),[h,n,10,m.filteredText])}else{var m=this.gridData[c].differentValuesPaginationInfo[h],n=m.previousPage+1;this.gridData[c].lastRequestValue=h;qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);OAT_JS.grid.appendNewValueData(c,
g)}.closure(this),[h,n,10,""])}},appendNewValueData:function(c,g,h){var j=this.gridData[c].lastRequestValue;if(g.PageNumber>this.gridData[c].differentValuesPaginationInfo[j].previousPage||h){this.gridData[c].differentValuesPaginationInfo[j].previousPage=g.PageNumber;this.gridData[c].differentValuesPaginationInfo[j].totalPages=g.PagesCount;h=[];g.Null&&-1==this.gridData[c].differentValues[j].indexOf("#NuN#")&&this.gridData[c].differentValues[j].push("#NuN#");for(var k=0;k<g.NotNullValues.length;k++){var m=
g.NotNullValues[k];-1==this.gridData[c].differentValues[j].indexOf(m)&&(this.gridData[c].differentValues[j].push(m),h.push(m));"Include"==this.gridData[c].blackLists[j].defaultAction?-1==this.gridData[c].blackLists[j].visibles.indexOf(m)&&-1==this.gridData[c].blackLists[j].hiddens.indexOf(m)&&this.gridData[c].blackLists[j].visibles.push(m):-1==this.gridData[c].blackLists[j].visibles.indexOf(m)&&-1==this.gridData[c].blackLists[j].hiddens.indexOf(m)&&this.gridData[c].blackLists[j].hiddens.push(m)}k=
this.gridData[c].columnDataField.indexOf(j);m=this.gridData[c].originalColumnDataField.indexOf(j);this.gridData[c].grid.loadDifferentValues(k,this.gridData[c].differentValues[j]);for(var n=0;n<h.length;n++){var l=!0;"all"!=this.gridData[c].blackLists[j].state&&0>this.gridData[c].blackLists[j].visibles.findIndex(h[n])&&(l=!1);if(!(this.gridData[c].blackLists[j].hasNull&&h[n].trimpivot()==this.gridData[c].defaultNullText)){var o=OAT.defaultPictureValue(h[n].trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[m],
this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[m]).replace(/ /g,"&nbsp;");OAT.appendNewPairToPopUp(this.gridData[c],h[n],k,l,o,j)}}}this.gridData[c].differentValuesPaginationInfo[j].previousPage<g.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[j].blocked=!1)},resetScrollValue:function(c,g,h){this.gridData[c].differentValuesPaginationInfo[g].filtered=!1;this.gridData[c].differentValuesPaginationInfo[g].blocked=!0;var h=this.gridData[c].columnDataField.indexOf(g),
j=this.gridData[c].originalColumnDataField.indexOf(g);OAT.removeAllPairsFromPopUp(this.gridData[c],h,1<OAT_JS.grid.cantPages(c,g));for(var k=0;k<this.gridData[c].differentValues[g].length;k++){var m=!0,n=this.gridData[c].differentValues[g][k];"all"!=this.gridData[c].blackLists[g].state&&0>this.gridData[c].blackLists[g].visibles.findIndex(n)&&(m=!1);var l=OAT.defaultPictureValue(n.trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[j],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[j]).replace(/ /g,
"&nbsp;");this.gridData[c].blackLists[g].hasNull&&n.trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],n,h,m,l,g)}this.gridData[c].differentValuesPaginationInfo[g].previousPage<OAT_JS.grid.cantPages(c,g)&&(this.gridData[c].differentValuesPaginationInfo[g].blocked=!1)},resetAllScrollValue:function(c){for(var g=0;g<this.gridData[c].grid.columns.length;g++){var h=this.gridData[c].grid.columns[g].getAttribute("dataField");this.gridData[c].differentValuesPaginationInfo[h].filtered=
!1;this.gridData[c].differentValuesPaginationInfo[h].blocked=!0;this.gridData[c].differentValuesPaginationInfo[h].previousPage<this.gridData[c].differentValuesPaginationInfo[h].totalPages&&(this.gridData[c].differentValuesPaginationInfo[h].blocked=!1)}},appendNewFilteredValueData:function(c,g,h,j){var k=this.gridData[c].lastRequestValue,h=this.gridData[c].columnDataField.indexOf(k),m=this.gridData[c].originalColumnDataField.indexOf(k),n=this.gridData[c].filteredValuesPaginationInfo[k];if(!((j||""==
j)&&n.filteredText!=j)&&g.PageNumber>n.previousPage){this.gridData[c].filteredValuesPaginationInfo[k].previousPage=g.PageNumber;this.gridData[c].filteredValuesPaginationInfo[k].totalPages=g.PagesCount;g.Null&&-1==this.gridData[c].differentValues[k].indexOf("#NuN#")&&this.gridData[c].differentValues[k].push("#NuN#");for(j=0;j<g.NotNullValues.length;j++){n=-1!=this.gridData[c].differentValues[k].indexOf(g.NotNullValues[j]);-1==this.gridData[c].differentValues[k].indexOf(g.NotNullValues[j])&&this.gridData[c].differentValues[k].push(g.NotNullValues[j]);
"Include"==this.gridData[c].blackLists[k].defaultAction&&!n?-1==this.gridData[c].blackLists[k].visibles.indexOf(g.NotNullValues[j])&&-1==this.gridData[c].blackLists[k].hiddens.indexOf(g.NotNullValues[j])&&this.gridData[c].blackLists[k].visibles.push(g.NotNullValues[j]):-1==this.gridData[c].blackLists[k].visibles.indexOf(g.NotNullValues[j])&&-1==this.gridData[c].blackLists[k].hiddens.indexOf(g.NotNullValues[j])&&this.gridData[c].blackLists[k].hiddens.push(g.NotNullValues[j]);n=!0;"all"!=this.gridData[c].blackLists[k].state&&
0>this.gridData[c].blackLists[k].visibles.findIndex(g.NotNullValues[j])&&(n=!1);var l=OAT.defaultPictureValue(g.NotNullValues[j].trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[m],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[m]).replace(/ /g,"&nbsp;");this.gridData[c].blackLists[k].hasNull&&g.NotNullValues[j].trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],g.NotNullValues[j],h,n,l,k)}this.gridData[c].filteredValuesPaginationInfo[k].previousPage<
g.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[k].blocked=!1)}},initValueRead:function(c,g){if(!(g>=this.gridData[c].grid.columns.length)){this.gridData[c].grid.lastRequestValue=this.gridData[c].grid.columns[g].getAttribute("dataField");var h=10;""!=qv.collection[this.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup&&(h=0);qv.collection[this.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(g){g=JSON.parse(g);dataField=this.gridData[c].grid.lastRequestValue;
this.gridData[c].differentValuesPaginationInfo[dataField].previousPage=g.PageNumber;this.gridData[c].differentValuesPaginationInfo[dataField].totalPages=g.PagesCount;for(var h=0,m=0;m<this.gridData[c].grid.columns.length;m++)if(this.gridData[c].grid.lastRequestValue==this.gridData[c].grid.columns[m].getAttribute("dataField")){h=m;break}if(g.Null){this.gridData[c].blackLists[dataField].hasNull=!0;-1==this.gridData[c].differentValues[dataField].indexOf("#NuN#")&&this.gridData[c].differentValues[dataField].push("#NuN#");
for(var n=!0,m=0;m<this.gridData[c].filterInfo.length;m++)this.gridData[c].filterInfo[m].DataField==dataField&&(this.gridData[c].filterInfo[m].NullIncluded||(n=!1));n&&-1==this.gridData[c].blackLists[dataField].visibles.indexOf("#NuN#")&&this.gridData[c].blackLists[dataField].visibles.push("#NuN#")}else this.gridData[c].blackLists[dataField].hasNull=!1;for(m=0;m<g.NotNullValues.length;m++)if(-1==this.gridData[c].differentValues[dataField].indexOf(g.NotNullValues[m])&&this.gridData[c].differentValues[dataField].push(g.NotNullValues[m]),
"all"==this.gridData[c].blackLists[dataField].state&&-1==this.gridData[c].blackLists[dataField].visibles.indexOf(g.NotNullValues[m])&&this.gridData[c].blackLists[dataField].visibles.push(g.NotNullValues[m]),"none"==this.gridData[c].blackLists[dataField].state&&-1==this.gridData[c].blackLists[dataField].hiddens.indexOf(g.NotNullValues[m])&&this.gridData[c].blackLists[dataField].hiddens.push(g.NotNullValues[m]),"Exclude"==this.gridData[c].blackLists[dataField].defaultAction&&""==this.gridData[c].blackLists[dataField].state&&
""!=g.NotNullValues[m].trimpivot()&&0<this.gridData[c].blackLists[dataField].visibles.length)for(n=0;n<this.gridData[c].blackLists[dataField].visibles.length;n++)this.gridData[c].blackLists[dataField].visibles[n]==g.NotNullValues[m].trimpivot()&&(this.gridData[c].blackLists[dataField].visibles[n]=g.NotNullValues[m]);this.gridData[c].grid.loadDifferentValues(h,this.gridData[c].differentValues[dataField]);h++;OAT_JS.grid.initValueRead(c,h)}.closure(this),[this.gridData[c].grid.lastRequestValue,1,h,
""])}},changeValues:function(c,g,h,j,k){h=jQuery("#"+c+g)[0];if(!((h.value||""==h.value)&&h.value!=k)){var h=this.gridData[c].columnDataField.indexOf(g),m=this.gridData[c].originalColumnDataField.indexOf(g);this.gridData[c].differentValuesPaginationInfo[g].filtered=!0;this.gridData[c].differentValuesPaginationInfo[g].blocked=!0;OAT.removeAllPairsFromPopUp(this.gridData[c],h,1<j.PagesCount);this.gridData[c].filteredValuesPaginationInfo[g].previousPage=1;this.gridData[c].filteredValuesPaginationInfo[g].totalPages=
j.PagesCount;this.gridData[c].filteredValuesPaginationInfo[g].filteredText=k;for(k=0;k<j.NotNullValues.length;k++){var n=-1!=this.gridData[c].differentValues[g].indexOf(j.NotNullValues[k]);-1==this.gridData[c].differentValues[g].indexOf(j.NotNullValues[k])&&this.gridData[c].differentValues[g].push(j.NotNullValues[k]);("all"==this.gridData[c].blackLists[g].state||"Include"==this.gridData[c].blackLists[g].defaultAction&&!n)&&-1==this.gridData[c].blackLists[g].visibles.indexOf(j.NotNullValues[k])&&-1==
this.gridData[c].blackLists[g].hiddens.indexOf(j.NotNullValues[k])&&this.gridData[c].blackLists[g].visibles.push(j.NotNullValues[k]);n=!0;"all"!=this.gridData[c].blackLists[g].state&&0>this.gridData[c].blackLists[g].visibles.findIndex(j.NotNullValues[k])&&(n=!1);this.gridData[c].filteredValuesPaginationInfo[g].values.push(j.NotNullValues[k]);var l=OAT.defaultPictureValue(j.NotNullValues[k].trimpivot(),this.gridData[c].rowsMetadata.columnsDataType[m],this.gridData[c].rowsMetadata.defaultPicture,this.gridData[c].rowsMetadata.forPivotCustomPicture[m]).replace(/ /g,
"&nbsp;");this.gridData[c].blackLists[g].hasNull&&j.NotNullValues[k].trimpivot()==this.gridData[c].defaultNullText||OAT.appendNewPairToPopUp(this.gridData[c],j.NotNullValues[k],h,n,l,g)}0<j.PagesCount&&(this.gridData[c].differentValuesPaginationInfo[g].blocked=!1)}},setColumnVisibleValue:function(c,g,h){g=this.gridData[c].originalColumnDataField.indexOf(this.gridData[c].columnDataField[g]);this.gridData[c].columnVisible[g]=h;OAT.SaveStateWhenServerPaging(OAT_JS.grid.gridData[c].grid,c,OAT_JS.grid.gridData[c].rowsPerPage,
OAT_JS.grid.gridData[c].dataFieldOrder,OAT_JS.grid.gridData[c].orderType,OAT_JS.grid.gridData[c].filterInfo,OAT_JS.grid.gridData[c].blackLists,OAT_JS.grid.gridData[c].columnVisible);""!=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup&&(h=OAT.createXMLMetadata(OAT_JS.grid.gridData[c],null,!0),c=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection],""!=c&&(null!=c&&void 0!=c)&&qv.util.autorefresh.UpdateLayoutSameGroup(c,h))},getTableWhenServerPagination:function(c){return("<Recordset"+
qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getPageDataForTableSync([1,0,!0,"","",OAT_JS.grid.gridData[c].filterInfo]).split("<Recordset")[1]).split("</Page>")[0]+"</Page>\n</Recordset>"},setFilterChangedWhenServerPagination:function(c,g){if(qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged||qv.util.isGeneXusPreview()){var h=g.getAttribute("dataField"),j=OAT_JS.grid.gridData[c].differentValues[h];if(OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].previousPage==
OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].totalPages){for(var k='<DATA event="FilterChanged" name="'+g.getAttribute("name")+'" displayName="'+g.getAttribute("displayName")+'">',m=0;m<j.length;m++){var n=!0;"all"!=OAT_JS.grid.gridData[c].blackLists[h].state&&0>OAT_JS.grid.gridData[c].blackLists[h].visibles.findIndex(j[m])&&(n=!1);n&&(k=k+"<VALUE>"+j[m]+"</VALUE>")}k+="</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].ControlName,
k);h=qv.util.dom.xmlDocument(k);h=qv.util.dom.selectXPathNode(h,"/DATA");qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.Name=h.getAttribute("name");qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.SelectedValues=[];j=-1;for(k=0;k<h.childNodes.length;k++)"VALUE"==h.childNodes[k].nodeName&&(j++,qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChangedData.SelectedValues[j]=h.childNodes[k].firstChild.nodeValue);
qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged&&qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].FilterChanged()}else OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].blocked=!0,j=OAT_JS.grid.gridData[c].differentValuesPaginationInfo[h].previousPage+1,OAT_JS.grid.gridData[c].lastRequestValue=h,qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getAttributeValues(function(h){h=JSON.parse(h);OAT_JS.grid.appendNewValueData(c,h,
!0);OAT_JS.grid.setFilterChangedWhenServerPagination(c,g)}.closure(this),[h,j,0,""])}},getAllDataRowsForExport:function(c,g,h,j){qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].getPageDataForTable(function(k){for(var k=k.split("<Record>"),m=[],n=1;n<k.length;n++){for(var l=[],o=0;o<OAT_JS.grid.gridData[c].grid.columns.length;o++){l[o]="#NuN#";var q=k[n].split("<"+OAT_JS.grid.gridData[c].grid.columns[o].getAttribute("dataField")+">");1<q.length&&(q=q[1].split("</"+OAT_JS.grid.gridData[c].grid.columns[o].getAttribute("dataField")+
">"),l[o]=q[0])}m.push(l);"xlsx"!=j&&(n>OAT_JS.grid.gridData[c].rowsPerPage&&""!=OAT_JS.grid.gridData[c].rowsPerPage)&&(OAT_JS.grid.gridData[c].grid.createRow(l,OAT_JS.grid.gridData[c].rowsMetadata.columnsDataType,OAT_JS.grid.gridData[c].rowsMetadata.defaultPicture,OAT_JS.grid.gridData[c].rowsMetadata.forPivotCustomPicture,OAT_JS.grid.gridData[c].rowsMetadata.conditionalFormatsColumns,OAT_JS.grid.gridData[c].rowsMetadata.formatValues,OAT_JS.grid.gridData[c].rowsMetadata.forPivotCustomFormat,OAT_JS.grid.gridData[c].rowsMetadata.columns,
null,OAT_JS.grid.gridData[c].columnVisible).style.visibility="collapse")}switch(j){case "pdf":OAT.ExportToPdf(g,h);break;case "xml":OAT.ExportToXML(g,h);break;case "html":OAT_JS.grid.gridData[c].grid.ExportToHtml(g,h);break;case "xls":OAT.ExportToExcel(g,h);break;case "xlsx":OAT.ExportToExcel2010(g,h,!0,m,c)}OAT_JS.grid.gridData[c].grid.removeAllCollapseRows()}.closure(this),[1,0,!1,OAT_JS.grid.gridData[c].dataFieldOrder,OAT_JS.grid.gridData[c].orderType,OAT_JS.grid.gridData[c].filterInfo])},restoreDefaultView:function(c){OAT_JS.grid.gridData[c].dataFieldOrder=
"";OAT_JS.grid.gridData[c].orderType="";this.gridData[c].filterInfo=[];for(var g=[],h=0;h<OAT_JS.grid.gridData[c].grid.columns.length;h++)g[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]=this.gridData[c].blackLists[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")].hasNull;for(h=0;h<OAT_JS.grid.gridData[c].grid.columns.length;h++)this.gridData[c].blackLists[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]={state:"all",visibles:[],defaultAction:"Include",
hiddens:[],hasNull:g[OAT_JS.grid.gridData[c].grid.columns[h].getAttribute("dataField")]};for(g=0;g<this.gridData[c].columnVisible.length;g++)this.gridData[c].grid.applySortOrderType(g,1),this.gridData[c].columnVisible[g]=!0,this.gridData[c].grid.showColumnHeader(g);this.gridData[c].rowsPerPage=this.gridData[c].defaultValues.rowsPerPage;0<jQuery("#"+this.gridData[c].grid.controlName+"tablePagination_rowsPerPage").length&&(jQuery("#"+this.gridData[c].grid.controlName+"tablePagination_rowsPerPage")[0].value=
this.gridData[c].defaultValues.rowsPerPage)},getStateChange:function(c){if(this.gridData[c].rowsPerPage!=this.gridData[c].defaultValues.rowsPerPage||(this.gridData[c].defaultValues.dataFieldOrder!=OAT_JS.grid.gridData[c].dataFieldOrder||this.gridData[c].defaultValues.orderType!=OAT_JS.grid.gridData[c].orderType)||void 0!=this.gridData[c].filterInfo&&0<this.gridData[c].filterInfo.length)return!0;for(var g=0;g<this.gridData[c].columnVisible.length;g++)if(!this.gridData[c].columnVisible[g])return!0;
return!1},refreshPivotWhenServerPagination:function(c,g,h){self.getDataForTable(c,1,this.gridData[c].rowsPerPage,!0,g,h,"","","",!0)},moveToFirstPage:function(c){1<this.gridData[c].actualPageNumber&&self.getDataForTable(c,1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToNextPage:function(c){this.gridData[c].actualPageNumber<this.gridData[c].actualCantPages&&self.getDataForTable(c,this.gridData[c].actualPageNumber+1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToLastPage:function(c){this.gridData[c].actualPageNumber<
this.gridData[c].actualCantPages&&self.getDataForTable(c,this.gridData[c].actualCantPages,this.gridData[c].rowsPerPage,!1,"","","","",!1)},moveToPreviousPage:function(c){1<this.gridData[c].actualPageNumber&&self.getDataForTable(c,this.gridData[c].actualPageNumber-1,this.gridData[c].rowsPerPage,!1,"","","","",!1)},cantPages:function(c,g){return this.gridData[c].differentValuesPaginationInfo[g].totalPages},setDataFieldPosition:function(c,g){this.gridData[c].columnDataField=[];this.gridData[c].columnDataField=
g;if(""!=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection].AutoRefreshGroup){var h=OAT.createXMLMetadata(OAT_JS.grid.gridData[c],null,!0),j=qv.collection[OAT_JS.grid.gridData[c].IdForQueryViewerCollection];""!=j&&(null!=j&&void 0!=j)&&qv.util.autorefresh.UpdateLayoutSameGroup(j,h)}},addValueToDifferentValues:function(c,g,h){var j=this.gridData[c].originalColumnDataField.indexOf(g),k=this.gridData[c].grid.columnsDataType[j],j=!1;if("integer"==k||"real"==k)j=!0;var k=[],m=!1;"#NuN#"==
h&&(k.push(h),m=!0);for(var n=0;n<this.gridData[c].differentValues[g].length;n++)j?parseFloat(h)<parseFloat(this.gridData[c].differentValues[g][n])&&!m&&(k.push(h),m=!0):h<this.gridData[c].differentValues[g][n]&&!m&&(k.push(h),m=!0),k.push(this.gridData[c].differentValues[g][n]);m||k.push(h);this.gridData[c].differentValues[g]=k}},pivot:{panel:1,tab:5,div:"",needs:["pivot","statistics"],cb:function(c,g,h,j,k,m,n,l,o,q,r,t,w,v,A,F,H,u,B,E,z,x,y){this.div=c;j=columnNumbers.length+rowNumbers.length+
filterNumbers.length;if(1<measures.length)for(var C=j,j=j+measures.length-1;C<j;C++)columnNumbers.push(C);else for(C=0;C<data.length;C++)data[C].append("0");var I;try{I=new OAT.Pivot(h,null,g,header,data,columnNumbers,rowNumbers,filterNumbers,j,{showChart:0},query,conditionalFormats,w,pageSize,k,m,n,c,l,o,q,measures,r,t,w,v,A,F,H,u,B,E,z,x,y)}catch(K){}return I}}},parseToIntRegisterValue=function(c,g){if(0<c.indexOf(g)){var h=c.split(g+'="');return 1==h.length?(h=c.split(g+"='"),h[1]?parseInt(h[1].split("'")[0]):
-1):h[1]?parseInt(h[1].split('"')[0]):-1}return-1},parseToStringRegisterValue=function(c,g){if(0<c.indexOf(g)){var h=c.split(g+'="');return 1==h.length?(h=c.split(g+"='"),h[1]?h[1].split("'")[0]:-1):h[1]?h[1].split('"')[0]:-1}return-1},EvaluateExpressionPivotJs=function(c,g,h){for(var j=[],k=0;k<c.length;k++)j[k]=c[k];for(c=[];0!=j.length;)if(k=j.shift(),isOperator(k)){var m=c.pop(),n=c.pop(),k=PerformOperation(parseFloat(m),parseFloat(n),k);c.push(k)}else if(isNaN(parseInt(k))){if("#NuN#"==g[h.itemPosition[k]])return"#NuN#";
c.push(g[h.itemPosition[k]])}else c.push(k);return c.pop()},PerformOperation=function(c,g,h){switch(h){case "+":return c+g;case "-":return g-c;case "*":return c*g;case "/":return g/c}},InfixToPostfix=function(c){for(var c=c.split(" "),g=[],h=[];0!=c.length;){var j=c.shift();if(isOperator(j)){for(;"left"==getAssociativity(j)&&getPrecedence(j)<=getPrecedence(h[h.length-1])||"right"==getAssociativity(j)&&getPrecedence(j)<getPrecedence(h[h.length-1]);)g.push(h.pop());h.push(j)}else if("("==j)h.push(j);
else if(")"==j){for(;"("!=h[h.length-1];){if(0==h.length)throw"";g.push(h.pop())}h.pop()}else g.push(j)}for(;0!=h.length;){if(h[h.length-1].match(/([()])/))throw"Parenthesis balancing error! Shame on you!";g.push(h.pop())}return g.join(" ")},isOperator=function(c){return c.match(/([*+-\/])/)?!0:!1},isNumber=function(c){return c.match(/([0-9]+)/)?!0:!1},getPrecedence=function(c){switch(c){case "^":return 9;case "*":case "/":case "%":return 8;case "+":case "-":return 6;default:return-1}},getAssociativity=
function(c){switch(c){case "+":case "-":case "*":case "/":return"left";case "^":return"right"}},OATSetCookie=function(c,g,h,j,k,m){document.cookie=c+"="+escape(g)+(null==h?"":"; expires="+h.toGMTString())+(null==j?"":"; path="+j)+(null==k?"":"; domain="+k)+(null==m?"":"; secure")},OATGetCookie=function(c){var c=c+"=",g=document.cookie;return 0<g.length&&(begin=g.indexOf(c),-1!=begin)?(begin+=c.length,end=g.indexOf(";",begin),-1==end&&(end=g.length),unescape(g.substring(begin,end))):null},OATIsNotEmptyValue=
function(c){return"#NaV#"!=c&&"#NuN#"!=c},OATGetRowsFromXML=function(c,g,h){var j=[],c=c.split("<Rows>");if(c.length)for(var c=c[1].split("</Rows>"),c=c[0].split("<Row>"),k=1;k<c.length;k++){var m={headers:[],cells:[],subTotal:!1,dataField:-1,rowSpan:0};"true"==parseToStringRegisterValue(c[k],"Subtotal")&&(m.subTotal=!0);var n;n=0<c[k].indexOf("</Header>")?c[k].split("</Header>")[0].replace("<Header>",""):c[k].split("/>")[0].replace("<Header","");m.dataField=parseToStringRegisterValue(n,"DataField");
n=n.replace(/<\//g,"-*-5").replace(/\/>/g,"-*-5").split("-*-5");for(var l=1;l<n.length;l++){var o,q=n[l].split(">")[0];if(""==q)q=n[l-1].split("<")[1].split(" ")[0],o="#NuN#";else try{o=n[l-1].split(q+">")[1].split("<")[0]}catch(r){o="#NuN#"}var q={dataField:q,value:o,rowSpan:1},t=n.length-1;h&&(t=n.length,m.subTotal&&t--);t=0<=l-t;if(0<j.length&&!t&&(0==l-1||0==m.headers[l-2].rowSpan)&&o==j[k-2].headers[l-1].value){q.rowSpan=0;for(t=k-2;0<=t;){if(0<j[t].headers[l-1].rowSpan){j[t].headers[l-1].rowSpan++;
break}t--}}m.headers.push(q)}if(h&&m.subTotal)if(1==k||!j[k-2].subTotal||m.headers.length!=j[k-2].headers.length)m.rowSpan=1;else for(t=k-2;0<=t;){if(0<j[t].rowSpan){j[t].rowSpan++;break}t--}n=c[k].split("<Cells>")[1].split("</Cell>");for(l=0;l<n.length-1;l++){q=-1!=m.dataField?m.dataField:g.columnsHeaders[l].dataField;for(o=1;o<n[l].split("<Cell />").length;o++)t={value:"#NuN#",dataField:q},m.cells.push(t);o=n[l].split("<Cell>")[1];t={value:o,dataField:q};m.cells.push(t)}j.push(m)}return j},OATGetColumnsHeadersFromXML=
function(c){var g=c.split("<Columns>"),c=[];if(1<g.length)for(var g=g[1].split("</Columns>")[0],g=g.split("<Header"),h=1;h<g.length;h++){var j=parseToStringRegisterValue(g[h],"DataField"),k=parseToStringRegisterValue(g[h],"Subtotal"),m=[],n=g[h].replace('DataField="'+j+'">',"").replace("DataField='"+j+"'>","").replace("</Header>","").replace(/IsNull="true" \/>/g,">#NuN#<F>").replace(/IsNull='true' \/>/g,">#NuN#<F>").replace(/IsNull="true"\/>/g,">#NuN#<F>").split("<");if(1<n.length)for(var l=1;l<n.length-
1;l++)if(1==l%2){var o=n[l].split(">")[0],q=n[l].split(o+">")[1];m.push({dataField:o,value:q,colSpan:1})}c.push({dataField:j,subTotal:"true"==k,subHeaders:m})}return c},OATGetDataFromXMLForPivot=function(c,g){dataString.split("<Record>");var h={};h.ServerRecordCount=parseToIntRegisterValue(c,"RecordCount");h.ServerPageCount=parseToIntRegisterValue(c,"PageCount");h.ServerPageNumber=parseToIntRegisterValue(c,"PageNumber");h.columnsHeaders=OATGetColumnsHeadersFromXML(c);h.rows=OATGetRowsFromXML(c,h,
g);return h},OATGetNewDataFromXMLForPivot=function(c,g,h,j){c=c.replace(/<Cell\/>/g,"<Cell />");if(void 0==j||""==j)if(-1!=parseToIntRegisterValue(c,"RecordCount")&&(g.ServerRecordCount=parseToIntRegisterValue(c,"RecordCount")),-1!=parseToIntRegisterValue(c,"PageCount"))g.ServerPageCount=parseToIntRegisterValue(c,"PageCount");g.ServerPageNumber=parseToIntRegisterValue(c,"PageNumber");1<c.split("<Columns>").length&&(g.columnsHeaders=OATGetColumnsHeadersFromXML(c));g.rows=OATGetRowsFromXML(c,g,h);return g},
OATgetDataFromXMLOldFormat=function(c,g,h){for(var c=c.split("<Record>"),j=[],k=[],m=1;m<c.length;m++){for(var n=[],l=[],o=0;o<g.length;o++){n[o]="#NuN#";var q=c[m].split("<"+g[o]+">");1<q.length&&(q=q[1].split("</"+g[o]+">"),n[o]=q[0],l[o]=n[o])}j.push(n);if(void 0!=h){n=g.length;for(o=0;o<h.length;o++)l[n+o]=void 0,q=c[m].split("<"+h[o]+">"),1<q.length&&(q=q[1].split("</"+h[o]+">"),l[n+o]=q[0]);k.push(l)}}return void 0!=h?[j,k]:j},OATgetAllDataFromXMLOldFormat=function(c,g,h){for(var c=c.split("<Record>"),
j=[],k=[],m=1;m<c.length;m++){for(var n=[],l=[],o=0;o<g.length;o++){n[o]="#NuN#";var q=c[m].split("<"+g[o]+">");1<q.length&&(q=q[1].split("</"+g[o]+">"),n[o]=q[0],l[o]=n[o])}j.push(n);n=g.length;for(o=0;o<h.length;o++)l[n+o]=void 0,q=c[m].split("<"+h[o]+">"),1<q.length&&(q=q[1].split("</"+h[o]+">"),l[n+o]=q[0]);k.push(l)}return[j,k]};OATParseMetadata=function(c,g,h,j){var k=[],m=[],n=[],l;l=-1!=c.indexOf("<OLAPDimension")?c.substring(0,c.indexOf("<OLAPDimension")):c.substring(0,c.indexOf("<OLAPMeasure"));
for(var o=c.substring(c.indexOf("<OLAPDimension"),c.length),q=o.split("<OLAPDimension"),r=1;r<q.length;r++)if(0<q[r].length)if(q[r]=-1!=q[r].indexOf("</OLAPDimension>")?q[r].substring(0,q[r].indexOf("</OLAPDimension>")):q[r].substring(0,q[r].indexOf("/>"))+">",c=!1,void 0!=g&&0<g.length&&(c=q[r].split('dataField="')[1].split('"')[0],c=-1!=g.indexOf(c)),-1!=q[r].indexOf('defaultPosition="hidden"')&&void 0==g||c&&void 0!=g){try{if(-1!=q[r].indexOf("displayName=")){var t=q[r].substring(q[r].indexOf("displayName=")+
13);k.push(t.split('"')[0]);m.push(q[r].substring(q[r].indexOf("dataField=")+11).split('"')[0]);try{n.push(q[r].substring(q[r].indexOf("name=")+6).split('"')[0])}catch(w){}}}catch(v){}q[r]=""}else q[r]="<OLAPDimension "+q[r]+"</OLAPDimension>";else q[r]="";g=o.split("<OLAPMeasure");t=!0;for(r=1;r<g.length;r++)(c=!1,void 0!=h&&0<h.length&&(c=g[r].split('dataField="')[1].split('"')[0],c=-1!=h.indexOf(c)),c)?g[r]="":(g[r]=-1!=g[r].indexOf("</OLAPMeasure")?"<OLAPMeasure "+g[r].substring(0,g[r].indexOf("</OLAPMeasure>"))+
"</OLAPMeasure>":-1!=g[r].indexOf("/>")?"<OLAPMeasure "+g[r].substring(0,g[r].indexOf("/>"))+"/>":"",t=!1);j&&t&&g.push('<OLAPMeasure popupDisabled="false" name="Quantity" displayName="'+gx.getMessage("GXPL_QViewerQuantity")+'" description="'+gx.getMessage("GXPL_QViewerQuantity")+'" dataField="F0" aggregation="count" summarize="yes" align="right" picture="" targetValue="0" defaultPosition="data" validPositions="data" dataType="integer" format="borderThickness:1"> </OLAPMeasure>');c=l;for(r=1;r<q.length;r++)0<
q[r].length&&(c+=q[r]);for(r=1;r<g.length;r++)0<g[r].length&&(c+=g[r]);return[c+"</OLAPCube>",k,m,n]};OATGetColumnsAndMeasureMeatadata=function(c,g,h,j){for(var k=[],m=[],n=[],l=[],o=[],q=[],r=[],t=[],w=[],v=0,A=0,F=[],H=[],u=[],B=0;B<c.length;B++){if("rows"==c[B].attributes.getNamedItem("defaultPosition").nodeValue||"hidden"==c[B].attributes.getNamedItem("defaultPosition").nodeValue)m[v]=c[B].attributes.getNamedItem("displayName").nodeValue,k[B]=m[v],v++;"columns"==c[B].attributes.getNamedItem("defaultPosition").nodeValue&&
(n[A]=c[B].attributes.getNamedItem("displayName").nodeValue,k[B]=n[A],A++);"filters"==c[B].attributes.getNamedItem("defaultPosition").nodeValue&&(l[A]=c[B].attributes.getNamedItem("displayName").nodeValue,k[B]=l[A],A++);c[B].attributes.getNamedItem("dataType");if(0<c[B].childNodes.length&&null!=c[B].childNodes)for(var E=0;E<c[B].childNodes.length;E++)if("formatValues"==c[B].childNodes[E].localName)for(var z=0;z<c[B].childNodes[E].childNodes.length;z++)if("value"==c[B].childNodes[E].childNodes[z].localName){var x=
{};x.format=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue;x.recursive=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("recursive").nodeValue;var y=c[B].childNodes[E].childNodes[z].textContent;x.value=y.replace(/^\s+|\s+$/g,"");x.columnNumber=B;o.push(x)}if(0<c[B].childNodes.length&&null!=c[B].childNodes)for(E=0;E<c[B].childNodes.length;E++)if("conditionalFormats"==c[B].childNodes[E].localName)for(z=0;z<c[B].childNodes[E].childNodes.length;z++)"rule"==c[B].childNodes[E].childNodes[z].localName&&
(x={},x.format=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,x.operation1=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("op1").nodeValue,x.value1=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("value1").nodeValue,null!=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("op2")&&(x.operation2=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("op2").nodeValue,x.value2=c[B].childNodes[E].childNodes[z].attributes.getNamedItem("value2").nodeValue),
x.columnNumber=B,q.push(x));H.push(c[B].attributes.getNamedItem("picture").nodeValue);u.push(c[B].attributes.getNamedItem("format").nodeValue);w.push(c[B].attributes.getNamedItem("dataField").nodeValue)}c=[];for(B=0;B<g.length;B++){F[B]=g[B].attributes.getNamedItem("displayName").nodeValue;if(0<g[B].childNodes.length&&null!=g[B].childNodes)for(E=0;E<g[B].childNodes.length;E++)if("formatValues"==g[B].childNodes[E].localName)for(z=0;z<g[B].childNodes[E].childNodes.length;z++)"value"==g[B].childNodes[E].childNodes[z].localName&&
(x={},x.format=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,x.recursive=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("recursive").nodeValue,y=g[B].childNodes[E].childNodes[z].textContent,x.value=y.replace(/^\s+|\s+$/g,""),x.columnNumber=B,r.push(x));if(0<g[B].childNodes.length&&null!=g[B].childNodes)for(E=0;E<g[B].childNodes.length;E++)if("conditionalFormats"==g[B].childNodes[E].localName)for(z=0;z<g[B].childNodes[E].childNodes.length;z++)"rule"==g[B].childNodes[E].childNodes[z].localName&&
(x={},x.format=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("format").nodeValue,x.operation1=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("op1").nodeValue,x.value1=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("value1").nodeValue,null!=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("op2")&&(x.operation2=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("op2").nodeValue,x.value2=g[B].childNodes[E].childNodes[z].attributes.getNamedItem("value2").nodeValue),
x.columnNumber=B,t.push(x));void 0!=g[B].attributes.getNamedItem("formula")&&""!=g[B].attributes.getNamedItem("formula").nodeValue?c.push({hasFormula:!0,textFormula:g[B].attributes.getNamedItem("formula").nodeValue}):c.push({hasFormula:!1});H.push(g[B].attributes.getNamedItem("picture").nodeValue);w.push(g[B].attributes.getNamedItem("dataField").nodeValue)}z={};for(v=0;v<j.length;v++)z[j[v]]=w.length+v;h.itemPosition=z;h.measureFormula=c;for(z=h.cantFormulaMeasures=0;z<h.measureFormula.length;z++)if(h.measureFormula[z].hasFormula){h.cantFormulaMeasures++;
A=h.measureFormula[z].textFormula;j="*-+/()".split("");for(v=0;v<j.length;v++)if(g=A.split(j[v]),1<g.length){A="";for(B=0;B<g.length-1;B++)A=A+g[B]+" "+j[v]+" ";A+=g[g.length-1]}v=InfixToPostfix(A);h.measureFormula[z].polishNotationText=v;for(B=v.split(" ");-1!=B.indexOf("");)B.splice(B.indexOf(""),1);g=[];for(A=0;A<B.length;A++)-1==j.indexOf(B[A])&&isNaN(parseInt(B[A]))&&(r=h.itemPosition[B[A]],-1==g.indexOf(r)&&g.push(r));h.measureFormula[z].relatedMeasures=g;for(A=v.split(" ");-1!=A.indexOf("");)A.splice(A.indexOf(""),
1);h.measureFormula[z].PolishNotation=A}return[k.concat(F),w,c,t,q,H,u]};OATgetState=function(c,g){"function"!==typeof JSON.retrocycle&&(JSON.retrocycle=function(c){var g=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function r(c){var h,j,k;if(c&&"object"===typeof c)if("[object Array]"===Object.prototype.toString.apply(c))for(h=0;h<c.length;h+=1){if((j=c[h])&&"object"===typeof j)k=j.$ref,"string"===typeof k&&g.test(k)?c[h]=eval(k):r(j)}else for(h in c)if("object"===
typeof c[h]&&(j=c[h]))k=j.$ref,"string"===typeof k&&g.test(k)?c[h]=eval(k):r(j)})(c);return c});try{var h;if(null!=localStorage.getItem(OAT.getURL()+c+g+"HiddenState")){var j=localStorage.getItem(OAT.getURL()+c+g+"HiddenState");h=JSON.retrocycle(JSON.parse(j))}if(null==h){var k=OATGetCookie('"'+OAT.getURL()+c+g+'HiddenStatecookie"');null!=k&&(h=JSON.parse(k))}return h}catch(m){try{return k=OATGetCookie('"'+OAT.getURL()+c+g+'HiddenStatecookie"'),h=JSON.parse(k)}catch(n){return null}}};var init=function(){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Layers=function(c){var g=this;this.baseOffset=c;this.layers=[];this.currentIndex=0;this.raise=function(c){if(-1!=g.layers.findIndex(c)){for(var j=c.style.zIndex,k=0;k<g.layers.length;k++){var m=g.layers[k];m.style.zIndex>j&&m.style.zIndex--}c.style.zIndex=g.currentIndex}};this.addLayer=function(c,j){var k=OAT.$(c);k&&(g.currentIndex++,k.style.zIndex=g.currentIndex,g.layers.push(k),OAT.Dom.attach(k,j?j:"mousedown",function(){g.raise(k)}))};
this.removeLayer=function(c){c=OAT.$(c);c=g.layers.findIndex(c);-1!=c&&g.layers.splice(c,1)};g.currentIndex=g.baseOffset};(function(){function c(c){function h(h,k){var n,E,z=h==window,x=k&&void 0!==k.message?k.message:void 0,k=c.extend({},c.blockUI.defaults,k||{});if(!k.ignoreIfBlocked||!c(h).data("blockUI.isBlocked")){k.overlayCSS=c.extend({},c.blockUI.defaults.overlayCSS,k.overlayCSS||{});n=c.extend({},c.blockUI.defaults.css,k.css||{});k.onOverlayClick&&(k.overlayCSS.cursor="pointer");E=c.extend({},
c.blockUI.defaults.themedCSS,k.themedCSS||{});x=void 0===x?k.message:x;z&&A&&j(window,{fadeOut:0});if(x&&"string"!=typeof x&&(x.parentNode||x.jquery)){var y=x.jquery?x[0]:x,C={};c(h).data("blockUI.history",C);C.el=y;C.parent=y.parentNode;C.display=y.style.display;C.position=y.style.position;C.parent&&C.parent.removeChild(y)}c(h).data("blockUI.onUnblock",k.onUnblock);var C=k.baseZ,I;I=t||k.forceIframe?c('<iframe class="blockUI" style="z-index:'+C++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+
k.iframeSrc+'"></iframe>'):c('<div class="blockUI" style="display:none"></div>');y=k.theme?c('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+C++ +';display:none"></div>'):c('<div class="blockUI blockOverlay" style="z-index:'+C++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');k.theme&&z?(C='<div class="blockUI '+k.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(C+10)+';display:none;position:fixed">',
k.title&&(C+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(k.title||"&nbsp;")+"</div>"),C+='<div class="ui-widget-content ui-dialog-content"></div></div>'):k.theme?(C='<div class="blockUI '+k.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(C+10)+';display:none;position:absolute">',k.title&&(C+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(k.title||"&nbsp;")+"</div>"),C+='<div class="ui-widget-content ui-dialog-content"></div></div>'):
C=z?'<div class="blockUI '+k.blockMsgClass+' blockPage" style="z-index:'+(C+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+k.blockMsgClass+' blockElement" style="z-index:'+(C+10)+';display:none;position:absolute"></div>';C=c(C);x&&(k.theme?(C.css(E),C.addClass("ui-widget-content")):C.css(n));k.theme||y.css(k.overlayCSS);y.css("position",z?"fixed":"absolute");(t||k.forceIframe)&&I.css("opacity",0);n=[I,y,C];var K=z?c("body"):c(h);c.each(n,function(){this.appendTo(K)});k.theme&&(k.draggable&&
c.fn.draggable)&&C.draggable({handle:".ui-dialog-titlebar",cancel:"li"});E=v&&(!c.support.boxModel||0<c("object,embed",z?null:h).length);if(w||E){z&&(k.allowBodyStretch&&c.support.boxModel)&&c("html,body").css("height","100%");if((w||!c.support.boxModel)&&!z){E=q(h,"borderTopWidth");var W=q(h,"borderLeftWidth"),U=E?"(0 - "+E+")":0,O=W?"(0 - "+W+")":0}c.each(n,function(c,g){var h=g[0].style;h.position="absolute";if(c<2){z?h.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+
k.quirksmodeOffsetHack+') + "px"'):h.setExpression("height",'this.parentNode.offsetHeight + "px"');z?h.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):h.setExpression("width",'this.parentNode.offsetWidth + "px"');O&&h.setExpression("left",O);U&&h.setExpression("top",U)}else if(k.centerY){z&&h.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');
h.marginTop=0}else if(!k.centerY&&z){var j="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+(k.css&&k.css.top?parseInt(k.css.top,10):0)+') + "px"';h.setExpression("top",j)}})}x&&(k.theme?C.find(".ui-widget-content").append(x):C.append(x),(x.jquery||x.nodeType)&&c(x).show());(t||k.forceIframe)&&k.showOverlay&&I.show();k.fadeIn?(n=k.onBlock?k.onBlock:r,I=k.showOverlay&&!x?n:r,n=x?n:r,k.showOverlay&&y._fadeIn(k.fadeIn,I),x&&C._fadeIn(k.fadeIn,
n)):(k.showOverlay&&y.show(),x&&C.show(),k.onBlock&&k.onBlock.bind(C)());m(1,h,k);z?(A=C[0],F=c(k.focusableElements,A),k.focusInput&&setTimeout(l,20)):o(C[0],k.centerX,k.centerY);k.timeout&&(x=setTimeout(function(){z?c.unblockUI(k):c(h).unblock(k)},k.timeout),c(h).data("blockUI.timeout",x))}}function j(h,j){var l,n=h==window,o=c(h),q=o.data("blockUI.history"),r=o.data("blockUI.timeout");r&&(clearTimeout(r),o.removeData("blockUI.timeout"));j=c.extend({},c.blockUI.defaults,j||{});m(0,h,j);null===j.onUnblock&&
(j.onUnblock=o.data("blockUI.onUnblock"),o.removeData("blockUI.onUnblock"));var t;t=n?c("body").children().filter(".blockUI").add("body > .blockUI"):o.find(">.blockUI");if(j.cursorReset&&(1<t.length&&(t[1].style.cursor=j.cursorReset),2<t.length))t[2].style.cursor=j.cursorReset;n&&(A=F=null);j.fadeOut?(l=t.length,t.stop().fadeOut(j.fadeOut,function(){--l===0&&k(t,q,j,h)})):k(t,q,j,h)}function k(h,j,k,l){var m=c(l);if(!m.data("blockUI.isBlocked")){h.each(function(){this.parentNode&&this.parentNode.removeChild(this)});
j&&j.el&&(j.el.style.display=j.display,j.el.style.position=j.position,j.el.style.cursor="default",j.parent&&j.parent.appendChild(j.el),m.removeData("blockUI.history"));m.data("blockUI.static")&&m.css("position","static");if("function"==typeof k.onUnblock)k.onUnblock(l,k);h=c(document.body);j=h.width();k=h[0].style.width;h.width(j-1).width(j);h[0].style.width=k}}function m(h,j,k){var l=j==window,j=c(j);if(h||!(l&&!A||!l&&!j.data("blockUI.isBlocked")))j.data("blockUI.isBlocked",h),l&&(k.bindEvents&&
(!h||k.showOverlay))&&(h?c(document).bind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",k,n):c(document).unbind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",n))}function n(h){if("keydown"===h.type&&h.keyCode&&9==h.keyCode&&A&&h.data.constrainTabKey){var j=F,k=h.shiftKey&&h.target===j[0];if(!h.shiftKey&&h.target===j[j.length-1]||k)return setTimeout(function(){l(k)},10),!1}var j=h.data,m=c(h.target);if(m.hasClass("blockOverlay")&&j.onOverlayClick)j.onOverlayClick(h);
return 0<m.parents("div."+j.blockMsgClass).length?!0:0===m.parents().children().filter("div.blockUI").length}function l(c){F&&(c=F[!0===c?F.length-1:0])&&c.focus()}function o(c,g,h){var j=c.parentNode,k=c.style,l=(j.offsetWidth-c.offsetWidth)/2-q(j,"borderLeftWidth"),c=(j.offsetHeight-c.offsetHeight)/2-q(j,"borderTopWidth");g&&(k.left=0<l?l+"px":"0");h&&(k.top=0<c?c+"px":"0")}function q(h,j){return parseInt(c.css(h,j),10)||0}c.fn._fadeIn=c.fn.fadeIn;var r=c.noop||function(){},t=/MSIE/.test(navigator.userAgent),
w=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),v=c.isFunction(document.createElement("div").style.setExpression);c.blockUI=function(c){h(window,c)};c.unblockUI=function(c){j(window,c)};c.growlUI=function(h,j,k,l){var m=c('<div class="growlUI"></div>');h&&m.append("<h1>"+h+"</h1>");j&&m.append("<h2>"+j+"</h2>");void 0===k&&(k=3E3);var n=function(h){h=h||{};c.blockUI({message:m,fadeIn:"undefined"!==typeof h.fadeIn?h.fadeIn:700,fadeOut:"undefined"!==typeof h.fadeOut?h.fadeOut:
1E3,timeout:"undefined"!==typeof h.timeout?h.timeout:k,centerY:!1,showOverlay:!1,onUnblock:l,css:c.blockUI.defaults.growlCSS})};n();m.css("opacity");m.mouseover(function(){n({fadeIn:0,timeout:3E4});var h=c(".blockMsg");h.stop();h.fadeTo(300,1)}).mouseout(function(){c(".blockMsg").fadeOut(1E3)})};c.fn.block=function(j){if(this[0]===window)return c.blockUI(j),this;var k=c.extend({},c.blockUI.defaults,j||{});this.each(function(){var h=c(this);(!k.ignoreIfBlocked||!h.data("blockUI.isBlocked"))&&h.unblock({fadeOut:0})});
return this.each(function(){"static"==c.css(this,"position")&&(this.style.position="relative",c(this).data("blockUI.static",!0));this.style.zoom=1;h(this,j)})};c.fn.unblock=function(h){return this[0]===window?(c.unblockUI(h),this):this.each(function(){j(this,h)})};c.blockUI.version=2.7;c.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",
cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:0.1,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:0.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1E3,centerX:!0,centerY:!0,
allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var A=null,F=[]}"function"===typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],c):c(jQuery)})();try{OAT.Loader.featureLoaded("layers")}catch(ERROR$$15){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){if(void 0==GlobalPivotInterval)var GlobalPivotInterval=[];OAT.Pivot=function(c,g,h,j,k,m,n,l,o,q,r,t,w,v,A,F,H,u,B,E,z,x,y,C,I,K,W,U,O,J,X,ba,T,L,G){var f=this;this.autoPaging=!1;this.prevRowWhenAutopaging=this.nextRowWhenAutopaging=0;this.paginationInfo=!1;this.TempDataStructForAggStepOptimization=[];this.actualPaginationPage=1;this.allDataWithoutSort=jQuery.extend(!0,[],k);this.IdForQueryViewerCollection=K;this.UcId=I;this.ShowMeasuresAsRows=
U;this.rememberLayoutStateVersion=X?"4.3.8SP":"4.3.8";2>x.length&&(this.ShowMeasuresAsRows=!1);this.swfPath=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/downloadify/media/downloadify.swf");this.downloadImagePath=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/download_file.png");this.allRowsPivot="vacio";this.HideDataFilds=T;this.OrderFildsHidden=L;this.initMetadata=G;fromUndefinedToBlanck(k);if(void 0!=k[0]){if(0<O.cantFormulaMeasures)for(var S=
0;S<k.length;S++)k[S][j.length]=S;for(var U=[],V=j.length-1;-1<V;V--){T=!0;for(L=0;L<k.length;L++)if(T&&k[L][V]!=parseInt(k[L][V])){T=!1;break}U[V]=T}V=0;k=U[V]?k.sort(function(f){return function(c,g){return parseInt(c[f])===parseInt(g[f])?0:parseInt(c[f])<parseInt(g[f])?-1:1}}(V)):k.sort(function(f){return function(c,g){return c[f]===g[f]?0:c[f]<g[f]?-1:1}}(V));T=k[0][V];for(S=L=0;S<k.length;S++)T!=k[S][V]?(T=k[S][V],k=OAT.PartialSort(k,L,S-1,V+1,j.length,U),L=S):S==k.length-1&&(k=OAT.PartialSort(k,
L,S,V+1,j.length,U))}U=k;k=[];0<U.length&&(k[0]=U[0]);T=0;for(S=1;S<U.length;S++){for(var L=!0,Q=0;Q<H.length;Q++)if(U[S][Q]!=U[S-1][Q]){L=!1;break}if(L){for(Q=H.length;Q<H.length+x.length;Q++)G=parseFloat(k[T][Q])+parseFloat(U[S][Q]),"#NuN#"==k[T][Q]&&"#NuN#"==U[S][Q]?G="#NuN#":"#NuN#"==k[T][Q]?G=U[S][Q]+"":"#NuN#"==U[S][Q]&&(G=k[T][Q]+""),k[T][Q]=G+"";if(0<O.cantFormulaMeasures){for(var P=k[T][j.length],L=U[S][j.length],Q=0;Q<O.measureFormula.length;Q++)if(O.measureFormula[Q].hasFormula)for(var aa=
0;aa<O.measureFormula[Q].relatedMeasures.length;aa++){var ca=O.measureFormula[Q].relatedMeasures[aa],G=parseFloat(J[P][ca])+parseFloat(J[L][ca]);J[P][ca]=G+""}for(Q=H.length;Q<H.length+x.length;Q++)G=parseFloat(J[P][Q])+parseFloat(J[L][Q]),J[P][Q]=G+"";for(G=0;G<j.length;G++)J[L][G]=""}}else T++,k[T]=U[S]}if(0<O.cantFormulaMeasures&&void 0!=k[0])for(U=0;U<k.length;U++)k[U].splice(j.length,1);this.serverPagination=X;this.pageData=ba;this.serverPagination&&(this.pageData.PreviousPageNumber=-1,this.pageData.AxisInfo=
[],this.pageData.FilterInfo=[]);if(!this.serverPagination&&void 0!=v&&(1<H.length||0<x.length))if(void 0!=k[0]&&(4>k[0].length-l.length&&4004<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(4==k[0].length-l.length&&2701<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(5==k[0].length-l.length&&2501<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(6==k[0].length-l.length&&1301<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&(7==k[0].length-l.length&&601<k.length)&&(this.autoPaging=!0),void 0!=k[0]&&8<=k[0].length-
l.length&&301<=k.length)this.autoPaging=!0;1<l.length&&(2>=H.length-l.length&&0==n.length)&&(this.autoPaging=!0);if(this.ShowMeasuresAsRows||this.serverPagination)this.autoPaging=!1;this.recordForFormula=J;this.formulaInfo=O;this.filterIndexes=l;this.initFilterIndexes=[];for(S=0;S<this.filterIndexes.length;S++)this.initFilterIndexes[S]=this.filterIndexes[S];this.getFormulaRowByDataRow=function(c,g){for(var h=false,j=f.recordForFormula,k=[],l=0;l<f.formulaInfo.recordDataLength;l++)k[l]=0;for(l=0;l<
j.length;l++){for(var n=false,q=0;q<c.length;q++)if(f.filterIndexes.indexOf(q)!=-1){n=f.filterIndexes.indexOf(q);if(f.filterDiv!=void 0){n=OAT.$v(f.filterDiv.selects[n]);if(n=="[all]")n=true;else{n=n==j[l][q];if(!n)break}}else n=true}else if(f.filterIndexes.length>0&&q>=c.length-x.length)n=true;else if(j[l][q]==c[q]||c[q]=="#FoE#"&&j[l][q]==0)n=true;else if(m!=void 0&&m.indexOf(q)!=-1&&m.indexOf(q)>m.length-x.length)n=true;else if(o>0&&o==q)n=true;else if(c[q]==void 0&&f.filterIndexes.length>0)n=
true;else{n=false;break}if(n){for(h=0;h<f.formulaInfo.measureFormula[g].relatedMeasures.length;h++){n=f.formulaInfo.measureFormula[g].relatedMeasures[h];k[n]=k[n]+parseFloat(j[l][n])}h=true}}return h?k:"#NuN#"};for(l=0;l<x.length;l++)if(O.measureFormula[l].hasFormula)for(J=0;J<k.length;J++)if(0==k[J][k[J].length-x.length+l]&&(X=this.getFormulaRowByDataRow(k[J],l,""),X=EvaluateExpressionPivotJs(O.measureFormula[l].PolishNotation,X,O),Infinity==X||isNaN(X)))k[J][k[J].length-x.length+l]="#FoE#";this.GeneralDataRows=
k;this.autoPagingRowsPerPage=void 0!=v?parseInt(v):10;this.TotalPagesPaging=parseInt(k.length/this.autoPagingRowsPerPage);0!=k.length%this.autoPagingRowsPerPage&&this.TotalPagesPaging++;this.GeneralDistinctValues=[];this.GrandTotalsPaging=[];this.columns=H;0<k.length&&fillGeneralDistinctValues(j.length-x.length,f,k);if(this.autoPaging){U=k;k=[];for(S=0;S<Math.min(U.length,this.autoPagingRowsPerPage);S++)k.append([U[S]])}this.RowsWhenMoveToFilter=[];this.FilterByTopFilter=!1;this.options={headingBefore:1,
headingAfter:0,agg:1,aggTotals:1,showChart:0,showRowChart:0,showColChart:0,customType:function(f){return f},showEmpty:0,subtotals:1,totals:1};if(q)for(p in q)this.options[p]=q[p];this.firstTime=!0;this.deleteState=this.readState=!1;this.defaultPicture=A;this.gd=new OAT.GhostDrag;this.div=OAT.$(c);this.filterDiv=OAT.$(h);this.chartDiv=OAT.$(g);this.defCArray="rgb(153,153,255) rgb(153,51,205) rgb(255,255,204) rgb(204,255,255) rgb(102,0,102) rgb(255,128,128) rgb(0,102,204) rgb(204,204,255) rgb(0,0,128) rgb(255,0,255) rgb(0,255,255) rgb(255,255,0)".split(" ");
this.QueryViewerCollection=F;this.containerName=u;this.formatValues=B;this.formatValuesMeasures=z;this.tempBlackLists=[];this.tempCollapsedValues=[];this.oldSortValues=[];this.stateChanged=!1;this.rowsPerPage=v;this.chartDiv&&(OAT.Dom.clear(f.chartDiv),c=OAT.Dom.create("div",{},"pivot_chart"),g=OAT.Dom.create("div",{},"pivot_row_chart"),h=OAT.Dom.create("div",{},"pivot_col_chart"),q=OAT.Dom.button(""),A=OAT.Dom.button(""),F=OAT.Dom.button(""),OAT.Dom.append([f.chartDiv,q,c,F,h,A,g]),this.charts={main:new OAT.BarChart(c,
{}),row:new OAT.BarChart(g,{}),col:new OAT.BarChart(h,{}),mainLink:q,rowLink:A,colLink:F,mainDiv:c,rowDiv:g,colDiv:h},OAT.Dom.attach(q,"click",function(){f.options.showChart=(f.options.showChart+1)%2;f.go(false)}),OAT.Dom.attach(A,"click",function(){f.options.showRowChart=(f.options.showRowChart+1)%2;f.go(false)}),OAT.Dom.attach(F,"click",function(){f.options.showColChart=(f.options.showColChart+1)%2;f.go(false)}));this.headerRow=j;this.allData=k;this.filteredData=[];this.tabularData=[];this.dataColumnIndex=
o;this.rowConditions=m;this.colConditions=n;this.initRowConditions=[];for(S=0;S<this.rowConditions.length;S++)this.initRowConditions[S]=this.rowConditions[S];this.initColConditions=[];for(S=0;S<this.colConditions.length;S++)this.initColConditions[S]=this.colConditions[S];1==H.length&&0==x.length&&(this.rowConditions=[0]);this.conditions=[];this.filterDiv.selects=[];this.rowStructure={};this.colStructure={};this.colPointers=[];this.rowPointers=[];this.rowTotals=[[],[]];this.colTotals=[[],[]];this.gTotal=
[];this.query=r;this.controlName=w;this.conditionalFormats=t;this.conditionalFormatsColumns=E;this.GreyList=[];this.EmptyValue="#NaV#";this.NullValue="#NuN#";this.initState={};"function"!==typeof JSON.decycle&&(JSON.decycle=function(f){var c=[],g=[];return function Y(f,h){var D,j,k;switch(typeof f){case "object":if(!f)return null;for(D=0;D<c.length;D=D+1)if(c[D]===f)return{$ref:g[D]};c.push(f);g.push(h);if(Object.prototype.toString.apply(f)==="[object Array]"){k=[];for(D=0;D<f.length;D=D+1)k[D]=Y(f[D],
h+"["+D+"]")}else{k={};for(j in f)Object.prototype.hasOwnProperty.call(f,j)&&(k[j]=Y(f[j],h+"["+JSON.stringify(j)+"]"))}return k;case "number":case "string":case "boolean":return f}}(f,"$")});this.saveState=function(c){try{if(window.localStorage){localStorage.removeItem(OAT.getURL()+f.query+f.controlName);localStorage.setItem(OAT.getURL()+f.query+f.controlName,JSON.stringify(JSON.decycle(c)))}else OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"',JSON.stringify(c),null,"/")}catch(g){try{OATSetCookie('"'+
OAT.getURL()+f.query+f.controlName+'cookie"',JSON.stringify(c),null,"/")}catch(h){}}};this.saveHiddenState=function(c){try{if(window.localStorage){localStorage.removeItem(OAT.getURL()+f.query+f.controlName+"HiddenState");localStorage.setItem(OAT.getURL()+f.query+f.controlName+"HiddenState",JSON.stringify(JSON.decycle(c)))}else OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'HiddenStatecookie"',JSON.stringify(c),null,"/")}catch(g){try{OATSetCookie('"'+OAT.getURL()+f.query+f.controlName+'HiddenStatecookie"',
JSON.stringify(c),null,"/")}catch(h){}}};this.getState=function(){if(typeof JSON.retrocycle!=="function")JSON.retrocycle=function(f){var c=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;(function na(f){var g,h,D;if(f&&typeof f==="object")if(Object.prototype.toString.apply(f)==="[object Array]")for(g=0;g<f.length;g=g+1){if((h=f[g])&&typeof h==="object"){D=h.$ref;typeof D==="string"&&c.test(D)?f[g]=eval(D):na(h)}}else for(g in f)if(typeof f[g]==="object")if(h=
f[g]){D=h.$ref;typeof D==="string"&&c.test(D)?f[g]=eval(D):na(h)}})(f);return f};try{var c;if(localStorage.getItem(OAT.getURL()+f.query+f.controlName)!=null){var g=localStorage.getItem(OAT.getURL()+f.query+f.controlName);c=JSON.retrocycle(JSON.parse(g))}if(c==null){var h=OATGetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"');h!=null&&(c=JSON.parse(h))}return c}catch(j){try{h=OATGetCookie('"'+OAT.getURL()+f.query+f.controlName+'cookie"');return c=JSON.parse(h)}catch(k){return null}}};this.cleanState=
function(){for(var c=0;c<f.filterDiv.selects.length;c++)f.filterDiv.selects[c].value="[all]";for(c=0;c<=f.conditions.length-1;c++){f.conditions[c].blackList=[];f.conditions[c].whiteList=[];f.conditions[c].greyList=[]}localStorage.removeItem(OAT.getURL()+f.query+f.controlName);f.deleteState=false;for(var c=[],g=0;g<f.initState.colConditions.length;g++)c[g]=f.initState.colConditions[g];for(var h=[],g=0;g<f.initState.rowConditions.length;g++)h[g]=f.initState.rowConditions[g];for(var j=[],g=0;g<f.initState.filterIndexes.length;g++)j[g]=
f.initState.filterIndexes[g];this.conditions=jQuery.extend(true,[],f.initState.conditions);this.rowConditions=h;this.colConditions=c;this.filterIndexes=j;this.stateChanged=f.initState.stateChanged;this.rowsPerPage=f.initState.rowsPerPage;f.saveState({query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:[],rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion})};this.cleanStateWhenServerPagination=
function(){for(var c=0;c<f.filterDiv.selects.length;c++)f.filterDiv.selects[c].value="[all]";for(c=0;c<=f.conditions.length-1;c++)f.conditions[c].blackList=[];for(var c=[],g=0;g<f.initState.colConditions.length;g++)c[g]=f.initState.colConditions[g];for(var h=[],g=0;g<f.initState.rowConditions.length;g++)h[g]=f.initState.rowConditions[g];for(var j=[],g=0;g<f.initState.filterIndexes.length;g++)j[g]=f.initState.filterIndexes[g];for(g=0;g<f.conditions.length;g++)if(f.conditions[g]&&f.conditions[g].distinctValues&&
f.conditions[g].dataField){for(var k=-1,l=0;l<f.initState.conditions.length;l++)f.initState.conditions[l]&&f.initState.conditions[l].dataField==f.conditions[g].dataField&&(k=l);if(k>-1){f.initState.conditions[k].distinctValues=[];for(l=0;l<f.conditions[g].distinctValues.length;l++)f.initState.conditions[k]&&f.initState.conditions[k].distinctValues.indexOf(f.conditions[g].distinctValues[l])==-1&&f.initState.conditions[k].distinctValues.push(f.conditions[g].distinctValues[l]);f.initState.conditions[k].previousPage=
f.conditions[g].previousPage;f.initState.conditions[k].totalPages=f.conditions[g].totalPages}}f.conditions=jQuery.extend(true,[],f.initState.conditions);f.pageData.AxisInfo=jQuery.extend(true,[],f.initState.AxisInfo);f.pageData.DataInfo=jQuery.extend(true,[],f.initState.DataInfo);f.pageData.FilterInfo=jQuery.extend(true,[],f.initState.FilterInfo);f.pageData.CollapseInfo=jQuery.extend(true,[],f.initState.CollapseInfo);f.rowConditions=h;f.colConditions=c;f.filterIndexes=j;f.stateChanged=f.initState.stateChanged;
f.rowsPerPage=f.initState.rowsPerPage;f.DefaultAction=f.initState.DefaultAction;f.initMetadata=jQuery.extend(true,{},f.initState.InitMetadata);f.initMetadata.Conditions=[];for(c=0;c<f.initState.conditions.length;c++){g=f.initMetadata.DataFields.indexOf(f.initState.conditions[c].dataField);f.initMetadata.Conditions[g]=f.conditions[c]}f.goWhenHide(true)};this.getDataXML=function(){var c;if(f.serverPagination){c=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync().split("<Recordset")[1];
c="<Recordset"+c}else{c='<OLAPData format="adonet">\n <Table>\n';for(var g=0;g<f.GeneralDataRows.length;g++){c=c+"  <Record>\n";for(var h=0;h<this.columns.length;h++){c=c+"    <"+this.columns[h].getAttribute("dataField")+">";c=c+f.GeneralDataRows[g][h];c=c+"</"+this.columns[h].getAttribute("dataField")+">\n"}for(h=0;h<x.length;h++){c=c+"    <"+x[h].getAttribute("dataField")+">";c=c+f.GeneralDataRows[g][h+this.columns.length];c=c+"</"+x[h].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}c=c+"</Table>\n</OLAPData>"}return c};
this.getFilteredDataXML=function(){if(f.serverPagination){for(var c=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync().split("<Record>"),g=[],h=1;h<c.length;h++){for(var j=[],k=0;k<f.pageData.dataFields.length;k++){j[k]="#NuN#";var l=c[h].split("<"+f.pageData.dataFields[k]+">");if(l.length>1){l=l[1].split("</"+f.pageData.dataFields[k]+">");j[k]=l[0]}else c[h].indexOf("<"+f.pageData.dataFields[k]+"/>")>=0&&(j[k]="")}f.filterOK(j)&&g.push(j)}c='<Recordset RecordCount="'+g.length+
'" PageCount="1">\n';c=c+'<Page PageNumber="1">\n';for(h=0;h<g.length;h++){c=c+"  <Record>\n";for(j=0;j<this.columns.length;j++){c=c+"    <"+this.columns[j].getAttribute("dataField")+">";c=c+g[h][j];c=c+"</"+this.columns[j].getAttribute("dataField")+">\n"}for(j=0;j<x.length;j++){c=c+"    <"+x[j].getAttribute("dataField")+">";c=c+g[h][j+this.columns.length];c=c+"</"+x[j].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}c=c+"</Page>\n</Recordset>"}else{c="<Table>\n";for(h=0;h<f.filteredData.length;h++){c=
c+"  <Record>\n";for(j=0;j<this.columns.length;j++){c=c+"    <"+this.columns[j].getAttribute("dataField")+">";c=c+f.filteredData[h][j];c=c+"</"+this.columns[j].getAttribute("dataField")+">\n"}for(j=0;j<x.length;j++){c=c+"    <"+x[j].getAttribute("dataField")+">";c=c+f.filteredData[h][j+this.columns.length];c=c+"</"+x[j].getAttribute("dataField")+">\n"}c=c+"  </Record>\n"}c=c+"</Table>"}return c};this.getMetadataXML=function(){xml='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+
this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">';var c=this.columns;if(f.initMetadata.Metadata)var g=jQuery.parseXML(f.initMetadata.Metadata),c=g.getElementsByTagName("OLAPDimension");for(var h=1,g=0;g<c.length;g++){var j=g;if(f.initMetadata.Metadata)for(var j=-1,k=0;k<f.conditions.length;k++)f.conditions[k].dataField==f.initMetadata.Dimensions[g].dataField&&
(j=k);xml=xml+"<OLAPDimension>";xml=xml+"<name>"+c[g].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+c[g].getAttribute("displayName")+"</displayName> ";xml=xml+"<description>"+c[g].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+c[g].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+c[g].getAttribute("dataType")+"</dataType> ";f.initMetadata.Dimensions&&!f.initMetadata.Dimensions[g].Visible&&(xml=xml+"<hidden>true</hidden>");xml=xml+"<defaultPosition>";var l=
0;if(c[g].getAttribute("defaultPosition")=="Data")xml=xml+c[g].getAttribute("defaultPosition");else if(j==-1){xml=xml+"hidden";l=h;h=h+1}else if(f.rowConditions.findIndex(j)!=-1){xml=xml+"rows";l=f.rowConditions.indexOf(j)+1}else if(f.colConditions.findIndex(j)!=-1){xml=xml+"columns";l=f.colConditions.indexOf(j)+1}else{xml=xml+"pages";l=f.filterIndexes.indexOf(j)+1}xml=xml+"</defaultPosition> ";xml=xml+"<axisOrder>"+l+"</axisOrder>";xml=xml+"<validPositions>"+c[g].getAttribute("validPositions")+"</validPositions> ";
l=c[g].getAttribute("summarize");j>=0&&(l=f.conditions[j].subtotals?"yes":"no");xml=xml+"<summarize>"+l+"</summarize> ";xml=xml+"<align>"+c[g].getAttribute("align")+"</align> ";xml=c[g].getAttribute("picture")===""?xml+"<picture/> ":xml+"<picture>"+c[g].getAttribute("picture")+"</picture> ";xml=c[g].getAttribute("picture")===""?xml+"<format/> ":xml+"<format>"+c[g].getAttribute("format")+"</format> ";l=-1;if(f.initMetadata.Metadata){l=-1;for(k=0;k<f.initMetadata.Conditions.length;k++)f.initMetadata.Conditions[k].dataField==
f.initMetadata.Dimensions[g].dataField&&(l=k)}k=j>-1?f.conditions[j].sort:l>-1?f.initMetadata.Conditions[l].sort:"metadata";xml=k=="metadata"?xml+"<order>"+(c[g].getAttribute("order")!=""?c[g].getAttribute("order"):"Ascending")+"</order> ":k==1?xml+"<order>Ascending</order> ":k==-1?xml+"<order>Descending</order> ":xml+"<order>Custom</order> ";xml=xml+"<popupDisabled>"+c[g].getAttribute("popupDisabled")+"</popupDisabled> ";xml=xml+"<customOrder/> ";xml=xml+"<filterType>";k=j>-1?f.conditions[j].blackList:
l>-1?f.initMetadata.Conditions[l].blackList:[];xml=k.length==0?f.conditions[j].defaultAction=="Exclude"?xml+"HideAllValues":xml+"ShowAllValues":xml+"ShowSomeValues";xml=xml+"</filterType>";xml=xml+"<include> ";var m=j>-1?f.filterIndexes.findIndex(j):-1;if(m!=-1&&f.filterDiv.selects[m].value!="[all]")k.findIndex(f.filterDiv.selects[m].value)===-1&&(xml=xml+"<value>"+f.filterDiv.selects[m].value+"</value> ");else{m=j>-1?f.conditions[j].distinctValues:l>-1?f.initMetadata.Conditions[l].distinctValues:
[];if(!(f.conditions[j].defaultAction=="Exclude"&&k.length==0))for(var n=0;n<m.length;n++)k.findIndex(m[n])===-1&&(xml=xml+"<value>"+m[n]+"</value> ")}xml=xml+"<value>TOTAL</value> </include>";xml=xml+"<collapseType>";k=j>-1?f.conditions[j].collapsedValues:l>-1?f.initMetadata.Conditions[l].collapsedValues:[];if(k==void 0||k.length==0){xml=xml+"ExpandAllValues";xml=xml+"</collapseType>"}else{xml=xml+"ExpandSomeValues";xml=xml+"</collapseType>";m=f.serverPagination?j>-1?f.conditions[j].distinctValues:
l>-1?f.initMetadata.Conditions[l].distinctValues:[]:f.GeneralDistinctValues[g];xml=xml+"<includeExpand> ";for(n=0;n<m.length;n++)m[n]!=void 0&&k.indexOf(m[n])==-1&&(xml=xml+"<value>"+m[n]+"</value>");xml=xml+"</includeExpand> "}xml=xml+"</OLAPDimension>"}c=x;if(f.initMetadata.Metadata){g=jQuery.parseXML(f.initMetadata.Metadata);c=g.getElementsByTagName("OLAPMeasure")}for(g=0;g<c.length;g++){xml=xml+"<OLAPMeasure> ";xml=xml+"<name>"+c[g].getAttribute("name")+"</name> ";xml=xml+"<displayName>"+c[g].getAttribute("displayName")+
"</displayName> ";xml=xml+"<description>"+c[g].getAttribute("description")+"</description> ";xml=xml+"<dataField>"+c[g].getAttribute("dataField")+"</dataField> ";xml=xml+"<dataType>"+c[g].getAttribute("dataType")+"</dataType> ";xml=xml+"<defaultAggregator>"+c[g].getAttribute("defaultAggregator")+"</defaultAggregator> ";xml=xml+"<validAggregators>"+c[g].getAttribute("validAggregators")+"</validAggregators> ";xml=xml+"<summarize>"+c[g].getAttribute("summarize")+"</summarize> ";xml=c[g].getAttribute("format")===
""?xml+"<format/> ":xml+"<format>"+c[g].getAttribute("format")+"</format> ";xml=xml+"<align>"+c[g].getAttribute("align")+"</align> ";xml=c[g].getAttribute("picture")===""?xml+"<picture/> ":xml+"<picture>"+c[g].getAttribute("picture")+"</picture> ";xml=xml+"<popupDisabled>"+c[g].getAttribute("popupDisabled")+"</popupDisabled> ";f.initMetadata.Measures&&!f.initMetadata.Measures[g].Visible&&(xml=xml+"<hidden>true</hidden>");xml=xml+"null </OLAPMeasure>"}xml=xml+"</OLAPCube>";return xml=xml.replace(/\&/g,
"&amp;")};this.createXMLMetadata=function(){for(var c='<OLAPCube format="'+this.defaultPicture.getAttribute("format")+'" thousandsSeparator="'+this.defaultPicture.getAttribute("thousandsSeparator")+'" decimalSeparator="'+this.defaultPicture.getAttribute("decimalSeparator")+'" dateFormat="'+this.defaultPicture.getAttribute("dateFormat")+'">',g=0;g<this.columns.length;g++)if(this.conditions[g]!=false&&this.conditions[g]!=void 0){var c=c+"<OLAPDimension> ",c=c+"<name>"+this.columns[g].getAttribute("name")+
"</name> ",c=c+"<displayName>"+this.columns[g].getAttribute("displayName")+"</displayName> ",c=c+"<description>"+this.columns[g].getAttribute("description")+"</description> ",c=c+"<dataField>"+this.columns[g].getAttribute("dataField")+"</dataField> ",c=c+"<dataType>"+this.columns[g].getAttribute("dataType")+"</dataType> ",c=c+"<defaultPosition>"+this.columns[g].getAttribute("defaultPosition")+"</defaultPosition> ",c=c+"<validPositions>"+this.columns[g].getAttribute("validPositions")+"</validPositions> ",
c=c+"<summarize>"+this.columns[g].getAttribute("summarize")+"</summarize> ",c=c+"<align>"+this.columns[g].getAttribute("align")+"</align> ",c=this.columns[g].getAttribute("picture")===""?c+"<picture/> ":c+"<picture>"+this.columns[g].getAttribute("picture")+"</picture> ",c=this.columns[g].getAttribute("picture")===""?c+"<format/> ":c+"<format>"+this.columns[g].getAttribute("format")+"</format> ",c=this.conditions[g].sort===1?c+"<order>ascending</order> ":c+"<order>descending</order> ",c=c+"<popupDisabled>"+
this.columns[g].getAttribute("popupDisabled")+"</popupDisabled> ",c=c+"<customOrder/> ",c=c+"<include> ",h=f.filterIndexes.findIndex(g);if(h!=-1&&f.filterDiv.selects[h].value!="[all]")this.conditions[g].blackList.findIndex(f.filterDiv.selects[h].value)===-1&&(c=c+"<value>"+f.filterDiv.selects[h].value.toString().trimpivot()+"</value> ");else if(f.serverPagination){if(f.conditions[g].state!="none")for(j=0;j<this.conditions[g].distinctValues.length;j++)this.conditions[g].blackList.findIndex(this.conditions[g].distinctValues[j])===
-1&&(c=c+"<value>"+this.conditions[g].distinctValues[j].toString().trimpivot()+"</value> ")}else for(var j=0;j<this.conditions[g].distinctValues.length;j++)this.conditions[g].blackList.findIndex(this.conditions[g].distinctValues[j])===-1&&(c=c+"<value>"+this.conditions[g].distinctValues[j].toString().trimpivot()+"</value> ");c=c+"<value>TOTAL</value> </include> <collapse/> null null null ";c=c+"<hide> ";if(f.serverPagination)if(f.conditions[g].state=="none")for(j=0;j<this.conditions[g].distinctValues.length;j++)c=
c+"<value>"+this.conditions[g].distinctValues[j].toString().trimpivot()+"</value> ";else{if(f.conditions[g].state!="all")for(j=0;j<this.conditions[g].blackList.length;j++)c=c+"<value>"+this.conditions[g].blackList[j].toString().trimpivot()+"</value> "}else for(j=0;j<this.conditions[g].blackList.length;j++)c=c+"<value>"+this.conditions[g].blackList[j].toString().trimpivot()+"</value> ";c=c+"</hide> ";if(f.rowConditions.findIndex(g)!=-1){c=c+"<condition>row</condition> ";c=c+"<filterbar>no</filterbar> ";
c=c+"<position>"+f.rowConditions.findIndex(g)+"</position>"}else if(f.colConditions.findIndex(g)!=-1){c=c+"<condition>col</condition> ";c=c+"<filterbar>no</filterbar> ";c=c+"<position>"+f.colConditions.findIndex(g)+"</position>"}else{c=c+"<condition>none</condition> ";c=c+"<filterbar>yes</filterbar> "}c=c+"<filterdivs> ";h!=-1&&(c=c+"<value>"+f.filterDiv.selects[h].value.toString().trimpivot()+"</value> ");c=c+"</filterdivs> ";c=c+"<restoreview>no</restoreview> ";c=c+" </OLAPDimension>"}for(g=0;g<
x.length;g++){c=c+"<OLAPMeasure> ";c=c+"<name>"+x[g].getAttribute("name")+"</name> ";c=c+"<displayName>"+x[g].getAttribute("displayName")+"</displayName> ";c=c+"<description>"+x[g].getAttribute("description")+"</description> ";c=c+"<dataField>"+x[g].getAttribute("dataField")+"</dataField> ";c=c+"<dataType>"+x[g].getAttribute("dataType")+"</dataType> ";c=c+"<defaultAggregator>"+x[g].getAttribute("defaultAggregator")+"</defaultAggregator> ";c=c+"<validAggregators>"+x[g].getAttribute("validAggregators")+
"</validAggregators> ";c=c+"<summarize>"+x[g].getAttribute("summarize")+"</summarize> ";c=x[g].getAttribute("format")===""?c+"<format/> ":c+"<format>"+x[g].getAttribute("format")+"</format> ";c=c+"<align>"+x[g].getAttribute("align")+"</align> ";c=x[g].getAttribute("picture")===""?c+"<picture/> ":c+"<picture>"+x[g].getAttribute("picture")+"</picture> ";c=c+"<popupDisabled>"+x[g].getAttribute("popupDisabled")+"</popupDisabled> ";c=c+" </OLAPMeasure>"}return c+"</OLAPCube>"};this.ExportToXML=function(){var c;
c='<EXPORT format="XML" type="pivot"><METADATA>';for(var g=0;g<this.columns.length;g++){var h="row",h=f.rowConditions.findIndex(g)!=-1?"row":f.colConditions.findIndex(g)!=-1?"column":"filter";c=c+"<OLAPDimension ";c=c+'name="'+this.columns[g].getAttribute("dataField")+'" ';c=c+'label="'+this.columns[g].getAttribute("displayName")+'" ';c=c+'picture="'+this.columns[g].getAttribute("picture")+'" ';c=c+'datatype="'+this.columns[g].getAttribute("dataType")+'" ';c=c+'showAll="true" ';c=c+'position="'+h+
'">';if(this.conditions[g]!=void 0&&this.conditions[g].distinctValues!=void 0)for(h=0;h<this.conditions[g].distinctValues.length;h++){c=c+"<VALUE CHECKED=";c=this.conditions[g].blackList.findIndex(this.conditions[g].distinctValues[h])===-1?c+'"true"':c+'"false"';c=this.conditions[g].collapsedValues.indexOf(this.conditions[g].distinctValues[h])==-1?c+' COLLAPSED="false">':c+' COLLAPSED="true">';c=c+this.conditions[g].distinctValues[h]+"</VALUE>"}c=c+"</OLAPDimension>"}for(g=0;g<x.length;g++){c=c+"<OLAPMeasure ";
c=c+'name="'+x[g].getAttribute("dataField")+'" ';c=c+'label="'+x[g].getAttribute("displayName")+'" ';c=c+'picture="'+x[g].getAttribute("picture")+'" ';c=c+'datatype="'+x[g].getAttribute("dataType")+'" ';c=c+'showAll="true" ';c=c+'aggregator="sum"/>'}c=c+"</METADATA><FLATDATA>";for(h=0;h<this.allDataWithoutSort.length;h++){c=c+"<ROW ";for(g=0;g<this.columns.length;g++)c=c+this.columns[g].getAttribute("dataField")+'="'+this.allDataWithoutSort[h][g]+'" ';for(g=0;g<x.length;g++)c=c+x[g].getAttribute("dataField")+
'="'+this.allDataWithoutSort[h][g+this.columns.length]+'" ';c=c+"/>"}h=c=c+"</FLATDATA><COLITEMS>";try{var j=0,k=this.colConditions.length;if(j===k)for(g=0;g<x.length;g++){c=c+'<COLITEM measure="'+x[g].getAttribute("displayName")+'" type=""';c=c+"/>"}else{j++;for(g=0;g<this.colStructure.items.length;g++)c=c+this.createXMLCOLITEMS(this.colStructure.items[g],j,k)}}catch(l){c=h}h=c=c+"</COLITEMS><ROWITEMS>";try{for(g=0;g<this.rowStructure.items.length;g++){j=0;k=this.columns.length-this.colConditions.length-
this.filterIndexes.length-1;k>=j&&(c=c+this.createXMLROWITEMS(this.rowStructure.items[g],j,k))}}catch(m){c=h}c=c+'</ROWITEMS><HTML><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><STYLE>.h2title {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt; height: 44px; color: #E0E0E0;}\n.h2titlewhite {background-color: #ffffff; font-family: Verdana; font-size: 10pt; font-weight: normal; height: 25px; color: black;}\n.even {background-color: #FEFEFE;\tfont-weight: normal; font-family: Verdana; font-size: 10pt;\tpadding: 5px; }\n.h2subtitle {background-color: #5C5D5F; border-color: #666666; font-family: Verdana; font-weight: normal; font-size: 10pt;\theight: 22px; color: #E0E0E0;}\n.gtotal {background-color: #EBEBEB; font-weight: normal; font-family: Verdana; font-size: 10pt;}\n.pivot_table td.total {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n.pivot_table td.subtotal {background-color: #EBEBEB; font-weight: normal;\tfont-family: Verdana; font-size: 10pt;}\n</STYLE></HEAD><BODY><TABLE border="2">';
for(h=0;h<jQuery("#"+f.controlName+"_"+f.query+" tr").length;h++){c=c+"<TR>";g=jQuery("#"+f.controlName+"_"+f.query+" tr")[h];for(k=0;k<g.children.length;k++){var j=g.children[k].textContent,n=g.children[k].getAttribute("hidden"),o="";g.children[k].getAttribute("style")!=void 0&&g.children[k].getAttribute("style")!=null&&(o=' style="'+g.children[k].getAttribute("style")+'" ');var q="";g.children[k].getAttribute("class")!=void 0&&g.children[k].getAttribute("class")!=null&&(q=' class="'+g.children[k].getAttribute("class")+
'" ');if(n===null){var n=g.children[k].getAttribute("rowspan"),r=g.children[k].getAttribute("colspan");c=n===null&&r===null||k===g.children.length-1?c+"<TD "+q+" "+o+">"+j+"</TD>":r===null?c+"<TD "+q+' rowspan="'+n+'" '+o+" >"+j+"</TD>":n===null?c+"<TD "+q+' colspan="'+r+'" '+o+" >"+j+"</TD>":c+"<TD "+q+' colspan="'+r+'" rowspan="'+n+'" '+o+" >"+j+"</TD>"}}c=c+"</TR>"}return(c+"</TABLE></BODY></HTML></EXPORT>").replace(/\&/g,"&amp;")};this.createXMLROWITEMS=function(f,c,g){var h=f.parent==void 0||
f.parent.collapsed==void 0?false:f.parent.collapsed,h='<ROWITEM dimension="'+H[c].getAttribute("dataField")+'" collapsed="'+f.collapsed+'" parentCollapsed="'+h+'" value="'+f.value+'" level="'+c+'"';if(c===g)return h+"/>";c++;for(var h=h+">",j=0;j<f.items.length;j++)h=h+this.createXMLROWITEMS(f.items[j],c,g);return h+"</ROWITEM>"};this.createXMLCOLITEMS=function(c,g,h){var j="";if(g===h)for(h=0;h<x.length;h++){for(var j=j+'<COLITEM measure="'+x[h].getAttribute("displayName")+'" type="">',k=f.rowConditions.length-
x.length+1,j=j+'<VALITEM dimension="'+H[g-1+k].getAttribute("dataField")+'" value="'+c.value+'"/>',l=c;l.parent.depth!=-1;){l=l.parent;j=j+'<VALITEM dimension="'+H[g-1+k].getAttribute("dataField")+'" value="'+l.value+'"/>'}j=j+"</COLITEM>"}else{g++;for(k=0;k<c.items.length;k++)j=j+this.createXMLCOLITEMS(c.items[k],g,h)}return j};this.ExportToExcel=function(c){for(var g='<table border="2">',h=0;h<jQuery("#"+f.controlName+"_"+f.query+" tr").length;h++){for(var g=g+"<tr>",j=jQuery("#"+f.controlName+
"_"+f.query+" tr")[h],k=0;k<j.children.length;k++){var l=j.children[k].textContent.replace(/^\s+|\s+$/g,""),m=j.children[k].getAttribute("hidden"),n="";j.children[k].getAttribute("style")!=void 0&&j.children[k].getAttribute("style")!=null&&(n=' style="'+j.children[k].getAttribute("style")+'" ');for(var o="",q=false,r=0;r<l.length;r++)if(l.charCodeAt(r)<1E3){o=q?o+" "+l[r]:o+l[r];q=false}else{q=l.charCodeAt(r).toString(16);o=o+"&#x"+q;q=true}if(m===null){l=j.children[k].getAttribute("rowspan");m=j.children[k].getAttribute("colspan");
g=l===null&&m===null||k===j.children.length-1?g+"<td "+n+">"+o+"</td>":m===null?g+'<td rowspan="'+l+'" '+n+" >"+o+"</td>":l===null?g+'<td colspan="'+m+'" '+n+" >"+o+"</td>":g+'<td colspan="'+m+'" rowspan="'+l+'" '+n+" >"+o+"</td>"}}g=g+"</tr>"}g=g+"</table>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:application/vnd.ms-excel,"+encodeURIComponent(g));else if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){g=new Blob([g],{type:"application/vnd.ms-excel"});saveAs(g,
c+".xls")}else return g};this.lightOn=function(){for(var c=0;c<f.gd.targets.length;c++){var g=f.gd.targets[c][0];gx.util.browser.isIE()?g.className=g.className+" drag-drop":g.classList.add("drag-drop")}};this.lightOff=function(){for(var c=0;c<f.gd.targets.length;c++){var g=f.gd.targets[c][0];try{gx.util.browser.isIE()&&11>gx.util.browser.ieVersion()?g.className.replace("drag-drop"):g.classList.remove("drag-drop")}catch(h){}}};f.gd.onFail=f.lightOff;this.process=function(c){f.lightOn();c.style.backgroundColor=
"#888";c.style.padding="2px";c.style.cursor="pointer"};this.filterOK=function(c){for(var g=0;g<f.filterIndexes.length;g++){var h=f.filterIndexes[g],j=f.filterDiv.selects[g];if(j.selectedIndex&&OAT.$v(j)!=c[h])return false}for(g=0;g<f.rowConditions.length;g++){h=c[f.rowConditions[g]];j=f.conditions[f.rowConditions[g]];if(j.blackList.findIndex(h)!=-1)return false}for(g=0;g<f.colConditions.length;g++){h=c[f.colConditions[g]];j=f.conditions[f.colConditions[g]];if(j.blackList.findIndex(h)!=-1)return false}return true};
this.sort=function(c,g){var h,j=c.sort;c.sort==0&&(j=1);c.sort==2&&(j=-1);h=function(f,c){return f==c?0:j*(parseInt(f)>parseInt(c)?1:-1)};var k=function(f,c){return f==c?0:j*(f>c?1:-1)};if(c.distinctValues!=void 0){for(var l=true,m=0;m<c.distinctValues.length;m++)l&&c.distinctValues[m]!=parseInt(c.distinctValues[m])&&(l=false);h=l?h:k;if(c.sort!=0&&c.sort!=2)c.distinctValues.sort(h);else if(g!=void 0&&f.columns[g]!=void 0){c.distinctValues.sort(h);h=[];for(k=0;k<c.distinctValues.length;k++)h[k]=c.distinctValues[k];
c.distinctValues=[];if(c.sort==0)for(k=0;k<f.columns[g].childNodes.length;k++){if(f.columns[g].childNodes[k]!=void 0&&f.columns[g].childNodes[k].localName!=void 0&&f.columns[g].childNodes[k].localName==="customOrder")for(l=0;l<f.columns[g].childNodes[k].childNodes.length;l++)if(f.columns[g].childNodes[k].childNodes[l].localName=="Value")for(var m=f.columns[g].childNodes[k].childNodes[l].textContent,n=0;n<h.length;n++)h[n].trimpivot()==m.trimpivot()&&c.distinctValues.push(h[n])}else for(k=0;k<f.columns[g].childNodes.length;k++)if(f.columns[g].childNodes[k]!=
void 0&&f.columns[g].childNodes[k].localName!=void 0&&f.columns[g].childNodes[k].localName==="customOrder")for(l=f.columns[g].childNodes[k].childNodes.length-1;l>=0;l--)if(f.columns[g].childNodes[k].childNodes[l].localName=="Value"){m=f.columns[g].childNodes[k].childNodes[l].textContent;for(n=0;n<h.length;n++)h[n].trimpivot()==m.trimpivot()&&c.distinctValues.push(h[n])}if(c.distinctValues.length<h.length)for(k=0;k<h.length;k++)c.distinctValues.indexOf(h[k])==-1&&c.distinctValues.push(h[k])}if(H.length==
1||(x.length=0))c.sort==1?f.allData.sort(function(f){return function(c,g){return c[f]===g[f]?0:c[f]<g[f]?-1:1}}(0)):c.sort==-1&&f.allData.sort(function(f){return function(c,g){return c[f]===g[f]?0:c[f]>g[f]?-1:1}}(0))}};this.initCondition=function(c){if(c==f.dataColumnIndex&&(H.length>1||x.length>0))f.conditions.push(false);else{var g=1,h=1,j=false,k="filters;rows;columns;hidden",l=false;if(f.columns[c]!=void 0){l=true;f.serverPagination&&f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")===
"ascending"&&(g=1);f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="descending"&&(g=-1);if(f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="custom"){g=0;f.serverPagination&&(g=1)}if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="yes")for(var h=1,m=0;m<f.columns[c].childNodes.length;m++)if(f.columns[c].childNodes[m]!=void 0&&f.columns[c].childNodes[m].localName!=void 0&&f.columns[c].childNodes[m].localName===
"include")for(var h=false,n=0;n<f.columns[c].childNodes[m].childNodes.length;n++)f.columns[c].childNodes[m].childNodes[n].localName!=null&&f.columns[c].childNodes[m].childNodes[n].localName.toLowerCase()==="value"&&f.columns[c].childNodes[m].childNodes[n].textContent=="TOTAL"&&(h=true);else f.columns[c].childNodes[m]!=void 0&&(f.columns[c].childNodes[m].localName!=void 0&&f.columns[c].childNodes[m].localName==="exclude")&&(h=false);if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")===
"no"){h=false;j=true}f.columns[c].getAttribute("validPositions")!=void 0&&(k=f.columns[c].getAttribute("validPositions"))}h={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:g,subtotals:h,hideSubtotalOption:j,validPosition:k,dataRowPosition:c,isDimension:l,topFilterValue:gx.getMessage("GXPL_QViewerJSAllOption")};if(f.serverPagination){h.topFilterValue="[all]";h.topFilterString=gx.getMessage("GXPL_QViewerJSAllOption")}f.conditions.push(h);if(!f.serverPagination){for(m=
0;m<f.allData.length;m++){n=f.allData[m][c];if(n==void 0){n=" ";f.allData[m][c]=" "}h.distinctValues.findIndex(n)==-1&&h.distinctValues.push(n)}if(g!=0&&g!=2)f.sort(h);else if(f.columns[c]!=void 0){m=h.sort;h.sort=h.sort!=2?1:-1;f.sort(h);h.sort=m;j=[];for(m=0;m<h.distinctValues.length;m++)j[m]=h.distinctValues[m];h.distinctValues=[];for(m=0;m<f.columns[c].childNodes.length;m++)if(f.columns[c].childNodes[m]!=void 0&&f.columns[c].childNodes[m].localName!=void 0&&f.columns[c].childNodes[m].localName===
"customOrder"){if(g==0)for(n=0;n<f.columns[c].childNodes[m].childNodes.length;n++){if(f.columns[c].childNodes[m].childNodes[n].localName=="Value"){k=f.columns[c].childNodes[m].childNodes[n].textContent;for(l=0;l<j.length;l++)j[l].trimpivot()==k.trimpivot()&&h.distinctValues.push(j[l])}}else for(n=f.columns[c].childNodes[m].childNodes.length-1;n>=0;n--)if(f.columns[c].childNodes[m].childNodes[n].localName=="Value"){k=f.columns[c].childNodes[m].childNodes[n].textContent;for(l=0;l<j.length;l++)j[l].trimpivot()==
k.trimpivot()&&h.distinctValues.push(j[l])}if(h.distinctValues.length<j.length)for(m=0;m<j.length;m++)h.distinctValues.indexOf(j[m])==-1&&h.distinctValues.push(j[m])}}}if(f.columns[c]!=void 0)for(m=0;m<f.columns[c].childNodes.length;m++)if(f.columns[c].childNodes[m]!=void 0&&f.columns[c].childNodes[m].localName!=void 0&&f.columns[c].childNodes[m].localName==="include")for(n=0;n<f.columns[c].childNodes[m].childNodes.length;n++)if(f.columns[c].childNodes[m].childNodes[n].localName!=null&&f.columns[c].childNodes[m].childNodes[n].localName.toLowerCase()===
"value"&&f.columns[c].childNodes[m].childNodes[n].textContent!="TOTAL")f.conditions[c].topFilterValue=f.columns[c].childNodes[m].childNodes[n].textContent}};this.restoreSubtotalsAndSortLayout=function(c){try{if(W){mState=f.getState();if(mState!=void 0&&mState.version!=void 0&&mState.version===f.rememberLayoutStateVersion&&mState.query==f.query&&f.conditions.length==mState.conditions.length){f.conditions[c].subtotals=mState.conditions[c].subtotals;f.conditions[c].sort=mState.conditions[c].sort;f.conditions[c].collapsedValues=
mState.conditions[c].collapsedValues}}}catch(g){}};this.applyCustomFilters=function(c){try{if(c!=f.dataColumnIndex&&f.columns[c]!=void 0)for(var g=0;g<f.columns[c].childNodes.length;g++){if(f.columns[c].childNodes[g]!=void 0&&f.columns[c].childNodes[g].localName!=void 0&&f.columns[c].childNodes[g].localName==="include")if(f.serverPagination){f.createFilterInfo({op:"none",values:"",dim:c});for(j=0;j<f.columns[c].childNodes[g].childNodes.length;j++)if(f.columns[c].childNodes[g].childNodes[j].localName!=
null&&f.columns[c].childNodes[g].childNodes[j].localName.toLowerCase()==="value"&&f.columns[c].childNodes[g].childNodes[j].textContent!="TOTAL"){f.UserFilterValues[c]==void 0&&(f.UserFilterValues[c]=[]);f.UserFilterValues[c].push(f.columns[c].childNodes[g].childNodes[j].textContent.trimpivot())}}else{f.conditions[c].blackList=[];for(var h=0;h<f.GeneralDistinctValues[c].length;h++)f.conditions[c].blackList.push(f.GeneralDistinctValues[c][h]);for(var j=0;j<f.columns[c].childNodes[g].childNodes.length;j++)if(f.columns[c].childNodes[g].childNodes[j].localName!=
null&&f.columns[c].childNodes[g].childNodes[j].localName.toLowerCase()==="value"){var k=f.conditions[c].blackList.indexOf(f.columns[c].childNodes[g].childNodes[j].textContent);if(k!=-1){f.conditions[c].topFilterValue=f.columns[c].childNodes[g].childNodes[j].textContent;f.conditions[c].blackList.splice(k,1)}}if(f.filterIndexes.indexOf(c)!=-1)f.conditions[c].blackList=[]}var l=f.rowConditions.indexOf(c),m=f.colConditions.indexOf(c);if((m<f.colConditions.length-1&&m!=-1||l<f.rowConditions.length-x.length&&
l!=-1)&&f.columns[c].childNodes[g]!=void 0&&f.columns[c].childNodes[g].localName!=void 0&&f.columns[c].childNodes[g].localName==="expand")if(f.serverPagination){for(j=0;j<f.columns[c].childNodes[g].childNodes.length;j++)if(f.columns[c].childNodes[g].childNodes[j].localName!=null&&f.columns[c].childNodes[g].childNodes[j].localName.toLowerCase()==="value"){f.UserExpandValues[c]==void 0&&(f.UserExpandValues[c]=[]);f.UserExpandValues[c].push(f.columns[c].childNodes[g].childNodes[j].textContent.trimpivot())}f.UserExpandValues[c]==
void 0&&(f.UserExpandValues[c]=["#ALLCOLLAPSE#"])}else{f.conditions[c].collapsedValues=[];for(h=0;h<f.GeneralDistinctValues[c].length;h++)f.conditions[c].collapsedValues.push(f.GeneralDistinctValues[c][h]);for(j=0;j<f.columns[c].childNodes[g].childNodes.length;j++)if(f.columns[c].childNodes[g].childNodes[j].localName!=null&&f.columns[c].childNodes[g].childNodes[j].localName.toLowerCase()==="value"){k=f.conditions[c].collapsedValues.indexOf(f.columns[c].childNodes[g].childNodes[j].textContent);k!=
-1&&f.conditions[c].collapsedValues.splice(k,1)}}}}catch(n){}};this.pseudoInitCondition=function(c,g){if(c==f.dataColumnIndex)f.conditions.push(false);else{var h=1,j=1,k=false,l="filters;rows;columns;hidden",m=false;if(f.columns[c]!=void 0){m=true;f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="descending"&&(h=-1);f.columns[c].getAttribute("order")!=void 0&&f.columns[c].getAttribute("order")==="custom"&&(h=0);if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")===
"yes"){j=1;f.columns[c].firstElementChild!=void 0&&f.columns[c].firstElementChild.localName=="exclude"&&(j=false)}if(g[c].sort!=void 0)h=g[c].sort;if(g[c].subtotals!=void 0)j=g[c].subtotals;if(f.columns[c].getAttribute("summarize")!=void 0&&f.columns[c].getAttribute("summarize")==="no"){j=false;k=true}f.columns[c].getAttribute("validPositions")!=void 0&&(l=f.columns[c].getAttribute("validPositions"))}h={distinctValues:[],blackList:[],whiteList:[],greyList:[],collapsedValues:[],sort:h,subtotals:j,
hideSubtotalOption:k,validPosition:l,dataRowPosition:c,isDimension:m,topFilterValue:gx.getMessage("GXPL_QViewerJSAllOption")};f.conditions.push(h);for(j=0;j<f.allData.length;j++){k=f.allData[j][c];if(k==void 0){k=" ";f.allData[j][c]=" "}h.distinctValues.findIndex(k)==-1&&h.distinctValues.push(k)}h.blackList=g[c].blackList;h.collapsedValues=g[c].collapsedValues;f.allData.length>0&&f.sort(h,c)}};this.init=function(){f.propPage=OAT.Dom.create("div",{});if(k[0]!=void 0){for(var c=0;c<f.headerRow.length;c++){f.initCondition(c);
f.applyCustomFilters(c)}for(var g=jQuery.extend(true,[],f.conditions),h=[],c=0;c<f.initRowConditions.length;c++)h[c]=f.initRowConditions[c];for(var j=[],c=0;c<f.initColConditions.length;c++)j[c]=f.initColConditions[c];for(var l=[],c=0;c<f.initFilterIndexes.length;c++)l[c]=f.initFilterIndexes[c];f.initState={query:f.query,conditions:g,colConditions:j,rowConditions:h,filterDivSelects:[],filterIndexes:l,stateChanged:false,rowsPerPage:v};for(c=0;c<f.headerRow.length;c++)f.restoreSubtotalsAndSortLayout(c);
h=W?f.getState():null;g=[];if(h!=null&&h.version!=void 0&&h.version===f.rememberLayoutStateVersion&&h.query==f.query&&f.conditions.length==h.conditions.length){for(j=0;j<=h.conditions.length-1;j++)if(h.conditions[j]!=false&&f.conditions[j]!=false){for(l=0;l<h.conditions[j].blackList.length;l++)f.conditions[j].blackList.indexOf(h.conditions[j].blackList[l])==-1&&f.GeneralDistinctValues[j].indexOf(h.conditions[j].blackList[l])!=-1&&f.conditions[j].blackList.append(h.conditions[j].blackList[l]);for(l=
0;l<h.conditions[j].collapsedValues.length;l++)f.conditions[j].collapsedValues.indexOf(h.conditions[j].collapsedValues[l])==-1&&f.GeneralDistinctValues[j].indexOf(h.conditions[j].collapsedValues[l])!=-1&&f.conditions[j].collapsedValues.append(h.conditions[j].collapsedValues[l]);try{f.conditions[j].sort=h.conditions[j].sort;f.sort(f.conditions[j],j);f.oldSortValues[j]=h.conditions[j].sort;f.conditions[j].subtotals=h.conditions[j].subtotals}catch(m){}}f.rowConditions=h.rowConditions;f.colConditions=
h.colConditions;f.rowsPerPage=h.rowsPerPage;f.filterIndexes=h.filterIndexes;if(h.filterDivSelects!=void 0)for(j=0;j<h.filterDivSelects.length;j++)g[j]=h.filterDivSelects[j];f.stateChanged=true}try{if(h!=null&&h.version===f.rememberLayoutStateVersion&&h.filterIndexes.length>0){h=false;for(c=0;c<f.conditions.length;c++){j=[];if(f.conditions[c]&&f.conditions[c].blackList)for(var n=0;n<f.conditions[c].blackList.length;n++){j.append(f.conditions[c].blackList[n]);h=true}f.tempBlackLists.append([j]);j=[];
if(f.conditions[c]&&f.conditions[c].collapsedValues)for(n=0;n<f.conditions[c].collapsedValues.length;n++){j.append(f.conditions[c].collapsedValues[n]);h=true}f.tempCollapsedValues.append([j])}if(!h)f.tempBlackLists=false}else f.tempBlackLists=false}catch(o){f.tempBlackLists=false}f.gd.clearSources();f.gd.clearTargets();(f.autoPaging||f.rowConditions.length<=16||f.GeneralDataRows.length<=1200)&&f.drawFilters();if(g.length>0){for(j=0;j<g.length;j++)f.filterDiv.selects[j].value=g[j];f.preGoWhenFilterByTopFilter(true)}try{if(f.filterIndexes.length==
0){f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();f.count()}}catch(q){}GlobalPivotInterval[I]!=void 0&&clearInterval(GlobalPivotInterval[I]);var r=0,t=0;GlobalPivotInterval[I]=setInterval(function(){if(f.autoPaging&&(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0||jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_currPage")[0]!=void 0)){var c;c=jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0?parseInt(jQuery("#"+
f.containerName+" #tablePagination_currPage")[0].value):parseInt(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_currPage")[0].value);if(f.actualPaginationPage!=c){var g=f.actualPaginationPage<c,h=c==parseInt(jQuery("#"+f.containerName+" #tablePagination_totalPages")[0].textContent);f.actualPaginationPage=c;f.changePaginationRows(c,g,h);c=jQuery("#"+f.containerName+" #tablePagination_totalPages")[0]!=void 0?parseInt(jQuery("#"+f.containerName+" #tablePagination_totalPages")[0].value):
parseInt(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination  #tablePagination_totalPages")[0].value);if(!isNaN(c))f.TotalPagesPaging=c;f.go(false)}c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(f.autoPagingRowsPerPage!=c){f.autoPagingRowsPerPage=c;f.actualPaginationPage=1;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter);f.changePaginationRows(1);f.go(false)},500)}}c=0;if(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>
0){c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c)){if(f.rowsPerPage!=c){f.rowsPerPage=c;f.stateChanged=true;c=[];for(g=0;g<f.filterDiv.selects.length;g++)c[g]=f.filterDiv.selects[g].value;f.saveState({query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:c,rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion})}else f.rowsPerPage=c;if(jQuery("#"+
f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){jQuery("#"+f.controlName+"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+f.containerName)[0].clientWidth>=400)&&jQuery("#"+f.controlName+"_"+f.query).css({width:"400px"});c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(j){}g=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-1;try{var k=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css("border-right-width");
k!=void 0&&k[0]!="0"&&(g=g-1)}catch(D){}k=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].clientWidth;if(k>c+1||k<c-1){jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:c+"px"});gx.util.browser.isIE()?jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:g+"px",marginBottom:"0px"}):jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:g+"px",marginBottom:"5px"});t=r;r=c}jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+
this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}):jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"5px"}))}jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+
f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({height:"65px"})}}else if(jQuery("#"+f.controlName+"_"+f.query)[0]!=void 0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){jQuery("#"+f.controlName+"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+f.containerName)[0].clientWidth>=
400)&&jQuery("#"+f.controlName+"_"+f.query).css({width:"400px"});c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(l){}if(t==0||t==r||r>c+6||r<c-6||t>r+6||t<r-6){jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:c+"px"});t=r;r=c}}},250)}else{OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");f.drawFilters();c=OAT.Dom.create("table",{},"pivot_table");c.id=this.controlName+"_"+this.query;g=
OAT.Dom.create("tbody");OAT.Dom.append([c,g],[f.div,c]);if(f.colConditions.length>0){c=0;j=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(j);for(c=0;c<f.colConditions.length;c++)j=f._drawColConditionsHeadingsCustom(j,c,c===f.colConditions.length-1);f.appendRowToTable(g,j,true);firstRow=j;if(f.colConditions.length>0){j=OAT.Dom.create("tr");for(c=0;c<x.length;c++){h=OAT.Dom.create("th",{},"h2titlewhite");h.colSpan=1;h.innerHTML=x[c].attributes.getNamedItem("displayName").nodeValue;f.setTitleTexrtAlign(h,
h.innerHTML);j.appendChild(h)}f.appendRowToTable(g,j,true)}c=x.length-f.colConditions.length;if(c>0){h=OAT.Dom.create("th",{},"h2subtitle ");h.innerHTML="";h.colSpan=c;h.style.borderLeftColor="transparent";firstRow.appendChild(h)}}else{j=OAT.Dom.create("tr");for(c=0;c<f.rowConditions.length-(x.length-1);c++){h=OAT.Dom.create("th",{cursor:"pointer"},"h2title");l=OAT.Dom.create("div");l.innerHTML=f.headerRow[f.rowConditions[c]]+"&nbsp&nbsp&nbsp";h.appendChild(l);j.appendChild(h)}if(f.colConditions.length>
0)for(c=0;c<f.colConditions.length;c++){h=OAT.Dom.create("th",{cursor:"pointer"},"h2title");l=OAT.Dom.create("div");l.innerHTML=f.headerRow[f.colConditions[c]]+"&nbsp&nbsp&nbsp";h.appendChild(l);j.appendChild(h)}for(n=0;n<f.rowConditions.length;n++)if(f.isMeasureByName(f.headerRow[f.rowConditions[n]])){h=OAT.Dom.create("th",{cursor:"pointer"},"h2titlewhite");l=OAT.Dom.create("div");l.innerHTML=f.headerRow[f.rowConditions[n]];f.setTitleTexrtAlign(l,f.headerRow[f.rowConditions[n]]);f.setClickEventHandlers(h,
f.headerRow[f.rowConditions[n]],"MEASURE",f.rowConditions[n]-H.length,"GrandTotal");OAT.Dom.append([h,l],[j,h])}if(f.colConditions.length)h.style.border="none";else{h=OAT.Dom.create("th");f._drawCorner(h,true);h.conditionIndex=-1;j.appendChild(h)}g.appendChild(j)}gx.util.browser.isIE()&&jQuery("#"+I+"_"+f.query+"_pivot_page").css({boxShadow:"0px 0px 0px"});GlobalPivotInterval[I]!=void 0&&clearInterval(GlobalPivotInterval[I]);t=r=0;setTimeout(function(){if(jQuery("#"+f.controlName+"_"+f.query)[0]!=
void 0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){jQuery("#"+f.controlName+"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+this.containerName)[0].clientWidth>=400)&&jQuery("#"+f.controlName+"_"+f.query).css({width:"400px"});var c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(g){}jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:c+"px"})}},250)}};this.initWhenServerPagination=
function(){f.propPage=OAT.Dom.create("div",{});f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup==""&&jQuery(".oat_winrect_container").remove();f.UserFilterValues=[];f.UserExpandValues=[];for(var c=0;c<f.headerRow.length;c++){f.initCondition(c);if(f.conditions[c]&&f.columns[c]){f.conditions[c].dataField=f.columns[c].getAttribute("dataField");f.conditions[c].state="all";f.conditions[c].defaultAction="Include";f.conditions[c].visibles=[];f.conditions[c].searchInfo={previousPage:0,
totalPages:0,filteredText:"",values:[]}}f.applyCustomFilters(c)}for(var g=jQuery.extend(true,[],f.conditions),h=[],c=0;c<f.initRowConditions.length;c++)h[c]=f.initRowConditions[c];for(var j=[],c=0;c<f.initColConditions.length;c++)j[c]=f.initColConditions[c];for(var k=[],c=0;c<f.initFilterIndexes.length;c++)k[c]=f.initFilterIndexes[c];c=jQuery.extend(true,{},f.initMetadata);f.initState={query:f.query,conditions:g,colConditions:j,rowConditions:h,filterDivSelects:[],filterIndexes:k,stateChanged:false,
rowsPerPage:v,AxisInfo:f.createAxisInfo(""),DataInfo:f.createDataInfo(),CollapseInfo:[],FilterInfo:[],InitMetadata:c};for(c=0;c<f.headerRow.length;c++)f.restoreSubtotalsAndSortLayout(c);var g=W?f.getState():null,l=false;if(g!=null&&g.version!=void 0&&g.version===f.rememberLayoutStateVersion&&g.query==f.query&&f.conditions.length==g.conditions.length){l=true;f.UserFilterValues=[];for(h=0;h<=g.conditions.length-1;h++)if(g.conditions[h]!=false&&f.conditions[h]!=false){for(j=0;j<g.conditions[h].distinctValues.length;j++)f.conditions[h].distinctValues.indexOf(g.conditions[h].distinctValues[j])==
-1&&f.conditions[h].distinctValues.append(g.conditions[h].distinctValues[j]);for(j=0;j<g.conditions[h].blackList.length;j++)f.conditions[h].blackList.indexOf(g.conditions[h].blackList[j])==-1&&f.conditions[h].blackList.append(g.conditions[h].blackList[j]);if(g.conditions[h].visibles)for(j=0;j<g.conditions[h].visibles.length;j++)f.conditions[h].visibles.indexOf(g.conditions[h].visibles[j])==-1&&f.conditions[h].visibles.append(g.conditions[h].visibles[j]);for(j=0;j<g.conditions[h].collapsedValues.length;j++)f.conditions[h].collapsedValues.indexOf(g.conditions[h].collapsedValues[j])==
-1&&f.conditions[h].collapsedValues.append(g.conditions[h].collapsedValues[j]);try{f.conditions[h].sort=g.conditions[h].sort;f.oldSortValues[h]=g.conditions[h].sort;f.conditions[h].subtotals=g.conditions[h].subtotals;f.conditions[h].defaultAction=g.conditions[h].defaultAction;f.conditions[h].state=g.conditions[h].state;f.conditions[h].topFilterValue=g.conditions[h].topFilterValue;f.conditions[h].totalPages=g.conditions[h].totalPages;f.conditions[h].previousPage=g.conditions[h].previousPage;f.conditions[h].blocked=
g.conditions[h].blocked}catch(m){}}f.rowConditions=g.rowConditions;f.colConditions=g.colConditions;f.rowsPerPage=g.rowsPerPage;f.filterIndexes=g.filterIndexes;if(g.filterDivSelects!=void 0)for(h=0;h<g.filterDivSelects.length;h++);f.stateChanged=true}try{if(g!=null&&g.version===f.rememberLayoutStateVersion&&g.filterIndexes.length>0){h=false;for(c=0;c<f.conditions.length;c++){j=[];if(f.conditions[c]&&f.conditions[c].blackList)for(var n=0;n<f.conditions[c].blackList.length;n++){j.append(f.conditions[c].blackList[n]);
h=true}f.tempBlackLists.append([j]);j=[];if(f.conditions[c]&&f.conditions[c].collapsedValues)for(n=0;n<f.conditions[c].collapsedValues.length;n++){j.append(f.conditions[c].collapsedValues[n]);h=true}f.tempCollapsedValues.append([j])}if(!h)f.tempBlackLists=false}else f.tempBlackLists=false}catch(o){f.tempBlackLists=false}f.gd.clearSources();f.gd.clearTargets();GlobalPivotInterval[I]!=void 0&&clearInterval(GlobalPivotInterval[I]);var q=0,r=0;GlobalPivotInterval[I]=setInterval(function(){var c=0;if(jQuery("#"+
f.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>0){c=parseInt(jQuery("#"+f.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);if(!isNaN(c)){if(jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"){jQuery("#"+f.controlName+"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+f.containerName)[0].clientWidth>=400)&&jQuery("#"+f.controlName+"_"+f.query).css({width:"400px"});c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>
-1&&(c=c+4)}catch(g){}var h=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-1;try{var j=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css("border-right-width");j!=void 0&&j[0]!="0"&&(h=h-1)}catch(k){}j=jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].clientWidth;if(j>c+1||j<c-1){jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:c+"px"});gx.util.browser.isIE()?jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({width:h+"px",marginBottom:"0px"}):jQuery("#"+f.controlName+
"_"+f.query+"_tablePagination").css({width:h+"px",marginBottom:"5px"});r=q;q=c}jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}):jQuery("#"+this.controlName+
"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"5px"}))}jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination").css({height:"65px"})}}else if(jQuery("#"+f.controlName+"_"+f.query)[0]!=void 0&&jQuery("#"+f.controlName+
"_"+f.query)[0].getAttribute("class")==="pivot_table"){jQuery("#"+f.controlName+"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+f.containerName)[0].clientWidth>=400)&&jQuery("#"+f.controlName+"_"+f.query).css({width:"400px"});c=jQuery("#"+f.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+4)}catch(D){}if(r==0||r==q||q>c+6||q<c-6||r>q+6||r<q-6){jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:c+"px"});r=q;q=c}}},20);f.pageData.AxisInfo=
g!=null&&g.AxisInfo!=null?g.AxisInfo:f.createAxisInfo("");f.pageData.DataInfo=g!=null&&g.DataInfo!=null?g.DataInfo:f.createDataInfo();if(g!=null&&g.FilterInfo!=null)f.pageData.FilterInfo=g.FilterInfo;if(f.UserFilterValues.length==0&&f.UserExpandValues.length==0){f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=
OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.preGoWhenServerPagination(true);l||f.initValueRead(f,0)}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,f.pageData.AxisInfo,f.pageData.DataInfo,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])}else f.initValueRead(f,0,true);setInterval(function(){for(var c=0;c<jQuery(".oat_winrect_container .pivot_popup_fix").length;c++)if((!jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[c].style.display||
jQuery(".oat_winrect_container .pivot_popup_fix").closest(".oat_winrect_container")[c].style.display!="none")&&jQuery(".oat_winrect_container .pivot_popup_fix").length>0){var g=jQuery(".oat_winrect_container .pivot_popup_fix")[c];if(g.scrollHeight-g.clientHeight-g.scrollTop<25){var h=g.getAttribute("ucid"),g=parseInt(g.getAttribute("columnNumber"));h==f.UcId&&f.readScrollValue(g)}}},250)};this.initValueRead=function(c,f,g){if(f>=c.columns.length){try{for(var h=0;h<jQuery("#"+c.UcId+"_"+c.query+"_pivot_page").find("select").length;h++){var j=
jQuery("#"+c.UcId+"_"+c.query+"_pivot_page").find("select")[h],k=parseInt(j.getAttribute("id").replace("page_select_","")),l=c.filterIndexes[k];if(c.conditions[l].filteredShowValues==void 0)c.conditions[l].filteredShowValues=[];for(var m=c.conditions[l].distinctValues,n=0;n<m.length;n++){var o=m[n];if(c.conditions[l].filteredShowValues.indexOf(o)==-1){c.conditions[l].filteredShowValues.push(o);o!="#NuN#"?OAT.Dom.option(o,o,j):OAT.Dom.option(" ",o,j)}}if(c.conditions[l].topFilterValue!="[all]"){o=
c.conditions[l].topFilterValue;if(c.conditions[l].filteredShowValues.indexOf(o)!=-1)j.selectedIndex=c.conditions[l].filteredShowValues.indexOf(o)+1;else{c.conditions[l].filteredShowValues.push(o);o!="#NuN#"?OAT.Dom.option(o,o,j):OAT.Dom.option(" ",o,j);j.selectedIndex=1}}}}catch(q){}g&&c.callServiceWhenCustomeValues()}else{h=10;if(c.QueryViewerCollection[c.IdForQueryViewerCollection].AutoRefreshGroup!=""||g)h=0;c.lastRequestValue=f;c.QueryViewerCollection[c.IdForQueryViewerCollection].getAttributeValues(function(h){h=
JSON.parse(h);c.conditions[f].previousPage=h.PageNumber;c.conditions[f].totalPages=h.PagesCount;c.conditions[f].blocked=false;if(h.Null){c.conditions[f].hasNull=true;c.conditions[f].distinctValues.indexOf("#NuN#")==-1&&c.conditions[f].distinctValues.push("#NuN#");var j=true;c.conditions[f].NullIncluded||(j=false);j&&c.conditions[f].visibles.indexOf("#NuN#")==-1&&c.conditions[f].visibles.push("#NuN#")}else c.conditions[f].hasNull=false;for(var j=[],k=0;k<h.NotNullValues.length;k++){var l=h.NotNullValues[k],
m=false;if(c.conditions[f].state=="none"&&c.UserFilterValues.length>0&&c.UserFilterValues[f]!=void 0&&c.UserFilterValues[f].length>0&&c.UserFilterValues[f].indexOf(l.trimpivot())!=-1){m=true;j.push(l)}c.conditions[f].distinctValues.indexOf(l)==-1&&c.conditions[f].distinctValues.push(l);c.conditions[f].state=="all"&&c.conditions[f].visibles.indexOf(l)==-1&&c.conditions[f].visibles.push(l);c.conditions[f].state=="none"&&(c.conditions[f].blackList.indexOf(l)==-1&&!m)&&c.conditions[f].blackList.push(l);
g&&c.UserExpandValues.length>0&&c.UserExpandValues[f]!=void 0&&(c.UserExpandValues[f][0]=="#ALLCOLLAPSE#"||c.UserExpandValues[f].indexOf(l.trimpivot())==-1)&&c.conditions[f].collapsedValues.push(l)}for(k=0;k<j.length;k++)c.createFilterInfo({op:"pop",values:j[k],dim:f},true);f++;c.initValueRead(c,f,g)}.closure(this),[c.columns[f].getAttribute("dataField"),1,h,""])}};this.callServiceWhenCustomeValues=function(){f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||
f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.preGoWhenServerPagination(true)}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,f.pageData.AxisInfo,f.pageData.DataInfo,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])};this.getOrderReference=function(c,g,h,j){return function(k,l,m){if(!(f.conditions[c].validPosition!=
void 0&&f.conditions[c].validPosition.indexOf("filters")==-1)){f.lightOff();if(k==f.filterDiv){f.stateChanged=true;f.filterIndexes.push(c);f.conditions[c].blackList=[];for(l=0;l<f.rowConditions.length;l++)f.rowConditions[l]==c&&f.rowConditions.splice(l,1);for(l=0;l<f.colConditions.length;l++)f.colConditions[l]==c&&f.colConditions.splice(l,1);f.serverPagination||(f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c));f.onDragundDropEventHandle(c,"filters");f.DiseablePivot();
setTimeout(function(){f.serverPagination?f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,{op:"all",value:"",dim:c},"",""):f.go(false);f.EneablePivot()},200)}else{k=k.conditionIndex;if(c==k){if(gx.util.browser.webkit&&g!=void 0){g.displayRef2([l,m]);h([l,m,j])}}else{for(var m=false,n=-1,o=false,q=-1,l=0;l<f.rowConditions.length;l++){if(f.rowConditions[l]==c){m=f.rowConditions;n=l}if(f.rowConditions[l]==k){o=f.rowConditions;q=l}}for(l=0;l<f.colConditions.length;l++){if(f.colConditions[l]==
c){m=f.colConditions;n=l}if(f.colConditions[l]==k){o=f.colConditions;q=l}}if(k==-1){f.colConditions.push(c);f.rowConditions.splice(n,1);autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c);f.go(f)}else if(k==-2){f.rowConditions.push(c);f.colConditions.splice(n,1);autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(c);f.go(f)}else{if(m==o)if(n+1==q){o.splice(q+1,0,c);o.splice(n,1)}else{o.splice(n,1);o.splice(q,0,c)}else{m.splice(n,1);o.splice(q,0,c)}f.serverPagination?
f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,"","",""):f.go(false)}}}}}};this.getClickReference=function(c,g,h){var j=OAT.Anchor.assign(h,{title:" ",content:f.propPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(f.QueryViewerCollection[f.IdForQueryViewerCollection])+" FilterPopup "});jQuery(h).data("anchorRef",j);return[function(h){f.ShowPopUp(c,g,h)},j]};this.ShowPopUp=function(c,g,h){var j=
function(){jQuery(".oat_winrect_container").css({display:"none"})},k,l;if(h.currentTarget!=void 0){k=h.currentTarget;l=OAT.Dom.eventPos(h)}else{k=h[2];l=[h[0],h[1]]}h=[];f.propPage.style.left=l[0]+"px";f.propPage.style.top=l[1]+"px";f.propPage.setAttribute("id","pop-up");f.propPage.setAttribute("class","oatpop-up");OAT.Dom.clear(f.propPage);h.append(f.propPage);l=OAT.Dom.create("div",{margin:"0",position:"absolute",cursor:"pointer"});l.setAttribute("class","oat_winrect_close_b");l.innerHTML="<span></span>";
OAT.Dom.attach(l,"click",j);if(!C){l=document.createElement("div");l.setAttribute("class","first_popup_subdiv");var m=OAT.Dom.radio("order");m.id="pivot_order_asc";OAT.Dom.attach(m,"change",function(){try{var h='<DATA event="OrderChanged" name="'+f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+'"  order="ascending">',h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h)}catch(j){}if(f.serverPagination){c.sort=
1;f.stateChanged=true;f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","")}else{c.sort=c.sort==0||c.sort==2?0:1;f.stateChanged=true;f.sort(c,g);f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}});l.appendChild(m);var n=OAT.Dom.create("label");n.htmlFor="pivot_order_asc";n.innerHTML=gx.getMessage("GXPL_QViewerJSAscending");l.appendChild(n);l.appendChild(OAT.Dom.create("br"));n=OAT.Dom.radio("order");n.id="pivot_order_desc";OAT.Dom.attach(n,"change",function(){try{var h=
'<DATA event="OrderChanged" name="'+f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+'"  order="descending">',h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h)}catch(j){}if(f.serverPagination){c.sort=-1;f.stateChanged=true;f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","")}else{c.sort=c.sort==0||c.sort==2?2:-1;f.stateChanged=true;f.sort(c,g);f.serverPagination||
f.updateSortImage(k.firstChild.children[1],2);f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}});l.appendChild(n);var o=OAT.Dom.create("label");o.htmlFor="pivot_order_desc";o.innerHTML=gx.getMessage("GXPL_QViewerJSDescending");l.appendChild(o);h.append(l);l=OAT.Dom.create("hr",{});h.append(l)}OAT.Dom.create("hr",{});OAT.Dom.create("hr",{});o=OAT.Dom.create("hr",{});OAT.Dom.create("hr",{});l=OAT.Dom.create("hr",{});if((c.hideSubtotalOption===void 0||!c.hideSubtotalOption)&&
(!f.autoPaging||f.colConditions.length==0)){var q=OAT.Dom.create("div");C&&q.setAttribute("class","first_popup_subdiv");var r=document.createElement("div");r.setAttribute("class",c.subtotals?"check_item_img":"uncheck_item_img");OAT.Dom.attach(r,"click",function(){c.subtotals=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");f.stateChanged=true;try{var h='<DATA event="SubtotalsChanged" name="'+
f.columns[g].getAttribute("name")+'" displayName="'+f.columns[g].getAttribute("displayName")+'"  subtotals="'+c.subtotals+'">',h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h)}catch(j){}if(f.autoPaging){f.DiseablePivot();setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter);f.go(false);f.EneablePivot()},500)}else if(f.serverPagination)f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","",
"");else{f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},500)}});var t=OAT.Dom.create("label");t.innerHTML=gx.getMessage("GXPL_QViewerJSSubtotals");t.htmlFor="pivot_checkbox_subtotals";r.appendChild(t);OAT.Dom.append([q,r]);h.append(q)}if(f.stateChanged){q=OAT.Dom.create("div");r=document.createElement("div");r.setAttribute("class","uncheck_item_img");OAT.Dom.attach(r,"click",function(){if(!f.autoPaging&&!f.serverPagination){f.cleanState();for(var g=0;g<f.conditions.length;g++)f.sort(f.conditions[g],
g);c.subtotals=true;f.DiseablePivot();setTimeout(function(){f.EneablePivot();f.go(false);j();f.stateChanged=false;f.EneablePivot()},200)}else if(f.serverPagination){f.cleanStateWhenServerPagination();f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");j();f.stateChanged=false}else{f.cleanState();for(g=0;g<f.conditions.length;g++)f.sort(f.conditions[g],g);if(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0)jQuery("#"+f.containerName+" #tablePagination_currPage")[0].value=
1;f.actualPaginationPage=1;f.DiseablePivot();setTimeout(function(){f.preGo(false,null,null,-1);j();f.stateChanged=false;f.EneablePivot()},200)}});t=OAT.Dom.create("label");t.innerHTML=gx.getMessage("GXPL_QViewerJSRestoreDefaultView");t.htmlFor="pivot_checkbox_restoreview";r.appendChild(t);OAT.Dom.append([q,r]);h.append(q)}if(x.length>0){q=OAT.Dom.create("div");r=document.createElement("div");r.setAttribute("class","uncheck_item_img");OAT.Dom.attach(r,"click",function(){if(!f.autoPaging&&!f.serverPagination){f.stateChanged=
true;f.changedFromColumnToRow(g);f.DiseablePivot();setTimeout(function(){f.go(false);j();f.EneablePivot()},200)}else if(f.serverPagination){f.stateChanged=true;f.changedFromColumnToRow(g);f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,c.dataField,"","","");j()}else if(f.columns.length<4){f.stateChanged=true;f.changedFromColumnToRow(g);f.DiseablePivot();setTimeout(function(){f.preGo(false,null,null,-1);f.distinctDivs(f.conditions[g],u,g);j();f.EneablePivot()},200)}});t=OAT.Dom.create("label");t.innerHTML=
f.rowConditions.findIndex(g)!=-1?gx.getMessage("GXPL_QViewerJSPivotDimensionToColumn"):gx.getMessage("GXPL_QViewerJSPivotDimensionToRow");t.htmlFor="pivot_checkbox_restoreview";r.appendChild(t);OAT.Dom.append([q,r]);h.append(q);h.append(o)}if(x.length>0){o=navigator.userAgent.toLowerCase().indexOf("android")>-1;if((gx.util.browser.isIPad()||gx.util.browser.isIPhone()||o)&&f.filterIndexes.findIndex(g)===-1){o=OAT.Dom.create("div");q=document.createElement("div");q.setAttribute("class","uncheck_item_img");
OAT.Dom.attach(q,"click",function(){f.filterIndexes.push(g);f.conditions[g].blackList=[];for(var c=0;c<f.rowConditions.length;c++)f.rowConditions[c]==g&&f.rowConditions.splice(c,1);for(c=0;c<f.colConditions.length;c++)f.colConditions[c]==g&&f.colConditions.splice(c,1);f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(g);f.go(false);j()});r=OAT.Dom.create("label");r.innerHTML=gx.getMessage("GXPL_QViewerJSMoveToFilterBar");r.htmlFor="pivot_checkbox_movetocolumn";q.appendChild(r);
OAT.Dom.append([o,q]);h.append(o);h.append(l)}}var u=OAT.Dom.create("div");u.setAttribute("class","last_div_popup");if(gx.util.browser.isIE()){OAT.Dom.create("span");OAT.Dom.create("span");OAT.Dom.create("span")}else{OAT.Dom.create("br");OAT.Dom.create("br");OAT.Dom.create("br")}h.append(u);OAT.Dom.append(h);f.distinctDivs(c,u,g);(gx.util.browser.isIPad()||gx.util.browser.isIPhone())&&jQuery(".oat_winrect_close_b").css({backgroundSize:"30px 30px",height:"30px",width:"30px",right:"-14px",top:"-14px"});
if(!C){m.checked=c.sort==1||c.sort==0;m.__checked=m.checked;n.checked=c.sort==-1||c.sort==2;n.__checked=n.checked}};this.changedFromColumnToRow=function(c){var g=f.rowConditions.findIndex(c),h="columns";if(g!=-1){f.rowConditions.splice(g,1);x.length>1?f.colConditions=[c].concat(f.colConditions):f.colConditions.push(c)}else if(f.serverPagination){h="rows";g=f.colConditions.findIndex(c);f.colConditions.splice(g,1);for(var g=[],j=0;j<f.initRowConditions.length-(x.length-1);j++){f.initRowConditions[j]==
c&&g.push(c);f.rowConditions.indexOf(f.initRowConditions[j])>-1&&g.push(f.initRowConditions[j])}for(j=0;j<f.initColConditions.length;j++){f.initColConditions[j]==c&&g.push(c);f.rowConditions.indexOf(f.initColConditions[j])>-1&&g.push(f.initColConditions[j])}for(j=0;j<f.initFilterIndexes.length;j++){f.initFilterIndexes[j]==c&&g.push(c);f.rowConditions.indexOf(f.initFilterIndexes[j])>-1&&g.push(f.initFilterIndexes[j])}g.sort(function(){return function(c,f){return c==f?0:c<f?-1:1}}(0));for(j=f.initRowConditions.length-
(x.length-1);j<f.initRowConditions.length;j++)g.push(f.initRowConditions[j]);f.rowConditions=[];for(j=0;j<g.length;j++)f.rowConditions[j]=g[j]}else{h="rows";g=f.colConditions.findIndex(c);f.colConditions.splice(g,1);x.length>1?f.rowConditions=[c].concat(f.rowConditions):f.rowConditions.push(c)}f.onDragundDropEventHandle(c,h)};this.getDelFilterReference=function(c){return function(){var g=f.filterIndexes.findIndex(c);g!=-1&&f.filterIndexes.splice(g,1);for(var g=[],h=0;h<f.initRowConditions.length-
(x.length-1);h++){f.initRowConditions[h]==c&&g.push(c);f.rowConditions.indexOf(f.initRowConditions[h])>-1&&g.push(f.initRowConditions[h])}for(h=0;h<f.initColConditions.length;h++){f.initColConditions[h]==c&&g.push(c);f.rowConditions.indexOf(f.initColConditions[h])>-1&&g.push(f.initColConditions[h])}for(h=0;h<f.initFilterIndexes.length;h++){f.initFilterIndexes[h]==c&&g.push(c);f.rowConditions.indexOf(f.initFilterIndexes[h])>-1&&g.push(f.initFilterIndexes[h])}g.sort(function(){return function(c,f){return c==
f?0:c<f?-1:1}}(0));for(h=f.initRowConditions.length-(x.length-1);h<f.initRowConditions.length;h++)g.push(f.initRowConditions[h]);f.rowConditions=[];for(h=0;h<g.length;h++)f.rowConditions[h]=g[h];for(g=0;g<f.filterDiv.selects.length;g++)if(c==f.filterDiv.selects[g].filterIndex){f.filterDiv.selects.splice(g,1);break}f.stateChanged=true;f.serverPagination||(f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(-1));f.onDragundDropEventHandle(c,"rows");f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.conditions[c].topFilterValue=
"[all]";f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[c].dataField,{op:"all",values:"",dim:c},"","")}else f.go(false);f.EneablePivot()},200)}};this.valueIsShowed=function(c,g){if(f.serverPagination)return f.conditions[g].state=="all"?true:f.conditions[g].state=="none"?false:f.conditions[g].blackList.findIndex(c)!=-1?false:f.conditions[g].distinctValues.findIndex(c)!=-1?true:f.conditions[g].defaultAction=="Exclude"?false:true;for(var h=0;h<f.filteredData.length;h++)if(f.filteredData[h][g]===
c)return true;return false};this.distinctDivs=function(c,g,h){var j=function(g,j){var k=OAT.Dom.create("div"),l=c.blackList.findIndex(t)==-1&&f.valueIsShowed(t,h)?"check_item_img":"uncheck_item_img";f.serverPagination&&(l=f.valueIsShowed(t,h)?"check_item_img":"uncheck_item_img");k.setAttribute("class",l);l=OAT.Dom.create("input");l.type="checkbox";l.id=j;var m=OAT.Dom.create("label");m.innerHTML=g;m.htmlFor=j;k.appendChild(m);return[k,l]},k=function(g,j){setTimeout(function(){if(f.serverPagination){var k=
"pop";g||(k="push");f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:k,values:j,dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{k=false;if(g){if(f.autoPaging){l=f.conditions[h].blackList.findIndex(j);l!=-1&&f.conditions[h].blackList.splice(l,1);for(l=f.conditions[h].blackList.findIndex(j);l!=-1;){f.conditions[h].blackList.splice(l,1);l=f.conditions[h].blackList.findIndex(j)}f.conditions[h].whiteList.findIndex(j);if(l==-1){for(l=
0;l<f.allData.length;l++)if(f.allData[l][h]===j)for(m=0;m<f.allData[l].length;m++)if(m!=h){n=f.rowConditions.findIndex(m);if(n!=-1)for(o=f.allData[l][m];f.conditions[n].blackList.findIndex(o)!=-1;)f.conditions[n].blackList.splice(f.conditions[n].blackList.findIndex(o),1)}f.conditions[h].whiteList.push(j)}}else{var l=c.blackList.findIndex(j);l!=-1&&c.blackList.splice(l,1);if(f.autoPaging)for(l=c.blackList.findIndex(j);l!=-1;){c.blackList.splice(l,1);l=c.blackList.findIndex(j)}c.whiteList.findIndex(j);
if(l==-1){for(l=0;l<f.allData.length;l++)if(f.allData[l][h]===j)for(var m=0;m<f.allData[l].length;m++)if(m!=h){var n=f.rowConditions.findIndex(m);if(n!=-1)for(var o=f.allData[l][m];f.conditions[n].blackList.findIndex(o)!=-1;)f.conditions[n].blackList.splice(f.conditions[n].blackList.findIndex(o),1)}c.whiteList.push(j)}}for(;f.GreyList.findIndex(j)!=-1;){index2=f.GreyList.findIndex(j);f.GreyList.splice(index2,1)}f.autoPaging&&(k=true)}else f.autoPaging?f.conditions[h].blackList.push(j):c.blackList.push(j);
f.onFilteredChangedEventHandle(h);f.stateChanged=true;if(f.autoPaging){if(jQuery("#"+f.containerName+" #tablePagination_currPage")[0]!=void 0){jQuery("#"+f.containerName+" #tablePagination_currPage")[0].value=1;f.actualPaginationPage=1}k?f.preGo(false,null,j,-1):f.preGo(false,null,j,h)}else f.go(false)}f.EneablePivot()},200)},l=function(){f.getValuesForColumn(f.UcId,h,this.value)};OAT.Dom.clear(g);var m=OAT.Dom.create("div");m.setAttribute("class","div_buttons_popup");var n=document.createElement("button");
n.textContent=gx.getMessage("GXPL_QViewerJSAll");n.setAttribute("class","btn");jQuery(n).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:"all",values:"",dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{f.autoPaging?f.conditions[h].blackList=[]:c.blackList=[];f.stateChanged=true;f.onFilteredChangedEventHandle(h);if(f.autoPaging){if(jQuery("#"+f.containerName+
" #tablePagination_currPage")[0]!=void 0){jQuery("#"+f.containerName+" #tablePagination_currPage")[0].value=1;f.actualPaginationPage=1}f.preGo(false,null,null,-1)}else f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});var o=document.createElement("button");o.textContent=gx.getMessage("GXPL_QViewerJSNone");o.setAttribute("class","btn");jQuery(o).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,
{op:"none",values:"",dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{c.blackList=[];if(f.autoPaging)for(j=0;j<f.GeneralDistinctValues[h].length;j++)f.conditions[h].blackList.push(f.GeneralDistinctValues[h][j]);else for(var j=0;j<c.distinctValues.length;j++)c.blackList.push(c.distinctValues[j]);f.stateChanged=true;f.onFilteredChangedEventHandle(h);f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});var q=document.createElement("button");q.textContent=
gx.getMessage("GXPL_QViewerJSReverse");q.setAttribute("class","btn");jQuery(q).click(function(){f.DiseablePivot();setTimeout(function(){if(f.serverPagination){f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[h].dataField,{op:"reverse",values:"",dim:h},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(h)}else{var j=[];if(f.autoPaging)for(k=0;k<f.GeneralDistinctValues[h].length;k++){l=f.GeneralDistinctValues[h][k];f.conditions[h].blackList.findIndex(l)==-1&&j.push(l)}else for(var k=
0;k<c.distinctValues.length;k++){var l=c.distinctValues[k];c.blackList.findIndex(l)==-1&&j.push(l)}f.autoPaging?f.conditions[h].blackList=j:c.blackList=j;f.stateChanged=true;f.onFilteredChangedEventHandle(h);f.autoPaging?f.preGo(false,null,null,-1):f.go(false)}f.distinctDivs(c,g,h);f.EneablePivot()},200)});OAT.Dom.append([m,n,o,q],[g,m]);if(f.serverPagination){m=OAT.Dom.create("div");m.setAttribute("class","div_filter_input");if(f.serverPagination){n=document.createElement("input");n.textContent=
"none";n.setAttribute("class","search_input");n.setAttribute("type","text");n.setAttribute("label","Search filter...");n.setAttribute("title","Search filter...");n.setAttribute("placeholder","Search filter...");n.setAttribute("id",f.UcId+h);jQuery(n).keyup(l);OAT.Dom.append([m,n],[g,m])}}if(f.autoPaging){l=OAT.Dom.create("div");f.GeneralDistinctValues[h].length<=9?l.setAttribute("class","pivot_popup_auto"):l.setAttribute("class","pivot_popup_fix");for(m=0;m<f.GeneralDistinctValues[h].length;m++){t=
f.GeneralDistinctValues[h][m];n=f.dimensionPictureValue(t,h);try{t=="#NuN#"&&!f.formulaInfo.measureFormula[h].hasFormula&&(n="&nbsp;")}catch(r){}n=n.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(n.length>33){o=n.substring(32,n.length).trimpivot().length>0?"...":"";n=n.substring(0,32)+o}n=n.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";o=j(n,"pivot_distinct_"+m);o[0].setAttribute("value",t);l.appendChild(o[0]);n=f.conditions[h].blackList.findIndex(t)==-1&&f.valueIsShowed(t,h)||f.conditions[h].distinctValues.findIndex(t)==
-1&&f.conditions[h].blackList.findIndex(t)==-1?"check_item_img":"uncheck_item_img";o[0].setAttribute("class",n);OAT.Dom.attach(o[0],"click",function(){f.DiseablePivot();var c=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");k(c,this.getAttribute("value"))})}}else{l=OAT.Dom.create("div");f.serverPagination&&(c=f.conditions[h]);c.distinctValues.length<=9?l.setAttribute("class","pivot_popup_auto"):
l.setAttribute("class","pivot_popup_fix");for(m=0;m<c.distinctValues.length;m++){var t=c.distinctValues[m];if(!f.serverPagination||!(f.conditions[h].hasNull&&t.trimpivot()==f.defaultPicture.getAttribute("textForNullValues"))){n=f.dimensionPictureValue(t,h);n=n.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(n.length>33){o=n.substring(32,n.length).trimpivot().length>0?"...":"";n=n.substring(0,32)+o}n=n.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";o=j(n,"pivot_distinct_"+m);o[0].setAttribute("value",
t);l.appendChild(o[0]);OAT.Dom.attach(o[0],"click",function(){f.DiseablePivot();var c=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");k(c,this.getAttribute("value"))})}}l.setAttribute("ucid",f.UcId);l.setAttribute("columnnumber",h);l.setAttribute("id","values_"+f.UcId+"_"+h)}g.appendChild(l)};this.DiseablePivot=function(){try{var c=jQuery('<div class="disable_popup" ></div>');if(jQuery("#"+f.containerName).length>
0){var g=Math.min(jQuery("#"+I+"_"+f.query+"_pivot_page")[0].clientHeight+jQuery("#"+I+"_"+f.query+"_pivot_content")[0].clientHeight,jQuery("#"+f.containerName)[0].clientHeight),h=Math.min(jQuery("#"+I+"_"+f.query)[0].clientWidth,jQuery("#"+f.containerName)[0].clientWidth);if(jQuery("#"+f.containerName).closest(".gxwebcomponent").length>0){jQuery("#"+I+"_"+f.query+"_tablePagination").length>0&&(g=g+jQuery("#"+I+"_"+f.query+"_tablePagination")[0].clientHeight);jQuery(c).css({width:h,height:g,position:"absolute",
top:jQuery("#"+f.containerName)[0].offsetTop,left:jQuery("#"+f.containerName)[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99})}else jQuery(c).css({width:h,height:g,position:"absolute",top:jQuery("#"+f.containerName)[0].offsetTop,left:jQuery("#"+I+"_"+f.query).offset().left,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":999});jQuery("#"+f.containerName).append(c)}else{g=Math.min(jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol").find(".pivot_filter_div")[0].clientHeight+
jQuery("#"+I+"_"+f.query).closest(".conteiner_table_div")[0].clientHeight,jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol")[0].clientHeight);h=Math.min(jQuery("#"+I+"_"+f.query)[0].clientWidth,jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol")[0].clientWidth);jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol").find(".pivot_pag_div").length>0&&(g=g+jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol").find(".pivot_pag_div")[0].clientHeight);jQuery(c).css({width:h,height:g,position:"absolute",
top:jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol")[0].offsetTop,left:jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol")[0].offsetLeft,"background-color":"rgba(0,0,0,0.1)",cursor:"wait","z-index":99});jQuery("#"+I+"_"+f.query).closest(".gx_usercontrol").append(c)}jQuery(".oat_winrect_container").block({message:null})}catch(j){}};this.EneablePivot=function(){for(jQuery(".disable_popup").remove();jQuery(".disable_popup").length>0;)jQuery(".disable_popup").remove();jQuery(".oat_winrect_container").unblock()};
this.addExpandCollapseFunctionality=function(c,g,h,j,k){var l=OAT.Dom.create("div",{width:"12px",height:"12px",display:"inline-block",cssFloat:"left",paddingRight:"5px",boxSizing:"content-box"});l.className=j?l.className+" expanded":l.className+" collapsed";c.insertBefore(l,c.firstChild);c.style.paddingLeft="0px";k?f.setClickEventHandlers(l,g.value,"DIMENSION",f.rowConditions[h],g,true):f.setClickEventHandlers(l,g.value,"DIMENSION",f.colConditions[h],g,true);return c};this.setClickEventHandlers=function(c,
g,h,j,k,l){if(!f.ShowMeasuresAsRows||f.h<500){jQuery(c).data("itemValue",g);jQuery(c).data("typeMorD",h);jQuery(c).data("numberMorD",j);jQuery(c).data("itemInfo",k);c.onclick=c!=void 0&&l==void 0?function(){f.onClickEventHandle(this)}:function(){f.onClickExpandCollapse(this)}}if(f.QueryViewerCollection[K].ItemClick)c.style.cursor="pointer"};this.getPerFilterValue=function(c,g){for(var h=false,j=0;j<c.length;j++)c[j]!=null&&(h=true);if(!h)return false;h=[];for(j=0;j<f.GeneralDataRows.length;j++){for(var k=
true,l=0;l<c.length;l++)c[l]!=null&&f.GeneralDataRows[j][f.filterIndexes[l]]!=c[l]&&(k=false);k&&h.append(f.GeneralDataRows[j][f.filterIndexes[g]])}return h};this.drawFilters=function(){var c=[],g=f.filterDiv,h=navigator.userAgent.toLowerCase(),h=h.indexOf("android")>-1;gx.util.browser.isIE()||h?f.filterDiv.className=f.filterDiv.className+" pivot_filter_div":f.filterDiv.classList.add("pivot_filter_div");if(f.filterIndexes.length==0)f.filterDiv.innerHTML="drop filters here";for(var j=0;j<g.selects.length;j++)c.push([g.selects[j].filterIndex,
g.selects[j].selectedIndex,g.selects[j].value]);OAT.Dom.clear(g);f.gd.addTarget(g);g.selects=[];if(!f.filterIndexes.length){j=gx.getMessage("GXPL_QViewerJSDropFiltersHere");if(gx.util.browser.isIPad()||gx.util.browser.isIPhone())j="";h=navigator.userAgent.toLowerCase();(h=h.indexOf("android")>-1)&&(j="");if(j[j.length-1]==='"'||j[j.length-1]==="'"||j[j.length-1]==="]"||j[j.length-1]==="}"||j[j.length-1]==="`")j=j.substring(0,j.length-1);h=document.createElement("span");h.textContent=j;g.appendChild(h)}for(var h=
function(){for(var c=this,g=f.conditions[this.filterIndex].distinctValues,h=0;h<g.length;h++){var j=g[h];if(f.conditions[this.filterIndex].filteredShowValues.indexOf(j)==-1){f.conditions[this.filterIndex].filteredShowValues.push(j);if(j!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(j,this.filterIndex),j,c)}catch(k){OAT.Dom.option(j,j,c)}else OAT.Dom.option(" ",j,c)}}var l=f.lastRequestValue=this.filterIndex;f.conditions[l].previousPage<f.conditions[l].totalPages&&f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){g=
JSON.parse(g);f.conditions[l].previousPage=g.PageNumber;f.conditions[l].totalPages=g.PagesCount;f.conditions[l].blocked=true;if(g.Null&&!f.conditions[l].hasNull){f.conditions[l].hasNull=true;f.conditions[l].distinctValues.indexOf("#NuN#")==-1&&f.conditions[l].distinctValues.push("#NuN#");f.conditions[l].defaultAction=="Include"?f.conditions[l].visibles.indexOf("#NuN#")==-1&&f.conditions[l].visibles.push("#NuN#"):f.conditions[l].blackList.indexOf("#NuN#")==-1&&f.conditions[l].blackList.push("#NuN#")}for(var h=
0;h<g.NotNullValues.length;h++){var j=g.NotNullValues[h];if(f.conditions[l].distinctValues.indexOf(j)==-1){f.conditions[l].distinctValues.push(j);f.conditions[l].defaultAction=="Include"&&f.conditions[l].visibles.indexOf(j)==-1&&f.conditions[l].visibles.push(j);f.conditions[l].state=="Exclude"&&f.conditions[l].blackList.indexOf(j)==-1&&f.conditions[l].blackList.push(j)}}g=f.conditions[l].distinctValues;for(h=0;h<g.length;h++){j=g[h];if(f.conditions[l].filteredShowValues.indexOf(j)==-1){f.conditions[l].filteredShowValues.push(j);
if(j!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(j,l),j,c)}catch(k){OAT.Dom.option(j,j,c)}else OAT.Dom.option(" ",j,c)}}}.closure(this),[f.columns[this.filterIndex].getAttribute("dataField"),1,0,""])},k=function(){f.stateChanged=true;if(f.serverPagination){f.DiseablePivot();f.conditions[this.filterIndex].topFilterValue=this.value;f.getDataForPivot(f.UcId,1,f.rowsPerPage,true,f.conditions[this.filterIndex].dataField,{op:"pagefilter",values:this.value,dim:this.filterIndex},"","");f.EneablePivot()}else{this.value==
"[all]"?f.autoPaging?f.preGoWhenFilterByTopFilter(false):f.preGoWhenMoveTopFilter(this.filterIndex):f.preGoWhenFilterByTopFilter(false);f.actualPaginationPage=1;f.DiseablePivot();setTimeout(function(){f.go(false);f.EneablePivot()},200)}},l=[],j=0;j<f.filterIndexes.length;j++){var m=f.filterIndexes[j],n=OAT.Dom.create("select");n.setAttribute("id","page_select_"+j);OAT.Dom.option(gx.getMessage("GXPL_QViewerJSAllOption"),"[all]",n);var o;o=f.serverPagination?[]:f.getPerFilterValue(l,j);if(f.GeneralDistinctValues.length>
0){for(var q=0;q<f.GeneralDistinctValues[m].length;q++){var r=f.GeneralDistinctValues[m][q];if(o){if(o.indexOf(r)!=-1)if(r!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(r,m),r,n)}catch(t){OAT.Dom.option(r,r,n)}else OAT.Dom.option(" ",r,n)}else if(r!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(r,m),r,n)}catch(u){OAT.Dom.option(r,r,n)}else OAT.Dom.option(" ",r,n)}try{for(var v=0,q=0;q<f.GeneralDistinctValues[m].length;q++){r=f.GeneralDistinctValues[m][q];if(f.conditions[m].topFilterValue===
r)n.selectedIndex=v+1;o?o.indexOf(r)!=-1&&v++:v++}}catch(x){}}if(f.serverPagination){f.conditions[m].filteredShowValues=[];o=f.conditions[m].distinctValues;for(q=0;q<o.length;q++){r=o[q];if(f.conditions[m].filteredShowValues.indexOf(r)==-1){f.conditions[m].filteredShowValues.push(r);if(r!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(r,m),r,n)}catch(w){OAT.Dom.option(r,r,n)}else OAT.Dom.option(" ",r,n)}}if(f.conditions[m].topFilterValue!="[all]"){r=f.conditions[m].topFilterValue;if(f.conditions[m].filteredShowValues.indexOf(r)!=
-1)n.selectedIndex=f.conditions[m].filteredShowValues.indexOf(r)+1;else{f.conditions[m].filteredShowValues.push(r);if(r!="#NuN#")try{OAT.Dom.option(f.dimensionPictureValue(r,m),r,n)}catch(y){OAT.Dom.option(r,r,n)}else OAT.Dom.option(" ",r,n);n.selectedIndex=1}}}n.filterIndex=m;for(q=0;q<c.length;q++)if(c[q][0]==m)for(o=0;o<n.length;o++)if(n[o].value==c[q][2])n.selectedIndex=o;l[j]=n.selectedIndex>0?n.value:null;f.serverPagination&&OAT.Dom.attach(n,"click",h);OAT.Dom.attach(n,"change",k);g.selects.push(n);
q=OAT.Dom.create("div");q.setAttribute("class","inner_filter_div");q.innerHTML=f.headerRow[m]+": ";o=document.createElement("div");o.setAttribute("class","close_span_filter");o.style.color="#f00";o.style.cursor="pointer";m=f.getDelFilterReference(m);OAT.Dom.attach(o,"click",m);f.serverPagination?OAT.Dom.append([f.filterDiv,q],[q,n,o]):f.GeneralDataRows.length==0?OAT.Dom.append([f.filterDiv,q],[q,n]):OAT.Dom.append([f.filterDiv,q],[q,n,o])}c=OAT.Dom.create("div");c.href="#";c.setAttribute("class",
"exportOptionsAnchor");f.exportPage=OAT.Dom.create("div",{padding:"5px"});OAT.Dom.attach(document,"mousedown",function(c){source=OAT.Event.source(c);for(var g=c=false,h=0;h<jQuery(".oat_winrect_container").length;h++){var j=jQuery(".oat_winrect_container")[h];if(source!=j&&!OAT.Dom.isChild(source,j))c=true;else{c=false;break}}for(h=0;h<jQuery(".oat_winrect_container").length;h++)jQuery(".oat_winrect_container")[h].style.display!="none"&&(g=true);f.serverPagination&&((source.getAttribute("class")==
"oat_winrect_close_b"||!OAT.Dom.isChild(source,j))&&g)&&f.resetAllScrollValue(f.UcId);c&&jQuery(".oat_winrect_container").css({display:"none"})});OAT.Anchor.assign(c,{title:" ",content:f.exportPage,result_control:false,activation:"click",type:OAT.WinData.TYPE_RECT,width:"auto",containerQuery:qv.util.GetContainerControlClass(f.QueryViewerCollection[f.IdForQueryViewerCollection])+" ExportPopup "});OAT.Event.attach(c,"click",function(c){c=OAT.Event.position(c);f.exportPage.style.left=c[0]+"px";f.exportPage.style.top=
c[1]+"px";f.exportPage.id="exportOptionsContainer";OAT.Dom.clear(f.exportPage);c=document.createElement("div");c.setAttribute("class","upper_container");jQuery("#divtoxml").remove();jQuery("#divtoxls").remove();jQuery("#divtoxlsx").remove();jQuery("#divtoexport").remove();jQuery("#divtohtml").remove();f.appendExportToXmlOption(c,false);f.appendExportToHtmlOption(c,false);f.appendExportToPdfOption(c,false);f.appendExportToExcelOption(c,false);f.appendExportToExcel2010Option(c,false);f.exportPage.appendChild(c);
c=OAT.Dom.create("hr",{});f.exportPage.appendChild(c);c=document.createElement("div");c.setAttribute("class","down_container");f.exportPage.appendChild(c);var g=document.createElement("span");g.textContent=gx.getMessage("GXPL_QViewerJSVisibleColumns");var h=document.createElement("div");h.setAttribute("class","div_label_win");h.appendChild(g);c.appendChild(h);for(var g=function(c,g){var h,j;if(g){h=f.initMetadata.Dimensions[c].dataField;j=f.initMetadata.Dimensions[c].displayName}else{h=f.initMetadata.Measures[c].dataField;
j=f.initMetadata.Measures[c].displayName}var k=f.headerRow.indexOf(j)!=-1,l=OAT.Dom.create("div");l.setAttribute("class",k?"check_item_img":"uncheck_item_img");l.setAttribute("dataField",j);l.setAttribute("isDimension",g);l.setAttribute("index",c);j=OAT.Dom.create("span");j.innerHTML=g?" "+f.initMetadata.Dimensions[c].displayName:" "+f.initMetadata.Measures[c].displayName;h=f.formulaInfo.itemPosition[h]==void 0||f.formulaInfo.cantFormulaMeasures==0;if(h=g?h&&f.initMetadata.Dimensions[c].validPosition!=
"hidden":h&&f.initMetadata.Measures[c].validPosition!="hidden"){l.appendChild(j);OAT.Event.attach(l,"click",function(){var c=l.getAttribute("isDimension")=="true";l.getAttribute("dataField");var g=parseInt(l.getAttribute("index"));this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");if(c){f.initMetadata.Dimensions[g].Visible=!f.initMetadata.Dimensions[g].Visible;f.preGoWhenShowHideDimension(g)}else{f.initMetadata.Measures[g].Visible=!f.initMetadata.Measures[g].Visible;
f.preGoWhenShowHideMeasures(g)}})}return l},j=h=f.autoNumber?1:0;j<f.initMetadata.Dimensions.length;j++){var k=g(j,true);c.appendChild(k)}for(j=h;j<f.initMetadata.Measures.length;j++){k=g(j,false);c.appendChild(k)}(gx.util.browser.isIPad()||gx.util.browser.isIPhone())&&jQuery(".oat_winrect_close_b").css({backgroundSize:"30px 30px",height:"30px",width:"30px",right:"-14px",top:"-14px"})});(f.QueryViewerCollection[K].ExportToXML||f.QueryViewerCollection[K].ExportToHTML||f.QueryViewerCollection[K].ExportToPDF||
f.QueryViewerCollection[K].ExportToXLS||f.QueryViewerCollection[K].ExportToXLSX)&&f.filterDiv.appendChild(c)};this.appendExportToXmlOption=function(c,g){var h;if(f.QueryViewerCollection[K].ExportToXML){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){h=document.createElement("div");h.style.marginBottom="10px";exportXMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXMLButtonSub.setAttribute("id","divtoxml");var j=f.query;if(j==""){j="Query";
try{j=f.controlName.split("_")[0]}catch(k){}}setTimeout(function(){jQuery("#divtoxml").downloadify({filename:function(){return j+".xml"},data:function(){return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+f.ExportToXML()},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXMLButtonSub);var l=OAT.Dom.create("label");l.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXml");
l.style.paddingLeft="9px";l.htmlFor="pivot_checkbox_restoreview";h.appendChild(l)}else{h=OAT.Dom.create("div");exportXMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});exportXMLButtonSub.setAttribute("id","divtoxml");h.appendChild(exportXMLButtonSub);exportXMLButtonSub.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");l=
OAT.Dom.create("label");l.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXml");l.htmlFor="pivot_checkbox_restoreview";h.appendChild(l);l=document.createElement("span");h.appendChild(l);OAT.Dom.attach(exportXMLButtonSub,"click",function(){if(f.serverPagination)f.getDataForPivot(f.UcId,1,-1,true,"","","XML","","",true);else{str=f.ExportToXML();if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+
str));else{var c=new Blob([str],{type:"text/xml"});if(f.query!="")saveAs(c,f.query+".xml");else{var g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".xml")}}}})}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.ExportToXMLWhenServerPagination=function(){f.QueryViewerCollection[f.IdForQueryViewerCollection].calculatePivottableData(function(c){f.allDataWithoutSort=OATgetDataFromXMLOldFormat(c,f.pageData.dataFields);f.allData=f.allDataWithoutSort;
for(var c=jQuery.extend(true,[],f.conditions),g=0;g<f.conditions.length;g++)if(f.conditions[g]){for(var h=0;h<f.allData.length;h++){var j=f.allData[h][g];if(j==void 0){j=" ";f.allData[h][V]=" "}f.conditions[g].distinctValues.findIndex(j)==-1&&f.conditions[g].distinctValues.push(j)}try{f.sort(f.conditions[g],g)}catch(k){}}f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();str=f.ExportToXML();f.allDataWithoutSort=[];f.allData=[];f.filteredData=[];f.conditions=c;if(gx.util.browser.webkit&&
!gx.util.browser.chrome)window.open("data:text/xml,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+str));else{c=new Blob([str],{type:"text/xml"});if(f.query!="")saveAs(c,f.query+".xml");else{g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(l){}saveAs(c,g+".xml")}}}.closure(this))};this.ExportToHTMLWhenServerPagination=function(){var c=location.href.substr(0,location.href.indexOf(location.pathname))+gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/css/pivot.css"),
c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" /></HEAD><DIV style="margin-bottom: 5px;">'+jQuery("#"+f.controlName+"_"+f.query)[0].outerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,""),c=c+"</DIV></BODY></HTML>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:text/html,"+c);else{c=new Blob([c],{type:"text/html"});
if(f.query!="")saveAs(c,f.query+".html");else{var g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".html")}}};this.appendExportToHtmlOption=function(c,g){var h;if(f.QueryViewerCollection[K].ExportToHTML){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var j=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});
j.setAttribute("id","divtoxml");h.appendChild(j);j.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");var k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportHtml");k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k);OAT.Dom.attach(j,"click",function(){if(f.serverPagination)f.getDataForPivot(f.UcId,1,-1,true,"","","HTML","","",true);else{var c=location.href.substr(0,location.href.indexOf(location.pathname))+gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/css/pivot.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" /></HEAD><DIV style="margin-bottom: 5px;">'+jQuery("#"+f.controlName+"_"+f.query)[0].outerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,"").replace(/sort-desc/g,""),c=c+"</DIV></BODY></HTML>";if(gx.util.browser.webkit&&!gx.util.browser.chrome)window.open("data:text/html,"+
c);else{c=new Blob([c],{type:"text/html"});if(f.query!="")saveAs(c,f.query+".html");else{var g="Query";try{g=f.controlName.substr(4).split("_")[0]}catch(h){}saveAs(c,g+".html")}}}})}else{h=document.createElement("div");h.style.marginBottom="10px";exportHTMLButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportHTMLButtonSub.setAttribute("id","divtohtml");var l=f.query;if(l==""){l="Query";try{l=f.controlName.split("_")[0]}catch(m){}}setTimeout(function(){jQuery("#divtohtml").downloadify({filename:function(){return l+
".html"},data:function(){var c=location.href.substr(0,location.href.indexOf(location.pathname))+gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/css/pivot.css"),c='<!DOCTYPE><HTML><BODY><HEAD><META content="text/html; charset=utf-8" http-equiv="Content-Type"/><link id="gxtheme_css_reference" rel="stylesheet" type="text/css" href="'+c+'" /></HEAD><DIV style="margin-bottom: 5px;">'+jQuery("#"+f.controlName+"_"+f.query)[0].outerHTML.replace(/display: none;/g,"").replace(/sort-asc/g,
"").replace(/sort-desc/g,"");return c+"</DIV></BODY></HTML>"},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportHTMLButtonSub);k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportHtml");k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));
c.appendChild(h);g=true}};this.appendExportToPdfOption=function(c){var g;if(f.QueryViewerCollection[K].ExportToPDF){if(gx.util.browser.isIE()&&9>=gx.util.browser.ieVersion()){g=document.createElement("div");g.style.marginBottom="10px";exportPdfButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportPdfButtonSub.setAttribute("id","divtoexport");var h=f.query;if(h==""){h="Query";try{h=f.controlName.split("_")[0]}catch(j){}}setTimeout(function(){jQuery("#divtoexport").downloadify({filename:function(){return h+
".pdf"},data:function(){return btoa(OAT.GeneratePDFOutput(f))},onComplete:function(){},onCancel:function(){},onError:function(){},dataType:"base64",swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);g.appendChild(exportPdfButtonSub);var k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportPdf");k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";g.appendChild(k)}else{g=OAT.Dom.create("div");var l=OAT.Dom.create("div",
{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});l.setAttribute("id","divtoxml");g.appendChild(l);l.setAttribute("class","download_file_img");g.setAttribute("class","export_item_div");k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportPdf");k.htmlFor="pivot_checkbox_restoreview";g.appendChild(k);h=f.query;if(h==""){h="Query";try{h=f.controlName.split("_")[0]}catch(m){}}OAT.Dom.attach(l,
"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,1,-1,true,"","","PDF","","",true):OAT.GeneratePDFOutput(f,h)})}c.appendChild(g)}};this.appendExportToExcelOption=function(c,g){var h;if(f.QueryViewerCollection[K].ExportToXLS){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var j=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",boxSizing:"content-box"});
j.setAttribute("id","divtoxml");h.appendChild(j);j.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");var k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXls2003");k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k);var l=f.query;if(l==""){l="Query";try{l=f.controlName.split("_")[0]}catch(m){}}OAT.Dom.attach(j,"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,1,-1,true,"","","XLS","","",true):f.ExportToExcel(l)})}else{h=
document.createElement("div");h.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id","divtoxls");l=f.query;if(l==""){l="Query";try{l=f.controlName.split("_")[0]}catch(n){}}setTimeout(function(){jQuery("#divtoxls").downloadify({filename:function(){return l+".xls"},data:function(){return f.ExportToExcel()},onComplete:function(){},onCancel:function(){},onError:function(){},swf:f.swfPath,downloadImage:f.downloadImagePath,
width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXLSButtonSub);k=OAT.Dom.create("label");k.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXls2003");k.style.paddingLeft="9px";k.htmlFor="pivot_checkbox_restoreview";h.appendChild(k)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.ExportToXLSXWhenServerPagination=function(){f.QueryViewerCollection[f.IdForQueryViewerCollection].calculatePivottableData(function(c){for(var g=
[],h=0;h<f.pageData.dataFields.length;h++)g.push(f.pageData.dataFields[h]);for(h=0;h<f.pageData.AxisInfo.length;h++)try{if(f.pageData.AxisInfo[h].Axis.Type=="Hidden"){var j=g.indexOf(f.pageData.AxisInfo[h].DataField);j>-1&&g.splice(j,1)}}catch(k){}for(h=0;h<x.length;h++)if(x[h].getAttribute("aggregation")=="average"){f.formulaInfo.measureFormula[h].hasFormula=true;f.formulaInfo.measureFormula[h].textFormula=x[h].getAttribute("dataField")+"_N/"+x[h].getAttribute("dataField")+"_D";f.formulaInfo.cantFormulaMeasures++;
for(var l=f.formulaInfo.measureFormula[h].textFormula,m=["*","-","+","/","(",")"],n=0;n<m.length;n++){var o=l.split(m[n]);if(o.length>1){for(var l="",q=0;q<o.length-1;q++)l=l+o[q]+" "+m[n]+" ";l=l+o[o.length-1]}}q=InfixToPostfix(l);O.measureFormula[h].polishNotationText=q;for(l=q.split(" ");l.indexOf("")!=-1;)l.splice(l.indexOf(""),1);n=[];for(o=0;o<l.length;o++)if(m.indexOf(l[o])==-1&&isNaN(parseInt(l[o]))){var r=O.itemPosition[l[o]];n.indexOf(r)==-1&&n.push(r)}f.formulaInfo.measureFormula[h].relatedMeasures=
n;for(m=q.split(" ");m.indexOf("")!=-1;)m.splice(m.indexOf(""),1);f.formulaInfo.measureFormula[h].PolishNotation=m}h=OATgetDataFromXMLOldFormat(c,g,f.OrderFildsHidden);f.GeneralDataRows=h[0];f.recordForFormula=h[1];f.allData=f.GeneralDataRows;c=jQuery.extend(true,[],f.conditions);f.GeneralDistinctValues=[];for(h=0;h<f.conditions.length;h++)if(f.conditions[h]){f.GeneralDistinctValues[h]=[];for(q=0;q<f.allData.length;q++){g=f.allData[q][h];if(g==void 0){g=" ";f.allData[q][j]=" "}f.conditions[h].distinctValues.findIndex(g)==
-1&&f.conditions[h].distinctValues.push(g);f.GeneralDistinctValues[h].findIndex(g)==-1&&f.GeneralDistinctValues[h].push(g)}try{f.sort(f.conditions[h],h)}catch(t){}}f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();j=f.query;if(j==""){j="Query";try{j=f.controlName.split("_")[0]}catch(u){}}OAT.GenerateExcelOutput(j,f,x);str=f.ExportToXML();f.GeneralDataRows=[];f.allData=[];f.filteredData=[];f.GeneralDistinctValues=[];f.conditions=c;for(h=0;h<x.length;h++)if(x[h].getAttribute("aggregation")==
"average"){f.formulaInfo.measureFormula[h]={hasFormula:false};f.formulaInfo.cantFormulaMeasures--}}.closure(this))};this.appendExportToExcel2010Option=function(c,g){var h;if(f.QueryViewerCollection[K].ExportToXLSX&&(f.allData.length>0||f.serverPagination)){if(!gx.util.browser.isIE()||9<gx.util.browser.ieVersion()){h=OAT.Dom.create("div");var j=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left",width:"21px",height:"21px",overflow:"hidden",marginRight:"10px",cursor:"pointer",
boxSizing:"content-box"});j.setAttribute("id","divtoxml");h.appendChild(j);j.setAttribute("class","download_file_img");h.setAttribute("class","export_item_div");j=OAT.Dom.create("label");j.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXlsx");j.htmlFor="pivot_checkbox_restoreview";h.appendChild(j);var k=f.query;if(k==""){k="Query";try{k=f.controlName.split("_")[0]}catch(l){}}OAT.Dom.attach(h,"click",function(){f.serverPagination?f.getDataForPivot(f.UcId,1,-1,true,"","","XLSX","","",true):OAT.GenerateExcelOutput(k,
f,x)})}else{h=document.createElement("div");h.style.marginBottom="10px";exportXLSButtonSub=OAT.Dom.create("div",{paddingLeft:"1px",position:"relative",cssFloat:"left"});exportXLSButtonSub.setAttribute("id","divtoxlsx");k=f.query;if(k==""){k="Query";try{k=f.controlName.split("_")[0]}catch(m){}}setTimeout(function(){jQuery("#divtoxlsx").downloadify({filename:function(){return k+".xlsx"},data:function(){return OAT.GenerateExcelOutput("",f,x)},onComplete:function(){},onCancel:function(){},onError:function(){},
dataType:"base64",swf:f.swfPath,downloadImage:f.downloadImagePath,width:21,height:21,transparent:true,append:false})},100);h.appendChild(exportXLSButtonSub);j=OAT.Dom.create("label");j.innerHTML=gx.getMessage("GXPL_QViewerContextMenuExportXlsx");j.style.paddingLeft="9px";j.htmlFor="pivot_checkbox_restoreview";h.appendChild(j)}g&&(gx.util.browser.isIE()||c.appendChild(OAT.Dom.create("br")));c.appendChild(h);g=true}};this.countTotals=function(){f.rowTotals=[[],[]];f.colTotals=[[],[]];f.gTotal=[];for(var c=
0;c<f.w;c++){f.colTotals[0].push([]);f.colTotals[1].push([])}for(c=0;c<f.h;c++){f.rowTotals[0].push([]);f.rowTotals[1].push([])}for(var g=[],c=0;c<f.w;c++)for(var h=0;h<f.h;h++){var j=f.tabularData[c][h][0];if(j!=f.EmptyValue&&j!="#NuN#"){x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.colTotals[0][c].push(f.tabularData[c][h][2][0]):f.colTotals[0][c].push(j);f.colTotals[1][c].push(f.tabularData[c][h][1]);x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.rowTotals[0][h].push(f.tabularData[c][h][2][0]):
f.rowTotals[0][h].push(j);f.rowTotals[1][h].push(f.tabularData[c][h][1]);x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.gTotal.push(f.tabularData[c][h][2][0]):f.gTotal.push(j)}else j=="#NuN#"&&(g[c]=true)}h=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];for(c=0;c<f.rowTotals[0].length;c++)f.rowTotals[0][c]=x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.calculateFormulaTotal(f.rowTotals[0][c],x.length-1,"MesaureAsColumn"):h(f.rowTotals[0][c]);for(c=
0;c<f.colTotals[0].length;c++)f.colTotals[0][c]=f.colTotals[0][c].length==0&&g[c]?"#NuN#":x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.calculateFormulaTotal(f.colTotals[0][c],x.length-1,"MesaureAsColumn"):h(f.colTotals[0][c]);f.gTotal=x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula?f.calculateFormulaTotal(f.gTotal,x.length-1,"MesaureAsColumn"):h(f.gTotal)};this.countSubTotals=function(){function c(f,g){for(var h=0;h<f.length-1;h++)for(var j=f[h],k=0;k<j.length;k++){j[k].totals=
[];j[k].filtrows=[];for(var l=0;l<g;l++){j[k].totals.push([]);j[k].filtrows.push([])}}}function g(c,f,h,j,k){if(c.length)for(c=c[c.length-1][f].parent;c.parent;){c.totals[h].push(j);c.filtrows[h].push(k);c=c.parent}}function h(c,g){for(var j=0;j<c.length-1;j++)for(var k=c[j],l=0;l<k.length;l++)for(var m=k[l].totals,n=k[l].filtrows,D=0;D<m.length;D++)if(x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula){var o=f.calculateFormulaTotal(m[D],x.length-1,"MesaureAsColumn");m[D]={array:m[D],
value:o,rows:n[D]}}else m[D]={array:m[D],value:g(m[D]),rows:n[D]}}c(f.colPointers,f.h);c(f.rowPointers,f.w);for(var j=0;j<f.w;j++)for(var k=0;k<f.h;k++){var l=f.tabularData[j][k][0],m=f.tabularData[j][k][1];if(l!=f.EmptyValue)if(x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula){g(f.colPointers,j,k,f.tabularData[j][k][2][0],m);g(f.rowPointers,k,j,f.tabularData[j][k][2][0],m)}else{g(f.colPointers,j,k,l,m);g(f.rowPointers,k,j,l,m)}}j=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];
h(f.colPointers,j);h(f.rowPointers,j)};this.countPointers=function(){function c(g,h,j){if(f.ShowMeasuresAsRows){f[j]=[];k=[g];g=h.length-(x.length-1)+1;if(j=="colPointers")g=h.length;for(l=0;l<g;l++){m=[];for(n=0;n<k.length;n++){D=k[n];for(o=0;o<D.items.length;o++)m.push(D.items[o])}k=m;f[j].push(k.copy())}}else{f[j]=[];for(var k=[g],l=0;l<h.length;l++){for(var m=[],n=0;n<k.length;n++)for(var D=k[n],o=0;o<D.items.length;o++)m.push(D.items[o]);k=m;f[j].push(k.copy())}}}c(f.rowStructure,f.rowConditions,
"rowPointers");c(f.colStructure,f.colConditions,"colPointers")};this.countOffsets=function(){function c(f){for(var g=0;g<f.length;g++)for(var h=f[g],j=0,k=0;k<h.length;k++){var l=h[k];l.offset=j;j=j+l.spanData}}c(f.rowPointers);c(f.colPointers)};this.count=function(){function c(g,h,j,k,l){var m=0,n=0,o=0;if(!g.items){g.span=1;g.spanData=1;g.spanDraw=1;return[g.span,g.spanData,g.spanDraw]}for(var M=0;M<g.items.length;M++){var q=c(g.items[M],h,j,k+1,l),m=m+q[0],n=n+q[1];if(!j||k<l)o=o+q[2]}g.span=m;
g.spanData=n;g.spanDraw=o;if(g.items.length&&g.items[0].items&&!f.ShowMeasuresAsRows&&f.conditions[h[g.items[0].depth]].subtotals&&(!f.autoPaging||f.colConditions.length==0)){m=g.items;h=0;if(g.items.length>0)for(;m!=false;){h++;m=m[0].items}for(m=0;m<g.items.length;m++){n=x.length;if(g.items[m].items!=null&&h-n>0){g.span=g.span+1;g.spanDraw=g.spanDraw+1}}}if(j&&!(k<l))g.spanDraw=1;if(g.collapsed!=void 0&&g.collapsed){g.span=1;g.spanDraw=1}return[g.span,g.spanData,g.spanDraw]}function g(c,h,j,k){var l=
0,m=0;if(!c.items){c.span=1;c.spanData=1;return[c.span,c.spanData]}for(var n=0,D=0;D<c.items.length;D++){var o=g(c.items[D],h,j+1,k),l=l+o[0],m=m+o[1];o[0]==0&&(n=n+1)}c.span=l;c.spanData=m;if(j!=-1&&j<k&&f.conditions[h[j+1]].subtotals)c.span=c.span+x.length*(c.items.length-n);if(c.collapsed!=void 0&&c.collapsed)c.span=1;return[c.span,c.spanData]}if(f.ShowMeasuresAsRows){h=f.rowConditions.length-(x.length-1)-2;g(f.rowStructure,f.rowConditions,-1,h);g(f.colStructure,f.colConditions,0,0)}else{var h=
f.rowConditions.length-(x.length-1)-1;c(f.rowStructure,f.rowConditions,true,-1,h);c(f.colStructure,f.colConditions,false)}f.countPointers();f.countOffsets();f.tabularData=[];var h=[],j=[];f.w=1;f.h=1;if(f.colConditions.length)f.w=f.colPointers[f.colPointers.length-1].length;if(f.rowConditions.length)f.h=f.rowPointers[f.rowPointers.length-1].length;if(!f.ShowMeasuresAsRows){for(var k=0;k<f.w;k++){for(var l=Array(f.h),m=Array(f.h),n=Array(f.h),o=0;o<f.h;o++){l[o]=[];m[o]=[];n[o]=[]}f.tabularData.push(l);
h.push(m);j.push(n)}o=function(c,g,h){for(var j=0,k=0;k<g.length;k++){for(var l=h[g[k]],m=false,n=0;n<c.items.length;n++)if(c.items[n].value!=l)j=j+c.items[n].spanData;else{m=c.items[n];break}if(f.autoPaging)if(m)c=m;else return-1;else m&&(c=m)}return j};l=function(c,g,h){for(var j=0,k=[],l=0;l<f.rowConditions.length-x.length+1;l++)k.push(g[l]);for(l=0;l<k.length;l++){for(var g=h[k[l]],m=false,n=0;n<c.items.length;n++)if(c.items[n].value!=g)j=j+c.items[n].spanData;else{m=c.items[n];break}if(f.autoPaging)if(m)c=
m;else return-1;else m&&(c=m)}return j};for(k=0;k<f.filteredData.length;k++){var q=f.filteredData[k],m=o(f.colStructure,f.colConditions,q),n=l(f.rowStructure,f.rowConditions,q),r=q[f.dataColumnIndex],r=r.toString(),r=r.replace(/,/g,"."),r=r.replace(/%/g,""),r=r.replace(/ /g,"");if(r!="#NuN#"){r=parseFloat(r);isNaN(r)&&(r=0)}if(f.autoPaging){if(m!=-1&&n!=-1){f.tabularData[m][n].push(r);h[m][n].push(k);if(x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula){q=f.getFormulaRowByDataRow(q,
x.length-1,"grandTotal-Tab");j[m][n].push(q)}}}else{if(x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula){q=f.getFormulaRowByDataRow(q,x.length-1,"grandTotal-Tab");if(r==0){f.tabularData[m][n].push(r);f.tabularData[m][n]=f.calculateFormulaTotal([q],x.length-1,"MesaureAsColumn")}else f.tabularData[m][n].push(f.calculateFormulaTotal([q],x.length-1,"MesaureAsColumn"));j[m][n].push(q)}else f.tabularData[m][n].push(r);h[m][n].push(k)}}l=OAT.Statistics[OAT.Statistics.list[f.options.agg].func];
for(k=0;k<f.w;k++)for(o=0;o<f.h;o++){m=f.tabularData[k][o].length==0;n=f.tabularData[k][o].length==1&&f.tabularData[k][o][0]=="#NuN#";r=parseFloat(l(f.tabularData[k][o]));f.tabularData[k][o]=!m&&!n?[r,h[k][o]]:n?["#NuN#",h[k][o]]:[f.EmptyValue,h[k][o]];if(x.length>0&&f.formulaInfo.measureFormula[x.length-1].hasFormula){!m&&!n&&(f.tabularData[k][o]=[r,h[k][o]]);f.tabularData[k][o].push(j[k][o])}}for(k=f.options.subtotals=0;k<f.conditions.length;k++)if(f.conditions[k].subtotals)f.options.subtotals=
true;f.countSubTotals();f.options.totals&&f.countTotals()}};this._drawGTotal=function(c,g){var h=OAT.Dom.create("td",{},"gtotal");if(f.gTotal!=NaN)if(f.autoPaging&&f.FilterByTopFilter){var j=calculateGrandTotalForLastMeasure(f);h.innerHTML=f.defaultPictureValue(j.toString(),true,0);h=f.applyConditionalFormats(h,j.toString(),true,0);f.setClickEventHandlers(h,j.toString(),"MEASURE",x.length-1,"GrandTotal")}else if(!f.autoPaging||f.FilterByTopFilter){if(isNaN(f.gTotal))f.gTotal=0;h.innerHTML=f.defaultPictureValue(f.gTotal.toString(),
true,0);h=f.applyConditionalFormats(h,f.gTotal.toString(),true,0);f.setClickEventHandlers(h,f.gTotal.toString(),"MEASURE",x.length-1,"GrandTotal")}else{h.innerHTML=f.defaultPictureValue(g[g.length-1].toString(),true,0);h=f.applyConditionalFormats(h,g[g.length-1].toString(),true,0);f.setClickEventHandlers(h,g[g.length-1].toString(),"MEASURE",x.length-1,"GrandTotal")}else h.innerHTML="-";c.appendChild(h)};this._drawRowTotals=function(c,g,h,j){for(var k=[],l=0;l<x.length-1;l++)k[l]=[];l=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func];
if(f.colConditions.length)for(var m=0;m<f.w;m++){var n=-1;if(f.colConditions.length>0)for(var o=0;o<x.length-1;o++){for(var q=OAT.Dom.create("td",{},"total"),r=0;r<h.length;r++)if(h[r][2]===m)if(l(h[r][0][o])!=NaN){q.innerHTML=f.defaultPictureValue(l(h[r][0][o]).toString(),false,o);q=f.applyConditionalFormats(q,l(h[r][0][o]).toString(),false,o);f.setClickEventHandlers(q,l(h[r][0][o]).toString(),"MEASURE",o,["PartialGrandTotal",h[r][3]]);n=r;k[o].push(l(h[r][0][o]))}else q.innerHTML="-";j.indexOf(m)==
-1&&c.appendChild(q)}q=OAT.Dom.create("td",{},"total");if(!isNaN(f.colTotals[0][m])||f.colTotals[0][m]=="#NuN#"||f.colTotals[0][m]=="#FoE#"){q.innerHTML=f.defaultPictureValue(f.colTotals[0][m].toString(),true,0);q=f.applyConditionalFormats(q,f.colTotals[0][m].toString(),true,0);n!=-1?f.setClickEventHandlers(q,f.colTotals[0][m].toString(),"MEASURE",x.length-1,["PartialGrandTotal",h[n][3]]):f.setClickEventHandlers(q,f.colTotals[0][m].toString(),"MEASURE",x.length-1,["PtrTotals",f.colTotals[1][m]])}else q.innerHTML=
"";j.indexOf(m)==-1&&c.appendChild(q);if(f.colPointers.length)for(n=f.colPointers[f.colPointers.length-1][m].parent;n.parent;){if(f.conditions[f.colConditions[n.depth]].subtotals&&n.offset+n.spanData-1==m){q=OAT.Dom.create("td",{},"total");o=[];for(r=0;r<n.totals.length;r++)o.append(n.totals[r].array);if(l(o)!=NaN){q.innerHTML=f.defaultPictureValue(l(o).toString(),true,0);q=f.applyConditionalFormats(q,l(o).toString(),true,0);f.setClickEventHandlers(q,l(o).toString(),"MEASURE",x.length-1,"GandTotal")}else q.innerHTML=
"-";c.appendChild(q)}n=n.parent}}if(f.colConditions.length>0)for(h=0;h<x.length-1;h++){q=OAT.Dom.create("td",{},"gtotal");q.innerHTML=f.defaultPictureValue(l(k[h]).toString(),false,h);q=f.applyConditionalFormats(q,l(k[h]).toString(),false,h);f.setClickEventHandlers(q,l(k[h]).toString(),"MEASURE",h,"GrandTotal");c.appendChild(q)}f._drawGTotal(c,g)};this._drawRowSubtotals=function(c,g,h,j,k,l,m){for(var g=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func],n=[],o=0;o<x.length-1;o++)n[o]=[];
for(var q=0;q<f.w;q++){o=OAT.Dom.create("td",{},"subtotal");if(h.totals[q].array.length>0){if(f.colConditions.length>0)for(var r=0;r<x.length-1;r++){var t=OAT.Dom.create("td",{},"total");if(j[0]!=void 0)for(var u=0;u<j.length;u++)if(j[u][2]==q){for(var v=[],w=0;w<j[u][0][r].length;w++)if(l<j[u][0][r][w][1]){v.push(j[u][0][r][w][0]);j[u][0][r][w][1]=l}if(g(v)!=NaN){t.innerHTML=f.defaultPictureValue(g(v).toString(),false,r);t=f.applyConditionalFormats(t,g(v).toString(),false,r);f.setClickEventHandlers(t,
g(v).toString(),"MEASURE",r,["PartialGrandTotal",j[0][3]]);n[r].push(g(v))}else t.innerHTML=""}c.appendChild(t)}o.innerHTML=f.defaultPictureValue(h.totals[q].value.toString(),true,0);if(k)k.innerHTML=f.defaultPictureValue(h.totals[q].value.toString(),true,0);o=f.applyConditionalFormats(o,h.totals[q].value.toString(),true,0);f.setClickEventHandlers(o,h.totals[q].value.toString(),"MEASURE",x.length-1,["PtrTotals",h.totals[q].rows])}else{if(f.colConditions.length>0)for(r=0;r<x.length-1;r++){t=OAT.Dom.create("td",
{},"total");t.innerHTML="";c.appendChild(t)}o.innerHTML=""}c.appendChild(o);if(f.colPointers.length)for(t=f.colPointers[f.colPointers.length-1][q].parent;t.parent;){if(f.conditions[f.colConditions[t.depth]].subtotals&&t.offset+t.spanData-1==q){o=OAT.Dom.create("td",{},"subtotal");c.appendChild(o);r=[];for(u=0;u<h.totals.length;u++)u>=t.offset&&u<t.spanData+t.offset&&r.append(h.totals[u].array);if(g(r)!=NaN){o.innerHTML=f.defaultPictureValue(g(r).toString(),true,0);o=f.applyConditionalFormats(o,g(r).toString(),
true,0);f.setClickEventHandlers(o,g(r).toString(),"MEASURE",x.length-1,"")}else o.innerHTML="-"}t=t.parent}}if(f.options.totals&&f.colConditions.length){if(f.colConditions.length>0){OAT.Dom.create("td",{},"total");for(j=0;j<x.length-1;j++){o=OAT.Dom.create("td",{},"total");r=n[j];if(g(r)!=NaN){o.innerHTML=f.defaultPictureValue(g(r).toString(),false,j);o=f.applyConditionalFormats(o,g(r).toString(),false,j)}else o.innerHTML="-";c.appendChild(o)}}r=[];for(u=0;u<h.totals.length;u++)r.append(h.totals[u].array);
o=OAT.Dom.create("td",{},"total");if(f.formulaInfo.measureFormula[x.length-1].hasFormula){h=f.calculateFormulaTotal(r,x.length-1,"MeasureInRows");if(h!=NaN&&!isNaN(h)){o.innerHTML=f.defaultPictureValue(h.toString(),true,0);o=f.applyConditionalFormats(o,h.toString(),true,0);f.setClickEventHandlers(o,h.toString(),"MEASURE",x.length-1,"")}else o.innerHTML="-"}else if(g(r)!=NaN){o.innerHTML=f.defaultPictureValue(g(r).toString(),true,0);if(m)m.innerHTML=f.defaultPictureValue(g(r).toString(),true,0);o=
f.applyConditionalFormats(o,g(r).toString(),true,0);f.setClickEventHandlers(o,g(r).toString(),"MEASURE",x.length-1,"")}else o.innerHTML="-";c.appendChild(o)}};this._drawRowSubtotalsAutoPaging=function(c,g){for(var h=0;h<g.length;h++){var j=h==g.length-1?true:false,k=OAT.Dom.create("td",{},"total");if(g[h]!=NaN){k.innerHTML=f.defaultPictureValue(g[h].toString(),j,h);k=f.applyConditionalFormats(k,g[h].toString(),j,h);f.setClickEventHandlers(k,g[h].toString(),"MEASURE",h,"")}else k.innerHTML=" ";c.appendChild(k)}};
this._sumValuesInDept=function(c,g,h){if(g===0){var g=c.items,j=0;if(g!=false)for(c=0;c<g.length;c++){j=j+parseFloat(g[c].value);h.append(parseFloat(g[c].value))}else{h.append(parseFloat(c.value));return parseFloat(c.value)}return j}for(var j=c.items,k=0,c=0;c<j.length;c++)k=k+f._sumValuesInDept(j[c],g-1,h);return k};this._sumValuesInDept=function(c,g,h){if(g===0){var g=c.items,j=0;if(g!=false)for(c=0;c<g.length;c++){j=j+parseFloat(g[c].value);g[c].value=="#NuN#"?h.append("#NuN#"):h.append(parseFloat(g[c].value))}else{h.append(parseFloat(c.value));
return parseFloat(c.value)}return j}for(var j=c.items,k=0,c=0;c<j.length;c++)k=k+f._sumValuesInDept(j[c],g-1,h);return k};this._sumValuesInDeptFormula=function(c,g,h,j){if(g===0){g=c.items;if(g!=false)for(var k=0;k<g.length;k++){for(var c=g[k],l=0;l<j;l++)c=c.parent;c=f.getFormulaRowByCoord(c,[],j,"");h.append([c])}else{c=f.getFormulaRowByCoord(g[k],[],j,"");h.append([c])}}else{c=c.items;for(k=0;k<c.length;k++)f._sumValuesInDeptFormula(c[k],g-1,h,j)}};this._drawRowSubtotalsForMeasures=function(c,
g,h,j,k,l,m){var n=OAT.Statistics[OAT.Statistics.list[f.options.aggTotals].func],g=OAT.Dom.create("td",{},"subtotal"),o=j,q=f.rowConditions.length-(x.length-1),j=q>=3&&k!=-1?q-k+j-1:q-1+j,k=[];f.formulaInfo.measureFormula[o].hasFormula?f._sumValuesInDeptFormula(h,j,k,o):f._sumValuesInDept(h,j,k);if(k.length>0)if(f.formulaInfo.measureFormula[o].hasFormula){j=f.calculateFormulaTotal(k,o,"MeasureInRows");if(j!=NaN){g.innerHTML=f.defaultPictureValue(j.toString(),false,o);g=f.applyConditionalFormats(g,
j.toString(),false,o);f.setClickEventHandlers(g,j.toString(),"MEASURE",o,["PtrTotals",h.filtrows]);l!=void 0&&f.setClickEventHandlers(l,l.innerHTML,"DIMENSION",o,["PtrTotals",h.filtrows])}else g.innerHTML=""}else if(n(k)!=NaN){g.innerHTML=f.defaultPictureValue(n(k).toString(),false,o);g=f.applyConditionalFormats(g,n(k).toString(),false,o);f.setClickEventHandlers(g,n(k).toString(),"MEASURE",o,["PtrTotals",h.filtrows]);l!=void 0&&f.setClickEventHandlers(l,l.innerHTML,"DIMENSION",o,["PtrTotals",h.filtrows])}else g.innerHTML=
"";else g.innerHTML="";if(m!=void 0&&m[o]){m[o].innerHTML=g.innerHTML;m[o]=false}c.appendChild(g)};this._drawCorner=function(c){if(x.length>0){c.innerHTML=f.headerRow[f.dataColumnIndex];c.className="h2titlewhite";this.setTitleTexrtAlign(c,c.innerHTML);f.setClickEventHandlers(c,f.headerRow[f.dataColumnIndex],"MEASURE",f.dataColumnIndex-H.length,"GrandTotal")}};this._drawCornerCustom=function(c){c.innerHTML="";c.className="h2titlewhite";this.setTitleTexrtAlign(c,c.innerHTML)};this._drawRowConditionsHeadingsCustom=
function(c){for(var g=0;g<f.rowConditions.length;g++){var h=f.conditions[f.rowConditions[g]];if(f.isMeasureByName(f.headerRow[f.rowConditions[g]])){if(!f.ShowMeasuresAsRows){var j=OAT.Dom.create("th",{cursor:"pointer"},"h2titlewhite"),k=OAT.Dom.create("div");k.innerHTML=f.headerRow[f.rowConditions[g]];this.setTitleTexrtAlign(k,f.headerRow[f.rowConditions[g]]);j.rowSpan=f.colConditions.length+2}}else{var j=OAT.Dom.create("th",{cursor:"pointer",height:"25px"},"h2title"),l=OAT.Dom.create("div",{position:"relative"}),
k=OAT.Dom.create("div",{overflow:"hidden"});k.innerHTML=f.serverPagination?f.headerRow[f.rowConditions[g]].replace(/ /g,"&nbsp;")+"&nbsp&nbsp&nbsp&nbsp":f.headerRow[f.rowConditions[g]]+"&nbsp&nbsp&nbsp";if(f.GeneralDataRows.length>0||f.serverPagination){var m=f.getClickReference(h,f.rowConditions[g],k),n=m[0],m=m[1];OAT.Dom.attach(j,"click",n);n=f.getOrderReference(f.rowConditions[g],m,n,k);f.gd.addSource(k,f.process,n);f.gd.addTarget(j)}j.conditionIndex=f.rowConditions[g];j.rowSpan=f.ShowMeasuresAsRows?
f.colConditions.length+1:f.colConditions.length+2;n=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});try{this.updateSortImage(n,h.sort)}catch(o){}OAT.Dom.append([j,l],[l,k],[l,n],[c,j])}}if(f.ShowMeasuresAsRows){j=OAT.Dom.create("th",{height:"25px"},"h2title");l=OAT.Dom.create("div",{position:"relative",width:"80px"});k=OAT.Dom.create("div",{overflow:"hidden"});k.innerHTML=gx.getMessage("GXPL_QViewerJSMeasures")+"&nbsp&nbsp&nbsp";OAT.Dom.append([j,l],
[l,k],[c,j]);j.rowSpan=f.colConditions.length+1;OAT.Dom.append([j,k],[c,j])}};this.isMeasureByName=function(c){for(var f=false,g=0;g<x.length-1;g++)x[g].attributes.getNamedItem("displayName").nodeValue==c&&(f=true);return f};this.setTitleTexrtAlign=function(c,f){for(var g=0;g<x.length;g++)if(x[g].getAttribute("displayName")===f){if(x[g].getAttribute("dataType")==="integer"||x[g].getAttribute("dataType")==="real")c.style.textAlign="right";if(x[g].getAttribute("date")==="integer")c.style.textAlign=
"left"}};this.updateSortImage=function(c,f){var g="none";switch(f){case 0:g="asc";break;case 1:g="asc";break;case -1:g="desc";break;case 2:g="desc"}var h=navigator.userAgent.toLowerCase().indexOf("android")>-1;if(gx.util.browser.isIE()||h){c.className.replace("sort-none");c.className.replace("sort-asc");c.className.replace("sort-desc")}else{c.classList.remove("sort-none");c.classList.remove("sort-asc");c.classList.remove("sort-desc")}gx.util.browser.isIE()||h?c.className=c.className+(" sort-"+g):
c.classList.add("sort-"+g)};this._drawRowConditionsHeadings=function(c){for(var g=OAT.Dom.create("tr"),h=0;h<f.rowConditions.length;h++){var j=f.conditions[f.rowConditions[h]];if(f.isMeasureByName(f.headerRow[f.rowConditions[h]])){if(!f.ShowMeasuresAsRows){var k=OAT.Dom.create("th",{cursor:"pointer"},"h2titlewhite"),l=OAT.Dom.create("div");l.innerHTML=f.headerRow[f.rowConditions[h]];f.setTitleTexrtAlign(l,f.headerRow[f.rowConditions[h]]);f.setClickEventHandlers(k,f.headerRow[f.rowConditions[h]],"MEASURE",
f.rowConditions[h]-H.length,"GrandTotal");OAT.Dom.append([k,l],[g,k])}}else{var l=f.headerRow[f.rowConditions[h]].length>8?f.headerRow[f.rowConditions[h]].length*10:80,k=OAT.Dom.create("th",{cursor:"pointer",height:"25px"},"h2title"),m=OAT.Dom.create("div",{position:"relative",width:l+"px"}),l=OAT.Dom.create("div",{overflow:"hidden"});l.innerHTML=f.headerRow[f.rowConditions[h]]+"&nbsp&nbsp&nbsp";var n=f.getClickReference(j,f.rowConditions[h],l),o=n[0],n=n[1];OAT.Dom.attach(k,"click",o);o=f.getOrderReference(f.rowConditions[h],
n,o,l);f.gd.addSource(l,f.process,o);f.gd.addTarget(k);k.conditionIndex=f.rowConditions[h];o=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});j!=void 0?this.updateSortImage(o,j.sort):this.updateSortImage(o,0);OAT.Dom.append([k,m],[m,l],[m,o],[g,k])}}if(f.ShowMeasuresAsRows){l=80;k=OAT.Dom.create("th",{height:"25px"},"h2title");m=OAT.Dom.create("div",{position:"relative",width:l+"px"});l=OAT.Dom.create("div",{overflow:"hidden"});l.innerHTML=gx.getMessage("GXPL_QViewerJSMeasures")+
"&nbsp&nbsp&nbsp";OAT.Dom.append([k,m],[m,l],[g,k]);k=OAT.Dom.create("th",{cursor:"none"},"h2titlewhite");l=OAT.Dom.create("div");l.innerHTML=gx.getMessage("GXPL_QViewerJSValue");k.style.textAlign="right";OAT.Dom.append([k,l],[g,k])}k=OAT.Dom.create("th");if(f.colConditions.length)k.style.border="none";else{f._drawCorner(k,true);k.conditionIndex=-1}k.colSpan=f.colStructure.span!=null?f.colStructure.span+(f.options.headingBefore?1:0)+(f.options.totals?1:0):(f.options.headingBefore?1:0)+(f.options.totals?
1:0);x.length>0&&!f.ShowMeasuresAsRows&&g.appendChild(k);if(f.colConditions.length){k=OAT.Dom.create("th",{border:"none",width:"0px;"});g.appendChild(k)}x.length>0&&g.cells[1]!=void 0&&g.cells[1].innerHTML==""?g.hidden=true:f.appendRowToTable(c,g,true);x.length>0&&(g.cells[1]!=void 0&&g.cells[1].innerHTML=="")&&document.getElementById(f.controlName+"_"+f.query+"_toolbar").rows[0].appendChild(g.cells[0])};this._drawColConditionsHeadingsCustom=function(c,g,h){var j=f.conditions[f.colConditions[g]],
k=OAT.Dom.create("th",{cursor:"pointer"},"h2title"),l=OAT.Dom.create("div",{position:"relative",width:(f.headerRow[f.colConditions[g]].length>8?(f.headerRow[f.colConditions[g]].length+3)*10:80)+"px"});if(h)k.style.borderRightColor="transparent";h=OAT.Dom.create("div",{overflow:"hidden"});h.innerHTML=f.serverPagination?f.headerRow[f.colConditions[g]].replace(/ /g,"&nbsp")+"&nbsp&nbsp&nbsp":f.headerRow[f.colConditions[g]]+"&nbsp&nbsp";if(f.GeneralDataRows.length>0||f.serverPagination){var m=f.getClickReference(j,
f.colConditions[g],h),n=m[0],m=m[1];OAT.Dom.attach(k,"click",n);n=f.getOrderReference(f.colConditions[g],m,n,h);f.gd.addSource(h,f.process,n);f.gd.addTarget(k)}n=OAT.Dom.create("div",{position:"absolute",right:"0px",bottom:"2px",width:"12px",height:"12px"});try{this.updateSortImage(n,j.sort)}catch(o){}l.appendChild(h);l.appendChild(n);k.conditionIndex=f.colConditions[g];k.appendChild(l);c.appendChild(k);return c};this._drawColConditionsHeadings=function(c,g){var h=f.conditions[f.colConditions[g]],
j=OAT.Dom.create("th",{cursor:"pointer"},"even"),k=OAT.Dom.create("div");k.innerHTML=f.headerRow[f.colConditions[g]];var l=f.getClickReference(h,f.colConditions[g],k),h=l[0],l=l[1];OAT.Dom.attach(j,"click",h);h=f.getOrderReference(f.colConditions[g],l,h,k);f.gd.addSource(k,f.process,h);f.gd.addTarget(j);j.conditionIndex=f.colConditions[g];j.appendChild(k);j.hidden=true;if(j.textContent==f.headerRow[f.colConditions[g]]){k=document.getElementById(f.controlName+"_"+f.query+"_toolbar");j.hidden=false;
k.rows[0].appendChild(j)}};this.getClassName=function(){return"even"};this.setStyleValues=function(c,f){function g(c){c=c.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(c,f,g,h){return f+f+g+g+h+h});return(c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c))?{r:parseInt(c[1],16),g:parseInt(c[2],16),b:parseInt(c[3],16)}:null}for(var h=f.split(";"),j=0;j<h.length;j++){var k=h[j].split(":");switch(k[0]){case "color":c.style.color=k[1][0]!=void 0&&k[1][0]==="#"?"rgb("+g(k[1]).r+","+g(k[1]).g+","+
g(k[1]).b+")":k[1];break;case "fontStyle":c.style.fontStyle=k[1];break;case "backgroundColor":c.style.backgroundColor=k[1];break;case "textDecoration":c.style.textDecoration=k[1];break;case "fontWeight":c.style.fontWeight=k[1];break;case "fontFamily":c.style.fontFamily=k[1];break;case "fontVariant":c.style.fontVariant=k[1];break;case "fontSize":c.style.fontSize=k[1].replace("px","")+"px";break;case "textAlign":c.style.textAlign=k[1];break;case "lineHeight":c.style.lineHeight=k[1];break;case "textIndent":c.style.textIndent=
k[1];break;case "verticalAlign":c.style.verticalAlign=k[1];break;case "wordSpacing":c.style.wordSpacing=k[1];break;case "display":c.style.display=k[1];break;case "borderThickness":c.style.borderThickness=k[1];c.style.borderWidth=k[1]+"px";break;case "borderColor":c.style.borderColor=k[1];break;case "borderWith":c.style.borderWith=k[1];break;case "borderStyle":c.style.borderStyle=k[1];break;case "padding":c.style.padding=k[1];break;case "paddingBottom":c.style.paddingBottom=k[1];break;case "paddingLeft":c.style.paddingLeft=
k[1];break;case "paddingRight":c.style.paddingRight=k[1];break;case "paddingTop":c.style.paddingTop=k[1]}}return c};this.underRecursionStyle=!1;this.applyFormatValues=function(c,g,h){var j=f.columns[h].getAttribute("format");j!=null&&j!=""&&(c=f.setStyleValues(c,j));f.underRecursionStyle=false;for(var k=0;k<f.formatValues.length;k++)if(f.formatValues[k].columnNumber==h&&f.formatValues[k].value===g.trimpivot()){c=f.setStyleValues(c,f.formatValues[k].format);if(f.formatValues[k].recursive!=void 0&&
f.formatValues[k].recursive=="yes")f.underRecursionStyle=true}for(var l=f.columns[h].getAttribute("dataType"),m=[],n=[],j=[],o=[],q=[],r=[],o=[],t=[],k=0;k<f.conditionalFormatsColumns.length;k++)if(f.conditionalFormatsColumns[k].columnNumber==h){if(f.conditionalFormatsColumns[k].operation1=="equal"){m[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;m[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation1==
"notequal"){n[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;n[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation1=="less"){q[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;q[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation1=="greater"){j[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):
f.conditionalFormatsColumns[k].value1;j[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation1=="greaterequal"&&f.conditionalFormatsColumns[k].operation2==void 0){o[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;j[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation1=="lessequal"){r[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;
q[1]=f.conditionalFormatsColumns[k].format}if(f.conditionalFormatsColumns[k].operation2&&f.conditionalFormatsColumns[k].operation1=="greaterequal"){t[0]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value1):f.conditionalFormatsColumns[k].value1;if(f.conditionalFormatsColumns[k].operation2&&f.conditionalFormatsColumns[k].operation2=="lessequal"){t[1]=l==="real"||l==="integer"?parseFloat(f.conditionalFormatsColumns[k].value2):f.conditionalFormatsColumns[k].value2;t[2]=f.conditionalFormatsColumns[k].format}}}c.style.textAlign=
"left";if(l==="real"){c.style.textAlign="left";g=parseFloat(g)}if(l==="integer"){c.style.textAlign="right";g=parseInt(g)}if(l==="real")c.style.textAlign="right";if(l!="date"){m[0]!=void 0&&g==m[0]&&(c=f.setStyleValues(c,m[1]));n[0]!=void 0&&g!=n[0]&&(c=f.setStyleValues(c,n[1]));if(j[0]!=void 0&&g>j[0]||o[0]!=void 0&&g>=o[0])c=f.setStyleValues(c,j[1]);if(q[0]!=void 0&&g<q[0]||r[0]!=void 0&&g<=r[0])c=f.setStyleValues(c,q[1]);t[0]!=void 0&&t[1]!=void 0&&(g>=t[0]&&g<=t[1])&&(c=f.setStyleValues(c,t[2]));
return c}if(l==="date"){c.style.textAlign="right";k=g.split("-");f.defaultPicture.getAttribute("dateFormat")!=void 0&&f.defaultPicture.getAttribute("dateFormat")!=null&&(picture=f.defaultPicture.getAttribute("dateFormat").split(""));h=Array(3);h[0]=parseInt(k[0]);h[1]=parseInt(k[1]);h[2]=parseInt(k[2]);if(j[0]!=void 0){k=j[0].split("-");l=Array(3);l[1]=parseInt(k[1]);l[2]=parseInt(k[2]);l[0]=parseInt(k[0]);if(l[0]<h[0]||l[0]<=h[0]&&l[1]<h[1]||l[0]<=h[0]&&l[1]<=h[1]&&l[2]<h[2])c=f.setStyleValues(c,
j[1])}if(q[0]!=void 0){k=q[0].split("-");l=Array(3);l[1]=parseInt(k[1]);l[2]=parseInt(k[2]);l[0]=parseInt(k[0]);if(l[0]>h[0]||l[0]>=h[0]&&l[1]>h[1]||l[0]>=h[0]&&l[1]>=h[1]&&l[2]>h[2])c=f.setStyleValues(c,q[1])}if(t[0]!=void 0&&t[1]!=void 0){k=t[0].split("-");m=t[1].split("-");l=Array(3);cmparElements2=Array(3);l[1]=parseInt(k[1]);l[2]=parseInt(k[2]);l[0]=parseInt(k[0]);cmparElements2[1]=parseInt(m[1]);cmparElements2[2]=parseInt(m[2]);cmparElements2[0]=parseInt(m[0]);if((l[0]<=h[0]||l[0]<=h[0]&&l[1]<
h[1]||l[0]<=h[0]&&l[1]<=h[1]&&l[2]<h[2])&&(cmparElements2[0]>h[0]||cmparElements2[0]>=h[0]&&cmparElements2[1]>h[1]||cmparElements2[0]>=h[0]&&cmparElements2[1]>=h[1]&&cmparElements2[2]>h[2]))c=f.setStyleValues(c,t[2])}}g>j[0]?c=f.setStyleValues(c,j[1]):g<q[0]?c=f.setStyleValues(c,q[1]):g>=t[0]&&g<=t[1]&&(c=f.setStyleValues(c,t[2]));return c};this.applyConditionalFormats=function(c,g,h,j){if(x.length>0){var k;if(h){j=x.length-1;k=x[x.length-1].getAttribute("dataType");h=x[x.length-1].getAttribute("format")}else{k=
x[j].getAttribute("dataType");h=x[j].getAttribute("format")}h!=null&&h!=""&&(c=f.setStyleValues(c,h));for(var l=0;l<f.formatValuesMeasures.length;l++)f.formatValuesMeasures[l].columnNumber==j&&f.formatValuesMeasures[l].value===g&&(c=f.setStyleValues(c,f.formatValuesMeasures[l].format));if(f.underRecursionStyle)for(l=0;l<f.formatValues.length;l++)c=f.setStyleValues(c,f.formatValues[l].format);for(var h=[],m=[],n=[],o=[],q=[],r=[],o=[],t=[],l=0;l<f.conditionalFormats.length;l++)if(f.conditionalFormats[l].columnNumber==
j){if(f.conditionalFormats[l].operation1=="equal"){h[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;h[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="notequal"){m[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;m[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="less"){q[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):
f.conditionalFormats[l].value1;q[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="lessequal"){r[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;q[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="greater"){n[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;n[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation1=="greaterequal"){o[0]=
k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;n[1]=f.conditionalFormats[l].format}if(f.conditionalFormats[l].operation2&&f.conditionalFormats[l].operation1=="greaterequal"){o=[];t[0]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value1):f.conditionalFormats[l].value1;if(f.conditionalFormats[l].operation2&&f.conditionalFormats[l].operation2=="lessequal"){t[1]=k==="real"||k==="integer"?parseFloat(f.conditionalFormats[l].value2):f.conditionalFormats[l].value2;
t[2]=f.conditionalFormats[l].format}}}if(k!="date"){h[0]!=void 0&&g==h[0]&&(c=f.setStyleValues(c,h[1]));m[0]!=void 0&&g!=m[0]&&(c=f.setStyleValues(c,m[1]));if(n[0]!=void 0&&g>n[0]||o[0]!=void 0&&g>=o[0])c=f.setStyleValues(c,n[1]);if(q[0]!=void 0&&g<q[0]||r[0]!=void 0&&g<=r[0])c=f.setStyleValues(c,q[1]);t[0]!=void 0&&t[1]!=void 0&&(g>=t[0]&&g<=t[1])&&(c=f.setStyleValues(c,t[2]))}if(k==="date"){g=g.split("-");f.defaultPicture.getAttribute("dateFormat")!=void 0&&f.defaultPicture.getAttribute("dateFormat")!=
null&&(picture=f.defaultPicture.getAttribute("dateFormat").split(""));j=Array(3);j[0]=parseInt(g[0]);j[1]=parseInt(g[1]);j[2]=parseInt(g[2]);try{if(h[0]!=void 0||o[0]!=void 0||r[0]!=void 0){var u;h[0]!=void 0?u=h[0].split("-"):o[0]!=void 0?u=o[0].split("-"):o[0]!=void 0&&(u=r[0].split("-"));var v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]==j[0]||v[0]==j[0]&&v[1]==j[1])h[1]!=void 0?c=f.setStyleValues(c,h[1]):n[1]!=void 0?c=f.setStyleValues(c,n[1]):q[1]!=void 0&&(c=
f.setStyleValues(c,q[1]))}if(m[0]!=void 0){u=m[0].split("-");v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]!=j[0]||v[0]!=j[0]&&v[1]!=j[1])c=f.setStyleValues(c,m[1])}if(n[0]!=void 0||o[0]!=void 0){u=n[0].split("-")!=void 0?n[0].split("-"):o[0].split("-");v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]<j[0]||v[0]<=j[0]&&v[1]<j[1]||v[0]<=j[0]&&v[1]<=j[1]&&v[2]<j[2])c=f.setStyleValues(c,n[1])}if(q[0]!=void 0||r[0]!=void 0){u=q[0].split("-")!=
void 0?q[0].split("-"):r[0].split("-");v=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);if(v[0]>j[0]||v[0]>=j[0]&&v[1]>j[1]||v[0]>=j[0]&&v[1]>=j[1]&&v[2]>j[2])c=f.setStyleValues(c,q[1])}if(t[0]!=void 0&&t[1]!=void 0){u=t[0].split("-");var w=t[1].split("-"),v=Array(3);cmparElements2=Array(3);v[1]=parseInt(u[1]);v[2]=parseInt(u[2]);v[0]=parseInt(u[0]);cmparElements2[1]=parseInt(w[1]);cmparElements2[2]=parseInt(w[2]);cmparElements2[0]=parseInt(w[0]);if((v[0]<=j[0]||v[0]<=j[0]&&
v[1]<j[1]||v[0]<=j[0]&&v[1]<=j[1]&&v[2]<j[2])&&(cmparElements2[0]>j[0]||cmparElements2[0]>=j[0]&&cmparElements2[1]>j[1]||cmparElements2[0]>=j[0]&&cmparElements2[1]>=j[1]&&cmparElements2[2]>j[2]))c=f.setStyleValues(c,t[2])}}catch(y){}}}return c};this.dimensionPictureValue=function(c,g){if(c=="#NuN#"){var h=f.defaultPicture.getAttribute("textForNullValues");return h!=void 0?h:""}var j,h=f.columns[g].getAttribute("dataType");j=f.columns[g].getAttribute("picture");return f.SetPictureValue(c,h,f.defaultPicture,
j)};this.getMeasureNumber=function(c,f){for(var g=0;g<f.length;g++)if(f[g].getAttribute("dataField")==c)return g};this.getMeasureName=function(c,f){for(var g=0;g<f.length;g++)if(f[g].getAttribute("dataField")==c)return f[g].getAttribute("displayName")};this.defaultPictureValue=function(c,g,h){if(c=="#NuN#"){c=f.defaultPicture.getAttribute("textForNullValues");return c!=void 0?c:""}if(c=="#NaV#"||isNaN(c))return"-";if(x.length>0){if(g){g=x[x.length-1].getAttribute("dataType");h=x[x.length-1].getAttribute("picture")}else{g=
x[h].getAttribute("dataType");h=x[h].getAttribute("picture")}return f.SetPictureValue(c,g,f.defaultPicture,h)}return c};this.SetPictureValue=function(c,f,g,h){var j=g.getAttribute("decimalSeparator")!=void 0&&g.getAttribute("decimalSeparator")!=null?g.getAttribute("decimalSeparator"):".",k=g.getAttribute("decimalPlaces")!=void 0&&g.getAttribute("decimalPlaces")!=null?g.getAttribute("decimalPlaces"):2,l=g.getAttribute("thousandsSeparator"),m=g.getAttribute("dateFormat"),n=c,g=false,o="";if(f=="integer"||
f=="real")if(h!=void 0||h!=null)if(h[0]!="Z"||h[0]!="9"||h[0]!=","||h[0]!="."){for(var g=true,q=0;h.length>q&&h[q]!="Z"&&h[q]!="9"&&h[q]!=","&&h[q]!=".";)q++;o=h.substring(0,q);h=h.substring(q)}var r=false,t="";if(f=="integer"||f=="real")if(h!=void 0||h!=null)if(h[h.length-1]!="Z"||h[h.length-1]!="9"||h[h.length-1]!=","||h[h.length-1]!="."){r=true;for(q=h.length-1;q>-1&&h[q]!="Z"&&h[q]!="9"&&h[q]!=","&&h[q]!=".";)q--;t=h.substring(q+1);h=h.substring(0,q+1)}switch(f){case "integer":case "real":q=c.split(".");
c=true;h==""&&f=="integer"&&(c=false);if(h!=void 0&&h!=""){c=h.indexOf(".")!=-1;m=h.split(".");if(m[1]!=void 0)k=m[1].length;else{k=0;c=false}f=="real"&&(n=parseFloat(n).toFixed(k));q=n.split(".");n="";for(f=0;f<m[0].length;f++)m[0][f]!=","&&(n=n+m[0][f]);if(n.indexOf("9")!=-1){n=n.length-n.indexOf("9");if(q[0].length<n){for(var f=q[0],u=0;u<n-q[0].length;u++)f="0"+f;q[0]=f}}n=q;f=q[0];m=m[0];if(l!=void 0&&l!=null){(u=f[0]=="-")&&(f=f.replace("-",""));if(f.length>3)for(var v=m.length-1;v>=0;v--){if(m.length-
1-v>f.length)break;if(m[v]===",")var x=f.length-(m.length-v-1),w=f.substring(0,x),f=f.substring(x),f=w.length>0?w+l+f:f}u&&(f="-"+f)}n[0]=f}else if(f=="real"){n=parseFloat(n).toFixed(2);q=n.split(".")}n=q[0];l=-1;if(h!=void 0&&h!=""){m=h.split(".");m.length>1&&(l=m[1].indexOf("Z"))}if(q[1]==null){if(c){l!=-1&&(k=l);if(k>0){n=n+j;for(l=0;l<k;l++)n=n+"0"}}}else if(c)if(l===-1)if(q[1].length<k){n=n+j+q[1];for(l=0;l<k-q[1].length;l++)n=n+"0"}else if(q[1].length>k){c="";for(l=0;l<k;l++)c=c+q[1].charAt(l);
n=n+j+c}else n=n+j+q[1];else{c=l;if(q[1].length<k){if(q[1].length>0||c>0){n=n+j+q[1];for(l=0;l<c-q[1].length;l++)n=n+"0"}}else if(q[1].length>k){c="";for(l=0;l<k;l++)c=c+q[1].charAt(l);n=n+j+c}else n=n+j+q[1]}h.indexOf("9");break;case "date":if(c=="")return"";if(h===""){k=c.split("-");if(m!=void 0&&m!=null){pict=m.split("");n="";for(l=0;l<=2;l++){pict[l]==="M"&&(n=n+k[1]);pict[l]==="D"&&(n=n+k[2]);pict[l]==="Y"&&(n=n+k[0]);l!=2&&(n=n+"/")}}else n=k[1]+"/"+k[2]+"/"+k[0]}else{q=c.split("-");if(h=="99/99/9999")if(q[0].length==
4)n=m==void 0||m==null||m=="MDY"?q[1]+"/"+q[2]+"/"+q[0]:m!=void 0&&m=="YMD"?q[0]+"/"+q[1]+"/"+q[2]:q[2]+"/"+q[1]+"/"+q[0];else for(n=c;n.indexOf("-")!=-1;)n.replace("-","/");else{h=="99/99/99"?q[0].length==4&&(q[0]=q[0].substr(q[0].length-2,2)):h!="9999/99/99"&&q[0].length==4&&(q[0]=q[0].substr(q[0].length-2,2));n=m==void 0||m==null||m=="MDY"?q[1]+"/"+q[2]+"/"+q[0]:m!=void 0&&m=="YMD"?q[0]+"/"+q[1]+"/"+q[2]:q[2]+"/"+q[1]+"/"+q[0]}}break;case "datetime":if(c=="")return"";j=c.split("T");c.indexOf("T")===
-1&&(j=c.split(" "));if(h===""){k=j[0].split("-");if(m!=void 0&&m!=null){pict=m.split("");n="";for(l=0;l<=2;l++){pict[l]==="M"&&(n=n+k[1]);pict[l]==="D"&&(n=n+k[2]);pict[l]==="Y"&&(n=n+k[0]);l!=2&&(n=n+"/")}}else n=k[1]+"/"+k[2]+"/"+k[0]}else{k=h.split(" ");q=j[0].split("-");if(k[0]=="99/99/9999")if(q[0].length==4)n=m==void 0||m==null||m=="MDY"?q[1]+"/"+q[2]+"/"+q[0]:m!=void 0&&m=="YMD"?q[0]+"/"+q[1]+"/"+q[2]:q[2]+"/"+q[1]+"/"+q[0];else for(n=c;n.indexOf("-")!=-1;)n.replace("-","/");else if(k[0]==
"99/99/99"){q[0].length==4&&(q[0]=q[0].substr(q[0].length-2,2));n=m==void 0||m==null||m=="MDY"?q[1]+"/"+q[2]+"/"+q[0]:m!=void 0&&m=="YMD"?q[0]+"/"+q[1]+"/"+q[2]:q[2]+"/"+q[1]+"/"+q[0]}else n=k[0]=="9999/99/99"?m==void 0||m==null||m=="MDY"?q[1]+"/"+q[2]+"/"+q[0]:m!=void 0&&m=="YMD"?q[0]+"/"+q[1]+"/"+q[2]:q[2]+"/"+q[1]+"/"+q[0]:""}if(h==="")j.length>1&&(n=n+" "+j[1]);else{k=h.split(" ");h.split(" ").length<2&&(k[0]!="99/99/9999"&&k[0]!="9999/99/99"&&k[0]!="99/99/99")&&k.append(h);if(k.length>1){if(j.length>
1){h=j[1].split(":");if(h.length<2){h[1]="00";h[2]="00"}h.length<3&&(h[2]="00")}else{h=Array(3);h[0]="00";h[1]="00";h[2]="00"}switch(k[1]){case "99":n=n+" "+h[0];break;case "99:99":n=n+" "+h[0]+":"+h[1];break;case "99:99:99":n=n+" "+h[0]+":"+h[1]+":"+h[2];break;default:n=n+" "+h[0]+":"+h[1]+":"+h[2]}}}break;case "character":h=="@!"&&(n=c.toUpperCase())}g&&(n=o+n);r&&(n=n+t);return n};this.concatToGrandTotal=function(c,f){for(var g=0;g<f.length;g++){for(var h=false,j=0;j<c.length;j++)if(c[j][2]===
f[g][2])for(var h=true,k=0;k<x.length-1;k++)for(var l=0;l<f[g][0][k].length;l++)f[g][0][k][l][1]==99&&c[j][0][k].push(f[g][0][k][l][0]);if(!h){h=jQuery.extend(true,[],f[g]);j=[];for(k=0;k<h[0].length;k++){for(var l=[],n=0;n<h[0][k].length;n++)l.push(h[0][k][n][0]);j.push(l)}h[0]=j;c.push(h)}}return c};this.countedRows=0;this.appendRowToTable=function(c,g,h){if(!f.autoPaging&&v&&!f.serverPagination){h||f.countedRows++;if(f.countedRows>v)g.style.display="none"}if(f.serverPagination&&f.ExportTo){h||
f.countedRows++;if(f.countedRows>f.rowsPerPage)g.style.display="none"}h&&g.setAttribute("title_row",true);if(f.autoPaging){var j=!f.paginationInfo?0:f.paginationInfo.pages[f.actualPaginationPage-1].extraRows;if(!h){if(f.countedRows<j)g.style.display="none";f.countedRows++}if(f.countedRows>f.autoPagingRowsPerPage+j)g.style.display="none"}c.appendChild(g)};this.drawTable=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=OAT.Dom.create("table",{},"");c.id=f.controlName+
"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");if(f.autoPaging&&f.allData.length<f.filteredData.length&&f.colPointers.length>1)f.allData=f.filteredData;else if(f.autoPaging&&f.filteredData.length>f.allData.length&&f.colPointers.length===0)f.filteredData=f.allData;f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");
h.setAttribute("class","divIeContainer");f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],[f.div,g]);f.countedRows=0;var j,g=f.colConditions.length;if(f.colConditions.length>0){var k=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);for(h=0;h<f.colConditions.length;h++)l=f._drawColConditionsHeadingsCustom(l,h,h===f.colConditions.length-1);f.appendRowToTable(c,l,true);j=l}try{for(var n=0-g,m=[false,0,0],g=[],h=[],o=false,q=false,r=[],
k=0;k<x.length;k++)r[k]=false;for(k=0;k<f.colConditions.length;k++){for(var l=OAT.Dom.create("tr"),t=f.colPointers[k],u=0;u<t.length;u++){var v=t[u],w=OAT.Dom.create("th",{},"even");if(v.span===0)v.span=1;w.colSpan=v.span*x.length;if(x.length==0)w.colSpan=v.span;if(v.span===0)n++;else{n=n+v.span*x.length;x.length==0&&(n=n+v.span)}w.innerHTML=f.dimensionPictureValue(v.value,f.colConditions[k]);for(var w=f.applyFormatValues(w,v.value,f.colConditions[k]),y=v,A=false,E=false;y.parent;){if(y.parent.collapsed==
void 0){m[0]=false;break}if(y.parent.collapsed){if(!m[0]||y.parent!=m[1]){E=true;k==f.colConditions.length-1&&h.append(u)}else m[2]++;k==f.colConditions.length-1&&!E&&g.append(u);m[0]=true;m[1]=y.parent;w.innerHTML="";A=true;w.colSpan=1;break}else y=y.parent}var C=f.conditions[f.colConditions[k]].collapsedValues.indexOf(v.value)!=-1;!A&&k<f.colConditions.length-1&&(w=f.addExpandCollapseFunctionality(w,v,k,!C,false));(!A||E)&&l.appendChild(w);var B=f.conditions[f.colConditions[v.depth]];if(B.subtotals&&
k+1<f.colConditions.length&&x.length>0){w=OAT.Dom.create("th",{},"h2subtitle ");w.innerHTML=gx.getMessage("GXPL_QViewerJSTotalFor")+" "+v.value;w.rowSpan=f.colConditions.length-k+1;n=n+f.colConditions.length-k;m[0]&&m[1]!=v||l.appendChild(w)}}if(f.options.totals&&k==0&&x.length>0){w=OAT.Dom.create("th",{},"h2subtitle");w.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");w.rowSpan=f.colConditions.length;if(f.colConditions.length>0){w.colSpan=x.length;n=n+f.colConditions.length+(x.length-1)}else n=n+f.colConditions.length;
totalSpan=f.colConditions.length;l.appendChild(w)}f.options.headingAfter&&f._drawColConditionsHeadings(l,k);f.appendRowToTable(c,l,true)}if(f.colConditions.length>0){l=OAT.Dom.create("tr");for(u=0;u<=t.length-m[2];u++)for(A=0;A<x.length;A++){w=OAT.Dom.create("th",{},"h2titlewhite");w.colSpan=1;w.innerHTML=x[A].attributes.getNamedItem("displayName").nodeValue;f.setTitleTexrtAlign(w,w.innerHTML);l.appendChild(w)}f.appendRowToTable(c,l,true)}if(n>0){w=OAT.Dom.create("th",{},"h2subtitle ");w.innerHTML=
"";w.colSpan=n;w.style.borderLeftColor="transparent";j.appendChild(w)}if(f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0)f._drawRowConditionsHeadings(c);else if(f.rowConditions.length==0&&f.options.headingBefore&&f.colConditions.length===0)try{f._drawRowConditionsHeadings(c)}catch(F){}var z=x.length>1,K;K=z?f.rowConditions.length-(x.length-1):f.rowConditions.length;t=[false,9999,true,0];j=[];for(var I=[],n=false,k=0;k<f.h;k++){l=OAT.Dom.create("tr");if(f.rowConditions.length)for(var v=
f.rowPointers[f.rowConditions.length-1][k],J=[],m=v;m.parent;){J.unshift(m);m=m.parent}for(u=0;u<f.rowConditions.length-(x.length-1);u++){v=J[u];if(v!=void 0&&v.offset==k){C=f.conditions[f.rowConditions[u]].collapsedValues.indexOf(v.value)!=-1;u>=f.rowConditions.length-(x.length-1)-1&&(C=false);w=OAT.Dom.create("th",{},"even");if(!t[0]||t[1]>=u){w.rowSpan=J[u].spanDraw;w.innerHTML=f.dimensionPictureValue(v.value,f.rowConditions[u]);w=f.applyFormatValues(w,v.value,f.rowConditions[u]);f.setClickEventHandlers(w,
v.value,"DIMENSION",f.rowConditions[u],v);if(u<f.rowConditions.length-(x.length-1)-1&&(x.length>0||u<f.rowConditions.length-1))w=f.addExpandCollapseFunctionality(w,v,u,!C,true)}else{w.rowSpan=1;w.innerHTML=""}if(t[1]>=u){t[0]=C;t[3]=v;t[1]=C?u:9999;t[2]=true}n=false;l.appendChild(w)}else x.length>0&&(n=true)}f.rowConditions.length-(x.length-1)==0&&(k>0&&x.length>0)&&(n=true);var A=[],L=x.length;L===0&&(L=1);for(m=0;m<L-1;m++){var v=J[f.rowConditions.length-(L-1)+m],G=OAT.Dom.create("td",{},"even");
if(v.value!=f.EmptyValue){if(!t[0]||f.autoPaging){G.innerHTML=f.defaultPictureValue(v.value,false,m);G=f.applyConditionalFormats(G,v.value,false,m);f.setClickEventHandlers(G,v.value,"MEASURE",m,v)}}else G.innerHTML="";t[0]&&!r[m]&&(r[m]=G);A[m]||(A[m]=[]);A[m].append([[v.value,[J[J.length-1].row!=void 0?J[J.length-1].row:v.row]]]);f.colConditions.length===0&&l.appendChild(G)}if(f.colConditions.length&&k==0&&f.options.headingBefore){w=OAT.Dom.create("th");if(f.rowConditions.length)w.style.border="none";
else{f._drawCorner(w,true);w.conditionIndex=-2}w.rowSpan=f.rowStructure.span;w.hidden=true}for(var E=false,m=[],O=0;O<L-1;O++)m[O]=[];for(u=0;u<f.w;u++){var Q=f.tabularData[u][k][0],O=false;try{O=Q=="#NaV#"&&f.tabularData[u][k][1].length>0}catch(T){}if(f.colConditions.length>0)for(var P=0;P<L-1;P++){G=OAT.Dom.create("td",{},f.getClassName(k,u));if(Q!=f.EmptyValue||O){var S=getValueMeasureFromMeasureList(A,f.tabularData[u][k][1][0],P,f.filteredData,x.length);G.innerHTML=f.defaultPictureValue(S,false,
P);G=f.applyConditionalFormats(G,S,false,P);f.setClickEventHandlers(G,S,"MEASURE",P,f.tabularData[u][k][1]);for(var U=false,X=0;X<j.length;X++)if(j[X][2]===u){S=="#NuN#"?j[X][0][P].push(["#NuN#",99]):S=="#FoE#"?W[P].append([["#FoE#",99]]):j[X][0][P].push([parseFloat(S),99]);j[X][3].append(f.tabularData[u][k][1].slice());U=true}if(!U){for(var W=[],U=0;U<L-1;U++)W[U]=[];S=="#NuN#"?W[P].append([["#NuN#",99]]):S=="#FoE#"?W[P].append([["#FoE#",99]]):W[P].append([[parseFloat(S),99]]);j.append([[W,P,u,f.tabularData[u][k][1].slice()]])}isNaN(parseFloat(S))||
m[P].push(parseFloat(S))}else G.innerHTML="";if(h.indexOf(u)!=-1)G.innerHTML="";g.indexOf(u)==-1&&l.appendChild(G)}G=OAT.Dom.create("td",{},f.getClassName(k,u));if(g.indexOf(u)==-1){if(Q!=f.EmptyValue&&x.length>0){G.innerHTML=f.defaultPictureValue(Q.toString(),true,0);G=f.applyConditionalFormats(G,Q.toString(),true,0);f.setClickEventHandlers(G,Q,"MEASURE",L-1,f.tabularData[u][k][1])}else G.innerHTML="";if((h.indexOf(u)!=-1||t[0])&&!f.autoPaging){o||(o=G);E||(E=G);G.innerHTML=""}x.length>0&&l.appendChild(G)}if(x.length>
0&&f.colPointers.length>0)for(v=f.colPointers[f.colPointers.length-1][u].parent;v.parent;){y=v.parent;for(O=false;y!=void 0;){O=v.parent.collapsed!=void 0&&v.parent.collapsed?true:false;y=y.parent}if(!O){B=f.conditions[f.colConditions[v.depth]];if(v.offset+v.spanData-1==u){G=OAT.Dom.create("td",{},"subtotal");if(v.totals[k].value>0){G.innerHTML=f.defaultPictureValue(v.totals[k].value.toString(),true,0);G=f.applyConditionalFormats(G,v.totals[k].value.toString(),true,0);f.setClickEventHandlers(G,v.totals[k].value.toString(),
"MEASURE",L-1,v);if(E!=false){E.innerHTML=f.defaultPictureValue(v.totals[k].value.toString(),true,0);E=false}}else G.innerHTML="";B.subtotals&&l.appendChild(G)}}v=v.parent}}if(f.options.totals&&f.colConditions.length){if(f.colConditions.length>0)for(P=0;P<L-1;P++){G=OAT.Dom.create("td",{},"total");for(E=A=0;E<m[P].length;E++)isNaN(m[P][E])||(A=parseFloat(m[P][E])+A);G.innerHTML=f.defaultPictureValue(A.toString(),false,P);G=f.applyConditionalFormats(G,A.toString(),false,P);f.setClickEventHandlers(G,
A.toString(),"MEASURE",P,["PtrTotals",f.rowTotals[1][k]]);l.appendChild(G)}if(f.rowConditions.length){G=OAT.Dom.create("td",{},"total");if(isNaN(f.rowTotals[0][k]))G.innerHTML="-";else{G.innerHTML=f.defaultPictureValue(f.rowTotals[0][k].toString(),true,0);G=f.applyConditionalFormats(G,f.rowTotals[0][k].toString(),true,0);f.setClickEventHandlers(G,f.rowTotals[0][k].toString(),"MEASURE",L-1,["PtrTotals",f.rowTotals[1][k]]);if((h.indexOf(u)!=-1||t[0])&&!f.autoPaging)o&&(q||(q=G))}x.length>0&&l.appendChild(G)}else f._drawGTotal(l)}if(f.colConditions.length&&
k==0&&f.options.headingAfter){w=OAT.Dom.create("th");if(f.rowConditions.length)w.style.border="none";else{f._drawCorner(w,true);w.conditionIndex=-2}w.rowSpan=f.rowStructure.span+(f.options.totals&&f.rowConditions.length?1:0);l.appendChild(w)}if((!t[0]||t[2])&&!n){f.appendRowToTable(c,l,false);t[2]=false}var V=f.rowConditions.length-2;z&&(f.rowConditions.length-2>=0&&J[f.rowConditions.length-2]!=void 0&&J[f.rowConditions.length-2].items!=void 0&&J[f.rowConditions.length-2].items.length<=1&&f.colConditions.length<=
0)&&(V=f.rowConditions.length-2-(L-1));f.rowConditions.length-(x.length-1)<=0&&(V=-1);for(u=V;u>=0;u--){var v=J[u],B=f.conditions[f.rowConditions[v.depth]],aa=f.rowConditions.indexOf(v.conditionNumber)+1,Z=f.rowConditions.length-x.length+1;if(v.offset+v.spanData-1==k&&(H.length<2||f.colConditions.length!=0||u<H.length-1)&&(f.colConditions.length==0||aa<Z)&&(!f.autoPaging||f.colConditions.length==0)){var ba;if(f.autoPaging){var ma=getDataRowFromItem(v);ba=getTotalsForDataRow(f.GeneralDataRows,ma,L,
f.conditions,f.filterIndexes,f.allData,f.filterDiv.selects,f)}l=OAT.Dom.create("tr");w=OAT.Dom.create("th",{},"h2subtitle");w.colSpan=K-u;w.innerHTML=v.value!="#NuN#"?gx.getMessage("GXPL_QViewerJSTotalFor")+" "+v.value:gx.getMessage("GXPL_QViewerJSTotalFor")+"  ";l.appendChild(w);if(!f.autoPaging&&z)for(m=0;m<L-1;m++){if(f.colConditions.length===0){var pa=false;if(!t[0]||t[2]||!(t[3]!=v&&u>=t[1]))pa=r;m>0?f._drawRowSubtotalsForMeasures(l,k,v,m,u,void 0,pa):f._drawRowSubtotalsForMeasures(l,k,v,m,u,
w,pa)}A=0}I=f.concatToGrandTotal(I,j);if(x.length>0)if(f.autoPaging)ba&&f._drawRowSubtotalsAutoPaging(l,ba);else{pa=o;t[0]&&!t[2]&&t[3]!=v&&u>=t[1]?pa=false:o=false;if(pa){f._drawRowSubtotals(l,k,v,j,pa,aa,q);q=false}else f._drawRowSubtotals(l,k,v,j,pa,aa,false)}(!f.autoPaging||ba)&&(!t[0]||t[2]||!(t[3]!=v&&u>=t[1]))&&B.subtotals&&f.appendRowToTable(c,l,false)}}if(V===-1){I=f.concatToGrandTotal(I,j);j=[]}else if(f.rowConditions.length-x.length==0){I=f.concatToGrandTotal(I,j);j=[]}}}catch(ca){}if(x.length>
0&&(!f.autoPaging||f.colConditions.length==0)){if(f.options.totals&&f.rowConditions.length&&(!f.autoPaging||f.TotalPagesPaging==f.actualPaginationPage)){l=OAT.Dom.create("tr");if(K!=0){w=OAT.Dom.create("th",{},"h2subtitle");w.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");w.colSpan=K;l.appendChild(w)}u=[];f.autoPaging&&(u=sumGrandPagingTotals(this.GeneralDataRows,f.conditions,x.length,f.formulaInfo,f));if(z)for(m=0;m<x.length-1;m++){numCol=f.rowConditions.length-(x.length-1)+m;G=OAT.Dom.create("td",
{},"gtotal");z=this.rowPointers[numCol];A=0;v=[];for(k=0;k<z.length;k++){if(f.formulaInfo.measureFormula[m].hasFormula){w=z[k];for(y=0;y<m;y++)w=w.parent;v.push(f.getFormulaRowByCoord(w,false,m,"MeasureInRows"))}OATIsNotEmptyValue(z[k].value)&&(A=A+parseFloat(z[k].value))}if(!f.autoPaging){f.formulaInfo.measureFormula[m].hasFormula&&(A=f.calculateFormulaTotal(v,m,"MeasureInRows"));u[m]=A}if(f.colConditions.length===0){if(f.autoPaging)if(isNaN(A))G.innerHTML="";else{G.innerHTML=f.defaultPictureValue(u[m].toString(),
false,m);G=f.applyConditionalFormats(G,u[m].toString(),false,m)}else if(isNaN(A))G.innerHTML="";else{G.innerHTML=f.defaultPictureValue(A.toString(),false,m);G=f.applyConditionalFormats(G,A.toString(),false,m);f.setClickEventHandlers(G,A.toString(),"MEASURE",m,"GrandTotal");m==0&&f.setClickEventHandlers(G,gx.getMessage("GXPL_QViewerJSTotal"),"DIMENSION",m,"GrandTotal")}l.appendChild(G)}}f._drawRowTotals(l,u,I,g);f.appendRowToTable(c,l,false)}f.rowConditions.length&&f.options.headingAfter&&f._drawRowConditionsHeadings(c)}};
this.drawTableWhenServerPagination=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=OAT.Dom.create("table",{},"");c.id=f.controlName+"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");h.setAttribute("class","divIeContainer");
f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],[f.div,g]);f.countedRows=0;var j;if(f.colConditions.length>0){var k=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);for(j=0;j<f.colConditions.length;j++)l=f._drawColConditionsHeadingsCustom(l,j,j===f.colConditions.length-1);f.appendRowToTable(c,l,true);j=l}try{for(k=0;k<f.colConditions.length;k++){for(var l=OAT.Dom.create("tr"),m=0;m<f.pageData.columnsHeaders.length;)if(f.pageData.columnsHeaders[m].subTotal){var n=
m>=f.pageData.columnsHeaders.length-x.length;f.ShowMeasuresAsRows&&(n=m>=f.pageData.columnsHeaders.length-1);if(n){if(k==0){r=OAT.Dom.create("th",{},"h2subtitle");r.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");r.rowSpan=f.colConditions.length;if(!f.ShowMeasuresAsRows)r.colSpan=x.length;l.appendChild(r)}}else if(k<f.pageData.columnsHeaders[m].subHeaders.length){r=OAT.Dom.create("th",{},"h2subtitle ");q=f.pageData.columnsHeaders[m].subHeaders[k].value;r.innerHTML=gx.getMessage("GXPL_QViewerJSTotalFor")+
" "+q.trimpivot();r.rowSpan=f.colConditions.length-k;if(!f.ShowMeasuresAsRows)r.colSpan=x.length;l.appendChild(r)}f.ShowMeasuresAsRows?m++:m=m+x.length}else{for(var o=1,q=f.pageData.columnsHeaders[m].subHeaders[k].value;m+1<f.pageData.columnsHeaders.length&&(!f.pageData.columnsHeaders[m+1].subTotal||k<f.pageData.columnsHeaders[m+1].subHeaders.length-1)&&f.pageData.columnsHeaders[m+1].subHeaders[k].value==q;){o++;m++}m++;var r=OAT.Dom.create("th",{},"even");r.colSpan=o;r.innerHTML=f.dimensionPictureValue(q.trimpivot(),
f.colConditions[k]);r=f.applyFormatValues(r,q.trimpivot(),f.colConditions[k]);l.appendChild(r)}f.appendRowToTable(c,l,true)}if(f.colConditions.length>0){if(f.pageData.columnsHeaders.length-f.colConditions.length>0){r=OAT.Dom.create("th",{},"h2subtitle ");r.innerHTML="";r.colSpan=f.pageData.columnsHeaders.length-f.colConditions.length;r.style.borderLeftColor="transparent";j.appendChild(r)}if(!f.ShowMeasuresAsRows){l=OAT.Dom.create("tr");for(m=0;m<f.pageData.columnsHeaders.length/x.length;m++)for(n=
0;n<x.length;n++){r=OAT.Dom.create("th",{},"h2titlewhite");r.colSpan=1;r.innerHTML=x[n].attributes.getNamedItem("displayName").nodeValue;f.setTitleTexrtAlign(r,r.innerHTML);l.appendChild(r)}f.appendRowToTable(c,l,true)}}if(f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0)f._drawRowConditionsHeadings(c);else if(f.rowConditions.length==0&&f.options.headingBefore&&f.colConditions.length===0)try{f._drawRowConditionsHeadings(c)}catch(t){}o=x.length>1?f.rowConditions.length-(x.length-
1):f.rowConditions.length;for(k=0;k<f.pageData.rows.length;k++){for(var l=OAT.Dom.create("tr"),u=f.pageData.rows[k],m=0;m<u.headers.length;m++){var v=u.headers[m];if(v.rowSpan>0){r=OAT.Dom.create("th",{},"even");r.rowSpan=v.rowSpan;r.innerHTML=f.dimensionPictureValue(v.value.trimpivot(),f.rowConditions[m]);r=f.applyFormatValues(r,v.value,f.rowConditions[m]);f.setClickEventHandlers(r,v.value,"DIMENSION",f.rowConditions[m],{cell:m,row:u});if(m<f.rowConditions.length-(x.length-1)-1&&!f.ShowMeasuresAsRows)var w=
f.conditions[f.rowConditions[m]].collapsedValues.indexOf(v.value)!=-1,r=f.addExpandCollapseFunctionality(r,v,m,!w,true);l.appendChild(r)}}if(u.headers.length<f.rowConditions.length-(x.length-1))for(var A=f.rowConditions.length-(x.length-1)-u.headers.length,n=0;n<A;n++){r=OAT.Dom.create("th",{},"even");r.innerHTML="";l.appendChild(r)}if(f.ShowMeasuresAsRows){var y=OAT.Dom.create("td",{},"even"),E=f.getMeasureName(u.dataField,x);y.innerHTML=E;y.style.textAlign="left";f.setClickEventHandlers(y,E,"MEASURE",
getMeasureNumberByName(E,x),"GrandTotal");l.appendChild(y)}var C=x.length;C===0&&(C=1);if(u.subTotal){l=OAT.Dom.create("tr");if(u.headers.length==0){r=OAT.Dom.create("th",{},"h2subtitle");r.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");r.colSpan=o}else{if(k==0)for(n=0;n<u.headers.length-1;n++){v=u.headers[n];r=OAT.Dom.create("th",{},"even");r.rowSpan=v.rowSpan;r.innerHTML=f.dimensionPictureValue(v.value.trimpivot(),f.rowConditions[n]);r=f.applyFormatValues(r,v.value,f.rowConditions[n]);f.setClickEventHandlers(r,
v.value,"DIMENSION",f.rowConditions[n],{cell:n,row:u,isTotal:false});l.appendChild(r)}r=OAT.Dom.create("th",{},"h2subtitle");r.colSpan=o-(u.headers.length-1);B=u.headers[u.headers.length-1].value.trimpivot();r.innerHTML=B=="#NuN#"?gx.getMessage("GXPL_QViewerJSTotalFor")+" "+f.defaultPicture.getAttribute("textForNullValues"):gx.getMessage("GXPL_QViewerJSTotalFor")+" "+B;f.setClickEventHandlers(r,gx.getMessage("GXPL_QViewerJSTotalFor")+" "+v.value,"DIMENSION",getMeasureNumberByName(v.dataField,H),["PtrTotals",
B,u,-1])}if(f.ShowMeasuresAsRows){if(u.rowSpan>0){r.rowSpan=u.rowSpan;l.appendChild(r)}}else l.appendChild(r);if(f.ShowMeasuresAsRows){y=OAT.Dom.create("td",{},"gtotal");E=f.getMeasureName(u.dataField,x);y.innerHTML=E;y.style.textAlign="left";l.appendChild(y)}for(n=0;n<u.cells.length;n++){B=u.cells[n].value;F=f.getMeasureNumber(u.cells[n].dataField,x);y=OAT.Dom.create("td",{},"gtotal");y.innerHTML=f.defaultPictureValue(B,false,F);y=f.applyConditionalFormats(y,B,false,F);u.headers.length==0&&f.colConditions.length==
0?f.setClickEventHandlers(y,B,"MEASURE",F,"GrandTotal"):f.setClickEventHandlers(y,B,"MEASURE",C-1,["PtrTotals",B,u,n]);l.appendChild(y)}}else for(n=0;n<u.cells.length;n++){var B=u.cells[n].value;if(f.colConditions.length>0&&f.pageData.columnsHeaders[n].subTotal){y=OAT.Dom.create("td",{},"subtotal");if(B!=f.EmptyValue){var F=f.getMeasureNumber(u.cells[n].dataField,x);y.innerHTML=f.defaultPictureValue(B,false,F);y=f.applyConditionalFormats(y,B,false,F);f.setClickEventHandlers(y,B,"MEASURE",F,["PtrTotals",
B,u,n])}else y.innerHTML=""}else{y=OAT.Dom.create("td",{},"even");if(B!=f.EmptyValue){F=f.getMeasureNumber(u.cells[n].dataField,x);y.innerHTML=f.defaultPictureValue(B,false,F);y=f.applyConditionalFormats(y,B,false,F);f.setClickEventHandlers(y,B,"MEASURE",F,{cell:n,row:u})}else y.innerHTML=""}l.appendChild(y)}f.appendRowToTable(c,l,false)}}catch(z){}};this.drawTableWhenShowMeasuresAsRows=function(){OAT.Dom.clear(f.div);f.div.setAttribute("class","conteiner_table_div");var c=OAT.Dom.create("table",
{},"");c.id=f.controlName+"_"+f.query+"_toolbar";OAT.Dom.create("tbody");OAT.Dom.create("tr");f.div.appendChild(c);var g=OAT.Dom.create("table",{},"pivot_table");g.id=this.controlName+"_"+this.query;c=OAT.Dom.create("tbody");f.drawFilters();f.countedRows=0;if(gx.util.browser.isIE()){var h=document.createElement("div");h.setAttribute("class","divIeContainer");f.div.appendChild(h);OAT.Dom.append([g,c],[h,g]);g.style.marginBottom="0px"}else OAT.Dom.append([g,c],[f.div,g]);if(f.autoPaging&&f.allData.length<
f.filteredData.length&&f.colPointers.length>1)f.allData=f.filteredData;else if(f.autoPaging&&f.filteredData.length>f.allData.length&&f.colPointers.length===0)f.filteredData=f.allData;var j,g=f.colConditions.length;if(f.colConditions.length>0){var k=0,l=OAT.Dom.create("tr");f._drawRowConditionsHeadingsCustom(l);for(j=0;j<f.colConditions.length;j++)l=f._drawColConditionsHeadingsCustom(l,j,j===f.colConditions.length-1);l.setAttribute("title_row",true);f.appendRowToTable(c,l,true);j=l}try{for(var h=0-
g,m=[false,0,0],n=[],o=[],g=[],k=0;k<x.length;k++)g[k]=false;for(k=0;k<f.colConditions.length;k++){for(var l=OAT.Dom.create("tr"),q=f.colPointers[k],r=0;r<q.length;r++){var t=q[r],u=OAT.Dom.create("th",{},"even");if(t.span===0)t.span=1;u.colSpan=t.span;k==0&&(t.span===0?h++:h=h+t.span*x.length);u.innerHTML=f.dimensionPictureValue(t.value,f.colConditions[k]);for(var u=f.applyFormatValues(u,t.value,f.colConditions[k]),v=t,w=false,y=false;v.parent;){if(v.parent.collapsed==void 0){m[0]=false;break}if(v.parent.collapsed){if(!m[0]||
v.parent!=m[1]){y=true;k==f.colConditions.length-1&&o.append(r)}else m[2]++;k==f.colConditions.length-1&&!y&&n.append(r);m[0]=true;m[1]=v.parent;u.innerHTML="";w=true;u.colSpan=1;break}else v=v.parent}(!w||y)&&l.appendChild(u)}if(f.options.totals&&k==0){u=OAT.Dom.create("th",{},"h2subtitle");u.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");u.rowSpan=f.colConditions.length;if(f.colConditions.length>0){u.colSpan=x.length;h=h+f.colConditions.length+(x.length-1)}else h=h+f.colConditions.length;totalSpan=
f.colConditions.length;l.appendChild(u)}f.options.headingAfter&&f._drawColConditionsHeadings(l,k);l.setAttribute("title_row",true);f.appendRowToTable(c,l,true)}if(h>2){u=OAT.Dom.create("th",{},"h2subtitle ");u.innerHTML="";if(h<1E3)u.colSpan=h;u.style.borderLeftColor="transparent";j.appendChild(u)}f.rowConditions.length&&f.options.headingBefore&&f.colConditions.length===0&&f._drawRowConditionsHeadings(c);var A;A=x.length>1?f.rowConditions.length-(x.length-1):f.rowConditions.length;j=[false,9999,true,
0];h=[];for(o=0;o<x.length;o++){h[o]=[];h[o][0]=[]}q=[];for(o=0;o<x.length;o++){q[o]=[];q[o][0]=[]}m=[];for(o=0;o<f.recordForFormula.length;o++)m[o]=f.recordForFormula[o];n=[];if(f.colConditions.length>0){n=[];for(o=0;o<f.allData.length;o++)n[o]=f.allData[o]}o=[];for(k=0;k<f.h;k++){l=OAT.Dom.create("tr");if(f.rowConditions.length)for(var E=f.rowConditions.length-(x.length-1),t=f.rowPointers[E][k],B=[],C=t;C.parent;){B.unshift(C);C=C.parent}else B=[f.rowPointers[0][0]];C=-1;for(r=0;r<f.rowConditions.length-
(x.length-1);r++){t=B[r];if(t!=void 0&&t.offset==k){C==-1&&(C=r);var F=f.conditions[f.rowConditions[r]].collapsedValues.indexOf(t.value)!=-1;r>=f.rowConditions.length-(x.length-1)-1&&(F=false);u=OAT.Dom.create("th",{},"even");if(!j[0]||j[1]>=r){u.rowSpan=B[r].span;u.innerHTML=f.dimensionPictureValue(t.value,f.rowConditions[r]);u=f.applyFormatValues(u,t.value,f.rowConditions[r]);f.setClickEventHandlers(u,t.value,"DIMENSION",f.rowConditions[r],t)}else{u.rowSpan=1;u.innerHTML=""}if(j[1]>=r){j[0]=F;j[3]=
t;j[1]=F?r:9999;j[2]=true}l.appendChild(u)}}var H=x.length;H===0&&(H=1);var z=OAT.Dom.create("td",{},"even"),t=B[f.rowConditions.length-(H-1)];if(t.value!=f.EmptyValue){if(!j[0]){z.innerHTML=t.value;z.style.textAlign="left";f.setClickEventHandlers(z,t.value,"MEASURE",getMeasureNumberByName(G,x),"GrandTotal")}}else z.innerHTML="";l.appendChild(z);var v=[],C=[],G=t.value,I=getMeasureNumberByName(G,x);if(f.colConditions.length==0){var J=t.items[0],z=OAT.Dom.create("td",{},"even");if(J!=f.EmptyValue){if(!j[0]){z.innerHTML=
f.defaultPictureValue(J.value,false,I);z=f.applyConditionalFormats(z,J.value,false,I);f.setClickEventHandlers(z,J.value,"MEASURE",I,[Math.floor(t.row/x.length)]);if(f.formulaInfo.measureFormula[I].hasFormula){var K=f.getFormulaRowByCoord(t,[],I,"MeasureInRows",m);if(K!=f.EmptyValue){q[I][0].push(K);h[I][0].push([K,-1])}}else{var L=J.value!="#NuN#"?parseFloat(J.value):"#NuN#";q[I][0].push(L);h[I][0].push([L,-1])}}}else z.innerHTML="";j[0]&&!g[ji]&&(g[ji]=z);v.append([[J.value,[J.row]]]);f.colConditions.length===
0&&l.appendChild(z)}else{var O=f.colPointers.length-1;f.colPointers[f.colPointers.length-1].length==0&&O--;if(f.colPointers[O]!=void 0){if(I==0){o.length>0&&!isNaN(o[0])&&n.splice(o[0],1);o=[]}for(r=0;r<f.colPointers[O].length;r++){var Q=f.colPointers[O][r],v=t,P;if(I>0)try{P=o[r]!=f.EmptyValue?[n[o[r]][f.headerRow.indexOf(G)],o[r]]:f.EmptyValue}catch(T){}else{P=f.getMeasureValueCoord(v,Q,f.headerRow.indexOf(G),n);P!=f.EmptyValue&&I==0?o.append(P[1]):I==0&&o.append(f.EmptyValue)}z=OAT.Dom.create("td",
{},"even");if(P!=f.EmptyValue){z.innerHTML=f.defaultPictureValue(P[0],false,I);z=f.applyConditionalFormats(z,P[0],false,I);f.setClickEventHandlers(z,P[0],"MEASURE",I,[P[1]]);var S=parseFloat(P[0]);P[0]=="#NuN#"&&(S="#NuN#");if(f.formulaInfo.measureFormula[I].hasFormula){S=f.getFormulaRowByCoord(v,Q,I,"MeasureInRows",m);S==f.EmptyValue&&(S=NaN)}q[I][r]==void 0?q[I][r]=[S]:q[I][r].push(S);h[I][r]==void 0?h[I][r]=[[S,-1]]:h[I][r].push([S,-1]);C.push(S)}else{z.innerHTML="";q[I][r]==void 0?q[I][r]=[0]:
q[I][r].push(0);h[I][r]==void 0?h[I][r]=[[NaN,-1]]:h[I][r].push([NaN,-1])}l.appendChild(z)}}}if(f.colConditions.length&&k==0&&f.options.headingAfter){u=OAT.Dom.create("th");if(f.rowConditions.length)u.style.border="none";else{f._drawCorner(u,true);u.conditionIndex=-2}u.rowSpan=f.rowStructure.span+(f.options.totals&&f.rowConditions.length?1:0);l.appendChild(u)}if(!j[0]||j[2]){f.appendRowToTable(c,l,false);j[2]=false}if(f.options.totals&&f.colConditions.length){z=OAT.Dom.create("td",{},"total");Z=0;
if(C.length>0)if(f.formulaInfo.measureFormula[getMeasureNumberByName(G,x)].hasFormula)Z=f.calculateFormulaTotal(C,getMeasureNumberByName(G,x),"MeasureInRows");else{Z=C.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(Z)&&(Z!="#NuN#"&&Z!="#FoE#")&&(Z=0)}if(Z!=0){z.innerHTML=f.defaultPictureValue(Z.toString(),false,getMeasureNumberByName(G,x));z=f.applyConditionalFormats(z,Z.toString(),false,getMeasureNumberByName(G,x))}else z.innerHTML="";l.appendChild(z)}C=
[];if(f.options.totals&&f.rowConditions.length-(x.length-1)>1)for(var U=f.rowConditions.length-(x.length-1)-2;U>=0;U--){v=false;if(k+1<f.rowPointers[E].length){for(var w=[],X=f.rowPointers[E][k+1];X.parent;){w.unshift(X);X=X.parent}for(y=U;y>=0;y--)w[y].value!=B[y].value&&(v=true)}else v=true;if(v=v&&f.conditions[f.rowConditions[U]].subtotals==1)for(v=0;v<x.length;v++){l=OAT.Dom.create("tr");if(v==0){u=OAT.Dom.create("th",{},"h2subtitle");u.colSpan=f.rowConditions.length-(x.length-1)-U;u.rowSpan=
x.length;u.innerHTML=gx.getMessage("GXPL_QViewerJSTotalFor")+" "+B[U].value;l.appendChild(u)}z=OAT.Dom.create("td",{},"total");P=x[v].getAttribute("displayName");z.innerHTML=P;z.style.textAlign="left";f.setClickEventHandlers(z,P,"MEASURE",v,"GrandTotal");l.appendChild(z);if(f.colConditions.length==0){for(var z=OAT.Dom.create("td",{},"total"),W=[],V=0;V<h[v][0].length;V++)if(h[v][0][V][1]==-1||h[v][0][V][1]>U)if(!isNaN(h[v][0][V][0])||h[v][0][V][0]=="#NuN#"||f.formulaInfo.measureFormula[v].hasFormula){W.push(h[v][0][V][0]);
h[v][0][V][1]=U}var Z=0;if(W.length!=0)if(f.formulaInfo.measureFormula[v].hasFormula)Z=f.calculateFormulaTotal(W,v,"MeasureInRows");else{Z=f.IsReduceNuN(W)?"#NuN#":W.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(Z)&&(Z!="#NuN#"&&Z!="#FoE#")&&(Z=0)}C.push(parseFloat(Z));if(Z!=0){z.innerHTML=f.defaultPictureValue(Z.toString(),false,v);z=f.applyConditionalFormats(z,Z.toString(),false,v)}else z.innerHTML="";l.appendChild(z)}else{O=f.colPointers.length-1;
f.colPointers[f.colPointers.length-1].length==0&&O--;if(f.colPointers[O]!=void 0)for(w=0;w<f.colPointers[O].length;w++){z=OAT.Dom.create("td",{},"total");W=[];for(V=0;V<h[v][w].length;V++)if(h[v][w][V][1]==-1||h[v][w][V][1]>U)if(!isNaN(h[v][w][V][0])||h[v][w][V][0]=="#NuN#"||f.formulaInfo.measureFormula[v].hasFormula){W.push(h[v][w][V][0]);h[v][w][V][1]=U}Z=0;if(W.length!=0)if(f.formulaInfo.measureFormula[v].hasFormula)Z=f.calculateFormulaTotal(W,v,"MeasureInRows");else{Z=f.IsReduceNuN(W)?"#NuN#":
W.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c});isNaN(Z)&&(Z!="#NuN#"&&Z!="#FoE#")&&(Z=0)}if(Z!=0&&(!isNaN(Z)||Z=="#NuN#"||Z=="#FoE#")){f.formulaInfo.measureFormula[v].hasFormula?C.append(W):C.push(parseFloat(Z));z.innerHTML=f.defaultPictureValue(Z.toString(),false,v);z=f.applyConditionalFormats(z,Z.toString(),false,v)}else z.innerHTML="";l.appendChild(z)}if(f.colConditions.length){z=OAT.Dom.create("td",{},"gtotal");Z=0;C.length!=0&&(Z=f.formulaInfo.measureFormula[v].hasFormula?
f.calculateFormulaTotal(C,v,"MeasureInRows"):f.IsReduceNuN(C)?"#NuN#":C.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));z.innerHTML=f.defaultPictureValue(Z.toString(),false,v);z=f.applyConditionalFormats(z,Z.toString(),false,v);l.appendChild(z);C=[]}}f.appendRowToTable(c,l,false)}}}if(x.length>0&&f.rowConditions.length-x.length+1>0&&f.options.totals&&f.rowConditions.length&&(!f.autoPaging||f.TotalPagesPaging==f.actualPaginationPage||f.FilterByTopFilter))for(k=
0;k<x.length;k++){l=OAT.Dom.create("tr");if(A!=0&&k==0){u=OAT.Dom.create("th",{},"h2subtitle");u.innerHTML=gx.getMessage("GXPL_QViewerJSTotal");u.colSpan=A;u.rowSpan=x.length;l.appendChild(u)}z=OAT.Dom.create("td",{},"gtotal");P=x[k].getAttribute("displayName");if(P!=f.EmptyValue){z.innerHTML=P;z.style.textAlign="left";f.setClickEventHandlers(z,P,"MEASURE",k,"GrandTotal")}else z.innerHTML="";l.appendChild(z);C=[];if(f.colConditions.length==0){z=OAT.Dom.create("td",{},"gtotal");Z=0;q[k][0].length>
0&&(Z=f.formulaInfo.measureFormula[k].hasFormula?f.calculateFormulaTotal(q[k][0],k,"MeasureInRows"):f.IsReduceNuN(q[k][0])?"#NuN#":q[k][0].reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));if(!isNaN(Z)||Z=="#NuN#"||Z=="#FoE#"){z.innerHTML=f.defaultPictureValue(Z.toString(),false,k);z=f.applyConditionalFormats(z,Z.toString(),false,k)}else z.innerHTML="";l.appendChild(z)}else{O=f.colPointers.length-1;f.colPointers[f.colPointers.length-1].length==0&&O--;if(f.colPointers[O]!=
void 0)for(r=0;r<f.colPointers[O].length;r++){z=OAT.Dom.create("td",{},"gtotal");Z=0;q[k][r]!=void 0&&q[k][r].length>0&&(Z=f.formulaInfo.measureFormula[k].hasFormula?f.calculateFormulaTotal(q[k][r],k,"MeasureInRows"):f.IsReduceNuN(q[k][r])?"#NuN#":q[k][r].reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));if(!isNaN(Z)||Z=="#NuN#"||Z=="#FoE#"){z.innerHTML=f.defaultPictureValue(Z.toString(),false,k);z=f.applyConditionalFormats(z,Z.toString(),false,k)}else z.innerHTML=
"";l.appendChild(z);f.formulaInfo.measureFormula[k].hasFormula?C.append(q[k][r]):isNaN(Z)||C.push(parseFloat(Z))}}if(f.options.totals&&f.colConditions.length){z=OAT.Dom.create("td",{},"gtotal");Z=0;C.length!=0&&(Z=f.formulaInfo.measureFormula[k].hasFormula?f.calculateFormulaTotal(C,k,"MeasureInRows"):f.IsReduceNuN(C)?"#NuN#":C.reduce(function(c,f){return!isNaN(c)&&!isNaN(f)?c+f:isNaN(c)&&isNaN(f)?0:isNaN(c)?f:c}));z.innerHTML=f.defaultPictureValue(Z.toString(),false,k);z=f.applyConditionalFormats(z,
Z.toString(),false,k);l.appendChild(z)}f.appendRowToTable(c,l,false)}}catch(aa){}};this.IsReduceNuN=function(c){isNuN=false;for(var f=0;f<c.length;f++){if(c[f]!="#NuN#"&&c[f]!=0)return false;c[f]=="#NuN#"&&(isNuN=true)}return isNuN};this.applyFilters=function(){f.filteredData=[];for(var c=0;c<f.allData.length;c++)f.filterOK(f.allData[c])&&f.filteredData.push(f.allData[c])};this.createTempDataStructForAggStepOptimization=function(){try{for(var c=0;c<f.GeneralDataRows.length;c++)for(var g=0;g<f.GeneralDataRows[0].length;g++)for(var h=
0;h<f.GeneralDataRows[0].length;h++){f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]]==void 0&&(f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]]=[]);f.TempDataStructForAggStepOptimization[f.GeneralDataRows[c][g]][f.GeneralDataRows[c][h]]=true}}catch(j){}};this.getMeasureValue=function(c,g,h){for(var j=c,c=[],k=[],l=0;l<h.length-x.length+1;l++)k[l]=h[h.length-x.length+1-(l+1)];for(l=0;l<k.length;l++){c[k[l]]=j.value;j=j.parent}var j="",m=false,n=f.allData;if(f.filterIndexes.length>
0)n=f.filteredData;for(l=0;l<n.length;l++){for(var o=false,q=0;q<k.length;q++)if(n[l][k[q]]==c[k[q]])o=true;else{o=false;break}if(o){j=n[l][h.length+f.filterIndexes.length-x.length+1+g];m=true;break}}return m?j:f.EmptyValue};this.getMeasureValueCoord=function(c,g,h,j){for(var k=[],l=[],m=0;m<f.rowConditions.length-x.length+1;m++)l[m]=f.rowConditions[f.rowConditions.length-x.length+1-(m+1)];for(m=f.colConditions.length-1;m>=0;m--){k[f.colConditions[m]]=g.value;g=g.parent}c=c.parent;for(m=0;m<l.length;m++){k[l[m]]=
c.value;c=c.parent}l="";c=false;for(m=g=0;m<j.length;m++){for(var n=false,o=0;o<k.length;o++)if(j[m][o]==k[o])n=true;else if(k[o]==void 0&&f.filterIndexes.length>0)n=true;else{n=false;break}if(n){l=j[m][h];g=m;c=true;break}}return c?[l,g]:f.EmptyValue};this.getFormulaRowByCoord=function(c,g,h,j,k){for(var j=[],l=[],m=0;m<f.rowConditions.length-x.length+1;m++)l[m]=f.rowConditions[f.rowConditions.length-x.length+1-(m+1)];if(g)for(m=f.colConditions.length-1;m>=0;m--){j[f.colConditions[m]]=g.value;g=
g.parent}c=c.parent;for(m=0;m<l.length;m++){j[l[m]]=c.value;c=c.parent}for(m=0;m<f.filterIndexes.length;m++){c=OAT.$v(f.filterDiv.selects[m]);j[f.filterIndexes[m]]=c=="[all]"?void 0:c}for(var n=false,l=k!=void 0?k:f.recordForFormula,c=[],g=[],m=0;m<f.formulaInfo.recordDataLength;m++)g[m]=0;for(m=0;m<l.length;m++){for(var o=false,q=0;q<j.length;q++)if(l[m][q]==j[q])o=true;else if(j[q]==void 0&&f.filterIndexes.indexOf(q)!=-1)o=true;else{o=false;break}if(o){for(n=0;n<f.formulaInfo.measureFormula[h].relatedMeasures.length;n++){o=
f.formulaInfo.measureFormula[h].relatedMeasures[n];if(l[m][o]==void 0)g[o]==0&&(g[o]="#NuN#");else{g[o]=="#NuN#"&&(g[o]=0);g[o]=g[o]+parseFloat(l[m][o])}}n=true;c.append(m)}}if(n){if(f.formulaInfo.cantFormulaMeasures==1)for(h=0;h<c.length;h++)k.splice(c[h],1);return g}return f.EmptyValue};this.calculateFormulaTotal=function(c,g){try{var h=[];if(c.length==0)return"#NuN#";for(var j=0;j<c.length;j++)if(c[j]!=f.EmptyValue&&c[j]!=0&&(c[j]!="#NuN#"||f.ShowMeasuresAsRows))for(var k=0;k<c[j].length;k++){h[k]==
void 0&&(h[k]=0);if(!isNaN(c[j][k])&&c[j][k]!="#NuN#"){h[k]=="#NuN#"&&(h[k]=0);h[k]=h[k]+c[j][k]}c[j][k]=="#NuN#"&&h[k]==0&&(h[k]="#NuN#")}if(f.ShowMeasuresAsRows){if(h.length==0)return NaN}else if(h.length==0)return"#NuN#";var l=EvaluateExpressionPivotJs(f.formulaInfo.measureFormula[g].PolishNotation,h,f.formulaInfo);return l==Infinity||isNaN(l)?"#FoE#":l}catch(m){return f.EmptyValue}};this.addToStack=function(c,g,h,j){if(f.GeneralDataRows.length>3E3||c<1||g.value==void 0)return true;var k=f.conditions[j[c]].dataRowPosition,
c=f.conditions[j[c-1]].dataRowPosition;if(f.allData.length>800&&f.filterIndexes.length>0)return true;for(j=0;j<f.allData.length;j++)if(f.allData[j][k]==h&&g.value==f.allData[j][c])return true;if(!f.autoPaging||f.rowConditions.length<8)for(j=0;j<f.GeneralDataRows.length;j++)if(f.GeneralDataRows[j][k]==h&&g.value==f.GeneralDataRows[j][c])return true;return false};this.createAggStructure=function(){function c(g,h,j,k){g.items=false;g.depth=-1;var g=[g],l=h.length;f.ShowMeasuresAsRows&&j&&(l=l-(x.length-
1));for(var m=0;m<l;m++){var n=f.conditions[h[m]],o=f.conditions[h[m]].dataRowPosition,q=n.sort;if(m>=1&&!f.autoPaging&&f.rowConditions.length>16&&f.GeneralDataRows.length>1200){n=f.conditions[h[m-1]];o=f.conditions[h[m-1]].dataRowPosition;q=n.sort}if(q!=0&&q!=2){for(var D=true,r=0;r<n.distinctValues.length;r++)if(D&&n.distinctValues[r]!=parseInt(n.distinctValues[r])){D=false;break}D?k.sort(function(c){return function(f,g){return q*(parseInt(f[c])===parseInt(g[c])?0:parseInt(f[c])<parseInt(g[c])?
-1:1)}}(o)):k.sort(function(c){return function(f,g){return q*(f[c]===g[c]?0:f[c]<g[c]?-1:1)}}(o))}var o=[],t=n.distinctValues.length;if(m>=1&&!f.autoPaging&&f.rowConditions.length>16&&f.GeneralDataRows.length>1200)for(var t=f.conditions[h[m]].dataRowPosition,u=[],r=0;r<g.length;r++){for(var v=[],M=0;M<k.length;M++){var w=k[M][t],N=f.addToStack3(m,g[r],k[M],h,q,D);if(N=="break")break;if(u.indexOf(w)==-1&&N){u.push(w);N=false;n.collapsedValues.indexOf(w)!=-1&&(N=true);w={value:w,parent:g[r],used:false,
items:false,depth:m,collapsed:N,conditionNumber:h[m]};v.push(w);o.push(w)}}u=[];g[r].items=v}else for(r=0;r<g.length;r++){v=[];M=[0];for(u=0;u<t;u++){var w=n.distinctValues[u];if(n.blackList.findIndex(w)==-1&&f.addToStack2(m,g[r],w,h,k,M,q,D)){N=false;n.collapsedValues.indexOf(w)!=-1&&(N=true);w={value:w,parent:g[r],used:false,items:false,depth:m,collapsed:N,conditionNumber:h[m]};v.push(w);o.push(w)}}g[r].items=v}g=o}if(f.ShowMeasuresAsRows&&j){o=[];for(r=0;r<g.length;r++){v=[];t=x.length;for(u=0;u<
t;u++){j=x[u].getAttribute("displayName");N=false;w={value:j,parent:g[r],used:false,items:false,depth:l,collapsed:N};j=false;if(f.colConditions.length==0){k=f.getMeasureValue(g[r],u,h);if(k==f.EmptyValue)j=true;else{var y={value:k,parent:w,used:false,items:false,depth:l+1,collapsed:N};w.items=[];w.items.push(y)}}if(!j){v.push(w);f.colConditions.length==0?o.push(y):o.push(w)}}g[r].items=v}g=o}}for(var g=[],h=0;h<f.allData.length;h++)g.push(f.allData[h]);c(f.rowStructure,f.rowConditions,true,g);c(f.colStructure,
f.colConditions,false,g)};this.addToStack3=function(c,g,h,j,k,l){if(g.value==void 0)return true;var m=f.conditions[j[c-1]].dataRowPosition;if(g.value==h[m]){k=true;for(l=1;l<c;l++){m=f.conditions[j[c-1-l]].dataRowPosition;g=g.parent;if(g.value!=h[m]){k=false;break}}if(k)return true}else return k==0||k==2||k==1&&!l&&h[m]<=g.value||k==-1&&!l&&h[m]>=g.value||k==1&&l&&parseInt(h[m])<=parseInt(g.value)||k==-1&&l&&parseInt(h[m])>=parseInt(g.value)?false:"break"};this.addToStack2=function(c,g,h,j,k,l,m,
n){if(f.GeneralDataRows.length>3E3&&!f.autoPaging||c<1||g.value==void 0)return true;var o=f.conditions[j[c]].dataRowPosition,q=f.conditions[j[c-1]].dataRowPosition;if(f.allData.length>1E3&&f.filterIndexes.length>0&&f.rowConditions.length<8)return true;for(var r=true,t=l[0];t<k.length;t++)if(m==0||m==2||m==1&&!n&&k[t][o]<=h||m==-1&&!n&&k[t][o]>=h||m==1&&n&&parseInt(k[t][o])<=parseInt(h)||m==-1&&n&&parseInt(k[t][o])>=parseInt(h)){if(k[t][o]==h){if(r&&m!=0&&m!=2){l[0]=t;r=false}if(g.value==k[t][q]){for(var u=
g,v=true,w=1;w<c;w++){var x=f.conditions[j[c-1-w]].dataRowPosition,u=u.parent;if(u.value!=k[t][x]){v=false;break}}if(v)return true}}}else break;if(f.GeneralDataRows.length<500&&f.GeneralDataRows.length>f.allData.length)for(t=0;t<f.GeneralDataRows.length;t++)if(f.GeneralDataRows[t][o]==h&&g.value==f.GeneralDataRows[t][q])if(c>1){x=f.conditions[j[c-2]].dataRowPosition;if(g.parent.value==f.GeneralDataRows[t][x])return true}else return true;return false};this.fillAggStructure=function(){function c(g,
h,j,k){if(f.ShowMeasuresAsRows){k=j.length-x.length;j.splice(k,0,"");for(var l=0;l<x.length;l++){var m=x[l].getAttribute("displayName");j[k]=m;m=g;for(n=0;n<h.length;n++){o=h[n];o=j[o];q=false;for(D=0;D<m.items.length;D++)if(m.items[D].value==o){q=m.items[D];break}q&&(m=q)}m.used=true}j.splice(k,1)}else{for(var m=g,n=0;n<h.length;n++){for(var o=h[n],o=j[o],q=false,D=0;D<m.items.length;D++)if(m.items[D].value==o){q=m.items[D];m.items[D].row=k;break}q&&(m=q)}m.used=true}}function g(c){if(c.items)for(var f=
0;f<c.items.length;f++)g(c.items[f]);else c.used=true}if(f.options.showEmpty){g(f.rowStructure);g(f.colStructure)}else for(var h=0;h<f.filteredData.length;h++){var j=f.filteredData[h];c(f.rowStructure,f.rowConditions,j,h);c(f.colStructure,f.colConditions,j,h)}};this.checkAggStructure=function(){function c(g){if(f.ShowMeasuresAsRows){if(f.colConditions>0){if(!g.items)return g.used;var h;for(h=g.items.length-1;h>-1;h--)if(h>-1){var j=c(g.items[h]);j!=void 0&&!j&&g.items.splice(h,1)}return g.items.length>
0}}else{if(!g.items)return g.used;for(h=g.items.length-1;h>=0;h--)c(g.items[h])||g.items.splice(h,1);return g.items.length>0}}c(f.rowStructure);f.ShowMeasuresAsRows||c(f.colStructure)};this.applyDefaultFormats=function(c,f){switch(typeof f){case "number":f=gx.text.charReplace(f.toString(),".",gx.decimalPoint);c.innerHTML=f}return c};this.refreshPivot=function(c,g){if(c!=""&&g!=""){for(var h=(new DOMParser).parseFromString(c,"text/xml").getElementsByTagName("OLAPDimension"),j,k=0;k<f.conditions.length;k++){if(f.conditions[k]&&
f.serverPagination)for(var l=jQuery.extend(true,[],f.conditions[k].blackList),m=0;m<l.length;m++)f.createFilterInfo({op:"pop",values:l[m],dim:k});f.conditions[k].blackList=[]}k=[];l=[];for(m=0;m<h.length;m++){for(var n=h[m].getElementsByTagName("name")[0].childNodes[0].nodeValue,o=-1,q=0;q<f.columns.length;q++)f.columns[q].attributes.getNamedItem("name").nodeValue===n&&(o=q);if(o!=-1){n=h[m].getElementsByTagName("condition")[0].childNodes[0].nodeValue;if(n==="row"){j=f.colConditions.findIndex(o);
if(j!=-1){f.colConditions.splice(j,1);x.length>1?f.rowConditions=[o].concat(f.rowConditions):f.rowConditions.push(o)}else{j=f.filterIndexes.findIndex(o);if(j!=-1){f.filterIndexes.splice(j,1);x.length>1?f.rowConditions=[o].concat(f.rowConditions):f.rowConditions.push(o)}}k[parseInt(h[m].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=o}else if(n==="col"){j=f.rowConditions.findIndex(o);if(j!=-1){f.rowConditions.splice(j,1);x.length>1?f.colConditions=[o].concat(f.colConditions):f.colConditions.push(o)}else{j=
f.filterIndexes.findIndex(o);if(j!=-1){f.filterIndexes.splice(j,1);x.length>1?f.colConditions=[o].concat(f.colConditions):f.colConditions.push(o)}}l[parseInt(h[m].getElementsByTagName("position")[0].childNodes[0].nodeValue)]=o}else if(n==="none"){j=f.colConditions.findIndex(o);if(j!=-1){f.colConditions.splice(j,1);x.length>1?f.filterIndexes=[o].concat(f.filterIndexes):f.filterIndexes.push(o)}else{j=f.rowConditions.findIndex(o);if(j!=-1){f.rowConditions.splice(j,1);x.length>1?f.filterIndexes=[o].concat(f.filterIndexes):
f.filterIndexes.push(o)}}}n=h[m].getElementsByTagName("order")[0].childNodes[0].nodeValue;if(f.serverPagination)f.conditions[o].sort=n=="descending"?-1:1;else{f.conditions[o].sort=n=="descending"?f.conditions[o].sort==0||f.conditions[o].sort==2?2:-1:f.conditions[o].sort==0||f.conditions[o].sort==2?0:1;f.stateChanged=true;f.sort(f.conditions[o],o)}q=h[m].getElementsByTagName("hide")[0].childNodes;for(n=0;n<q.length;n++)if(q[n].tagName==="value"){j=f.conditions[o].blackList.findIndex(q[n].textContent);
if(j===-1)for(j=0;j<f.conditions[o].distinctValues.length;j++)f.conditions[o].distinctValues[j].toString().trimpivot()==q[n].textContent&&(f.serverPagination?f.createFilterInfo({op:"push",values:f.conditions[o].distinctValues[j],dim:o}):f.conditions[o].blackList.append(f.conditions[o].distinctValues[j]))}if(h[m].getElementsByTagName("filterdivs").length>0){q=h[m].getElementsByTagName("filterdivs")[0].childNodes;for(n=0;n<q.length;n++)if(q[n].tagName==="value"){j=f.filterIndexes.findIndex(o);if(j!=
-1&&f.filterDiv.selects[j]!=void 0)f.filterDiv.selects[j].value=q[n].textContent}}}}if(f.rowConditions.length-(x.length-1)==k.length)for(h=0;h<k.length;h++)f.rowConditions[h]=k[h];if(f.colConditions.length==l.length)for(h=0;h<l.length;h++)f.colConditions[h]=l[h];if(f.serverPagination){for(h=0;h<f.columns.length;h++)f.pageData.AxisInfo=f.createAxisInfo(f.columns[h].getAttribute("dataField"));f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.pageData.DataInfo=f.createDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||
f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.goWhenServerPagination(false,true)}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],c)}}.closure(this),[1,f.rowsPerPage,true,f.pageData.AxisInfo,f.pageData.DataInfo,f.pageData.FilterInfo,f.pageData.CollapseInfo,true])}else f.go(false,true)}};this.changePaginationRows=function(c){if(f.autoPaging){var g=
f.GeneralDataRows;if(f.RowsWhenMoveToFilter.length>0)g=f.RowsWhenMoveToFilter;f.allData=[];var h=[];(!this.paginationInfo||!this.paginationInfo.pages)&&createPaginationInfo(f,g);h=f.paginationInfo.pages[c-1].rows;f.colConditions.length>0&&(h=f.rowsForBlankCells(h));f.allData=h;c=f.conditions;f.conditions=[];for(g=0;g<f.headerRow.length;g++)f.pseudoInitCondition(g,c)}};this.rowsForBlankCells=function(c){for(var g=[],h=[],j=[],k=[],l=0;l<c.length;l++){for(var m=[],n=[],o=0;o<f.rowConditions.length-
(x.length-1);o++)n[o]=c[l][f.rowConditions[o]];for(o=0;o<f.colConditions.length;o++)m[o]=c[l][f.colConditions[o]];if(j.indexOf(m.toString())==-1){g.push(m);j.push(m.toString())}if(k.indexOf(n.toString())==-1){h.push(n);k.push(n.toString())}}j=[];for(c=0;c<g.length;c++)for(k=0;k<h.length;k++){l=[];for(o=0;o<f.rowConditions.length-(x.length-1);o++)l[f.rowConditions[o]]=h[k][o];for(o=0;o<f.colConditions.length;o++)l[f.colConditions[o]]=g[c][o];j.push(l)}c=[];for(g=0;g<j.length;g++){h=f.getRowFromDimensionRow(j[g],
f.GeneralDataRows);c.push(h)}return c};this.getRowFromDimensionRow=function(c,f){for(var g=0;g<f.length;g++){for(var h=true,j=0;j<c.length;j++)if(c[j]!=void 0&&c[j]!=f[g][j]){h=false;break}if(h)return f[g]}return null};this.countNotFiltered=function(c){for(var g=0,h=0;h<c.length;h++)f.notInBlackList(c[h],f.conditions)||g++;c=parseInt(g/f.autoPagingRowsPerPage);g%f.autoPagingRowsPerPage!=0&&c++;return c};this.setNewPagesAccount=function(c){try{jQuery("#"+f.controlName+" #tablePagination_totalPages").length>
0?jQuery("#"+f.containerName+" #tablePagination_totalPages")[0].innerHTML=" "+c:jQuery("#"+f.controlName+"_"+f.query+"_tablePagination #tablePagination_totalPages")[0].innerHTML=" "+c}catch(g){if(f.paginationInfo.totalPages>1){c={currPage:f.actualPaginationPage,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+f.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.autoPagingRowsPerPage,firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",true),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",true),lastArrow:!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",true),nextArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+
"QueryViewer/oatPivot/images/nextBlue.png",true),topNav:false,controlName:f.controlName+"_"+f.query,cantPages:f.paginationInfo.totalPages};jQuery("#"+f.controlName+"_"+f.query).partialTablePagination(c);jQuery("#"+f.controlName+"_"+f.query).css("margin-bottom","0px")}}};this.notInBlackList=function(c,f){for(var g=false,h=0;h<c.length;h++)f[h]!=void 0&&(f[h].blackList!=void 0&&f[h].blackList.findIndex(c[h])!=-1)&&(g=true);return g};this.preGoWhenShowHideMeasures=function(c){f.headerRow.indexOf(f.initMetadata.Measures[c].displayName);
if(f.initMetadata.Measures[c].Visible){for(var g=x.length-1,c=0;c<g;c++)f.rowConditions.splice(f.rowConditions.length-1,1);if(g>=0&&x[0].getAttribute("dataField")!="F0"){c=f.rowConditions.length+f.colConditions.length+f.filterIndexes.length;if(x.length>0){g=c;for(c=c+x.length;g<c;g++)f.rowConditions.push(g)}}}else if(x.length>1){f.rowConditions.splice(f.rowConditions.length-1,1);f.dataColumnIndex=f.dataColumnIndex-1}for(g=0;g<f.columns.length;g++){c=f.columns[g].getAttribute("dataField");c=f.initMetadata.DataFields.indexOf(c);
f.initMetadata.Conditions[c]=f.conditions[g]}this.goWhenHide()};this.preGoWhenShowHideDimension=function(c){for(var g=0;g<f.columns.length;g++){var h=f.columns[g].getAttribute("dataField"),h=f.initMetadata.DataFields.indexOf(h);f.initMetadata.Conditions[h]=f.conditions[g]}for(var j,k=f.initMetadata.DataFields[c],g=0;g<f.columns.length;g++){h=f.columns[g].getAttribute("dataField");k==h&&(j=g)}if(!f.initMetadata.Dimensions[c].Visible){f.initMetadata.DimensionPosition[c]="row";f.colConditions.indexOf(j)>
-1&&(f.initMetadata.DimensionPosition[c]="col");f.filterIndexes.indexOf(j)>-1&&(f.initMetadata.DimensionPosition[c]="fil")}j=f.headerRow.indexOf(f.initMetadata.Dimensions[c].displayName);if(f.initMetadata.Dimensions[c].Visible){j=f.initMetadata.DimensionPosition[c];if(j==void 0){g=f.initMetadata.Dimensions[c].defaultPosition;j=g.indexOf("rows")>-1?"row":g.indexOf("columns")>-1?"col":g.indexOf("filters")>-1?"fil":"row"}for(g=h=0;g<c;g++)f.initMetadata.Dimensions[g].Visible&&(h=h+1);c=h;if(j=="row"){h=
[];g=f.rowConditions.indexOf(c)>-1;for(j=0;j<f.rowConditions.length;j++)if(f.rowConditions[j]<c)h.push(f.rowConditions[j]);else if(f.rowConditions[j]==c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.rowConditions[j]+1)}g||h.push(c);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+1;h=[];for(j=0;j<f.colConditions.length;j++)f.colConditions[j]>=c?h.push(f.colConditions[j]+1):h.push(f.colConditions[j]);f.colConditions=[];f.colConditions=h;h=[];for(j=0;j<
f.filterIndexes.length;j++)f.filterIndexes[j]>=c?h.push(f.filterIndexes[j]+1):h.push(f.filterIndexes[j]);f.filterIndexes=[];f.filterIndexes=h}else if(j=="col"){h=[];for(j=0;j<f.rowConditions.length;j++)f.rowConditions[j]>=c?h.push(f.rowConditions[j]+1):h.push(f.rowConditions[j]);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+1;h=[];g=f.colConditions.indexOf(c)>-1;for(j=0;j<f.colConditions.length;j++)if(f.colConditions[j]<c)h.push(f.colConditions[j]);else if(f.colConditions[j]==
c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.colConditions[j]+1)}g||h.push(c);f.colConditions=[];f.colConditions=h;h=[];for(j=0;j<f.filterIndexes.length;j++)f.filterIndexes[j]>=c?h.push(f.filterIndexes[j]+1):h.push(f.filterIndexes[j]);f.filterIndexes=[];f.filterIndexes=h}else if(j=="fil"){h=[];for(j=0;j<f.rowConditions.length;j++)f.rowConditions[j]>=c?h.push(f.rowConditions[j]+1):h.push(f.rowConditions[j]);f.rowConditions=[];f.rowConditions=h;f.dataColumnIndex=f.dataColumnIndex+
1;h=[];for(j=0;j<f.colConditions.length;j++)f.colConditions[j]>=c?h.push(f.colConditions[j]+1):h.push(f.colConditions[j]);f.colConditions=[];f.colConditions=h;h=[];g=f.filterIndexes.indexOf(c)>-1;for(j=0;j<f.filterIndexes.length;j++)if(f.filterIndexes[j]<c)h.push(f.filterIndexes[j]);else if(f.filterIndexes[j]==c){h.push(c);h.push(c+1);g=true}else{if(!g){h.push(c);g=true}h.push(f.filterIndexes[j]+1)}g||h.push(c);f.filterIndexes=[];f.filterIndexes=h}}else{f.rowConditions.indexOf(j)>-1?f.rowConditions.splice(f.rowConditions.indexOf(j),
1):f.colConditions.indexOf(j)>-1?f.colConditions.splice(f.colConditions.indexOf(j),1):f.filterIndexes.indexOf(j)>-1&&f.filterIndexes.splice(f.filterIndexes.indexOf(j),1);f.dataColumnIndex=f.dataColumnIndex-1;for(g=0;g<f.rowConditions.length;g++)f.rowConditions[g]>j&&(f.rowConditions[g]=f.rowConditions[g]-1);for(g=0;g<f.colConditions.length;g++)f.colConditions[g]>j&&(f.colConditions[g]=f.colConditions[g]-1);for(g=0;g<f.filterIndexes.length;g++)f.filterIndexes[g]>j&&(f.filterIndexes[g]=f.filterIndexes[g]-
1)}this.goWhenHide()};this.goWhenHide=function(c){for(var g=[],h=0;h<f.initMetadata.Dimensions.length;h++)f.initMetadata.Dimensions[h].Visible||g.push(f.initMetadata.Dimensions[h].dataField);for(var j=[],h=0;h<f.initMetadata.Measures.length;h++)f.initMetadata.Measures[h].Visible||j.push(f.initMetadata.Measures[h].dataField);f.saveHiddenState({DataFields:f.initMetadata.DataFields,Dimensions:f.initMetadata.Dimensions,Measures:f.initMetadata.Measures,DimensionPosition:f.initMetadata.DimensionPosition,
Conditions:f.initMetadata.Conditions,version:f.rememberLayoutStateVersion});h=OATParseMetadata(f.initMetadata.Metadata,g,j,f.serverPagination);g=h[0];f.HideDataFilds=h[2];f.OrderFildsHidden=h[1];h=jQuery.parseXML(g);x=h.getElementsByTagName("OLAPMeasure");f.columns=h.getElementsByTagName("OLAPDimension");h=OATGetColumnsAndMeasureMeatadata(f.columns,x,f.formulaInfo,f.OrderFildsHidden);f.headerRow=h[0];f.formulaInfo.measureFormula=h[2];f.conditionalFormats=h[3];f.conditionalFormatsColumns=h[4];h=h[1];
if(!f.serverPagination){var k=[],h=OATgetAllDataFromXMLOldFormat(f.initMetadata.DataString,h,f.OrderFildsHidden),k=h[0];f.recordForFormula=h[1];if(h[1].length>0)f.formulaInfo.recordDataLength=h[1][0].length}if(x.length>0)f.dataColumnIndex=f.headerRow.length-1;else if(!f.serverPagination)for(h=0;h<k.length;h++)k[h].append("0");f.serverPagination||reLoadDataArrays(k,f.formulaInfo,f.headerRow,f.columns,f,x,f.recordForFormula);if(f.serverPagination){f.conditions=[];for(h=0;h<f.headerRow.length;h++){f.initCondition(h);
if(f.conditions[h]&&f.columns[h]){f.conditions[h].dataField=f.columns[h].getAttribute("dataField");f.conditions[h].state="all";f.conditions[h].defaultAction="Include";f.conditions[h].visibles=[];f.conditions[h].searchInfo={previousPage:0,totalPages:0,filteredText:"",values:[]}}f.applyCustomFilters(h)}for(h=0;h<f.columns.length;h++){k=f.columns[h].getAttribute("dataField");k=f.initMetadata.DataFields.indexOf(k);if(f.initMetadata.Conditions[k]!=""){f.initMetadata.Conditions[k].dataRowPosition=f.conditions[h].dataRowPosition;
f.conditions[h]=f.initMetadata.Conditions[k]}}f.cleanGridCache();f.pageData.AxisInfo=f.createAxisInfo();f.pageData.DataInfo=f.createDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){if(!qv.util.anyError(c)||f.QueryViewerCollection[f.IdForQueryViewerCollection].debugServices){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows);f.goWhenServerPagination(false,false)}else{c=qv.util.getErrorFromText(c);qv.util.renderError(f.QueryViewerCollection[f.IdForQueryViewerCollection],
c)}}.closure(this),[1,f.rowsPerPage,true,f.pageData.AxisInfo,f.pageData.DataInfo,f.pageData.FilterInfo,f.pageData.CollapseInfo,true]);if(c)f.initValueRead(f,0);else for(h=0;h<f.columns.length;h++)if(f.conditions[h].totalPages==void 0){c=10;f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup!=""&&(c=0);var l=h;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(c){c=JSON.parse(c);f.conditions[l].previousPage=c.PageNumber;f.conditions[l].totalPages=c.PagesCount;
f.conditions[l].blocked=false;if(c.Null){f.conditions[l].hasNull=true;f.conditions[l].distinctValues.indexOf("#NuN#")==-1&&f.conditions[l].distinctValues.push("#NuN#");var g=true;f.conditions[l].NullIncluded||(g=false);g&&f.conditions[l].visibles.indexOf("#NuN#")==-1&&f.conditions[l].visibles.push("#NuN#")}else f.conditions[l].hasNull=false;for(var g=[],h=0;h<c.NotNullValues.length;h++){var j=c.NotNullValues[h],k=false;if(f.conditions[l].state=="none"&&f.UserFilterValues.length>0&&f.UserFilterValues[l]!=
void 0&&f.UserFilterValues[l].length>0&&f.UserFilterValues[l].indexOf(j.trimpivot())!=-1){k=true;g.push(j)}f.conditions[l].distinctValues.indexOf(j)==-1&&f.conditions[l].distinctValues.push(j);f.conditions[l].state=="all"&&f.conditions[l].visibles.indexOf(j)==-1&&f.conditions[l].visibles.push(j);f.conditions[l].state=="none"&&(f.conditions[l].blackList.indexOf(j)==-1&&!k)&&f.conditions[l].blackList.push(j);f.UserExpandValues.length>0&&f.UserExpandValues[l]!=void 0&&(f.UserExpandValues[l][0]=="#ALLCOLLAPSE#"||
f.UserExpandValues[l].indexOf(j.trimpivot())==-1)&&f.conditions[l].collapsedValues.push(j)}for(h=0;h<g.length;h++)f.createFilterInfo({op:"pop",values:g[h],dim:l},true)}.closure(this),[f.columns[l].getAttribute("dataField"),1,c,""])}}if(!f.serverPagination){f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.initCondition(h);for(h=0;h<f.columns.length;h++){k=f.columns[h].getAttribute("dataField");k=f.initMetadata.DataFields.indexOf(k);if(f.initMetadata.Conditions[k]!=""){f.initMetadata.Conditions[k].dataRowPosition=
f.conditions[h].dataRowPosition;f.conditions[h]=f.initMetadata.Conditions[k]}}f.autoPaging=false;f.init();if(f.filterIndexes.length>0){f.preGoWhenMoveTopFilter(f.filterIndexes[0],true);if(f.tempBlackLists&&!f.autoPaging)for(h=0;h<f.conditions.length;h++)if(f.conditions[h]){if(f.tempBlackLists[h])f.conditions[h].blackList=f.tempBlackLists[h];if(f.tempCollapsedValues[h])f.conditions[h].collapsedValues=f.tempCollapsedValues[h]}try{if(f.oldSortValues.length>0)for(c=0;c<f.conditions.length;c++)if(f.conditions[c]){f.conditions[c].sort=
f.oldSortValues[c];f.sort(f.conditions[c])}}catch(m){}}f.go(false,false)}};this.preGo=function(c,g,h,j,l){if(l&&W){c=f.getState();if(c!=null&&c.version===f.rememberLayoutStateVersion&&c.query==f.query&&this.conditions.length==c.conditions.length&&c.filterIndexes.length==0){for(l=0;l<=c.conditions.length-1;l++)if(c.conditions[l]!=false&&f.conditions[l]!=false){for(var m=0;m<c.conditions[l].blackList.length;m++)f.conditions[l].blackList.indexOf(c.conditions[l].blackList[m])==-1&&f.conditions[l].distinctValues.indexOf(c.conditions[l].blackList[m])!=
-1&&f.conditions[l].blackList.append(c.conditions[l].blackList[m]);f.conditions[l].sort=c.conditions[l].sort}f.rowConditions=c.rowConditions;f.colConditions=c.colConditions;f.rowsPerPage=c.rowsPerPage}}if(f.filterIndexes.length>0){collapseRowForCollapseValues(f);l=f.RowsWhenMoveToFilter}else l=f.GeneralDataRows;m=k;k=[];for(var n=c=0,o=[];c<this.autoPagingRowsPerPage&&n<l.length;){if((j==-1||n<l.length&&l[n][j]!=h)&&f.isNotFilterByTopFilter(l[n])&&!f.notInBlackList(l[n],f.conditions)){var q=f.canBeConsiderNoNew(l[n],
k,o);k.append([l[n]]);q||c++}n++}if(k.length<1){k=m;this.go(false,g)}f.allData=k;h=f.conditions;f.conditions=[];for(c=0;c<f.headerRow.length;c++)f.pseudoInitCondition(c,h);setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500);this.go(false,g)};this.canBeConsiderNoNew=function(c,g,h){if(f.colConditions.length>0)for(var j=false,k=0;k<g.length;k++){for(var l=true,m=0;m<f.rowConditions.length;m++)g[k][f.rowConditions[m]]!=c[f.rowConditions[m]]&&(l=false);if(l==true){j=true;break}}if(f.filterIndexes.length>
0){j=false;for(k=0;k<h.length;k++){l=true;for(m=0;m<f.rowConditions.length-x.length+1;m++)h[k][f.rowConditions[m]]!=c[f.rowConditions[m]]&&(l=false);if(l==true){j=true;break}}j||h.push(c)}return j};this.preGoWhenMoveTopFilter=function(c,g){if(g==void 0)for(var h=0;h<f.filterDiv.selects.length;h++)f.filterDiv.selects[h].value="[all]";else{for(var j=false,h=0;h<f.filterDiv.selects.length;h++)f.filterDiv.selects[h].value!="[all]"&&(j=true);if(j&&!f.autoPaging)return}f.FilterByTopFilter=false;for(var k=
[],h=0;h<H.length;h++){var l=h;l!=c&&f.filterIndexes.findIndex(l)==-1&&k.append(l)}j=f.GeneralDataRows;if(f.autoPaging){collapseRowForCollapseValues(f);k=f.RowsWhenMoveToFilter;j=[];l=h=0;value=null;for(var m=[];h<this.autoPagingRowsPerPage&&l<k.length;){if(!f.notInBlackList(k[l],f.conditions)&&f.isNotFilterByTopFilter(k[l])){var n=f.canBeConsiderNoNew(k[l],j,m);j.append([k[l]]);n||h++}l++}f.allData=j;f.nextRowWhenAutopaging=l;f.prevRowWhenAutopaging=0;j=f.conditions;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.pseudoInitCondition(h,
j);f.TotalPagesPaging=parseInt(f.RowsWhenMoveToFilter.length/f.autoPagingRowsPerPage);f.RowsWhenMoveToFilter.length%f.autoPagingRowsPerPage!=0&&f.TotalPagesPaging++;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500)}else{m=[];for(h=0;h<j.length;h++){for(var o=false,l=n=0;l<m.length;l++){for(var q=true,r=0;r<k.length;r++)if(j[h][k[r]]!=m[l][k[r]]){q=false;break}if(q){n=l;o=true;break}}if(o){x.length>0&&(f.formulaInfo.measureFormula[x.length-1].hasFormula||(m[n][f.dataColumnIndex]!=
"#NuN#"&&j[h][f.dataColumnIndex]!="#NuN#"?m[n][f.dataColumnIndex]=(parseFloat(m[n][f.dataColumnIndex])+parseFloat(j[h][f.dataColumnIndex])).toString():m[n][f.dataColumnIndex]=="#NuN#"&&(m[n][f.dataColumnIndex]=j[h][f.dataColumnIndex])));for(o=0;o<x.length-1;o++){l=f.rowConditions[f.rowConditions.length-x.length+1+o];f.formulaInfo.measureFormula[o].hasFormula&&f.filterIndexes.length>0||(m[n][l]=(parseFloat(m[n][l])+parseFloat(j[h][l])).toString())}}else{n=[];for(l=0;l<j[h].length;l++)n.append([j[h][l]]);
m.append([n]);for(o=0;o<x.length;o++){l=o<x.length-1?f.rowConditions[f.rowConditions.length-x.length+1+o]:f.dataColumnIndex;if(f.formulaInfo.measureFormula[o].hasFormula&&f.filterIndexes.length>0){q=f.getFormulaRowByDataRow(j[h],o,"");if(q!=f.EmptyValue&&q!="#NuN#"){q=f.calculateFormulaTotal([q],o,"MeasureInRows");isNaN(q)||(n[l]=q.toString())}}}}}f.allData=m;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.initCondition(h);for(h=0;h<f.headerRow.length;h++)f.restoreSubtotalsAndSortLayout(h)}};this.isNotFilterByTopFilter=
function(c){for(var g=0;g<f.filterIndexes.length;g++){var h=f.filterIndexes[g],j=f.filterDiv.selects[g];if(j!=void 0&&j.selectedIndex&&OAT.$v(j)!="[all]"&&OAT.$v(j)!=c[h])return false}return true};this.preGoWhenFilterByTopFilter=function(){if(f.autoPaging){collapseRowForCollapseValues(f);f.FilterByTopFilter=true;f.allData=f.GeneralDataRows;var c=f.RowsWhenMoveToFilter;k=[];var g=l=0;column=-1;value=null;for(var h=[];l<this.autoPagingRowsPerPage&&g<c.length;){if((column==-1||g<c.length&&c[g][column]!=
value)&&f.isNotFilterByTopFilter(c[g])&&!f.notInBlackList(c[g],f.conditions)){var j=f.canBeConsiderNoNew(c[g],k,h);k.append([c[g]]);j||l++}g++}f.allData=k;f.nextRowWhenAutopaging=g;f.prevRowWhenAutopaging=0;c=f.conditions;f.conditions=[];for(l=0;l<f.headerRow.length;l++)f.pseudoInitCondition(l,c);setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500)}else{f.FilterByTopFilter=true;f.allData=f.GeneralDataRows;f.conditions=[];for(var l=0;l<f.headerRow.length;l++)f.initCondition(l);
for(l=0;l<f.headerRow.length;l++)f.restoreSubtotalsAndSortLayout(l)}};this.preGoWhenCollapsedValue=function(){if(!collapseRowForCollapseValues(f))return false;var c=f.RowsWhenMoveToFilter,g=[],h=0,j=0;value=null;for(var k=[];h<this.autoPagingRowsPerPage&&j<c.length;){if(!f.notInBlackList(c[j],f.conditions)){var l=f.canBeConsiderNoNew(c[j],g,k);g.append([c[j]]);l||h++}j++}f.allData=g;f.nextRowWhenAutopaging=j;f.prevRowWhenAutopaging=0;c=f.conditions;f.conditions=[];for(h=0;h<f.headerRow.length;h++)f.pseudoInitCondition(h,
c);f.TotalPagesPaging=parseInt(f.RowsWhenMoveToFilter.length/f.autoPagingRowsPerPage);f.RowsWhenMoveToFilter.length%f.autoPagingRowsPerPage!=0&&f.TotalPagesPaging++;setTimeout(function(){createPaginationInfo(f,f.RowsWhenMoveToFilter)},500);return true};this.go=function(c,g){if(k[0]!=void 0){if(!c){f.gd.clearSources();f.gd.clearTargets();f.drawFilters();try{f.applyFilters();f.createAggStructure();f.fillAggStructure();f.checkAggStructure();f.count()}catch(h){}if(g===void 0||g===null||!g){var j=f.createXMLMetadata(),
l=f.QueryViewerCollection[I];l!=""&&(l!=null&&l!=void 0)&&qv.util.autorefresh.UpdateLayoutSameGroup(l,j)}}j=[];for(l=0;l<f.filterDiv.selects.length;l++)j[l]=f.filterDiv.selects[l].value;if(f.firstTime)f.firstTime=false;else{j={query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:j,rowsPerPage:f.rowsPerPage,version:f.rememberLayoutStateVersion};f.deleteState?f.cleanState():f.saveState(j);f.readState=true}f.ShowMeasuresAsRows?
f.drawTableWhenShowMeasuresAsRows():f.drawTable();j=0;if(jQuery("#"+this.controlName+"_"+f.query+"tablePagination_rowsPerPage").length>0){j=parseInt(jQuery("#"+this.controlName+"_"+f.query+"tablePagination_rowsPerPage")[0].value);isNaN(j)||(v=j)}j={currPage:1,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.rowsPerPage!="undefined"?f.rowsPerPage:50,firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=
gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",true),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",
true),lastArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",true),nextArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/nextBlue.png",true),topNav:false,controlName:this.controlName+"_"+f.query};if(!f.autoPaging&&v){jQuery("#"+this.controlName+"_"+f.query).tablePagination(j);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}if(f.autoPaging&&f.allData.length<f.GeneralDataRows.length&&(f.filteredData.length>=f.autoPagingRowsPerPage||f.actualPaginationPage>1||f.paginationInfo&&f.paginationInfo.pages.length>1)){j={currPage:f.actualPaginationPage,ignoreRows:jQuery("tbody tr[title_row=true]",
jQuery("#"+this.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.autoPagingRowsPerPage,firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",true),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",true),lastArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",true),nextArrow:!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/nextBlue.png",true),topNav:false,controlName:this.controlName+"_"+f.query,cantPages:f.TotalPagesPaging};jQuery("#"+this.controlName+"_"+f.query).partialTablePagination(j);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}jQuery("#"+this.controlName+
"_"+f.query)[0].clientWidth<380&&(!y&&jQuery("#"+this.containerName)[0].clientWidth>=400)&&jQuery("#"+this.controlName+"_"+f.query).css({width:"400px"});j=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-4;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(j=j+4)}catch(m){}l=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-1;jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:j+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({width:l+"px",marginBottom:"5px"});
jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}):jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"5px"}));
setInterval(function(){jQuery("#"+f.controlName+"_"+f.query).length>0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",
marginBottom:"0px"}):jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"5px"}))},150);if(!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()){jQuery(".h2title").css({height:"25px"});jQuery(".h2titlewhite").css({height:"25px"})}setInterval(function(){if(jQuery("#"+I+"_"+f.query+"_pivot_page")[0]!=void 0){var c=21;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+2)}catch(g){}jQuery("#"+I+"_"+f.query+"_pivot_page").css({height:c+"px"});
c=jQuery("#"+f.controlName+"_"+f.query)[0].getBoundingClientRect().top-jQuery("#"+I+"_"+f.query+"_pivot_page")[0].getBoundingClientRect().bottom;c=c+jQuery("#"+I+"_"+f.query+"_pivot_page")[0].offsetHeight;c>28&&jQuery("#"+I+"_"+f.query+"_pivot_page").css({height:c+"px"})}},100);if(!f.autoPaging&&(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length<1||!jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").is(":visible"))){jQuery("#"+f.containerName+" .conteiner_table_div").css({marginBottom:"5px"});
setTimeout(function(){!f.autoPaging&&(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length<1||!jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").is(":visible"))&&jQuery("#"+f.containerName+" .conteiner_table_div").css({marginBottom:"5px"})},150)}f.colConditions.length===0&&jQuery(".h2title > div").css({width:"100%"})}else setInterval(function(){if(jQuery("#"+I+"_"+f.query+"_pivot_page")[0]!=void 0){var c=21;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>
-1&&(c=c+2)}catch(g){}jQuery("#"+I+"_"+f.query+"_pivot_page").css({height:c+"px"});c=jQuery("#"+f.controlName+"_"+f.query)[0].getBoundingClientRect().top-jQuery("#"+I+"_"+f.query+"_pivot_page")[0].getBoundingClientRect().bottom;c=c+jQuery("#"+I+"_"+f.query+"_pivot_page")[0].offsetHeight;c>28&&jQuery("#"+I+"_"+f.query+"_pivot_page").css({height:c+"px"})}},100)};this.gridCache=[];this.cleanGridCache=function(){f.gridCache=[]};this.addPageToCache=function(c,g){f.gridCache.push({page:c,data:g})};this.getPageDataFromCache=
function(c){for(var g=0;g<f.gridCache.length;g++)if(f.gridCache[g].page==c)return f.gridCache[g].data;return false};this.goWhenServerPagination=function(c,g){f.getPageDataFromCache(f.pageData.ServerPageNumber)||f.addPageToCache(f.pageData.ServerPageNumber,f.pageData.rows);if(f.pageData.ServerPageNumber!=f.pageData.PreviousPageNumber){f.QueryViewerCollection[f.IdForQueryViewerCollection].CurrentPage=f.pageData.ServerPageNumber;f.pageData.ServerPageNumber==1?typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnFirstPage==
"function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnFirstPage():f.pageData.ServerPageNumber==f.pageData.ServerPageCount?typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnLastPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnLastPage():f.pageData.ServerPageNumber<f.pageData.PreviousPageNumber?typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnPreviousPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnPreviousPage():
typeof f.QueryViewerCollection[f.IdForQueryViewerCollection].OnNextPage=="function"&&f.QueryViewerCollection[f.IdForQueryViewerCollection].OnNextPage();f.pageData.PreviousPageNumber=f.pageData.ServerPageNumber}if(!c){f.gd.clearSources();f.gd.clearTargets();f.drawFilters();if(f.QueryViewerCollection[f.IdForQueryViewerCollection].AutoRefreshGroup!=""&&(g===void 0||g===null||!g))if(!f.firstTime||f.getState()&&f.getState().version==f.rememberLayoutStateVersion){var h;if(f.serverPagination){h=f.getMetadataXML();
h=h.replace(/\&amp;/g,"&")}else h=f.createXMLMetadata();var j=f.QueryViewerCollection[f.IdForQueryViewerCollection];j!=""&&(j!=null&&j!=void 0)&&qv.util.autorefresh.UpdateLayoutSameGroup(j,h)}}h=[];for(j=0;j<f.filterDiv.selects.length;j++)h[j]=f.filterDiv.selects[j].value;if(f.firstTime)f.firstTime=false;else{h={query:f.query,conditions:f.conditions,colConditions:f.colConditions,rowConditions:f.rowConditions,filterIndexes:f.filterIndexes,filterDivSelects:h,rowsPerPage:f.rowsPerPage,AxisInfo:f.pageData.AxisInfo,
FilterInfo:f.pageData.FilterInfo,version:f.rememberLayoutStateVersion,DataInfo:f.pageData.DataInfo};f.deleteState?f.cleanState():f.saveState(h);f.readState=true}f.drawTableWhenServerPagination();if(f.pageData.ServerPageCount>0&&(f.pageData.ServerPageCount>1||f.pageData.rows.length>10)&&f.rowsPerPage>0){h={currPage:f.pageData.ServerPageNumber,ignoreRows:jQuery("tbody tr[title_row=true]",jQuery("#"+this.controlName+"_"+f.query)),optionsForRows:[10,15,20],rowsPerPage:f.rowsPerPage,firstArrow:!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",true),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+
"QueryViewer/oatPivot/images/prevBlue.png",true),lastArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",true),nextArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",
true):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/nextBlue.png",true),topNav:false,controlName:this.controlName+"_"+f.query,cantPages:f.pageData.ServerPageCount,controlUcId:I,control:f};jQuery("#"+this.controlName+"_"+f.query).partialTablePagination(h);jQuery("#"+this.controlName+"_"+f.query).css("margin-bottom","0px")}jQuery("#"+this.controlName+"_"+f.query).length>0&&(jQuery("#"+this.controlName+"_"+f.query)[0].clientWidth<380&&!y&&jQuery("#"+
this.containerName)[0].clientWidth>=400)&&jQuery("#"+this.controlName+"_"+f.query).css({width:"400px"});try{var k=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-4;jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(k=k+4)}catch(l){}try{var m=jQuery("#"+this.controlName+"_"+f.query)[0].offsetWidth-1;jQuery("#"+I+"_"+f.query+"_pivot_page").css({width:k+"px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({width:m+"px"});gx.util.browser.isIE()||jQuery("#"+this.controlName+
"_"+f.query+"_tablePagination").css({marginBottom:"5px"});jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater").length>0&&jQuery("#"+this.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+this.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}):jQuery("#"+this.controlName+"_"+f.query+
"_tablePagination").css({height:"65px",marginBottom:"5px"}))}catch(n){}setInterval(function(){if(!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()){jQuery(".h2title").css({height:"25px"});jQuery(".h2titlewhite").css({height:"25px"});jQuery(".header_value").css({height:"25px"});jQuery(".header_value").css({lineHeight:"25px"})}jQuery("#"+f.controlName+"_"+f.query).length>0&&jQuery("#"+f.controlName+"_"+f.query)[0].getAttribute("class")==="pivot_table"&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length>
0&&jQuery("#"+f.controlName+"_"+f.query+"_tablePagination")[0].getBoundingClientRect().bottom<jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater")[0].getBoundingClientRect().bottom&&(gx.util.browser.isIE()?jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"0px"}):jQuery("#"+this.controlName+"_"+f.query+"_tablePagination").css({height:"65px",marginBottom:"5px"}))},150);if(!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()){jQuery(".h2title").css({height:"25px"});
jQuery(".h2titlewhite").css({height:"25px"})}setInterval(function(){if(jQuery("#"+I+"_"+f.query+"_pivot_page")[0]!=void 0){var c=21;try{jQuery("#MAINFORM")[0].className.indexOf("form-horizontal")>-1&&(c=c+2)}catch(g){}try{jQuery("#"+I+"_"+f.query+"_pivot_page").css({height:c+"px"});var h=jQuery("#"+f.controlName+"_"+f.query)[0].getBoundingClientRect().top-jQuery("#"+I+"_"+f.query+"_pivot_page")[0].getBoundingClientRect().bottom,h=h+jQuery("#"+I+"_"+f.query+"_pivot_page")[0].offsetHeight;h>28&&jQuery("#"+
I+"_"+f.query+"_pivot_page").css({height:h+"px"})}catch(j){}}},100);if(f.pageData.ServerPageCount==0){jQuery("#"+f.containerName+" .conteiner_table_div").css({marginBottom:"5px"});setTimeout(function(){(jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").length<1||!jQuery("#"+f.controlName+"_"+f.query+"_tablePagination_paginater").is(":visible"))&&jQuery("#"+f.containerName+" .conteiner_table_div").css({marginBottom:"5px"})},150)}};this.getDataForPivot=function(c,g,h,j,k,l,m,n,o,q){j&&
f.cleanGridCache();if(j&&h>-1)f.rowsPerPage=h;f.pageData.PreviousPageNumber=f.pageData.ServerPageNumber;if(!j&&f.getPageDataFromCache(g)){f.pageData.ServerPageNumber=g;f.pageData.rows=f.getPageDataFromCache(f.pageData.ServerPageNumber);f.preGoWhenServerPagination(true)}else{if(k!="")f.pageData.AxisInfo=f.createAxisInfo(k);l!=""&&f.createFilterInfo(l);f.pageData.CollapseInfo=f.CreateExpandCollapseInfo("");f.ExportTo="";if(h<0){h=0;f.ExportTo=m}c=true;if(g>1||!j)c=false;o!=void 0&&o!=""&&(c=true);f.pageData.AxisInfo=
f.createAxisInfo(k);f.pageData.DataInfo=f.createDataInfo();f.QueryViewerCollection[f.IdForQueryViewerCollection].getPageDataForPivotTable(function(c){f.pageData=OATGetNewDataFromXMLForPivot(c,f.pageData,f.ShowMeasuresAsRows,f.ExportTo);f.preGoWhenServerPagination(q);if(f.ExportTo!=""){c=f.query;if(c==""){c="Query";try{c=f.controlName.split("_")[0]}catch(g){}}f.ExportTo=="HTML"&&f.ExportToHTMLWhenServerPagination();f.ExportTo=="PDF"&&OAT.GeneratePDFOutput(f,c);f.ExportTo=="XLS"&&f.ExportToExcel(c);
f.ExportTo=="XML"&&f.ExportToXMLWhenServerPagination();f.ExportTo=="XLSX"&&f.ExportToXLSXWhenServerPagination();f.cleanGridCache()}}.closure(this),[g,h,j,f.pageData.AxisInfo,f.pageData.DataInfo,f.pageData.FilterInfo,f.pageData.CollapseInfo,c])}};this.CreateExpandCollapseInfo=function(){for(var c=[],g={},h=0;h<f.columns.length;h++){for(var g=-1,j=0;j<f.conditions.length;j++)f.conditions[j].dataField==f.columns[h].getAttribute("dataField")&&(g=j);if(f.conditions[g].collapsedValues.length){g={DataField:f.conditions[g].dataField,
NullExpanded:true,NotNullValues:{Expanded:[],Collapsed:f.conditions[g].collapsedValues,DefaultAction:"Expand"}};c.push(g)}}return c};this.createAxisInfo=function(){for(var c=[],g=1,h=0;h<f.initMetadata.Dimensions.length;h++){var j=-1,k="Rows",l=1,m="Ascending",n=true;if(f.initMetadata.Dimensions[h].Visible){for(m=0;m<f.conditions.length;m++)f.conditions[m].dataField==f.initMetadata.Dimensions[h].dataField&&(j=m);m=f.conditions[j].sort==1?"Ascending":"Descending";n=f.conditions[j].subtotals==1||f.conditions[j].subtotals?
true:false;f.rowConditions.indexOf(j)>-1&&(l=f.rowConditions.indexOf(j)+1);if(f.colConditions.indexOf(j)>-1){k="Columns";l=f.colConditions.indexOf(j)+1}if(f.filterIndexes.indexOf(j)>-1){k="Pages";l=f.filterIndexes.indexOf(j)+1}}else{k="Hidden";l=g;g=g+1}c.push({DataField:f.initMetadata.Dimensions[h].dataField,Order:m,Axis:{Type:k,Position:l},Subtotals:n})}return c};this.createDataInfo=function(){for(var c=[],g=1,h=1,j=0;j<f.initMetadata.Measures.length;j++){c.push({DataField:f.initMetadata.Measures[j].dataField,
Axis:{Type:f.initMetadata.Measures[j].Visible?"Data":"Hidden",Position:f.initMetadata.Measures[j].Visible?h:g}});f.initMetadata.Measures[j].Visible?h=h+1:g=g+1}return c};this.createFilterInfo=function(c,g){DataFieldFilter=f.conditions[c.dim].dataField;if(c.op=="all"||c.op=="pagefilter"&&c.values=="[all]"){for(var h=-1,j=0;j<f.pageData.FilterInfo.length;j++)if(DataFieldFilter==f.pageData.FilterInfo[j].DataField){h=j;break}h>-1&&f.pageData.FilterInfo.splice(h,1);f.conditions[c.dim].state="all";f.conditions[c.dim].visibles=
[];f.conditions[c.dim].blackList=[];f.conditions[c.dim].defaultAction="Include"}else{if(f.conditions[c.dim].state=="none"){f.conditions[c.dim].visibles=[];for(var k=0;k<f.conditions[c.dim].distinctValues.length;k++)f.conditions[c.dim].blackList.indexOf(f.conditions[c.dim].distinctValues[k])==-1&&f.conditions[c.dim].blackList.push(f.conditions[c.dim].distinctValues[k])}else if(f.conditions[c.dim].state=="all"){f.conditions[c.dim].blackList=[];for(k=0;k<f.conditions[c.dim].distinctValues.length;k++)f.conditions[c.dim].visibles.indexOf(f.conditions[c.dim].distinctValues[k])==
-1&&f.conditions[c.dim].visibles.push(f.conditions[c.dim].distinctValues[k])}if(c.op=="none"){f.conditions[c.dim].state="none";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];f.conditions[c.dim].defaultAction="Exclude"}else if(c.op=="push"){f.conditions[c.dim].state="";h=f.conditions[c.dim].visibles.indexOf(c.values);h>-1&&f.conditions[c.dim].visibles.splice(h,1);f.conditions[c.dim].blackList.indexOf(c.values)==-1&&f.conditions[c.dim].blackList.push(c.values)}else if(c.op=="pop"){f.conditions[c.dim].state=
"";f.conditions[c.dim].visibles.indexOf(c.values)==-1&&f.conditions[c.dim].visibles.push(c.values);h=f.conditions[c.dim].blackList.indexOf(c.values);h>-1&&f.conditions[c.dim].blackList.splice(h,1)}else if(c.op=="pagefilter"){f.conditions[c.dim].state="";f.conditions[c.dim].defaultAction="Exclude";f.conditions[c.dim].visibles=[];f.conditions[c.dim].visibles.push(c.values);for(j=0;j<f.conditions[c.dim].distinctValues.length;j++){h=f.conditions[c.dim].distinctValues[j];f.conditions[c.dim].blackList.indexOf(h)==
-1&&h!=c.values&&f.conditions[c.dim].blackList.push(h)}}else if(c.op=="reverse"){f.conditions[c.dim].defaultAction=f.conditions[c.dim].defaultAction=="Include"?"Exclude":"Include";if(f.conditions[c.dim].state=="none"){h=-1;for(j=0;j<f.pageData.FilterInfo.length;j++)if(DataFieldFilter==f.pageData.FilterInfo[j].DataField){h=j;break}h>-1&&f.pageData.FilterInfo.splice(h,1);f.conditions[c.dim].state="all";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];return}if(f.conditions[c.dim].state==
"all"){f.conditions[c.dim].state="none";f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[]}else{for(var j=[],l=0;l<f.conditions[c.dim].visibles.length;l++)j.push(f.conditions[c.dim].visibles[l]);for(var m=[],l=0;l<f.conditions[c.dim].blackList.length;l++)m.push(f.conditions[c.dim].blackList[l]);f.conditions[c.dim].visibles=[];f.conditions[c.dim].blackList=[];for(k=0;k<f.conditions[c.dim].distinctValues.length;k++){h=f.conditions[c.dim].distinctValues[k];j.indexOf(h)==-1?f.conditions[c.dim].visibles.push(h):
f.conditions[c.dim].blackList.push(h)}for(k=0;k<m.length;k++)f.conditions[c.dim].visibles.indexOf(m[k])==-1&&f.conditions[c.dim].visibles.push(m[k]);for(k=0;k<j.length;k++)f.conditions[c.dim].blackList.indexOf(j[k])==-1&&f.conditions[c.dim].blackList.push(j[k])}}j=false;m=true;l=[];for(k=0;k<f.conditions[c.dim].visibles.length;k++)f.conditions[c.dim].visibles[k]!="#NuN#"&&l.push(f.conditions[c.dim].visibles[k]);var n=[];if(f.conditions[c.dim].state!="none"){for(k=0;k<f.conditions[c.dim].distinctValues.length;k++){h=
f.conditions[c.dim].distinctValues[k];h!="#NuN#"&&l.indexOf(h)==-1&&n.push(h)}for(k=0;k<f.conditions[c.dim].blackList.length;k++)f.conditions[c.dim].blackList[k]!="#NuN#"&&n.indexOf(f.conditions[c.dim].blackList[k])==-1&&n.push(f.conditions[c.dim].blackList[k]);l.length==0&&f.conditions[c.dim].defaultAction=="Exclude"&&(n=[])}if(c.op=="none"){m=false;l=[];n=[]}else f.conditions[c.dim].distinctValues.indexOf("#NuN#")>-1||n.indexOf(f.conditions[c.dim].blackList[k])!=-1?f.conditions[c.dim].visibles.indexOf("#NuN#")==
-1&&(m=false):f.conditions[c.dim].defaultAction=="Exclude"&&(m=false);if(f.conditions[c.dim].hasNull&&c.op!="none"){for(var h=f.defaultPicture.getAttribute("textForNullValues"),o=false,q=0,k=0;k<f.conditions[c.dim].distinctValues.length;k++)q=f.conditions[c.dim].distinctValues[k].length;for(k=0;k<f.conditions[c.dim].distinctValues.length;k++)if(f.conditions[c.dim].distinctValues[k].trimpivot()==f.defaultPicture.getAttribute("textForNullValues")){h=f.conditions[c.dim].distinctValues[k];o=true;break}if(!o)for(k=
0;k<q-f.defaultPicture.getAttribute("textForNullValues").length;k++)h=h+" ";if(m){if(l.indexOf(h)==-1){if(n.indexOf(h)!=-1){n.splice(n.indexOf(h),1);l.push(h)}else f.conditions[c.dim].defaultAction=="Exclude"&&l.push(h);if(f.conditions[c.dim].blackList.indexOf(h)!=-1){f.conditions[c.dim].blackList.splice(f.conditions[c.dim].blackList.indexOf(h),1);f.conditions[c.dim].visibles.indexOf(h)==-1&&f.conditions[c.dim].visibles.push(h)}}}else{if(n.indexOf(h)==-1){n.push(h);f.conditions[c.dim].blackList.indexOf(h)==
-1&&f.conditions[c.dim].blackList.push(h)}l.indexOf(h)!=-1&&l.splice(l.indexOf(h),1);f.conditions[c.dim].visibles.indexOf(h)!=-1&&f.conditions[c.dim].visibles.splice(f.conditions[c.dim].visibles.indexOf(h),1)}}k=f.conditions[c.dim].previousPage==f.conditions[c.dim].totalPages;q=(m||!f.conditions[c.dim].hasNull)&&n.length==0&&c.op!="none"&&c.op!="push"&&(f.conditions[c.dim].defaultAction=="Include"||k)&&!g&&c.op!="reverse";h=0;o=false;for(k=0;k<f.pageData.FilterInfo.length;k++)if(f.pageData.FilterInfo[k].DataField==
DataFieldFilter){o=j=true;f.pageData.FilterInfo[k].NullIncluded=m;f.pageData.FilterInfo[k].NotNullValues.Included=l;f.pageData.FilterInfo[k].NotNullValues.Excluded=n;f.pageData.FilterInfo[k].NotNullValues.DefaultAction=f.conditions[c.dim].defaultAction;h=k}q&&o&&f.pageData.FilterInfo.splice(h,1);if(!j&&!q){filter={DataField:DataFieldFilter,NullIncluded:m,NotNullValues:{Included:l,Excluded:n,DefaultAction:f.conditions[c.dim].defaultAction}};f.pageData.FilterInfo.push(filter)}}};this.moveToNextPage=
function(){this.pageData.ServerPageNumber<this.pageData.ServerPageCount&&this.getDataForPivot(this.UcId,this.pageData.ServerPageNumber+1,this.rowsPerPage,false,"","","","")};this.moveToFirstPage=function(){this.pageData.ServerPageNumber>1&&this.getDataForPivot(this.UcId,1,this.rowsPerPage,false,"","","","")};this.moveToLastPage=function(){this.pageData.ServerPageNumber<this.pageData.ServerPageCount&&this.getDataForPivot(this.UcId,this.pageData.ServerPageCount,this.rowsPerPage,false,"","","","")};
this.moveToPreviousPage=function(){this.pageData.ServerPageNumber>1&&f.getDataForPivot(I,this.pageData.ServerPageNumber-1,this.rowsPerPage,false,"","","","")};this.preGoWhenServerPagination=function(c){f.goWhenServerPagination(c,false)};this.readScrollValue=function(c){var g=f.conditions[c].dataField;if(!f.conditions[c].blocked){f.conditions[c].blocked=true;if(f.conditions[c].filtered){var h=f.conditions[c].searchInfo,j=h.previousPage+1;f.lastRequestValue=g;var k=h.filteredText;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){g=
JSON.parse(g);f.appendNewFilteredValueData(g,c,k)}.closure(this),[g,j,10,h.filteredText])}else{var j=f.conditions[c].previousPage+1;f.lastRequestValue=c;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(c){c=JSON.parse(c);f.appendNewValueData(f.lastRequestValue,c)}.closure(this),[g,j,10,""])}}};this.getValuesForColumn=function(c,g,h){var j=f.conditions[g].dataField;if(h!=""){var k=h.replace(/\\/g,"\\\\");f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(h){h=
JSON.parse(h);f.changeValues(c,j,g,h,k)}.closure(this),[j,1,10,k])}else f.resetScrollValue(c,j,g)};this.appendNewValueData=function(c,g){if(g.PageNumber>f.conditions[c].previousPage){f.conditions[c].previousPage=g.PageNumber;f.conditions[c].totalPages=g.PagesCount;var h=[];g.Null&&f.conditions[c].indexOf("#NuN#")==-1&&f.conditions[c].distinctValues.push("#NuN#");for(var j=0;j<g.NotNullValues.length;j++){var k=g.NotNullValues[j];if(f.conditions[c].distinctValues.indexOf(k)==-1){f.conditions[c].distinctValues.push(k);
h.push(k)}f.conditions[c].defaultAction=="Include"?f.conditions[c].visibles.indexOf(k)==-1&&f.conditions[c].blackList.indexOf(k)==-1&&f.conditions[c].visibles.push(k):f.conditions[c].visibles.indexOf(k)==-1&&f.conditions[c].blackList.indexOf(k)==-1&&f.conditions[c].blackList.push(k)}for(j=0;j<h.length;j++){k=true;f.conditions[c].state!="all"&&f.conditions[c].blackList.indexOf(h[j])!=-1&&(k=false);f.conditions[c].hasNull&&h[j].trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(h[j],
c,k)}}if(f.conditions[c].previousPage<g.PagesCount)f.conditions[c].blocked=false};this.changeValues=function(c,g,h,j,k){c=jQuery("#"+c+h)[0];(g=c.value)&&(g=g.replace(/\\/g,"\\\\"));if(!((c.value||c.value=="")&&g!=k)){f.conditions[h].filtered=true;f.conditions[h].blocked=true;f.removeAllPairsFromPopUp(h,j.PagesCount>1);f.conditions[h].searchInfo.previousPage=1;f.conditions[h].searchInfo.totalPages=j.PagesCount;f.conditions[h].searchInfo.filteredText=k;for(k=0;k<j.NotNullValues.length;k++){c=j.NotNullValues[k];
g=f.conditions[h].distinctValues.indexOf(c)!=-1;f.conditions[h].distinctValues.indexOf(c)==-1&&f.conditions[h].distinctValues.push(c);(f.conditions[h].state=="all"||f.conditions[h].defaultAction=="Include"&&!g)&&f.conditions[h].visibles.indexOf(c)==-1&&f.conditions[h].blackList.indexOf(c)==-1&&f.conditions[h].visibles.push(c);g=true;f.conditions[h].state!="all"&&f.conditions[h].visibles.findIndex(c)<0&&(g=false);f.conditions[h].searchInfo.values.push(c);f.conditions[h].hasNull&&c.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||
f.appendNewPairToPopUp(c,h,g)}if(j.PagesCount>0)f.conditions[h].blocked=false}};this.resetScrollValue=function(c,g,h){f.conditions[h].filtered=false;f.conditions[h].blocked=true;f.removeAllPairsFromPopUp(h,data.PagesCount>1);for(c=0;c<f.conditions[h].distinctValues.length;c++){var g=true,j=f.conditions[h].distinctValues[c];f.conditions[h].state!="all"&&f.conditions[h].visibles.findIndex(j)<0&&(g=false);f.conditions[h].hasNull&&j.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(j,
h,g)}if(f.conditions[h].previousPage<f.conditions[h].totalPages)f.conditions[h].blocked=false};this.resetAllScrollValue=function(){for(var c=0;c<f.conditions.length;c++){f.conditions[c].filtered=false;f.conditions[c].blocked=true;if(f.conditions[c].previousPage<f.conditions[c].totalPages)f.conditions[c].blocked=false}};this.appendNewFilteredValueData=function(c,g,h){var j=f.conditions[g].searchInfo;if(!((h||h=="")&&j.filteredText!=h)&&c.PageNumber>j.previousPage){f.conditions[g].searchInfo.previousPage=
c.PageNumber;f.conditions[g].searchInfo.totalPages=c.PagesCount;c.Null&&f.conditions[g].distinctValues.indexOf("#NuN#")==-1&&f.conditions[g].distinctValues.push("#NuN#");for(h=0;h<c.NotNullValues.length;h++){var j=c.NotNullValues[h],k=f.conditions[g].distinctValues.indexOf(j)!=-1;f.conditions[g].distinctValues.indexOf(j)==-1&&f.conditions[g].distinctValues.push(j);f.conditions[g].defaultAction=="Include"&&!k?f.conditions[g].visibles.indexOf(j)==-1&&f.conditions[g].blackList.indexOf(j)==-1&&f.conditions[g].visibles.push(j):
f.conditions[g].visibles.indexOf(j)==-1&&f.conditions[g].blackList.indexOf(j)==-1&&f.conditions[g].blackList.push(j);k=true;f.conditions[g].state!="all"&&f.conditions[g].visibles.findIndex(j)<0&&(k=false);f.conditions[g].hasNull&&j.trimpivot()==f.defaultPicture.getAttribute("textForNullValues")||f.appendNewPairToPopUp(j,g,k)}if(f.conditions[g].searchInfo.previousPage<f.conditions[g].searchInfo.totalPages)f.conditions[g].blocked=false}};this.appendNewPairToPopUp=function(c,g,h){var j=f.dimensionPictureValue(c,
g);c=="#NuN#"&&(j="&nbsp;");j=j.replace(/\&amp;/g,"&").replace(/\&nbsp;/g," ");if(j.length>33)var k=j.substring(32,j.length).trimpivot().length>0?"...":"",j=j.substring(0,32)+k;j=j.replace(/ /g,"&nbsp;")+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";h=function(h,j){var k=OAT.Dom.create("div"),l=f.valueIsShowed(c,g)?"check_item_img":"uncheck_item_img";k.setAttribute("class",l);l=OAT.Dom.create("input");l.type="checkbox";l.id=j;var m=OAT.Dom.create("label");m.innerHTML=h;m.htmlFor=j;k.appendChild(m);return[k,l]}(j,
"pivot_distinct_"+S,h);h[0].setAttribute("value",c);j=jQuery("#values_"+f.UcId+"_"+g)[0];j.appendChild(h[0]);j.children.length>9&&j.setAttribute("class","pivot_popup_fix");OAT.Dom.attach(h[0],"click",function(){f.DiseablePivot();var c=this.getAttribute("class")!=="check_item_img";this.setAttribute("class",this.getAttribute("class")==="check_item_img"?"uncheck_item_img":"check_item_img");var h=this.getAttribute("value");if(f.serverPagination){var j="pop";c||(j="push");f.getDataForPivot(f.UcId,1,f.rowsPerPage,
true,f.conditions[g].dataField,{op:j,values:h,dim:g},"","");f.stateChanged=true;f.onFilteredChangedEventHandleWhenServerPagination(g);f.EneablePivot()}})};this.removeAllPairsFromPopUp=function(c,g){jQuery("#values_"+f.UcId+"_"+c).find(".check_item_img").remove();jQuery("#values_"+f.UcId+"_"+c).find(".uncheck_item_img").remove();jQuery(".last_div_popup .check_item_img").remove();jQuery(".last_div_popup .uncheck_item_img").remove();if(g){jQuery("#values_"+f.UcId+"_"+c).removeClass("pivot_popup_auto");
jQuery("#values_"+f.UcId+"_"+c).addClass("pivot_popup_fix")}else{jQuery("#values_"+f.UcId+"_"+c).removeClass("pivot_popup_fix");jQuery("#values_"+f.UcId+"_"+c).addClass("pivot_popup_auto")}};var ha=!1,ia;this.onClickEventHandle=function(c){if(ha!="expand")if(ha){ha=false;clearTimeout(ia);var g=f.ClickHandle(c),g=g.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(this.QueryViewerCollection[K],g,true)}else{ha=true;g=300;f.QueryViewerCollection[K].ItemDoubleClick==void 0&&(g=0);ia=setTimeout(function(){ha=
false;var g=f.ClickHandle(c),g=g.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(f.QueryViewerCollection[K],g,false)},g)}else ha=false};this.onClickExpandCollapse=function(c){ha="expand";var g=jQuery(c).data("itemValue");jQuery(c).data("typeMorD");var h=jQuery(c).data("numberMorD");jQuery(c).data("itemInfo");if(f.conditions[h].collapsedValues.indexOf(g)==-1){f.conditions[h].collapsedValues.append(g);if(f.serverPagination)f.ExpandCollapseHandleWhenServerPagination(c,"collapse");else{c=f.ExpandCollapseHandle(c,
"ItemCollapse");c=c.replace(/\&/g,"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[K],c,true)}}else{f.conditions[h].collapsedValues.splice(f.conditions[h].collapsedValues.indexOf(g),1);if(f.serverPagination)f.ExpandCollapseHandleWhenServerPagination(c,"expande");else{c=f.ExpandCollapseHandle(c,"ItemExpand");c=c.replace(/\&/g,"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[K],c,false)}}if(this.autoPaging){collapseRowForCollapseValues(f);f.actualPaginationPage=
1;f.changePaginationRows(1);f.go(false)}else f.serverPagination||f.go(false)};this.onDblClickEventHandle=function(c){c=f.ClickHandle(c);c=c.replace(/\&/g,"&amp;");qv.pivot.onItemClickEvent(this.QueryViewerCollection[K],c,true)};this.cleanValueForNull=function(c){if(c=="#NuN#"){c=f.defaultPicture.getAttribute("textForNullValues");return c!=void 0?c:""}return c};this.isClickedRow=function(c,g,h,j,k){if(f.rowConditions.indexOf(k)==-1)return true;for(g=0;g<h;g++){k=f.rowConditions[g];if(c[k]!=j[k])return false}return true};
this.isClickedRowMeasure=function(c,f,g){for(f=0;f<c.length;f++)if(c[f]!=void 0&&c[f]!=g[f])return false;return true};this.ClickHandle=function(c){var g=jQuery(c).data("itemValue"),h=jQuery(c).data("typeMorD"),j=jQuery(c).data("numberMorD"),k=jQuery(c).data("itemInfo"),c='<DATA><ITEM type="'+h+'" ';if(h==="MEASURE"){c=c+'name="'+x[j].getAttribute("name")+'" ';c=c+'displayName="'+x[j].getAttribute("displayName")+'" ';c=c+'location="data">'}else{c=c+'name="'+H[j].getAttribute("name")+'" ';c=c+'displayName="'+
H[j].getAttribute("displayName")+'" ';c=c+'location="rows">'}var c=c+f.cleanValueForNull(g),l=c=c+"</ITEM><CONTEXT><RELATED>";try{if(f.serverPagination){if(f.allRowsPivot=="vacio"){f.allRowsPivot=[];f.allFullRowsPivot=[];for(var m=f.QueryViewerCollection[f.IdForQueryViewerCollection].getPivottableDataSync().split("<Record>"),n=1;n<m.length;n++){for(var o=[],q=[],r=0;r<f.pageData.dataFields.length;r++){o[r]="#NuN#";var t=m[n].split("<"+f.pageData.dataFields[r]+">");if(t.length>1){var u=t[1].split("</"+
f.pageData.dataFields[r]+">");o[r]=u[0];q[r]=o[r]}else if(m[n].indexOf("<"+f.pageData.dataFields[r]+"/>")>=0){o[r]="";q[r]=""}}f.allRowsPivot.push(o);for(r=0;r<f.HideDataFilds.length;r++){t=m[n].split("<"+f.HideDataFilds[r]+">");if(t.length>1){u=t[1].split("</"+f.HideDataFilds[r]+">");q[q.length+r]=u[0]}}f.allFullRowsPivot.push(q)}}m=false;if(k.row){m=!k.row.subTotal;!m&&(k.isTotal!=void 0&&!k.isTotal)&&(m=true)}if(k.row!=void 0&&m){for(var v=k.row,w=k.cell,o=f.pageData.rows.indexOf(v),y=k.cell,A=
f.pageData.columnsHeaders[y],E=[],n=0;n<f.pageData.dataFields.length;n++)E[n]=void 0;for(n=0;n<v.headers.length;n++){var C=f.pageData.dataFields.indexOf(v.headers[n].dataField);if(v.headers[n]!=void 0&&v.headers[n].value!=void 0)E[C]=v.headers[n].value}for(n=0;n<A.subHeaders.length;n++)if(A.subHeaders[n]!=void 0){C=f.pageData.dataFields.indexOf(A.subHeaders[n].dataField);if(A.subHeaders[n].value!=void 0)E[C]=A.subHeaders[n].value}for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+
'">';c=c+"<VALUES>";if(h==="MEASURE")if(E[n]!=void 0)c=c+"<VALUE>"+f.cleanValueForNull(E[n])+"</VALUE>";else{if(f.filterIndexes.indexOf(n)!=-1){B=[];for(z=0;z<f.allRowsPivot.length;z++)if(B.indexOf(f.allRowsPivot[z][n])===-1&&f.filterOK(f.allRowsPivot[z])&&f.isClickedRowMeasure(E,g,f.allRowsPivot[z])){B=B.concat(f.allRowsPivot[z][n]);c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n])+"</VALUE>"}}}else{B=[];for(z=0;z<f.allRowsPivot.length;z++)if(f.allRowsPivot[z][j]===g&&f.isClickedRow(E,g,w,
f.allRowsPivot[z],j)&&B.indexOf(f.allRowsPivot[z][n])===-1&&f.filterOK(f.allRowsPivot[z])){B=B.concat(f.allRowsPivot[z][n]);c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n])+"</VALUE>"}}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";if(h==="MEASURE")if(E[n+this.columns.length]!=void 0)c=c+"<VALUE>"+f.cleanValueForNull(E[n+this.columns.length])+"</VALUE>";else if(j==n)c=c+"<VALUE>"+f.cleanValueForNull(g)+"</VALUE>";else{B=
[];for(z=0;z<f.allRowsPivot.length;z++)f.allRowsPivot[z][j+this.columns.length]===g&&(f.isClickedRowMeasure(E,g,f.allRowsPivot[z])&&f.filterOK(f.allRowsPivot[z])&&B.indexOf(f.allRowsPivot[z][n+this.columns.length])===-1)&&(c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n+this.columns.length])+"</VALUE>")}else{B=[];for(z=0;z<f.allRowsPivot.length;z++)if(f.allRowsPivot[z][j]===g&&f.isClickedRow(E,g,w,f.allRowsPivot[z],j)&&f.filterOK(f.allRowsPivot[z])&&B.indexOf(f.allRowsPivot[z][n+this.columns.length])===
-1){B=B.concat(f.allRowsPivot[z][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n+this.columns.length])+"</VALUE>"}}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES>";r=function(c,f){for(var g=0;g<c.length;g++)if(c[g]!=void 0&&c[g]!=f[g])return false;return true};if(h==="MEASURE"){B=[];for(z=0;z<f.allFullRowsPivot.length;z++)if(r(E,f.allFullRowsPivot[z])&&f.isClickedRow(E,g,w,f.allFullRowsPivot[z],
j)&&f.filterOK(f.allFullRowsPivot[z])&&B.indexOf(f.allFullRowsPivot[z][n+this.columns.length+x.length])===-1){B=B.concat(f.allFullRowsPivot[z][n+this.columns.length+x.length]);c=c+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[z][n+this.columns.length+x.length])+"</VALUE>"}}else{B=[];for(z=0;z<f.allFullRowsPivot.length;z++)if(f.allFullRowsPivot[z][j]===g&&f.isClickedRow(E,g,w,f.allFullRowsPivot[z],j)&&f.filterOK(f.allFullRowsPivot[z])&&B.indexOf(f.allFullRowsPivot[z][n+this.columns.length+x.length])===
-1){B=B.concat(f.allFullRowsPivot[z][n+this.columns.length+x.length]);c=c+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[z][n+this.columns.length+x.length])+"</VALUE>"}}c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k==="GrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<f.allRowsPivot.length;z++)if(B.indexOf(f.allRowsPivot[z][n])===-1&&f.filterOK(f.allRowsPivot[z])){B=B.concat(f.allRowsPivot[z][n]);c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n])+
"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES>";B=[];for(z=0;z<f.allFullRowsPivot.length;z++)if(B.indexOf(f.allFullRowsPivot[z][n+this.columns.length+x.length])===-1&&f.filterOK(f.allFullRowsPivot[z])){B=B.concat(f.allFullRowsPivot[z][n+this.columns.length+x.length]);c=c+"<VALUE>"+f.cleanValueForNull(f.allFullRowsPivot[z][n+this.columns.length+x.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=
c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<f.allRowsPivot.length;z++)if(B.indexOf(f.allRowsPivot[z][n+this.columns.length])===-1&&f.filterOK(f.allRowsPivot[z])){B=B.concat(f.allRowsPivot[z][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(f.allRowsPivot[z][n+this.columns.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PtrTotals"){v=k[2];y=k[3];y>-1&&(A=f.pageData.columnsHeaders[y]);E=[];for(n=0;n<f.pageData.dataFields.length;n++)E[n]=
void 0;for(n=0;n<v.headers.length;n++){C=f.pageData.dataFields.indexOf(v.headers[n].dataField);if(v.headers[n]!=void 0&&v.headers[n].value!=void 0)E[C]=v.headers[n].value}if(y>-1)for(n=0;n<A.subHeaders.length;n++)if(A.subHeaders[n]!=void 0){C=f.pageData.dataFields.indexOf(A.subHeaders[n].dataField);if(A.subHeaders[n].value!=void 0)E[C]=A.subHeaders[n].value}G=[];h=[];for(n=0;n<f.allRowsPivot.length;n++)if(f.filterOK(f.allRowsPivot[n])&&f.isClickedRowMeasure(E,g,f.allRowsPivot[n])){G.push(f.allRowsPivot[n]);
f.HideDataFilds.length>0&&h.push(f.allFullRowsPivot)}for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(r=0;r<G.length;r++)if(B.indexOf(G[r][n])===-1){B=B.concat(G[r][n]);c=c+"<VALUE>"+f.cleanValueForNull(G[r][n])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<f.HideDataFilds.length;n++){c=c+'<ITEM name="'+f.OrderFildsHidden[n]+'">';c=c+"<VALUES>";B=[];for(r=0;r<G.length;r++)if(B.indexOf(G[r][n])===-1){B=B.concat(G[r][n]);c=
c+"<VALUE>"+f.cleanValueForNull(h[r][n+this.columns.length+x.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<G.length;z++)if(B.indexOf(G[z][n+this.columns.length])===-1){B=B.concat(G[z][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(G[z][n+this.columns.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}}}else if(k!="")if(k!="GrandTotal"&&(k[0]===void 0||k[0]!="PartialGrandTotal"&&k[0]!=
"RowSubtotal"&&k[0]!="PtrTotals")){for(var o=k.row!=void 0?k.row:k[0],n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";if(h==="MEASURE")c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[o][n])+"</VALUE>";else for(var B=[],z=0;z<this.GeneralDataRows.length;z++)if(this.GeneralDataRows[z][j]===g&&f.isClickedRow(this.filteredData[o],g,j,this.GeneralDataRows[z],j)&&B.indexOf(this.GeneralDataRows[z][n])===-1&&f.filterOK(this.GeneralDataRows[z])){B=
B.concat(this.GeneralDataRows[z][n]);c=c+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[z][n])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";if(h==="MEASURE")c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[o][n+this.columns.length])+"</VALUE>";else{B=[];for(z=0;z<this.allDataWithoutSort.length;z++)if(this.allDataWithoutSort[z][j]===g&&f.filterOK(this.allDataWithoutSort[z])&&B.indexOf(this.allDataWithoutSort[z][n+
this.columns.length])===-1){B=B.concat(this.allDataWithoutSort[z][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.allDataWithoutSort[z][n+this.columns.length])+"</VALUE>"}}c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k==="GrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<this.GeneralDataRows.length;z++)if(B.indexOf(this.GeneralDataRows[z][n])===-1&&f.filterOK(this.GeneralDataRows[z])){B=B.concat(this.GeneralDataRows[z][n]);
c=c+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[z][n])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<this.allDataWithoutSort.length;z++)if(B.indexOf(this.allDataWithoutSort[z][n+this.columns.length])===-1&&f.filterOK(this.allDataWithoutSort[z])){B=B.concat(this.allDataWithoutSort[z][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.allDataWithoutSort[z][n+this.columns.length])+"</VALUE>"}c=
c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PartialGrandTotal"){for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[k[1][0]][n])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}var F=[];jQuery.each(k[1],function(c,f){jQuery.inArray(f,F)===-1&&F.push(f)});for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";for(z=0;z<F.length;z++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[F[z]][n+
this.columns.length])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="RowSubtotal"){q=k[1].items;for(n=0;n<this.columns.length;n++){for(var c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">',c=c+"<VALUES>",r=0;r<q.length;r++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[q[r].row][n])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";for(r=0;r<q.length;r++)c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[q[r].row][n+
this.columns.length])+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}else if(k[0]==="PtrTotals"){for(var G=[],n=0;n<k[1].length;n++)for(r=0;r<k[1][n].length;r++)G.findIndex(k[1][n][r])===-1&&G.append(k[1][n][r]);for(n=0;n<this.columns.length;n++){c=c+'<ITEM name="'+this.columns[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(r=0;r<G.length;r++)if(B.indexOf(this.filteredData[G[r]][n])===-1){B=B.concat(this.filteredData[G[r]][n]);c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[G[r]][n])+"</VALUE>"}c=
c+"</VALUES>";c=c+"</ITEM>"}for(n=0;n<x.length;n++){c=c+'<ITEM name="'+x[n].getAttribute("name")+'">';c=c+"<VALUES>";B=[];for(z=0;z<G.length;z++)if(B.indexOf(this.filteredData[G[z]][n+this.columns.length])===-1){B=B.concat(this.filteredData[G[z]][n+this.columns.length]);c=c+"<VALUE>"+f.cleanValueForNull(this.filteredData[G[z]][n+this.columns.length])+"</VALUE>"}c=c+"</VALUES>";c=c+"</ITEM>"}}}catch(I){c=l}l=c=c+"</RELATED><FILTERS>";try{for(n=0;n<f.filterIndexes.length;n++){c=c+'<ITEM name="'+this.columns[f.filterIndexes[n]].getAttribute("name")+
'" displayName="'+this.columns[f.filterIndexes[n]].getAttribute("displayName")+'">';c=c+"<VALUES>";c=c+"<VALUE>";c=f.filterDiv.selects[n].value==="[all]"?c+gx.getMessage("GXPL_QViewerJSAllOption"):c+f.cleanValueForNull(f.filterDiv.selects[n].value);c=c+"</VALUE>";c=c+"</VALUES>";c=c+"</ITEM>"}}catch(J){c=l}return c+"</FILTERS></CONTEXT></DATA>"};this.ExpandCollapseHandle=function(c,g){var h=jQuery(c).data("itemValue");jQuery(c).data("typeMorD");var j=jQuery(c).data("numberMorD"),k=jQuery(c).data("itemInfo"),
l;l='<DATA event="'+g+'"><ITEM name="'+H[j].getAttribute("name")+'" ';l=l+'displayName="'+H[j].getAttribute("displayName")+'" ';l=l+">"+f.cleanValueForNull(h);h=l=l+"</ITEM><CONTEXT><EXPANDEDVALUES>";try{if(k!="")for(var k=[],n=0;n<this.GeneralDataRows.length;n++)if(k.indexOf(this.GeneralDataRows[n][j])==-1){k=k.concat(this.GeneralDataRows[n][j]);f.conditions[j].collapsedValues.indexOf(this.GeneralDataRows[n][j])===-1&&(l=l+"<VALUE>"+f.cleanValueForNull(this.GeneralDataRows[n][j])+"</VALUE>")}}catch(m){l=
h}return l+"</EXPANDEDVALUES></CONTEXT></DATA>"};this.ExpandCollapseHandleWhenServerPagination=function(c,g){if(typeof f.QueryViewerCollection[K].ItemExpand=="function"||qv.util.isGeneXusPreview()){var h=jQuery(c).data("numberMorD");if(f.conditions[h].previousPage>=f.conditions[h].totalPages){h=f.ExpandCollapseHandleWhenServerPaginationCreateXML(c,g);h=h.replace(/\&/g,"&amp;");qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[K],h,g=="collapse");f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,
f.rowsPerPage,true,"","","","",true)}else{f.lastColumnNumber=h;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(h){var h=JSON.parse(h),j=f.lastColumnNumber;f.conditions[j].previousPage=h.PageNumber;f.conditions[j].totalPages=h.PagesCount;f.conditions[j].blocked=true;if(h.Null&&!f.conditions[j].hasNull){f.conditions[j].hasNull=true;f.conditions[j].distinctValues.indexOf("#NuN#")==-1&&f.conditions[j].distinctValues.push("#NuN#");f.conditions[j].defaultAction=="Include"?
f.conditions[j].visibles.indexOf("#NuN#")==-1&&f.conditions[j].visibles.push("#NuN#"):f.conditions[j].blackList.indexOf("#NuN#")==-1&&f.conditions[j].blackList.push("#NuN#")}for(var k=0;k<h.NotNullValues.length;k++){var l=h.NotNullValues[k];if(f.conditions[j].distinctValues.indexOf(l)==-1){f.conditions[j].distinctValues.push(l);f.conditions[j].defaultAction=="Include"&&f.conditions[j].visibles.indexOf(l)==-1&&f.conditions[j].visibles.push(l);f.conditions[j].state=="Exclude"&&f.conditions[j].blackList.indexOf(l)==
-1&&f.conditions[j].blackList.push(l)}}var n=f.ExpandCollapseHandleWhenServerPaginationCreateXML(c,g),n=n.replace(/\&/g,"&amp;");f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,f.rowsPerPage,true,"","","","",true);setTimeout(function(){qv.pivot.onItemExpandCollapseEvent(f.QueryViewerCollection[K],n,g=="collapse")},2E3)}.closure(this),[f.columns[h].getAttribute("dataField"),1,0,""])}}else f.getDataForPivot(f.UcId,f.pageData.ServerPageNumber,f.rowsPerPage,true,"","","","",true)};this.ExpandCollapseHandleWhenServerPaginationCreateXML=
function(c,g){var h=jQuery(c).data("itemValue");jQuery(c).data("typeMorD");var j=jQuery(c).data("numberMorD");jQuery(c).data("itemInfo");actionName='event="ItemExpand"';g=="collapse"&&(actionName='event="ItemCollapse"');for(var k="<DATA "+actionName+"><ITEM ",k=k+'name="'+H[j].getAttribute("name")+'" ',k=k+'displayName="'+H[j].getAttribute("displayName")+'" ',k=k+">"+h+"</ITEM><CONTEXT><EXPANDEDVALUES>",h=0;h<f.conditions[j].distinctValues.length;h++)f.conditions[j].collapsedValues.indexOf(f.conditions[j].distinctValues[h])==
-1&&(k=k+"<VALUE>"+f.conditions[j].distinctValues[h]+"</VALUE>");return k+"</EXPANDEDVALUES></CONTEXT></DATA>"};this.onFilteredChangedEventHandle=function(c){for(var g='<DATA event="FilterChanged" name="'+this.columns[c].getAttribute("name")+'" displayName="'+this.columns[c].getAttribute("displayName")+'">',h=0;h<f.conditions[c].distinctValues.length;h++){var j=f.conditions[c].distinctValues[h];if(f.conditions[c].blackList.findIndex(j)==-1&&f.valueIsShowed(j,c)||f.conditions[c].blackList.findIndex(j)==
-1)g=g+"<VALUE>"+j+"</VALUE>"}g=g+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,g);if(this.QueryViewerCollection[K].FilterChanged){g=g.replace(/\&/g,"&amp;");h=qv.util.dom.xmlDocument(g);c=qv.util.dom.selectXPathNode(h,"/DATA");this.QueryViewerCollection[K].FilterChangedData={};this.QueryViewerCollection[K].FilterChangedData.Name=c.getAttribute("name");this.QueryViewerCollection[K].FilterChangedData.SelectedValues=
[];g=-1;for(h=0;h<c.childNodes.length;h++)if(c.childNodes[h].nodeName=="VALUE"){g++;this.QueryViewerCollection[K].FilterChangedData.SelectedValues[g]=c.childNodes[h].firstChild.nodeValue}this.QueryViewerCollection[K].FilterChanged()}};this.onFilteredChangedEventHandleWhenServerPagination=function(c){if(f.QueryViewerCollection[K].FilterChanged||qv.util.isGeneXusPreview())if(f.conditions[c].previousPage>=f.conditions[c].totalPages)f.onFilteredChangedEventHandleWhenServerPaginationCreateXML(c,f.conditions[c].distinctValues,
f.conditions[c].blackList);else{f.lastColumnNumber=c;f.QueryViewerCollection[f.IdForQueryViewerCollection].getAttributeValues(function(g){setTimeout(function(){var h=JSON.parse(g);f.onFilteredChangedEventHandleWhenServerPaginationCreateXML(f.lastColumnNumber,h.NotNullValues,f.conditions[c].blackList)},200)}.closure(this),[f.columns[c].getAttribute("dataField"),1,0,""])}};this.onFilteredChangedEventHandleWhenServerPaginationCreateXML=function(c,g){for(var h='<DATA event="FilterChanged" name="'+f.columns[c].getAttribute("name")+
'" displayName="'+f.columns[c].getAttribute("displayName")+'">',j=0;j<g.length;j++){var k=g[j],l=true;f.conditions[c].state=="all"?l=true:f.conditions[c].state=="none"?l=false:f.conditions[c].blackList.findIndex(k)!=-1?l=false:g.findIndex(k)!=-1?l=true:f.conditions[c].defaultAction=="Exclude"&&(l=false);l&&(h=h+"<VALUE>"+k+"</VALUE>")}h=h+"</DATA>";qv.util.isGeneXusPreview()&&window.external.SendText(f.QueryViewerCollection[f.IdForQueryViewerCollection].ControlName,h);if(f.QueryViewerCollection[K].FilterChanged){h=
h.replace(/\&/g,"&amp;");j=qv.util.dom.xmlDocument(h);h=qv.util.dom.selectXPathNode(j,"/DATA");f.QueryViewerCollection[K].FilterChangedData={};f.QueryViewerCollection[K].FilterChangedData.Name=h.getAttribute("name");f.QueryViewerCollection[K].FilterChangedData.SelectedValues=[];k=-1;for(j=0;j<h.childNodes.length;j++)if(h.childNodes[j].nodeName=="VALUE"){k++;f.QueryViewerCollection[K].FilterChangedData.SelectedValues[k]=h.childNodes[j].firstChild.nodeValue}f.QueryViewerCollection[K].FilterChanged()}};
this.onDragUndDrop=function(c,g){for(var h='<DATA name="'+f.columns[c].getAttribute("name")+'" displayName="'+f.columns[c].getAttribute("displayName")+'">',j=0;j<g.length;j++){var k=g[j],l=true;f.conditions[c].state=="all"?l=true:f.conditions[c].state=="none"?l=true:f.conditions[c].defaultAction=="Exclude"&&(l=false);l&&(h=h+"<VALUE>"+k+"</VALUE>")}(h+"</DATA>").replace(/\&/g,"&amp;");for(j=0;j<Node.children.length;j++)if(Node.childNodes[j].nodeName=="VALUE"){valueIndex++;f.QueryViewerCollection[K].FilterChangedData.SelectedValues[valuesIndex]=
Node.childNodes[j].firstChild.nodeValues}f.QueryViewerCollection[K].FilterChanged()};this.onDragundDropEventHandle=function(c,f){var g='<DATA event="DragAndDrop" name="'+this.columns[c].getAttribute("name")+'" displayName="'+this.columns[c].getAttribute("displayName")+'" position="'+f+'"/>';try{g=g.replace(/\&/g,"&amp;");qv.pivot.onOAT_PIVOTDragAndDropEvent(this.QueryViewerCollection[K],g)}catch(h){}};f.autoPaging&&0<f.colConditions.length&&(k=f.rowsForBlankCells(k));if(f.serverPagination)f.initWhenServerPagination();
else if(f.init(),f.autoPaging||16>=f.rowConditions.length||1200>=f.GeneralDataRows.length)if(0<f.filterIndexes.length){f.preGoWhenMoveTopFilter(f.filterIndexes[0],!0);f.stateChanged=!0;if(f.tempBlackLists&&!f.autoPaging)for(S=0;S<f.conditions.length;S++)if(f.conditions[S]&&(f.tempBlackLists[S]&&(f.conditions[S].blackList=f.tempBlackLists[S]),f.tempCollapsedValues[S]))f.conditions[S].collapsedValues=f.tempCollapsedValues[S];try{if(0<f.oldSortValues.length)for(j=0;j<f.conditions.length;j++)f.conditions[j]&&
(f.conditions[j].sort=f.oldSortValues[j],f.sort(f.conditions[j]))}catch(fa){}f.go(!1)}else f.autoPaging?f.preGoWhenCollapsedValue()?f.go(!1):f.preGo(!1,null,null,-1,!0):f.go(!0);else setTimeout(function(){if(f.filterIndexes.length>0){f.preGoWhenMoveTopFilter(f.filterIndexes[0],true);f.stateChanged=true;if(f.tempBlackLists&&!f.autoPaging)for(var c=0;c<f.conditions.length;c++)if(f.conditions[c]){if(f.tempBlackLists[c])f.conditions[c].blackList=f.tempBlackLists[c];if(f.tempCollapsedValues[c])f.conditions[c].collapsedValues=
f.tempCollapsedValues[c]}try{if(f.oldSortValues.length>0)for(c=0;c<f.conditions.length;c++)if(f.conditions[c]){f.conditions[c].sort=f.oldSortValues[c];f.sort(f.conditions[c])}}catch(g){}f.go(false)}else f.autoPaging?f.preGoWhenCollapsedValue()?f.go(false):f.preGo(false,null,null,-1,true):f.go(true)},500)};try{OAT.Loader.featureLoaded("pivot")}catch(ERROR$$31){}var sortUnidimensionalArray=function(c,g,h){for(var j=function(c,g){return c==g?0:1*(parseInt(c)>parseInt(g)?1:-1)},k=function(c,g){return c==
g?0:1*(c>g?1:-1)},m=!0,n=0;n<c.length;n++)m&&c[n]!=parseInt(c[n])&&(m=!1);c.sort(m?j:k);for(j=0;j<h.columns[g].childNodes.length;j++)if(void 0!=h.columns[g].childNodes[j]&&void 0!=h.columns[g].childNodes[j].localName&&"customOrder"===h.columns[g].childNodes[j].localName){c=[];for(k=0;k<h.columns[g].childNodes[j].childNodes.length;k++)"Value"==h.columns[g].childNodes[j].childNodes[k].localName&&c.push(h.columns[g].childNodes[j].childNodes[k].textContent)}return c},fillGeneralDistinctValues=function(c,
g,h){g.GeneralDistinctValues=[];for(var j=0;j<c;j++){for(var k=[],m=0;m<h.length;m++)void 0==h[m][j]?-1==k.findIndex(" ")&&k.append(" "):-1==k.findIndex(h[m][j])&&k.append(h[m][j]);g.GeneralDistinctValues[j]=sortUnidimensionalArray(k,j,g)}},fromUndefinedToBlanck=function(c){for(var g=0;g<c.length;g++)for(var h=0;h<c[g].length;h++)void 0==c[g][h]&&(c[g][h]=" ")},sumGrandPagingTotals=function(c,g,h,j,k){for(var m=c[0].length-h,g=[],n=0;n<h;n++)if(j.measureFormula[n].hasFormula){g[n]=[];for(var l=0;l<
k.formulaInfo.recordDataLength;l++)g[n][l]=0}else g[n]=0;for(var o=!0,n=0;n<c.length;n++)if(k.isNotFilterByTopFilter(c[n])&&!k.notInBlackList(c[n],k.conditions)){for(l=0;l<h;l++)j.measureFormula[l].hasFormula||("#NuN#"!=c[n][m+l]&&"#NuN#"!=g[l]?g[l]+=parseFloat(c[n][m+l]):o&&"#NuN#"==c[n][m+l]?g[l]="#NuN#":"#NuN#"==g[l]&&"#NuN#"!=c[n][m+l]&&(g[l]=parseFloat(c[n][m+l])));o=!1}for(c=0;c<h;c++)if(j.measureFormula[c].hasFormula)for(n=0;n<k.recordForFormula.length;n++)for(l=0;l<k.formulaInfo.measureFormula[c].relatedMeasures.length;l++)m=
k.formulaInfo.measureFormula[c].relatedMeasures[l],isNaN(parseFloat(k.recordForFormula[n][m]))||(g[c][m]+=parseFloat(k.recordForFormula[n][m]));for(c=0;c<h;c++)j.measureFormula[c].hasFormula&&(g[c]=k.calculateFormulaTotal([g[c]],c,"MeasureInRows"));return g},notInBlackListB=function(c,g){for(var h=!1,j=0;j<c.length;j++)void 0!=g[j]&&(void 0!=g[j].blackList&&-1!=g[j].blackList.findIndex(c[j]))&&(h=!0);return h},getDataRowFromItem=function(c){for(var g=[];0<c.depth;)g=[c.value].concat(g),c=c.parent;
return g=[c.value].concat(g)},getTotalsForDataRow=function(c,g,h,j,k,m,n,l){for(var o=c[0].length-h,j=[],q=0;q<h;q++)j[q]=0;for(var q=[],r=0;r<k.length;r++)q[r]=k[r];q.sort();for(k=0;k<q.length;k++)q[k]<g.length&&("[all]"==n[k].value?g.splice(q[k],0,"#-#!"):g.splice(q[k],0,n[k].value));n=!1;k=!0;for(q=0;q<c.length;q++)if(l.isNotFilterByTopFilter(c[q])&&!l.notInBlackList(c[q],l.conditions)){for(var r=!0,t=0;t<g.length&&!(c[q][t]!=g[t]&&"#-#!"!=g[t]&&(r=!1),!r);t++);if(r){n||(n=belongToCollection(c[q],
m));for(r=0;r<h;r++)"#NuN#"!=c[q][o+r]&&"#NuN#"!=j[r]?j[r]+=parseFloat(c[q][o+r]):k&&"#NuN#"==c[q][o+r]?j[r]="#NuN#":"#NuN#"==j[r]&&"#NuN#"!=c[q][o+r]&&(j[r]=parseFloat(c[q][o+r]));k=!1}}try{for(c=0;c<h;c++)if(l.formulaInfo.measureFormula[c].hasFormula){var w=l.getFormulaRowByDataRow(g,c,"");j[c]=l.calculateFormulaTotal([w],c,"MesaureAsColumn")}}catch(v){}return!n?!1:j},belongToCollection=function(c,g){for(var h=0;h<g.length;h++){for(var j=!0,k=0;k<c.length-measures.length&&!(g[h][k]!=c[k]&&(j=!1),
!j);k++);if(j)return!0}return!1},removeExtraRows=function(c,g,h){var j=1,k=c[0][0];0<c[0].length-0-1&&(j=1+j);for(var m=[],n=0;n<c.length&&!(k==c[n][0]?(m.append([c[n]]),0===c[0].length-g-0-1&&(j+=1)):(j=1+j,k=c[n][0],0<c[0].length-g-1&&(j+=getTrueCantRows(m,1,g)),m=[],m.append([c[n]])),j>h);n++);0<c[0].length-g-0-1&&getTrueCantRows(m,1,g);return n},collapseRowForCollapseValues=function(c){c.paginationInfo=!1;if(0<c.filterIndexes.length){c.FilterByTopFilter=!0;for(var g=c.allData=c.GeneralDataRows,
h=[],j=0;j<c.columns.length;j++)if(-1==c.filterIndexes.findIndex(j))h.append(j);else{var k=c.filterIndexes.findIndex(j),k=c.filterDiv.selects[k];void 0!=k&&"[all]"!=OAT.$v(k)&&h.append(j)}k=[];for(j=0;j<g.length;j++){for(var m=!1,n=0,l=0;l<k.length;l++){for(var o=!0,q=0;q<h.length;q++)if(g[j][h[q]]!=k[l][h[q]]){o=!1;break}if(o){n=l;m=!0;break}}if(m){0<measures.length&&(c.formulaInfo.measureFormula[measures.length-1].hasFormula||("#NuN#"!=k[n][c.dataColumnIndex]&&"#NuN#"!=g[j][c.dataColumnIndex]?k[n][c.dataColumnIndex]=
(parseFloat(k[n][c.dataColumnIndex])+parseFloat(g[j][c.dataColumnIndex])).toString():"#NuN#"==k[n][c.dataColumnIndex]&&(k[n][c.dataColumnIndex]=g[j][c.dataColumnIndex])));for(m=0;m<measures.length-1;m++)l=c.rowConditions[c.rowConditions.length-measures.length+1+m],c.formulaInfo.measureFormula[m].hasFormula&&0<c.filterIndexes.length||(k[n][l]=(parseFloat(k[n][l])+parseFloat(g[j][l])).toString())}else{n=[];for(m=0;m<g[j].length;m++)n.append([g[j][m]]);k.append([n]);for(m=0;m<measures.length;m++)l=m<
measures.length-1?c.rowConditions[c.rowConditions.length-measures.length+1+m]:c.dataColumnIndex,c.formulaInfo.measureFormula[m].hasFormula&&0<c.filterIndexes.length&&(o=c.getFormulaRowByDataRow(g[j],m,""),o!=c.EmptyValue&&"#NuN#"!=o&&(o=c.calculateFormulaTotal([o],m,"MeasureInRows"),isNaN(o)||(n[l]=o.toString())))}}c.RowsWhenMoveToFilter=k}for(var r=[],h=[],j=0;j<c.conditions.length;j++)void 0!=c.conditions[j].collapsedValues&&0<c.conditions[j].collapsedValues.length&&(r.push(c.conditions[j].dataRowPosition),
h.push(c.conditions[j].collapsedValues));if(0<r.length){g=c.GeneralDataRows;0<c.RowsWhenMoveToFilter.length&&(g=c.RowsWhenMoveToFilter);c.FilterByTopFilter=!0;k=[];for(j=0;j<g.length;j++){for(var t=!1,w=0;w<r.length;w++)if(-1!=h[w].findIndex(g[j][r[w]])){t=!0;if(c.isNotFilterByTopFilter(g[j])&&!c.notInBlackList(g[j],c.conditions)){m=!1;for(l=n=0;l<k.length;l++){o=!0;for(q=0;q<=r[w];q++)if(g[j][q]!=k[l][q]){o=!1;break}if(o){n=l;m=!0;break}}if(m){0<measures.length&&(c.formulaInfo.measureFormula[measures.length-
1].hasFormula||("#NuN#"!=k[n][c.dataColumnIndex]&&"#NuN#"!=g[j][c.dataColumnIndex]?k[n][c.dataColumnIndex]=(parseFloat(k[n][c.dataColumnIndex])+parseFloat(g[j][c.dataColumnIndex])).toString():"#NuN#"==k[n][c.dataColumnIndex]&&(k[n][c.dataColumnIndex]=g[j][c.dataColumnIndex])));for(m=0;m<measures.length-1;m++)l=c.rowConditions[c.rowConditions.length-measures.length+1+m],c.formulaInfo.measureFormula[m].hasFormula&&0<c.filterIndexes.length||(k[n][l]=(parseFloat(k[n][l])+parseFloat(g[j][l])).toString())}else{n=
[];for(m=0;m<g[j].length;m++)n.append([g[j][m]]);k.append([n]);for(m=0;m<measures.length;m++)l=m<measures.length-1?c.rowConditions[c.rowConditions.length-measures.length+1+m]:c.dataColumnIndex,c.formulaInfo.measureFormula[m].hasFormula&&0<c.filterIndexes.length&&(o=c.getFormulaRowByDataRow(g[j],m,""),o!=c.EmptyValue&&"#NuN#"!=o&&(o=c.calculateFormulaTotal([o],m,"MeasureInRows"),isNaN(o)||(n[l]=o.toString())))}}break}if(!t){n=[];for(m=0;m<g[j].length;m++)n.append([g[j][m]]);k.append([n]);for(m=0;m<
measures.length;m++)l=m<measures.length-1?c.rowConditions[c.rowConditions.length-measures.length+1+m]:c.dataColumnIndex,c.formulaInfo.measureFormula[m].hasFormula&&0<c.filterIndexes.length&&(o=c.getFormulaRowByDataRow(g[j],m,""),o!=c.EmptyValue&&"#NuN#"!=o&&(o=c.calculateFormulaTotal([o],m,"MeasureInRows"),isNaN(o)||(n[l]=o.toString())))}}c.RowsWhenMoveToFilter=k}if(0<c.filterIndexes.length){h=[];for(j=0;j<c.columns.length;j++)-1==c.filterIndexes.findIndex(j)?h.append(j):(k=c.filterIndexes.findIndex(j),
k=c.filterDiv.selects[k],void 0!=k&&"[all]"!=OAT.$v(k)&&h.append(j));g=c.RowsWhenMoveToFilter;k=[];for(t=g[0].length-1;-1<t;t--){j=!0;for(n=0;n<g.length;n++)if(j&&g[n][t]!=parseInt(g[n][t])){j=!1;break}k[t]=j}t=h[0];g=k[t]?g.sort(function(c){return function(g,h){return parseInt(g[c])===parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(t)):g.sort(function(c){return function(g,h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(t));h=g[0][t];for(j=n=0;j<g.length;j++)h!=g[j][t]?(h=g[j][t],g=OAT.PartialSort(g,
n,j-1,t+1,c.headerRow.length,k),n=j):j==g.length-1&&(g=OAT.PartialSort(g,n,j,t+1,c.headerRow.length,k));c.RowsWhenMoveToFilter=g}0<c.filterIndexes.length||0<r.length||(c.RowsWhenMoveToFilter=c.GeneralDataRows);return 0<r.length},calculateTotalRowsWithSubtotalRows=function(c,g,h){for(var j=[],k=0;k<h.rowConditions.length-1-(measures.length-1);k++)h.conditions[h.rowConditions[k]]&&(j[k]=1==h.conditions[h.rowConditions[k]].subtotals?1:0);for(var m=k=0;m<h.rowConditions.length-1-(measures.length-1);m++){if(-1!=
h.conditions[h.rowConditions[m]].collapsedValues.indexOf(c[h.rowConditions[m]])){k=1;break}if(c[h.rowConditions[m]]!=g[h.rowConditions[m]]){k+=j.reduce(function(c,g){return c+g});break}j[m]=0}return k},showSubtotalRowsForFirstColumn=function(c,g,h){for(var j=0;j<h.rowConditions.length-1-(measures.length-1);j++);j=0;-1!=h.conditions[h.rowConditions[0]].collapsedValues.indexOf(c[h.rowConditions[0]])?substotals=1:c[h.rowConditions[0]]!=g[h.rowConditions[0]]&&(j=1);return j},createPaginationInfo=function(c,
g){c.paginationInfo||(c.paginationInfo={},c.paginationInfo.pages=[]);for(var h=0,j=0,k=0,m=0,n=[],l=0,o=0;o<g.length;)if(m>=c.autoPagingRowsPerPage&&(m=!1,c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,lastSumShow:m,extraRows:l},h++,j=o,m=0,n=[],l=0),!c.notInBlackList(g[o],c.conditions)&&c.isNotFilterByTopFilter(g[o])){var q=0;0==n.length&&(0<h&&!c.paginationInfo.pages[h-1].lastSumShow)&&(q=showSubtotalRowsForFirstColumn(c.paginationInfo.pages[h-1].rows[c.paginationInfo.pages[h-1].rows.length-
1],g[o],c),0<q&&(n.append([c.paginationInfo.pages[h-1].rows[c.paginationInfo.pages[h-1].rows.length-1]]),l=calculateTotalRowsWithSubtotalRows(n[0],g[o],c),q=1));if(0<n.length&&(1!=n.length||0==l))q=calculateTotalRowsWithSubtotalRows(n[n.length-1],g[o],c);m+1+q<=c.autoPagingRowsPerPage?(n.append([g[o]]),m=m+1+q,k=o,o++):(m+=q,m=0<q&&m==c.autoPagingRowsPerPage,c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,lastSumShow:m,extraRows:l},h++,j=o,m=0,n=[],l=0)}else o++;m<c.autoPagingRowsPerPage&&
(c.paginationInfo.pages[h]={firstRow:j,lastRow:k,rows:n,extraRows:0},h++);c.paginationInfo.totalPages=h;c.setNewPagesAccount(c.paginationInfo.totalPages);c.TotalPagesPaging=c.paginationInfo.totalPages},calculateGrandTotalForLastMeasure=function(c){if(c.actualPaginationPage==c.TotalPagesPaging){var g=c.GeneralDataRows;0<c.RowsWhenMoveToFilter.length&&(g=c.RowsWhenMoveToFilter);for(var h=0,j=!0,k=[],m=0;m<g.length;m++)if(c.isNotFilterByTopFilter(g[m])&&!c.notInBlackList(g[m],c.conditions))if(c.formulaInfo.measureFormula[measures.length-
1].hasFormula){var n=c.getFormulaRowByDataRow(g[m],measures.length-1,"");n!=c.EmptyValue&&"#NuN#"!=n&&k.push(n)}else isNaN(parseFloat(g[m][c.dataColumnIndex]))||(j=!1,h+=parseFloat(g[m][c.dataColumnIndex]));return c.formulaInfo.measureFormula[measures.length-1].hasFormula?c.calculateFormulaTotal([k],measures.length-1,"MeasureInRows"):j?"#NuN#":h}return 0},getTrueCantRows=function(c,g,h){var j=0;0!=c[0].length-h-g-1&&(j=1+j);for(var k=c[0][g],m=[],n=0;n<c.length;n++)k==c[n][g]?(m.append([c[n]]),0===
c[0].length-h-g-1&&(j+=1)):(j=1+j,k=c[n][g],0<c[0].length-h-g-1&&(j+=getTrueCantRows(m,g+1,h)),m=[],m.append([c[n]]));0<c[0].length-h-g-1&&(j+=getTrueCantRows(m,g+1,h));return j},getMeasureNumberByName=function(c,g){for(var h=0;h<g.length;h++)if(g[h].getAttribute("displayName")==c)return h;return 0},getColumnByDataField=function(c,g){for(var h=0;h<g.length;h++)if(g[h].getAttribute("dataField")==c)return g[h];return null},saveAsIE=function(){var c=get_blob();saveAs(new c([self.file.fileName||self.file.fileContent],
{type:"text/plain;charset="+self.file.fileContent.toBase64()}),(self.file.fileName||self.file.fileContent)+"."+self.fileExtension)},getValueMeasureFromMeasureList=function(c,g,h,j,k){for(var m=0;m<c.length;m++)if(void 0!=c[m][h]&&c[m][h][1][0]==g)return c[m][h][0];return j[g][j[0].length-k+h]},reLoadDataArrays=function(c,g,h,j,k,m,n){fromUndefinedToBlanck(c);if(void 0!=c[0]){if(0<g.cantFormulaMeasures)for(var l=0;l<c.length;l++)c[l][h.length]=l;for(var o=[],q=h.length-1;-1<q;q--){for(var l=!0,r=0;r<
c.length;r++)if(l&&c[r][q]!=parseInt(c[r][q])){l=!1;break}o[q]=l}for(var q=0,c=o[q]?c.sort(function(c){return function(g,h){return parseInt(g[c])===parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(q)):c.sort(function(c){return function(g,h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(q)),r=c[0][q],t=0,l=0;l<c.length;l++)r!=c[l][q]?(r=c[l][q],c=OAT.PartialSort(c,t,l-1,q+1,h.length,o),t=l):l==c.length-1&&(c=OAT.PartialSort(c,t,l,q+1,h.length,o))}o=c;c=[];0<o.length&&(c[0]=o[0]);q=0;for(l=1;l<o.length;l++){for(var r=
!0,w=0;w<j.length;w++)if(o[l][w]!=o[l-1][w]){r=!1;break}if(r){for(w=j.length;w<j.length+m.length;w++)t=parseFloat(c[q][w])+parseFloat(o[l][w]),"#NuN#"==c[q][w]&&"#NuN#"==o[l][w]?t="#NuN#":"#NuN#"==c[q][w]?t=o[l][w]+"":"#NuN#"==o[l][w]&&(t=c[q][w]+""),c[q][w]=t+"";if(0<g.cantFormulaMeasures){for(var v=c[q][h.length],r=o[l][h.length],w=0;w<g.measureFormula.length;w++)if(g.measureFormula[w].hasFormula)for(var A=0;A<g.measureFormula[w].relatedMeasures.length;A++){var F=g.measureFormula[w].relatedMeasures[A],
t=parseFloat(n[v][F])+parseFloat(n[r][F]);n[v][F]=t+""}for(w=j.length;w<j.length+m.length;w++)t=parseFloat(n[v][w])+parseFloat(n[r][w]),n[v][w]=t+"";for(t=0;t<h.length;t++)n[r][t]=""}}else q++,c[q]=o[l]}if(0<g.cantFormulaMeasures&&void 0!=c[0])for(j=0;j<c.length;j++)c[j].splice(h.length,1);k.recordForFormula=n;k.formulaInfo=g;for(n=0;n<m.length;n++)if(g.measureFormula[n]&&g.measureFormula[n].hasFormula)for(j=0;j<c.length;j++)if(0==c[j][c[j].length-m.length+n]&&(l=k.getFormulaRowByDataRow(c[j],n,""),
l=EvaluateExpressionPivotJs(g.measureFormula[n].PolishNotation,l,g),Infinity==l||isNaN(l)))c[j][c[j].length-m.length+n]="#FoE#";k.GeneralDataRows=c;k.autoPagingRowsPerPage=void 0!=pageSize?parseInt(pageSize):10;k.TotalPagesPaging=parseInt(c.length/k.autoPagingRowsPerPage);0!=c.length%k.autoPagingRowsPerPage&&k.TotalPagesPaging++;k.allData=c;0<c.length&&fillGeneralDistinctValues(h.length-m.length,k,c)}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){OAT.Statistics={list:[{longDesc:"Count",shortDesc:"COUNT",func:"count"},{longDesc:"Sum",shortDesc:"SUM",func:"sum"},{longDesc:"Product",shortDesc:"PRODUCT",func:"product"},{longDesc:"Arithmetic mean",shortDesc:"MEAN",func:"amean"},{longDesc:"Maximum",shortDesc:"MAX",func:"max"},{longDesc:"Minimum",shortDesc:"MIN",func:"min"},{longDesc:"Distinct values",shortDesc:"DISTINCT",func:"distinct"},{longDesc:"Variance",shortDesc:"VAR",func:"variance"},
{longDesc:"Standard deviation",shortDesc:"STDDEV",func:"deviation"},{longDesc:"Median",shortDesc:"MEDIAN",func:"median"},{longDesc:"Mode",shortDesc:"MODE",func:"mode"}],count:function(c){return c.length},sum:function(c){if("#FoE#"==c)return"#NaV#";for(var g=0<c.length,h=0,j=0;j<c.length;j++)"#NuN#"!=c[j]&&(g=!1),isNaN(c[j])||(h+=c[j]);return g?"#NuN#":h},product:function(c){for(var g=1,h=0;h<c.length;h++)g*=c[h];return g},amean:function(c){for(var g=0,h=0;h<c.length;h++)g+=c[h];return c.length?g/
c.length:0},max:function(c){for(var g=Number.MIN_VALUE,h=0;h<c.length;h++)c[h]>g&&(g=c[h]);return g},min:function(c){for(var g=Number.MAX_VALUE,h=0;h<c.length;h++)c[h]<g&&(g=c[h]);return g},distinct:function(c){for(var g=0,h={},j=0;j<c.length;j++)h[c[j]]=1;for(p in h)g++;return g},deviation:function(c){c=OAT.Statistics.variance(c);return Math.sqrt(c)},variance:function(c){if(2>c.length)return 0;for(var g=0,h=OAT.Statistics.amean(c),j=0;j<c.length;j++)g+=(c[j]-h)*(c[j]-h);return g/(c.length-1)},median:function(c){return c.sort(function(c,
h){return c-h})[Math.floor(c.length/2)]},mode:function(c){for(var g={},h=0;h<c.length;h++){var j=c[h]+"";j in g?g[j]++:g[j]=1}var c=0,h="",k;for(k in g)j=g[k],j>c&&(c=j,h=k);return parseFloat(h)}};try{OAT.Loader.featureLoaded("statistics")}catch(ERROR$$32){}OAT.WinData={TYPE_TEMPLATE:-1,TYPE_AUTO:0,TYPE_MS:1,TYPE_MAC:2,TYPE_ROUND:3,TYPE_RECT:4,TYPE_ODS:5};OAT.Win=function(c){var g=this;this.options={title:"",x:0,y:0,visibleButtons:"cmMfr",enabledButtons:"cmMfr",innerWidth:0,innerHeight:0,outerWidth:350,
outerHeight:!1,stackGroupBase:100,type:OAT.WinData.TYPE_AUTO,template:!1,className:!1};for(var h in c)this.options[h]=c[h];g.dom={buttons:{c:!1,m:!1,M:!1,f:!1,r:!1},container:!1,content:!1,title:!1,caption:!1,status:!1,resizeContainer:!1};g.moveTo=function(c,h){g.dom.container.style.left=c+"px";g.dom.container.style.top=h+"px"};g.innerResizeTo=function(){};g.outerResizeTo=function(){};g.show=function(){document.body.appendChild(g.dom.container);OAT.Dom.show(g.dom.container)};g.hide=function(){OAT.Dom.hide(g.dom.container)};
g.close=g.hide();g.minimize=function(){};g.maximize=function(){};g.flip=function(){};g.accomodate=function(c){c=OAT.Dom.getWH(c);g.innerResizeTo(c[0],c[1])};g.options.type==OAT.WinData.TYPE_TEMPLATE&&OAT.WinTemplate(g);g.options.type==OAT.WinData.TYPE_MS&&OAT.WinMS(g);g.options.type==OAT.WinData.TYPE_MAC&&OAT.WinMAC(g);g.options.type==OAT.WinData.TYPE_RECT&&OAT.WinRECT(g,c.containerQuery);g.options.type==OAT.WinData.TYPE_ROUND&&OAT.WinROUND(g);g.options.type==OAT.WinData.TYPE_ODS&&OAT.WinODS(g);-1!=
g.options.enabledButtons.indexOf("m")&&g.dom.buttons.m&&OAT.Dom.attach(g.dom.buttons.m,"click",g.minimize);-1!=g.options.enabledButtons.indexOf("M")&&g.dom.buttons.M&&OAT.Dom.attach(g.dom.buttons.M,"click",g.maximize);-1!=g.options.enabledButtons.indexOf("c")&&g.dom.buttons.c&&OAT.Dom.attach(g.dom.buttons.c,"click",g.hide);-1!=g.options.enabledButtons.indexOf("f")&&g.dom.buttons.f&&OAT.Dom.attach(g.dom.buttons.f,"click",g.flip);-1!=g.options.enabledButtons.indexOf("r")&&g.dom.buttons.r&&OAT.Resize.create(g.dom.buttons.r,
g.dom.resizeContainer,OAT.Resize.TYPE_XY);g.dom.title&&OAT.Drag.create(g.dom.title,g.dom.container);g.moveTo(g.options.x,g.options.y);(g.options.outerWidth||g.options.outerHeight)&&g.outerResizeTo(g.options.outerWidth,g.options.outerHeight);(g.options.innerWidth||g.options.innerHeight)&&g.innerResizeTo(g.options.innerWidth,g.options.innerHeight);g.dom.caption&&(g.dom.caption.innerHTML=g.options.title);g.options.stackGroupBase&&OAT.WinManager.addWindow(g.options.stackGroupBase,g.dom.container);g.hide()};
OAT.WinTemplate=function(c){var g=c.options.template;if(g){for(var h="function"==typeof g?g():OAT.$(g).cloneNode(!0),j={oat_w_ctr:"container",oat_w_title_ctr:"title",oat_w_title_t_ctr:"caption",oat_w_content:"content",oat_w_max_b:["buttons","M"],oat_w_min_b:["buttons","m"],oat_w_close_b:["buttons","c"],oat_w_flip_b:["buttons","f"],oat_w_resize_handle:["buttons","r"]},k=[h],g=h.getElementsByTagName("*"),h=0;h<g.length;h++)k.push(g[h]);for(h=0;h<k.length;h++){var g=k[h],m;for(m in j)if(OAT.Dom.isClass(g,
m)){var n=j[m];n instanceof Array?c.dom[n[0]][n[1]]=g:c.dom[n]=g}}c.moveTo=function(g,h){c.dom.container.style.left=g+"px";c.dom.container.style.top=h+"px"};c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"};c.innerResizeTo=function(g,h){c.dom.content.style.width=g?g+"px":"auto";c.dom.content.style.height=h?h+"px":"auto"}}else alert("OAT Window cannot be created, as a template is required but not specified!")};OAT.WinMS=function(c){OAT.Style.include("winms.css");
c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winms_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winms_content");c.dom.title=OAT.Dom.create("div",{},"oat_winms_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winms_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winms_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",
{},"oat_winms_close_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("M")&&(c.dom.buttons.M=OAT.Dom.create("div",{},"oat_winms_max_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.M]));-1!=c.options.visibleButtons.indexOf("m")&&(c.dom.buttons.m=OAT.Dom.create("div",{},"oat_winms_min_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.m]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winms_resize_b"),OAT.Dom.append([c.dom.container,
c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinMAC=function(c){OAT.Style.include("winmac.css");c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winmac_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winmac_content");c.dom.title=OAT.Dom.create("div",{},"oat_winmac_title");c.dom.caption=OAT.Dom.create("span",
{},"oat_winmac_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winmac_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);c.dom.buttons.lc=OAT.Dom.create("div",{},"oat_winmac_leftCorner");OAT.Dom.append([c.dom.title,c.dom.buttons.lc]);c.dom.buttons.rc=OAT.Dom.create("div",{},"oat_winmac_rightCorner");OAT.Dom.append([c.dom.title,c.dom.buttons.rc]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winmac_close_b"),OAT.Dom.append([c.dom.title,
c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("M")&&(c.dom.buttons.M=OAT.Dom.create("div",{},"oat_winmac_max_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.M]));-1!=c.options.visibleButtons.indexOf("m")&&(c.dom.buttons.m=OAT.Dom.create("div",{},"oat_winmac_min_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.m]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winmac_resize_b"),OAT.Dom.append([c.dom.container,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,
c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h-8+"px":"auto"}};OAT.WinRECT=function(c,g){OAT.Style.include("winrect.css");c.dom.container=void 0!=g?OAT.Dom.create("div",{position:"absolute"},g+" oat_winrect_container"):OAT.Dom.create("div",{position:"absolute"},"oat_winrect_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winrect_content");c.dom.title=OAT.Dom.create("div",{},"oat_winrect_title");
c.dom.caption=OAT.Dom.create("span",{},"oat_winrect_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winrect_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winrect_close_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.c]));OAT.Dom.append([c.dom.title,c.dom.caption]);c.outerResizeTo=function(g,j){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=j?j+"px":
"auto"}};OAT.WinROUND=function(c){OAT.Style.include("winround.css");c.dom.container=OAT.Dom.create("div",{position:"absolute"},"oat_winround_container");c.dom.resizeContainer=c.dom.container;c.dom.table=OAT.Dom.create("table",{},"oat_winround_wrapper");c.dom.tr_t=OAT.Dom.create("tr",{});c.dom.td_lt=OAT.Dom.create("td",{},"oat_winround_lt");c.dom.td_t=OAT.Dom.create("td",{},"oat_winround_t");c.dom.td_rt=OAT.Dom.create("td",{},"oat_winround_rt");c.dom.tr_m=OAT.Dom.create("tr",{});c.dom.td_l=OAT.Dom.create("td",
{},"oat_winround_l");c.dom.td_m=OAT.Dom.create("td",{},"oat_winround_m");c.dom.td_r=OAT.Dom.create("td",{},"oat_winround_r");c.dom.tr_b=OAT.Dom.create("tr",{});c.dom.td_lb=OAT.Dom.create("td",{},"oat_winround_lb");c.dom.td_b=OAT.Dom.create("td",{},"oat_winround_b");c.dom.td_rb=OAT.Dom.create("td",{},"oat_winround_rb");c.dom.content=OAT.Dom.create("div",{},"oat_winround_content");c.dom.title=OAT.Dom.create("div",{},"oat_winround_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winround_caption");
c.dom.status=OAT.Dom.create("div",{},"oat_winround_status");-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winround_close_b"),OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winround_resize_b"),OAT.Dom.append([c.dom.td_rb,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);OAT.Browser.isIE?(c.dom.container.innerHTML='<table class="oat_winround_wrapper"><tr><td class="oat_winround_lt"></td><td class="oat_winround_t"></td><td class="oat_winround_rt"></td></tr><tr><td class="oat_winround_l"></td><td class="oat_winround_m"></td><td class="oat_winround_r"></td></tr><tr><td class="oat_winround_lb"></td><td class="oat_winround_b"></td><td class="oat_winround_rb"></td></tr></table>',
c.dom.container.childNodes[0].childNodes[0].childNodes[0].childNodes[1].appendChild(c.dom.title),c.dom.container.childNodes[0].childNodes[0].childNodes[1].childNodes[1].appendChild(c.dom.content),c.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[1].appendChild(c.dom.status),c.dom.container.childNodes[0].childNodes[0].childNodes[2].childNodes[2].appendChild(c.dom.buttons.r)):(OAT.Dom.append([c.dom.tr_t,c.dom.td_lt,c.dom.td_t,c.dom.td_rt]),OAT.Dom.append([c.dom.tr_m,c.dom.td_l,c.dom.td_m,
c.dom.td_r]),OAT.Dom.append([c.dom.tr_b,c.dom.td_lb,c.dom.td_b,c.dom.td_rb]),OAT.Dom.append([c.dom.table,c.dom.tr_t,c.dom.tr_m,c.dom.tr_b]),OAT.Dom.append([c.dom.td_t,c.dom.title]),OAT.Dom.append([c.dom.td_m,c.dom.content]),OAT.Dom.append([c.dom.td_b,c.dom.status]),OAT.Dom.append([c.dom.container,c.dom.table]));c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinODS=function(c){OAT.Style.include("winods.css");c.dom.container=
OAT.Dom.create("div",{position:"absolute"},"oat_winods_container");c.dom.resizeContainer=c.dom.container;c.dom.content=OAT.Dom.create("div",{},"oat_winods_content");c.dom.title=OAT.Dom.create("div",{},"oat_winods_title");c.dom.caption=OAT.Dom.create("span",{},"oat_winods_caption");c.dom.status=OAT.Dom.create("div",{},"oat_winods_status");OAT.Dom.append([c.dom.container,c.dom.title,c.dom.content,c.dom.status]);-1!=c.options.visibleButtons.indexOf("c")&&(c.dom.buttons.c=OAT.Dom.create("div",{},"oat_winods_close_b"),
OAT.Dom.append([c.dom.title,c.dom.buttons.c]));-1!=c.options.visibleButtons.indexOf("r")&&(c.dom.buttons.r=OAT.Dom.create("div",{},"oat_winods_resize_b"),OAT.Dom.append([c.dom.container,c.dom.buttons.r]));OAT.Dom.append([c.dom.title,c.dom.caption]);c.outerResizeTo=function(g,h){c.dom.container.style.width=g?g+"px":"auto";c.dom.container.style.height=h?h+"px":"auto"}};OAT.WinManager={stackingGroups:{},addWindow:function(c,g){if(c in OAT.WinManager.stackingGroups)var h=OAT.WinManager.stackingGroups[c];
else h=new OAT.Layers(c),OAT.WinManager.stackingGroups[c]=h;h.addLayer(g,"click")},removeWindow:function(){if(zI in OAT.WinManager.stackingGroups)var c=OAT.WinManager.stackingGroups[zI];else c=new OAT.Layers(zI),OAT.WinManager.stackingGroups[zI]=c;c.removeLayer(container)}};try{OAT.Loader.featureLoaded("win")}catch(ERROR$$33){}OAT.Resize={TYPE_X:1,TYPE_Y:2,TYPE_XY:3,element:[],mouse_x:0,mouse_y:0,move:function(c){if(OAT.Resize.element.length){for(var g=c.clientX-OAT.Resize.mouse_x,h=c.clientY-OAT.Resize.mouse_y,
j=1,k=0;k<OAT.Resize.element.length;k++){var m=OAT.Resize.element[k][0],m=OAT.Dom.getWH(m),n=OAT.Resize.element[k][2],l=g,o=h;switch(OAT.Resize.element[k][1]){case OAT.Resize.TYPE_X:o=0;break;case -OAT.Resize.TYPE_X:l=-g;o=0;break;case OAT.Resize.TYPE_Y:l=0;break;case -OAT.Resize.TYPE_Y:l=0;o=-h;break;case -OAT.Resize.TYPE_XY:l=-g,o=-h}n(m[0]+l,m[1]+o)&&(j=0)}if(j){for(k=0;k<OAT.Resize.element.length;k++)switch(m=OAT.Resize.element[k][0],OAT.Resize.element[k][1]){case OAT.Resize.TYPE_X:OAT.Dom.resizeBy(m,
g,0);break;case -OAT.Resize.TYPE_X:OAT.Dom.resizeBy(m,-g,0);break;case OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(m,0,h);break;case -OAT.Resize.TYPE_Y:OAT.Dom.resizeBy(m,0,-h);break;case OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(m,g,h);break;case -OAT.Resize.TYPE_XY:OAT.Dom.resizeBy(m,-g,-h)}OAT.Resize.mouse_x=c.clientX;OAT.Resize.mouse_y=c.clientY}}},up:function(){for(var c=0;c<OAT.Resize.element.length;c++)OAT.Resize.element[c][3]();OAT.Resize.element=[]},create:function(c,g,h,j,k){var m=OAT.$(c),c=OAT.$(g),
g=function(){return!1},n=function(){return!1};j&&(g=j);k&&(n=k);switch(h){case OAT.Resize.TYPE_XY:m.style.cursor="nw-resize";break;case OAT.Resize.TYPE_X:m.style.cursor="w-resize";break;case OAT.Resize.TYPE_Y:m.style.cursor="n-resize"}j=function(c){OAT.Resize.element=m._Resize_movers;OAT.Resize.mouse_x=c.clientX;OAT.Resize.mouse_y=c.clientY;c.cancelBubble=!0};m._Resize_movers||(OAT.Dom.attach(m,"mousedown",j),m._Resize_movers=[]);m._Resize_movers.push([c,h,g,n])},remove:function(c,g){var h=OAT.$(c);
OAT.$(g);if(h._Resize_movers){for(var j=-1,k=0;k<h._Resize_movers.length;k++)h._Resize_movers[k][0]==g&&(j=k);-1!=j&&h._Resize_movers.splice(j,1)}},removeAll:function(c){c=OAT.$(c);c._Resize_movers&&(c._Resize_movers=[])},createDefault:function(c,g,h){if(OAT.Preferences.allowDefaultResize){var j=OAT.Dom.create("div",{position:"absolute",width:"10px",height:"10px",right:"0px",fontSize:"1px",bottom:"0px",backgroundImage:"url("+OAT.Preferences.imagePath+"resize.gif)"});c.appendChild(j);OAT.Resize.create(j,
c,OAT.Resize.TYPE_XY,g,h);OAT.Dom.hide(j);var k=function(){j._Resize_pending&&OAT.Dom.hide(j)};OAT.Dom.attach(c,"mouseover",function(){OAT.Dom.show(j);j._Resize_pending=0});OAT.Dom.attach(c,"mouseout",function(){j._Resize_pending=1;setTimeout(k,2E3)})}}};OAT.Dom.attach(document,"mousemove",OAT.Resize.move);OAT.Dom.attach(document,"mouseup",OAT.Resize.up);try{OAT.Loader.featureLoaded("resize")}catch(ERROR$$34){}OAT.Ajax={number:0,httpError:1,startRef:!1,endRef:!1,errorRef:!1,cancel:!1,dialog:!1,GET:1,
POST:2,SOAP:4,PUT:8,MKCOL:16,PROPFIND:32,PROPPATCH:64,AUTH_BASIC:1024,AUTH_DIGEST:512,TYPE_TEXT:0,TYPE_XML:1,user:"",password:"",imagePath:OAT.Preferences.imagePath,requests:[],startNotify:function(){if(OAT.Ajax.startRef)OAT.Ajax.startRef();else if(-1!=OAT.Loader.loadedLibs.findIndex("dialog")){if(!OAT.Ajax.dialog){var c=OAT.Ajax.imagePath;"/"==c.charAt(c.length-1)&&c.substring(0,c.length-1);c=OAT.Dom.create("div");c.innerHTML="Ajax call in progress...";var g=OAT.Dom.create("div"),h=OAT.Dom.create("img");
h.setAttribute("src",OAT.Ajax.imagePath+"/progress.gif");g.appendChild(h);c.appendChild(g);OAT.Ajax.dialog=new OAT.Dialog("Please wait",c,{width:260,modal:0,zIndex:1001,resize:0,imagePath:OAT.Ajax.imagePath+"/"});OAT.Ajax.dialog.ok=OAT.Ajax.dialog.hide;OAT.Ajax.dialog.cancel=OAT.Ajax.dialog.hide;OAT.Ajax.setCancel(OAT.Ajax.dialog.cancelBtn)}OAT.Ajax.dialog.show()}},endNotify:function(){OAT.Ajax.endRef?OAT.Ajax.endRef():-1!=OAT.Loader.loadedLibs.findIndex("dialog")&&OAT.Ajax.dialog&&OAT.Ajax.dialog.hide()},
command:function(c,g,h,j,k,m){(OAT.Ajax.startRef||OAT.Preferences.showAjax)&&!OAT.Ajax.number&&OAT.Ajax.startNotify();OAT.Ajax.number++;var n=new OAT.XMLHTTP,l=null,o={state:1};OAT.Ajax.requests.push(o);n.setResponse(function(){if(o.state&&4==n.getReadyState()){var c=n.getAllResponseHeaders();OAT.Ajax.number--;(OAT.Ajax.endRef||OAT.Preferences.showAjax)&&!OAT.Ajax.number&&OAT.Ajax.endNotify();if("2"==n.getStatus().toString().charAt(0)||0==n.getStatus())if(k==OAT.Ajax.TYPE_TEXT)j(n.getResponseText(),
c);else{if(OAT.Dom.isIE()||OAT.Dom.isWebKit()){xmlStr=n.getResponseText();var g=OAT.Xml.createXmlDoc(xmlStr)}else g=n.getResponseXML();j(g,c)}else OAT.Ajax.errorRef?OAT.Ajax.errorRef(n.getStatus(),n.getResponseText(),c):OAT.Ajax.httpError&&confirm("Problem retrieving data, status="+n.getStatus()+", do you want to see returned problem description?")&&alert(n.getResponseText())}});l=h();c&OAT.Ajax.GET&&(h=/\?/.test(g)?g+"&"+l:g+"?"+l,n.open("GET",h,!0));c&OAT.Ajax.POST&&(n.open("POST",g,!0),n.setRequestHeader("Content-Type",
"application/x-www-form-urlencoded"));c&OAT.Ajax.SOAP&&n.open("POST",g,!0);c&OAT.Ajax.PUT&&n.open("PUT",g,!0);c&OAT.Ajax.MKCOL&&n.open("MKCOL",g,!0);c&OAT.Ajax.PROPFIND&&n.open("PROPFIND",g,!0);c&OAT.Ajax.PROPPATCH&&n.open("PROPPATCH",g,!0);c&OAT.Ajax.AUTH_BASIC&&n.setRequestHeader("Authorization","Basic "+OAT.Crypto.base64e(OAT.Ajax.user+":"+OAT.Ajax.password));if(m)for(var q in m)n.setRequestHeader(q,m[q]);n.send(c&OAT.Ajax.GET?null:l)},setStart:function(c){OAT.Ajax.startRef=c},setEnd:function(c){OAT.Ajax.endRef=
c},handleError:function(c){OAT.Ajax.errorRef=c},setCancel:function(c){c=OAT.$(c);OAT.Ajax.cancel=c;OAT.Dom.attach(c,"click",OAT.Ajax.cancelAll)},cancelAll:function(){for(var c=0;c<OAT.Ajax.requests.length;c++)OAT.Ajax.requests[c].state&&(OAT.Ajax.requests[c].state=0);(OAT.Ajax.endRef||OAT.Preferences.showAjax)&&OAT.Ajax.endNotify();OAT.Ajax.number=0}};OAT.XMLHTTP=function(){this.obj=this.iframe=!1;this.open=function(c,g,h){this.iframe?this.temp_src=g:this.obj.open(c,g,h)};this.send=function(c){this.iframe?
this.ifr.src=this.temp_src:this.obj.send(c)};this.setResponse=function(c){this.iframe?OAT.Dom.attach(this.ifr,"load",c):this.obj.onreadystatechange=c};this.getResponseText=function(){return this.iframe?this.ifr.contentWindow.document.body.innerHTML:this.obj.responseText};this.getResponseXML=function(){return this.iframe?(alert("IFRAME mode active -> XML data not supported"),""):this.obj.responseXML};this.getReadyState=function(){return this.iframe?4:this.obj.readyState};this.getStatus=function(){return this.iframe?
200:this.obj.status};this.setRequestHeader=function(c,g){this.iframe||this.obj.setRequestHeader(c,g)};this.getAllResponseHeaders=function(){return!this.iframe?this.obj.getAllResponseHeaders():{}};this.isIframe=function(){return this.iframe};window.XMLHttpRequest?this.obj=new XMLHttpRequest:window.ActiveXObject&&(this.obj=new ActiveXObject("Microsoft.XMLHTTP"));this.obj||(this.iframe=!0,this.ifr=OAT.Dom.create("iframe"),this.ifr.style.display="none",this.ifr.src="javascript:;",document.body.appendChild(this.ifr))};
OAT.XMLHTTP_supported=function(){return!(new OAT.XMLHTTP).isIframe()};try{OAT.Loader.featureLoaded("ajax")}catch(ERROR$$35){}OAT.AnchorData={active:!1,window:!1};OAT.Anchor={appendContent:function(c){if(c.content&&c.window){"function"==typeof c.content&&(c.content=c.content());var g=c.window;OAT.Dom.clear(g.dom.content);g.dom.content.appendChild(c.content);OAT.Anchor.fixSize(g)}},callForData:function(c,g){var h=c.window;c.stat=1;c.title&&(h.dom.caption.innerHTML=c.title);c.status&&(h.dom.status.innerHTML=
c.status);var j=c.datasource;if(j){j.connection=c.connection;var k=c.elm.innerHTML,m=function(){h.dom.caption.innerHTML=c.elm.innerHTML;c.title&&(h.dom.caption.innerHTML=c.title)};j.bindRecord(m);j.bindEmpty(m)}switch(c.result_control){case "grid":m=new OAT.FormObject.grid(0,0,0,1);m.showAll=!0;c.content=m.elm;m.elm.style.position="relative";m.init();j.bindRecord(m.bindRecordCallback);j.bindPage(m.bindPageCallback);j.bindHeader(m.bindHeaderCallback);break;case "form":var n=!1;c.content=OAT.Dom.create("div");
n=new OAT.Form(c.content,{onDone:function(){h.resizeTo(n.totalWidth+5,n.totalHeight+5);c.anchorTo(g[0],g[1])}});j.bindFile(function(c){c=OAT.Xml.createXmlDoc(c);n.createFromXML(c)});break;case "timeline":m=new OAT.FormObject.timeline(0,20,0);c.content=m.elm;m.elm.style.position="relative";m.elm.style.width=c.width-5+"px";m.elm.style.height=c.height-65+"px";m.init();for(var l=0;l<m.datasources[0].fieldSets.length;l++)m.datasources[0].fieldSets[l].realIndexes=[l];j.bindPage(m.bindPageCallback)}OAT.Anchor.appendContent(c);
if(j){j.options.query=j.options.query.replace(/\$link_name/g,k);c.connection.options.endpoint=c.href;c.connection.options.url=c.href;switch(j.type){case OAT.DataSourceData.TYPE_SPARQL:k=new OAT.SparqlQuery;k.fromString(j.options.query);k=k.variables.length?"format=xml":"format=rdf";j.options.query="query="+encodeURIComponent(j.options.query)+"&"+k;break;case OAT.DataSourceData.TYPE_GDATA:j.options.query=j.options.query?"q="+encodeURIComponent(j.options.query):""}j.advanceRecord(0)}},fixSize:function(){setTimeout(function(){},
50)},assign:function(c,g){var h=OAT.$(c),j={href:!1,newHref:"javascript:void(0)",connection:!1,datasource:!1,content:!1,status:!1,title:!1,result_control:"grid",activation:"hover",width:340,height:!1,elm:h,window:!1,arrow:!1,type:OAT.WinData.TYPE_RECT,visibleButtons:"cr",enabledButtons:"cr",template:!1},k;for(k in g)j[k]=g[k];var m=new OAT.Win({outerWidth:j.width,outerHeight:j.height,title:"Loading...",type:j.type,status:j.status,visibleButtons:j.visibleButtons,enabledButtons:j.enabledButtons,template:j.template,
containerQuery:j.containerQuery});OAT.Dom.attach(m.dom.container,"mouseover",function(){var c=OAT.AnchorData.active;c&&"hover"==c.activation&&c.endClose()});OAT.Dom.attach(m.dom.container,"mouseout",function(){var c=OAT.AnchorData.active;c&&"hover"==c.activation&&c.startClose()});k=OAT.Dom.create("div",{});j.window=m;m.close=function(){OAT.Dom.hide(m.dom.container)};m.onclose=m.close;m.close();j.stat=0;!j.href&&"href"in h&&(j.href=h.href);"a"==h.tagName.toString().toLowerCase()&&OAT.Dom.changeHref(h,
j.newHref);j.displayRef=function(c){var g=j.window;g.hide();OAT.AnchorData.active=j;c=OAT.Dom.eventPos(c);OAT.AnchorData.window=g;j.stat?OAT.Anchor.appendContent(j):OAT.Anchor.callForData(j,c);"focus"==j.activation&&(c=OAT.Dom.position(h));j.anchorTo(c[0],c[1]);g.show();j.anchorTo(c[0],c[1])};j.displayRef2=function(c){var g=j.window;g.hide();OAT.AnchorData.active=j;OAT.AnchorData.window=g;j.stat?OAT.Anchor.appendContent(j):OAT.Anchor.callForData(j,c);"focus"==j.activation&&(c=OAT.Dom.position(h));
j.anchorTo(c[0],c[1]);g.show();j.anchorTo(c[0],c[1])};j.anchorTo=function(c,g){var h=j.window,k=OAT.Dom.getFreeSpace(c,g),m=OAT.Dom.getWH(h.dom.container),t=k[1]?g-30-m[1]:g+30,k=k[0]?c+20-m[0]:c-30;0>k&&(k=10);0>t&&(t=10);h.moveTo(k,t-20)};j.closeRef=function(){j.closeFlag&&(j.window.hide(),OAT.AnchorData.active=!1)};j.close=function(){j.window.hide()};j.startClose=function(){j.closeFlag=1;setTimeout(j.closeRef,1E3)};j.endClose=function(){j.closeFlag=0};switch(j.activation){case "hover":OAT.Dom.attach(h,
"mouseover",j.displayRef);OAT.Dom.attach(h,"mouseout",j.startClose);break;case "click":OAT.Dom.attach(h,"click",j.displayRef);break;case "dblclick":OAT.Dom.attach(h,"dblclick",j.displayRef);break;case "focus":OAT.Dom.attach(h,"focus",j.displayRef),OAT.Dom.attach(h,"blur",j.close)}return j},close:function(c,g){c=OAT.$(c);"BODY"!=c.tagName&&(c.className.match(/^oat_win.+_container$/)?(OAT.Dom.hide(c),g&&this.close(c.parentNode)):this.close(c.parentNode))},openAnchor:function(){var c=this.window;c.hide();
OAT.AnchorData.active=this;b=OAT.Dom.eventPos(b);OAT.AnchorData.window=c;a.stat?OAT.Anchor.appendContent(a):OAT.Anchor.callForData(a,b);"focus"==a.activation&&(b=OAT.Dom.position(e));a.anchorTo(b[0],b[1]);c.show();a.anchorTo(b[0],b[1])}};try{OAT.Loader.featureLoaded("anchor")}catch(ERROR$$36){}OAT.Animation=function(c,g){var h=this;this.elm=OAT.$(c);this.options={delay:50,startFunction:function(){},conditionFunction:function(){},stepFunction:function(){},stopFunction:function(){}};for(var j in g)h.options[j]=
g[j];this.step=function(){setTimeout(function(){h.running&&(h.options.conditionFunction(h)?(h.running=0,h.options.stopFunction(h),OAT.MSG.send(h,OAT.MSG.ANIMATION_STOP,h)):(h.options.stepFunction(h),h.step(h)))},h.options.delay)};this.start=function(){h.running=1;h.options.startFunction(h);h.step()};this.stop=function(){h.running=0}};OAT.AnimationSize=function(c,g){var h=this;this.options={width:-1,height:-1,delay:50,speed:1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,
startFunction:function(c){c.stepX=0;c.stepY=0;var g=OAT.Dom.getWH(c.elm);c.width=g[0];c.height=g[1];c.diffX=-1==h.options.width?0:h.options.width-g[0];c.diffY=-1==h.options.height?0:h.options.height-g[1];c.signX=0<=c.diffX?1:-1;c.signY=0<=c.diffY?1:-1;var g=c.diffX*c.diffX,j=c.diffY*c.diffY;c.stepX=c.signX*Math.sqrt(h.options.speed*h.options.speed*g/(g+j));c.stepY=c.signY*Math.sqrt(h.options.speed*h.options.speed*j/(g+j))},stopFunction:function(c){-1!=h.options.width&&(c.elm.style.width=h.options.width+
"px");-1!=h.options.height&&(c.elm.style.height=h.options.height+"px")},conditionFunction:function(c){var g=0<c.signX?c.width>=h.options.width:c.width<=h.options.width,c=0<c.signY?c.height>=h.options.height:c.height<=h.options.height;-1==h.options.width&&(g=1);-1==h.options.height&&(c=1);return g&&c},stepFunction:function(c){c.width+=c.stepX;c.height+=c.stepY;var g=parseInt(c.width),j=parseInt(c.height);-1!=h.options.width&&(c.elm.style.width=(0<=g?g:0)+"px");-1!=h.options.height&&(c.elm.style.height=
(0<=j?j:0)+"px")}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationPosition=function(c,g){var h=this;this.options={left:-1,top:-1,delay:50,speed:1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c.stepX=0;c.stepY=0;var g=OAT.Dom.getLT(c.elm);c.left=g[0];c.top=g[1];c.diffX=-1==h.options.left?0:h.options.left-g[0];c.diffY=-1==h.options.top?0:h.options.top-g[1];c.signX=0<=c.diffX?1:-1;c.signY=0<=c.diffY?1:-1;
var g=c.diffX*c.diffX,j=c.diffY*c.diffY;c.stepX=c.signX*Math.sqrt(h.options.speed*h.options.speed*g/(g+j));c.stepY=c.signY*Math.sqrt(h.options.speed*h.options.speed*j/(g+j))},stopFunction:function(c){-1!=h.options.left&&(c.elm.style.left=h.options.left+"px");-1!=h.options.top&&(c.elm.style.top=h.options.top+"px")},conditionFunction:function(c){var g=0<c.signX?c.left>=h.options.left:c.left<=h.options.left,c=0<c.signY?c.top>=h.options.top:c.top<=h.options.top;-1==h.options.left&&(g=1);-1==h.options.top&&
(c=1);return g&&c},stepFunction:function(c){c.left+=c.stepX;c.top+=c.stepY;var g=parseInt(c.left),j=parseInt(c.top);-1!=h.options.left&&(c.elm.style.left=g+"px");-1!=h.options.top&&(c.elm.style.top=j+"px")}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationOpacity=function(c,g){var h=this;this.options={opacity:1,delay:50,speed:0.1};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c.opacity=1;OAT.Browser.isGecko&&
(c.opacity=parseFloat(OAT.Dom.style(c.elm,"opacity")));if(OAT.Browser.isIE){var g=OAT.Dom.style(c.elm,"filter").match(/alpha\(opacity=([^\)]+)\)/);g&&(c.opacity=parseFloat(g[1])/100)}c.step_=1;c.diff=h.options.opacity-c.opacity;c.sign=0<=c.diff?1:-1;c.step_=c.sign*h.options.speed},stopFunction:function(c){OAT.Style.opacity(c.elm,h.options.opacity)},conditionFunction:function(c){return 0<c.sign?c.opacity+1.0E-4>=h.options.opacity:c.opacity-1.0E-4<=h.options.opacity},stepFunction:function(c){c.opacity+=
c.step_;OAT.Style.opacity(c.elm,c.opacity)}});this.start=h.animation.start;this.stop=h.animation.stop};OAT.AnimationCSS=function(c,g){var h=this;this.options={delay:50,property:!1,start:0,step:1,stop:10};for(var j in g)h.options[j]=g[j];this.animation=new OAT.Animation(c,{delay:h.options.delay,startFunction:function(c){c[h.options.property]=h.options.start;c.elm.style[h.options.property]=h.options.start},stopFunction:function(c){c.elm.style[h.options.property]=h.options.stop},conditionFunction:function(c){return c[h.options.property]==
h.options.stop},stepFunction:function(c){c[h.options.property]+=h.options.step;c.elm.style[h.options.property]=c[h.options.property]}});this.start=h.animation.start;this.stop=h.animation.stop};try{OAT.Loader.featureLoaded("animation")}catch(ERROR$$37){}OAT.getURL=function(){try{var c=location.href.substring(0,location.href.lastIndexOf("/")),g=c;"http://"==g.substr(0,7)&&(g=g.substr(7));var h="",j=g.indexOf("/");-1<j&&(h=g.substr(j+1),g.substr(0,j));var k=location.href.substring(c.length+1,location.href.length+
1),j=k.indexOf("?");-1<j&&(k=k.substring(0,j));j=k.indexOf("#");-1<j&&(k=k.substring(0,j));c="";j=k.indexOf(".");-1<j&&(c=k.substring(j+1),k=k.substr(0,j));j=k;""!=c&&(j+="."+c);""==j&&(k="index");args=location.search.substr(1).split("?");return h+k}catch(m){return""}};OAT.PartialSort=function(c,g,h,j,k,m){for(var n=[],l=0;l<=h-g;l++)n[l]=c[g+l];m[j]?n.sort(function(c){return function(g,h){return parseInt(g[c])===parseInt(h[c])?0:parseInt(g[c])<parseInt(h[c])?-1:1}}(j)):n.sort(function(c){return function(g,
h){return g[c]===h[c]?0:g[c]<h[c]?-1:1}}(j));if(j<k-1)for(var l=n[0][j],o=0,q=0;q<n.length;q++)l!=n[q][j]?(l=n[q][j],n=OAT.PartialSort(n,o,q-1,j+1,k,m),o=q):q==n.length-1&&(n=OAT.PartialSort(n,o,q,j+1,k,m));for(l=g;l<=h;l++)c[l]=n[l-g];return c};OAT.BarChart=function(c,g){var h=this;this.options={percentage:!1,spacing:25,paddingLeft:30,paddingBottom:30,paddingTop:5,width:15,colors:["#f00","#0f0","#00f"],border:!0,grid:!0,gridDesc:!0,gridNum:6,shadow:!0,shadowColor:"#222",shadowOffset:2};for(var j in g)this.options[j]=
g[j];this.maxValue=0;this.data=[];this.textX=[];this.textY=[];this.div=OAT.$(c);OAT.Dom.makePosition(h.div);this.getFreeH=function(){return OAT.Dom.getWH(h.div)[1]-h.options.paddingTop-h.options.paddingBottom};this.drawColumn=function(c,g){var j=h.options,l=h.freeH,o="object"==typeof h.data[c]?h.data[c]:[h.data[c]];if(j.percentage){for(var q=[],r=0,t=0;t<o.length;t++)r+=o[t];for(t=0;t<o.length;t++)q.push(h.maxValue*o[t]/r)}else q=o;for(var w=j.paddingBottom,r=0,o=[],t=0;t<q.length;t++){var v=q[t],
A=OAT.Dom.create("div",{position:"absolute",fontSize:"0px",lineHeight:"0px"});j.border&&(A.style.border="1px solid #000");A.style.width=j.width+"px";A.style.backgroundColor=j.colors[t];A.style.left=g+"px";A.style.bottom=w+"px";v=h.scale(v);A.style.height=v+"px";w+=v;r+=v;o.push(A)}j.shadow&&(q=OAT.Dom.create("div",{position:"absolute",fontSize:"0px",lineHeight:"0px"}),q.style.left=parseInt(g)+j.shadowOffset+"px",q.style.bottom=j.paddingBottom+j.shadowOffset+"px",q.style.width=j.width+"px",q.style.height=
r+"px",q.style.backgroundColor=j.shadowColor,j.border&&(q.style.borderColor=j.shadowColor,q.style.borderWidth="1px",q.style.borderStyle="solid"),h.div.appendChild(q));for(t=0;t<o.length;t++)h.div.appendChild(o[t]);h.textX.length&&(r=OAT.Dom.create("div",{position:"absolute"}),r.className="textX",r.innerHTML=h.textX[c],r.style.top=l+j.paddingTop+2+"px",r.style.left=g+"px",h.div.appendChild(r),l=OAT.Dom.getWH(r),r.style.left=g+Math.round(j.width/2)-Math.round(l[0]/2)+"px")};this.draw=function(){OAT.Dom.clear(h.div);
h.div.style.width="100%";if(h.data.length){var c=h.options.paddingLeft,g=h.data.length*(h.options.width+h.options.spacing);h.freeH=h.getFreeH();for(var j=h.maxValue=0;j<h.data.length;j++)if("object"==typeof h.data[j]){for(var l=0,o=0;o<h.data[j].length;o++)l+=parseFloat(h.data[j][o]);l>h.maxValue&&(h.maxValue=l)}else parseFloat(h.data[j])>h.maxValue&&(h.maxValue=h.data[j]);if(h.options.grid){j=(h.options.percentage?100:h.maxValue)/h.options.gridNum;l=Math.floor(Math.log(j)/Math.log(10));l=Math.pow(10,
l);l*=Math.round(j/l);for(j=0;j<=(h.options.percentage?100:h.maxValue);j+=l){var j=Math.round(1E3*j)/1E3,o=OAT.Dom.create("div",{position:"absolute",width:g+"px",height:"1px",fontSize:"0px",lineHeight:"0px",backgroundColor:"#000"}),q=h.options.percentage?h.scale(j/100*h.maxValue):h.scale(j),q=h.options.paddingTop+h.freeH-q;o.style.left=c+"px";o.style.top=q+"px";h.div.appendChild(o);if(h.options.gridDesc){var r=OAT.Dom.create("div",{position:"absolute"});r.innerHTML=j;r.className="textY";r.style.left=
c+"px";r.style.top=q+"px";h.div.appendChild(r);o=OAT.Dom.getWH(r);r.style.left=c-2-o[0]+"px";r.style.top=q-Math.round(o[1]/2)+"px"}}}c+=Math.round(h.options.spacing/2);for(j=0;j<h.data.length;j++)h.drawColumn(j,c),c+=h.options.width+h.options.spacing;if(h.textY.length){var t=OAT.Dom.create("div",{position:"absolute"});t.className="legend";t.style.left=c+"px";t.style.top=h.options.paddingTop+"px";h.div.appendChild(t);for(j=h.data[0].length-1;0<=j;j--)o=OAT.Dom.create("div",{clear:"left"}),c=OAT.Dom.create("div"),
c.className="legend_box",c.style.backgroundColor=h.options.colors[j],o.appendChild(c),c=OAT.Dom.text(h.textY[j]),o.appendChild(c),t.appendChild(o)}l=h.options.paddingLeft+h.data.length*(h.options.width+h.options.spacing)+5;h.textY.length&&(o=OAT.Dom.getWH(t),l+=o[0]+5+Math.round(h.options.spacing/2));isNaN(l)||(h.div.style.width=l+"px")}};this.scale=function(c){return Math.round(c/h.maxValue*h.freeH)};this.attachData=function(c){h.data=c};this.attachTextX=function(c){h.textX=c};this.attachTextY=function(c){h.textY=
c}};try{OAT.Loader.featureLoaded("barchart")}catch(ERROR$$39){}OAT.Crypto={base64e:function(c){var g="",h,j,k="",m,n,l="",o=0;if(!c.length)return g;do h=c.charCodeAt(o++),j=c.charCodeAt(o++),k=c.charCodeAt(o++),m=h>>2,h=(h&3)<<4|j>>4,n=(j&15)<<2|k>>6,l=k&63,isNaN(j)?n=l=64:isNaN(k)&&(l=64),g=g+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l);while(o<c.length);return g},base64d:function(c){if(!c)return"";var g="",h,j,k="",m,n="",l=0;/[^A-Za-z0-9\+\/\=]/g.exec(c)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/', and '='\nExpect errors in decoding.");c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");if(!c.length)return g;do h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),
j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(l++)),h=h<<2|j>>4,j=(j&15)<<4|m>>2,k=(m&3)<<6|n,g+=String.fromCharCode(h),64!=m&&(g+=String.fromCharCode(j)),64!=n&&(g+=String.fromCharCode(k));while(l<c.length);return g},md5:function(c){function g(c,g,h,j,k,t){c=m(m(g,c),m(j,t));
return m(c<<k|c>>>32-k,h)}function h(c,h,j,k,m,t,w){return g(h&j|~h&k,c,h,m,t,w)}function j(c,h,j,k,m,t,w){return g(h&k|j&~k,c,h,m,t,w)}function k(c,h,j,k,m,t,w){return g(j^(h|~k),c,h,m,t,w)}function m(c,g){var h=(c&65535)+(g&65535);return(c>>16)+(g>>16)+(h>>16)<<16|h&65535}return function(c){for(var g="",h=0;h<4*c.length;h++)g+="0123456789abcdef".charAt(c[h>>2]>>8*(h%4)+4&15)+"0123456789abcdef".charAt(c[h>>2]>>8*(h%4)&15);return g}(function(c,l){c[l>>5]|=128<<l%32;c[(l+64>>>9<<4)+14]=l;for(var o=
1732584193,q=-271733879,r=-1732584194,t=271733878,w=0;w<c.length;w+=16)var v=o,A=q,F=r,H=t,o=h(o,q,r,t,c[w+0],7,-680876936),t=h(t,o,q,r,c[w+1],12,-389564586),r=h(r,t,o,q,c[w+2],17,606105819),q=h(q,r,t,o,c[w+3],22,-1044525330),o=h(o,q,r,t,c[w+4],7,-176418897),t=h(t,o,q,r,c[w+5],12,1200080426),r=h(r,t,o,q,c[w+6],17,-1473231341),q=h(q,r,t,o,c[w+7],22,-45705983),o=h(o,q,r,t,c[w+8],7,1770035416),t=h(t,o,q,r,c[w+9],12,-1958414417),r=h(r,t,o,q,c[w+10],17,-42063),q=h(q,r,t,o,c[w+11],22,-1990404162),o=h(o,
q,r,t,c[w+12],7,1804603682),t=h(t,o,q,r,c[w+13],12,-40341101),r=h(r,t,o,q,c[w+14],17,-1502002290),q=h(q,r,t,o,c[w+15],22,1236535329),o=j(o,q,r,t,c[w+1],5,-165796510),t=j(t,o,q,r,c[w+6],9,-1069501632),r=j(r,t,o,q,c[w+11],14,643717713),q=j(q,r,t,o,c[w+0],20,-373897302),o=j(o,q,r,t,c[w+5],5,-701558691),t=j(t,o,q,r,c[w+10],9,38016083),r=j(r,t,o,q,c[w+15],14,-660478335),q=j(q,r,t,o,c[w+4],20,-405537848),o=j(o,q,r,t,c[w+9],5,568446438),t=j(t,o,q,r,c[w+14],9,-1019803690),r=j(r,t,o,q,c[w+3],14,-187363961),
q=j(q,r,t,o,c[w+8],20,1163531501),o=j(o,q,r,t,c[w+13],5,-1444681467),t=j(t,o,q,r,c[w+2],9,-51403784),r=j(r,t,o,q,c[w+7],14,1735328473),q=j(q,r,t,o,c[w+12],20,-1926607734),o=g(q^r^t,o,q,c[w+5],4,-378558),t=g(o^q^r,t,o,c[w+8],11,-2022574463),r=g(t^o^q,r,t,c[w+11],16,1839030562),q=g(r^t^o,q,r,c[w+14],23,-35309556),o=g(q^r^t,o,q,c[w+1],4,-1530992060),t=g(o^q^r,t,o,c[w+4],11,1272893353),r=g(t^o^q,r,t,c[w+7],16,-155497632),q=g(r^t^o,q,r,c[w+10],23,-1094730640),o=g(q^r^t,o,q,c[w+13],4,681279174),t=g(o^q^
r,t,o,c[w+0],11,-358537222),r=g(t^o^q,r,t,c[w+3],16,-722521979),q=g(r^t^o,q,r,c[w+6],23,76029189),o=g(q^r^t,o,q,c[w+9],4,-640364487),t=g(o^q^r,t,o,c[w+12],11,-421815835),r=g(t^o^q,r,t,c[w+15],16,530742520),q=g(r^t^o,q,r,c[w+2],23,-995338651),o=k(o,q,r,t,c[w+0],6,-198630844),t=k(t,o,q,r,c[w+7],10,1126891415),r=k(r,t,o,q,c[w+14],15,-1416354905),q=k(q,r,t,o,c[w+5],21,-57434055),o=k(o,q,r,t,c[w+12],6,1700485571),t=k(t,o,q,r,c[w+3],10,-1894986606),r=k(r,t,o,q,c[w+10],15,-1051523),q=k(q,r,t,o,c[w+1],21,
-2054922799),o=k(o,q,r,t,c[w+8],6,1873313359),t=k(t,o,q,r,c[w+15],10,-30611744),r=k(r,t,o,q,c[w+6],15,-1560198380),q=k(q,r,t,o,c[w+13],21,1309151649),o=k(o,q,r,t,c[w+4],6,-145523070),t=k(t,o,q,r,c[w+11],10,-1120210379),r=k(r,t,o,q,c[w+2],15,718787259),q=k(q,r,t,o,c[w+9],21,-343485551),o=m(o,v),q=m(q,A),r=m(r,F),t=m(t,H);return[o,q,r,t]}(function(c){for(var g=[],h=0;h<8*c.length;h+=8)g[h>>5]|=(c.charCodeAt(h/8)&255)<<h%32;return g}(c),8*c.length))},sha:function(c){function g(c,g){var k=(c&65535)+(g&
65535);return(c>>16)+(g>>16)+(k>>16)<<16|k&65535}return function(c){for(var g="",k=0;k<4*c.length;k++)g+="0123456789abcdef".charAt(c[k>>2]>>8*(3-k%4)+4&15)+"0123456789abcdef".charAt(c[k>>2]>>8*(3-k%4)&15);return g}(function(c,j){c[j>>5]|=128<<24-j%32;c[(j+64>>9<<4)+15]=j;for(var k=Array(80),m=1732584193,n=-271733879,l=-1732584194,o=271733878,q=-1009589776,r=0;r<c.length;r+=16){for(var t=m,w=n,v=l,A=o,F=q,H=0;80>H;H++){k[H]=16>H?c[r+H]:(k[H-3]^k[H-8]^k[H-14]^k[H-16])<<1|(k[H-3]^k[H-8]^k[H-14]^k[H-
16])>>>31;var u=m<<5|m>>>27,u=g(g(u,20>H?n&l|~n&o:40>H?n^l^o:60>H?n&l|n&o|l&o:n^l^o),g(g(q,k[H]),20>H?1518500249:40>H?1859775393:60>H?-1894007588:-899497514)),q=o,o=l,l=n<<30|n>>>2,n=m,m=u}m=g(m,t);n=g(n,w);l=g(l,v);o=g(o,A);q=g(q,F)}return[m,n,l,o,q]}(function(c){for(var g=[],k=0;k<8*c.length;k+=8)g[k>>5]|=(c.charCodeAt(k/8)&255)<<24-k%32;return g}(c),8*c.length))}};try{OAT.Loader.featureLoaded("crypto")}catch(ERROR$$40){}}
if(!gx.util.browser.isIE()||8<gx.util.browser.ieVersion()){(function(c){c.fn.tablePagination=function(g){var h={firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",!0),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",!0),lastArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",!0),nextArrow:!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/nextBlue.png",!0),rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:!1},g=c.extend(h,g);return this.each(function(){function j(j){if(!(0==j||j>H)){var j=(j-1)*h.rowsPerPage,k=j+h.rowsPerPage-1;c(A).show();for(var l=0;l<A.length;l++){(l<
j||l>k)&&c(A[l]).hide();if("pivot"===g.jstype)for(;null!=A[l].childNodes[0].getAttribute("pivotCorrect");)A[l].deleteCell(0);"tf"==A[l].getAttribute("visibQ")&&c(A[l]).hide()}if("pivot"===g.jstype&&1<j&&(null===A[j].childNodes[0].getAttribute("spanCorrect")||"0"===A[j].childNodes[0].getAttribute("spanCorrect"))){k=A[j-1];for(l=1;l<j+1&&!(0>j-l);l++)for(var k=A[j-l],m=0;m<k.childNodes.length;m++)if(void 0!=k.childNodes[m]&&void 0!=k.childNodes[m].getAttribute("rowspan")&&1<k.childNodes[m].getAttribute("rowspan")){if(k.childNodes[m].getAttribute("rowspan")<=
l||null!=k.childNodes[m].getAttribute("hidden"))break;for(var n=j;n<j+(k.childNodes[m].getAttribute("rowspan")-l);n++){var o=0;void 0!=A[n].childNodes[0].getAttribute("colspan")&&null!=A[n].childNodes[0].getAttribute("colspan")&&parseInt(A[n].childNodes[0].getAttribute("colspan"));var o=void 0!=k.childNodes[m].getAttribute("colspan")&&null!=k.childNodes[m].getAttribute("colspan")?parseInt(k.childNodes[m].getAttribute("colspan")):1,q=A[n].insertCell(m);q.setAttribute("pivotCorrect",!0);q.setAttribute("colspan",
o);q.setAttribute("class","pivotAdd");q.setAttribute("style",k.childNodes[m].style.cssText+"border-bottom: none; border-top: none;");n===j&&(q.innerHTML=k.childNodes[m].innerHTML,q.className=k.childNodes[m].className+" pivotAdd",q.removeChild(q.childNodes[0]));void 0!=A[n].childNodes[0].getAttribute("rowspan")&&null!=A[n].childNodes[0].getAttribute("rowspan")&&(n=n+parseInt(A[n].childNodes[0].getAttribute("rowspan"))-1)}}}}}function k(){var g=Math.round(F/h.rowsPerPage),g=g*h.rowsPerPage<F?g+1:g;
0<c(l)[t]().find(o).length&&c(l)[t]().find(o).html(g);return g}function m(g){1>g||g>H||(u=g,j(u),c(l)[t]().find(q).val(u))}function n(){var c=1;try{var j=100;gx.util.browser.webkit&&!(0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length)&&(j*=100);if(u>10*j){0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length&&(c+=2);for(j=u/j;10<j;)j/=10,c++}}catch(k){}!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(j=[],j.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>"),
j.push("<span id='tablePagination_perPage'>"),j.push("<select id='"+g.controlName+"tablePagination_rowsPerPage' style='margin-top: 1px;'><option value='5'>5</option></select>"),j.push(gx.getMessage("GXPL_QViewerJSPerPage")),j.push("</span>"),j.push("<span id='"+g.controlName+"_tablePagination_paginater'>"),j.push("<img class='pagefirst' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_firstPage' src='"+h.firstArrow+"'>"),j.push("<img class='pageprev' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_prevPage' src='"+
h.prevArrow+"'>"),j.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>"),j.push("<input id='tablePagination_currPage' type='input' value='"+u+"' size='"+c+"' style='margin-top: 2px;'>"),j.push("<span>&nbsp;"+gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+H+"</span>"),j.push("<img class='pagenext' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_nextPage' src='"+h.nextArrow+"'>"),j.push("<img class='pagelast' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_lastPage' src='"+
h.lastArrow+"'>")):(j=[],j.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>"),j.push("<span id='tablePagination_perPage'>"),j.push("<select id='"+g.controlName+"tablePagination_rowsPerPage' style='margin-top: 1px;'><option value='5'>5</option></select>"),j.push(gx.getMessage("GXPL_QViewerJSPerPage")),j.push("</span>"),j.push("<span id='"+g.controlName+"_tablePagination_paginater'>"),j.push("<span class='pagefirst_ios' id='tablePagination_firstPage'/>"),j.push("<span class='pageprev_ios'  id='tablePagination_prevPage' />"),
j.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>"),j.push("<input id='tablePagination_currPage' type='input' value='"+u+"' size='"+c+"' style='margin-top: 2px;'>"),j.push("<span>&nbsp;"+gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+H+"</span>"),j.push("<span class='pagenext_ios'  id='tablePagination_nextPage' />"),j.push("<span class='pagelast_ios'  id='tablePagination_lastPage' />"));j.push("</span>");j.push("</div>");return j.join("").toString()}
var l=c(this)[0],o,q,r;o="#tablePagination_totalPages";q="#tablePagination_currPage";r="#"+g.controlName+"tablePagination_rowsPerPage";var t=h.topNav?"prev":"next";try{h.rowsPerPage=parseInt(h.rowsPerPage)}catch(w){h.rowsPerPage=10}var v=c.makeArray(c("tbody tr",l)),A=c.grep(v,function(g){return-1==c.inArray(g,h.ignoreRows)},!1),F=A.length,H=k(),u=h.currPage>H?1:h.currPage;-1==c.inArray(h.rowsPerPage,h.optionsForRows)&&h.optionsForRows.push(h.rowsPerPage);0==c(l)[t]().find(o).length?h.topNav?c(this).before(n()):
(c(this).after(n()),1==H?c("#"+g.controlName+"_tablePagination_paginater").css("display","none"):c("#"+g.controlName+"_tablePagination_paginater").css("display","")):c(l)[t]().find(q).val(u);(function(){var j=h.optionsForRows;j.sort(function(c,g){return c-g});for(var k=c(l)[t]().find(r)[0],m=k.length=0;m<j.length;m++)k.options[m]=j[m]==h.rowsPerPage?new Option(j[m],j[m],true,true):new Option(j[m],j[m]);A.length<=h.rowsPerPage?c("#"+g.controlName+"_tablePagination").css("display","none"):c("#"+g.controlName+
"_tablePagination").css("display","");H==1||H==0?c("#"+g.controlName+"_tablePagination_paginater").css("display","none"):c("#"+g.controlName+"_tablePagination_paginater").css("display","")})();j(u);c(l)[t]().find("#tablePagination_firstPage").bind("click",function(){m(1)});c(l)[t]().find("#tablePagination_prevPage").bind("click",function(){m(u-1)});c(l)[t]().find("#tablePagination_nextPage").bind("click",function(){m(parseInt(u)+1)});c(l)[t]().find("#tablePagination_lastPage").bind("click",function(){m(H)});
c(l)[t]().find(q).bind("change",function(){m(this.value)});c(l)[t]().find(r).bind("change",function(){h.rowsPerPage=parseInt(this.value,10);H=k();m(1);H==1?c("#"+g.controlName+"_tablePagination_paginater").css("display","none"):c("#"+g.controlName+"_tablePagination_paginater").css("display","")})})}})(jQuery);var currPageNumber=[];(function(c){c.fn.partialTablePagination=function(g){var h={firstArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+
gx.staticDirectory+"QueryViewer/oatPivot/images/PageFirst.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/firstBlue.png",!0),prevArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PagePrevious.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/prevBlue.png",!0),lastArrow:!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageLast.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/lastBlue.png",!0),nextArrow:!gx.util.browser.isIPad()&&!gx.util.browser.isIPhone()?(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+"QueryViewer/oatPivot/images/PageNext.png",!0):(new Image).src=gx.util.resourceUrl(gx.basePath+gx.staticDirectory+
"QueryViewer/oatPivot/images/nextBlue.png",!0),rowsPerPage:5,currPage:1,jstype:"pivot",optionsForRows:[5,10,25,50,100],ignoreRows:[],topNav:!1,cantPages:10},g=c.extend(h,g);return this.each(function(){function j(j,k){if(!(1>j||j>jQuery("#"+g.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].innerHTML.replace("&nbsp;","")))if(currPageNumber[g.controlName]=j,c(m)[o]().find(n).val(currPageNumber[g.controlName]),g.control&&"table"==g.jstype){var l=k?h.rowsPerPage:OAT_JS.grid.gridData[g.controlUcId].rowsPerPage;
g.control.getDataForTable(g.controlUcId,j,l,k,"","","","","",!0)}else g.control&&(l=k?h.rowsPerPage:g.control.rowsPerPage,g.control.getDataForPivot(g.controlUcId,j,l,k,"","","","","",!0))}function k(){var c=1;try{var j=100;gx.util.browser.webkit&&!(0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length)&&(j*=100);if(currPageNumber[g.controlName]>10*j){0<jQuery("#"+g.controlName).closest(".gxwebcomponent").length&&(c+=2);for(var k=currPageNumber[g.controlName]/j;10<k;)k/=10,c++}}catch(l){}!gx.util.browser.isIPad()&&
!gx.util.browser.isIPhone()?(j=[],j.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>"),j.push("<span id='tablePagination_perPage'>"),j.push("<select id='"+g.controlName+"tablePagination_rowsPerPage' style='margin-top: 1px;'></select>"),j.push(gx.getMessage("GXPL_QViewerJSPerPage")),j.push("</span>"),j.push("<span id='"+g.controlName+"_tablePagination_paginater'>"),j.push("<img class='pagefirst' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_firstPage' src='"+
h.firstArrow+"'>"),j.push("<img class='pageprev' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_prevPage' src='"+h.prevArrow+"'>"),j.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>"),j.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[g.controlName]+"' size='"+c+"' style='margin-top: 2px;'>"),j.push("<span>&nbsp;"+gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+t+"</span>"),
j.push("<img class='pagenext' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_nextPage' src='"+h.nextArrow+"'>"),j.push("<img class='pagelast' style='vertical-align:middle; width:0px; height:0px;' id='tablePagination_lastPage' src='"+h.lastArrow+"'>")):(j=[],j.push("<div id='"+g.controlName+"_tablePagination' class='pivot_pag_div'>"),j.push("<span id='tablePagination_perPage'>"),j.push("<select id='"+g.controlName+"tablePagination_rowsPerPage' style='margin-top: 1px;'><option value='5'>5</option></select>"),
j.push(gx.getMessage("GXPL_QViewerJSPerPage")),j.push("</span>"),j.push("<span id='"+g.controlName+"_tablePagination_paginater'>"),j.push("<span class='pagefirst_ios' id='tablePagination_firstPage'/>"),j.push("<span class='pageprev_ios'  id='tablePagination_prevPage' />"),j.push("<span style=''>&nbsp;"+gx.getMessage("GXPL_QViewerJSPage")+"&nbsp;</span>"),j.push("<input id='tablePagination_currPage' type='input' value='"+currPageNumber[g.controlName]+"' size='"+c+"' style='margin-top: 2px;'>"),j.push("<span>&nbsp;"+
gx.getMessage("GXPL_QViewerJSOf")+"</span><span id='tablePagination_totalPages'>&nbsp;"+t+"</span>"),j.push("<span class='pagenext_ios'  id='tablePagination_nextPage' />"),j.push("<span class='pagelast_ios'  id='tablePagination_lastPage' />"));j.push("</span>");j.push("</div>");return j.join("").toString()}var m=c(this)[0],n,l;n="#tablePagination_currPage";l="#"+g.controlName+"tablePagination_rowsPerPage";var o=h.topNav?"prev":"next";try{h.rowsPerPage=parseInt(h.rowsPerPage)}catch(q){h.rowsPerPage=
10}var r=c.makeArray(c("tbody tr",m));c.grep(r,function(g){return-1==c.inArray(g,h.ignoreRows)},!1);var t=h.cantPages;currPageNumber[g.controlName]=h.currPage>t?1:h.currPage;-1==c.inArray(h.rowsPerPage,h.optionsForRows)&&h.optionsForRows.push(h.rowsPerPage);0==c(m)[o]().find("#tablePagination_totalPages").length?h.topNav?c(this).before(k()):c(this).after(k()):c(m)[o]().find(n).val(currPageNumber[g.controlName]);(function(){var j=h.optionsForRows;j.sort(function(c,g){return c-g});for(var k=c(m)[o]().find(l)[0],
n=k.length=0;n<j.length;n++)k.options[n]=j[n]==h.rowsPerPage?new Option(j[n],j[n],!0,!0):new Option(j[n],j[n]);1==t||0==t?c("#"+g.controlName+"_tablePagination_paginater").css("display","none"):c("#"+g.controlName+"_tablePagination_paginater").css("display","")})();c(m)[o]().find("#tablePagination_firstPage").bind("click",function(){j(1,!1)});c(m)[o]().find("#tablePagination_prevPage").bind("click",function(){j(currPageNumber[g.controlName]-1,!1)});c(m)[o]().find("#tablePagination_nextPage").bind("click",
function(){j(parseInt(currPageNumber[g.controlName])+1,!1)});c(m)[o]().find("#tablePagination_lastPage").bind("click",function(){j(parseInt(c("#"+g.controlName+"_tablePagination_paginater #tablePagination_totalPages")[0].textContent.replace("&nbsp;","")),!1)});c(m)[o]().find(n).bind("change",function(){j(parseInt(this.value,10),!1)});c(m)[o]().find(l).bind("change",function(){h.rowsPerPage=parseInt(this.value,10);t=h.cantPages;j(1,!0)})})}})(jQuery)};
